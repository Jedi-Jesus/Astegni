<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tutor Market Analysis</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.3/dist/chart.umd.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="../css-tier-1/main.css">
    <style>
        .chart-container {
            max-width: 800px;
            margin: 0 auto;
        }
        .fade-in {
            animation: fadeIn 0.5s ease-in;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        table {
            border-collapse: collapse;
            width: 100%;
        }
        th, td {
            padding: 12px;
            text-align: left;
        }
        .tooltip {
            position: relative;
        }
        .tooltip .tooltip-text {
            visibility: hidden;
            width: 220px;
            background-color: #1f2937;
            color: #fff;
            text-align: center;
            border-radius: 6px;
            padding: 10px;
            position: absolute;
            z-index: 10;
            bottom: 125%;
            left: 50%;
            transform: translateX(-50%);
            opacity: 0;
            transition: opacity 0.3s;
        }
        .tooltip:hover .tooltip-text {
            visibility: visible;
            opacity: 1;
        }
        input[type="range"] {
            width: 100%;
            accent-color: #2563eb;
            cursor: pointer;
        }
        tr {
            transition: background-color 0.2s;
        }
        tr:hover {
            background-color: #f1f5f9;
        }
        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #2563eb;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            animation: spin 1s linear infinite;
            display: none;
            margin: 0 auto;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .positive {
            color: #16a34a; /* Tailwind green-600 */
        }
        .negative {
            color: #dc2626; /* Tailwind red-600 */
        }
    </style>
</head>
<body class="bg-gray-50 font-sans antialiased">
    <div class="container mx-auto p-6 max-w-5xl">
        <h1 class="text-4xl font-extrabold text-gray-900 mb-8 text-center">Tutor Market Analysis</h1>
        <div class="flex justify-center mb-8 space-x-4">
            <button onclick="toggleView('graph')" class="bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition duration-300 focus:outline-none focus:ring-2 focus:ring-blue-500" aria-label="View market data as graph">See Market (Graph)</button>
            <button onclick="toggleView('table')" class="bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition duration-300 focus:outline-none focus:ring-2 focus:ring-blue-500" aria-label="View market data as table">See Market (Table)</button>
            <button onclick="toggleView('price')" class="bg-green-600 text-white px-6 py-3 rounded-lg hover:bg-green-700 transition duration-300 focus:outline-none focus:ring-2 focus:ring-green-500" aria-label="Suggest hourly price">Suggest Price</button>
        </div>

        <!-- Graph View -->
        <div id="graphContainer" class="hidden bg-white p-6 rounded-xl shadow-lg chart-container">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-2xl font-semibold text-gray-700">Market Trends by Rating</h2>
                <div class="w-1/3">
                    <label class="block text-gray-700 mb-2 font-medium">Time Period (Months): <span id="timeValue" class="font-bold">3</span></label>
                    <input type="range" id="timePeriod" min="1" max="12" step="1" value="3" oninput="updateTimePeriod(this.value)" class="w-full" aria-label="Select time period for market data">
                    <select id="graphType" onchange="updateGraph()" class="border rounded-lg p-2 bg-gray-50 text-gray-700 mt-2 w-full" aria-label="Select graph type">
                        <option value="line">Line Graph</option>
                        <option value="bar">Bar Graph</option>
                    </select>
                </div>
            </div>
            <div id="spinner" class="spinner"></div>
            <canvas id="marketChart" class="hidden"></canvas>
            <div class="flex justify-center mt-4 space-x-4 flex-wrap">
                <label class="flex items-center m-1"><input type="checkbox" checked data-dataset="0" onchange="toggleDataset(this)" class="mr-2"> No. of Tutors</label>
                <label class="flex items-center m-1"><input type="checkbox" checked data-dataset="1" onchange="toggleDataset(this)" class="mr-2"> Avg Students</label>
                <label class="flex items-center m-1"><input type="checkbox" checked data-dataset="2" onchange="toggleDataset(this)" class="mr-2"> Avg Achievement</label>
                <label class="flex items-center m-1"><input type="checkbox" checked data-dataset="3" onchange="toggleDataset(this)" class="mr-2"> Avg Price</label>
                <label class="flex items-center m-1"><input type="checkbox" checked data-dataset="4" onchange="toggleDataset(this)" class="mr-2"> Avg Certifications</label>
                <label class="flex items-center m-1"><input type="checkbox" checked data-dataset="5" onchange="toggleDataset(this)" class="mr-2"> Avg Experience</label>
            </div>
        </div>

        <!-- Table View -->
        <div id="tableContainer" class="hidden bg-white p-6 rounded-xl shadow-lg">
            <h2 class="text-2xl font-semibold text-gray-700 mb-6">Market Data by Rating</h2>
            <div class="w-1/3 mb-4">
                <label class="block text-gray-700 mb-2 font-medium">Time Period (Months): <span id="tableTimeValue" class="font-bold">3</span></label>
                <input type="range" id="tableTimePeriod" min="1" max="12" step="1" value="3" oninput="updateTableTimePeriod(this.value)" class="w-full" aria-label="Select time period for table data">
            </div>
            <table class="min-w-full bg-white border rounded-lg">
                <thead class="bg-gray-100">
                    <tr>
                        <th class="border-b text-gray-700 font-medium">Rating</th>
                        <th class="border-b text-gray-700 font-medium">No. of Tutors</th>
                        <th class="border-b text-gray-700 font-medium">Avg Students</th>
                        <th class="border-b text-gray-700 font-medium">
                            Avg Achievement (%)
                            <span class="tooltip inline-block ml-1">
                                <svg class="w-4 h-4 text-gray-500" fill="currentColor" viewBox="0 0 20 20">
                                    <path d="M10 0a10 10 0 100 20 10 10 0 000-20zm1 15H9v-2h2v2zm0-4H9V5h2v6z"/>
                                </svg>
                                <span class="tooltip-text">Average percentage improvement or decline in student exam results for tutors with this rating.</span>
                            </span>
                        </th>
                        <th class="border-b text-gray-700 font-medium">
                            Avg Certifications
                            <span class="tooltip inline-block ml-1">
                                <svg class="w-4 h-4 text-gray-500" fill="currentColor" viewBox="0 0 20 20">
                                    <path d="M10 0a10 10 0 100 20 10 10 0 000-20zm1 15H9v-2h2v2zm0-4H9V5h2v6z"/>
                                </svg>
                                <span class="tooltip-text">Average number of teaching certifications held by tutors with this rating.</span>
                            </span>
                        </th>
                        <th class="border-b text-gray-700 font-medium">
                            Avg Experience (Years)
                            <span class="tooltip inline-block ml-1">
                                <svg class="w-4 h-4 text-gray-500" fill="currentColor" viewBox="0 0 20 20">
                                    <path d="M10 0a10 10 0 100 20 10 10 0 000-20zm1 15H9v-2h2v2zm0-4H9V5h2v6z"/>
                                </svg>
                                <span class="tooltip-text">Average years of tutoring experience for tutors with this rating.</span>
                            </span>
                        </th>
                        <th class="border-b text-gray-700 font-medium">Avg Price/Hour ($)</th>
                    </tr>
                </thead>
                <tbody id="marketTableBody"></tbody>
            </table>
        </div>

        <!-- Price Suggestion View -->
        <div id="priceContainer" class="hidden bg-white p-6 rounded-xl shadow-lg">
            <h2 class="text-2xl font-semibold text-gray-700 mb-6">Suggest Your Hourly Price</h2>
            <div class="grid grid-cols-1 gap-6">
                <div>
                    <label class="block text-gray-700 mb-2 font-medium">Time Period (Months): <span id="priceTimeValue" class="font-bold">3</span></label>
                    <input type="range" id="priceTimePeriod" min="1" max="12" step="1" value="3" oninput="updatePriceTimePeriod(this.value)" class="w-full" aria-label="Select time period for price suggestion">
                </div>
                <button onclick="suggestPrice()" class="bg-green-600 text-white px-6 py-3 rounded-lg hover:bg-green-700 transition duration-300 focus:outline-none focus:ring-2 focus:ring-green-500" aria-label="Calculate suggested price">Calculate Suggested Price</button>
                <div id="priceResult" class="text-gray-700 mt-4 hidden"></div>
            </div>
        </div>

        <!-- Market Insights -->
        <div class="mt-8 bg-white p-6 rounded-xl shadow-lg">
            <h2 class="text-2xl font-semibold text-gray-700 mb-4">Market Insights for New Tutors</h2>
            <p class="text-gray-600">Tutors with ratings above 4.5 can charge $50-$60/hour, while those with ratings around 4.2–4.5 typically charge $40-$50/hour. Tutors with ratings below 4.2 may charge $35-$40/hour. Longer time periods (9-12 months) show stronger trends, so building a consistent track record with high ratings is key to commanding higher rates.</p>
        </div>
    </div>

    <script>
        // Sample data for different time periods
        const tutorDataByTime = {
            3: [
                { name: "Tutor A", rating: 4.8, students: 20, achievement: 15, certifications: 2, experience: 5, pricePerHour: 50 },
                { name: "Tutor B", rating: 4.2, students: 15, achievement: 10, certifications: 1, experience: 3, pricePerHour: 40 },
                { name: "Tutor C", rating: 4.5, students: 25, achievement: 20, certifications: 3, experience: 7, pricePerHour: 60 },
                { name: "Tutor D", rating: 3.9, students: 10, achievement: -8, certifications: 0, experience: 2, pricePerHour: 35 },
                { name: "Tutor E", rating: 4.7, students: 30, achievement: 18, certifications: 2, experience: 6, pricePerHour: 55 }
            ],
            6: [
                { name: "Tutor A", rating: 4.7, students: 22, achievement: 16, certifications: 2, experience: 5.5, pricePerHour: 52 },
                { name: "Tutor B", rating: 4.3, students: 18, achievement: 12, certifications: 1, experience: 3.5, pricePerHour: 42 },
                { name: "Tutor C", rating: 4.6, students: 28, achievement: 22, certifications: 3, experience: 7.5, pricePerHour: 62 },
                { name: "Tutor D", rating: 4.0, students: 12, achievement: -9, certifications: 0, experience: 2.5, pricePerHour: 37 },
                { name: "Tutor E", rating: 4.8, students: 32, achievement: 19, certifications: 2, experience: 6.5, pricePerHour: 57 }
            ],
            9: [
                { name: "Tutor A", rating: 4.9, students: 25, achievement: 17, certifications: 3, experience: 6, pricePerHour: 55 },
                { name: "Tutor B", rating: 4.4, students: 20, achievement: 13, certifications: 1, experience: 4, pricePerHour: 45 },
                { name: "Tutor C", rating: 4.7, students: 30, achievement: 24, certifications: 4, experience: 8, pricePerHour: 65 },
                { name: "Tutor D", rating: 4.1, students: 15, achievement: -10, certifications: 1, experience: 3, pricePerHour: 40 },
                { name: "Tutor E", rating: 4.9, students: 35, achievement: 20, certifications: 3, experience: 7, pricePerHour: 60 }
            ],
            12: [
                { name: "Tutor A", rating: 5.0, students: 28, achievement: 18, certifications: 3, experience: 6.5, pricePerHour: 58 },
                { name: "Tutor B", rating: 4.5, students: 22, achievement: 14, certifications: 2, experience: 4.5, pricePerHour: 48 },
                { name: "Tutor C", rating: 4.8, students: 33, achievement: 25, certifications: 4, experience: 8.5, pricePerHour: 68 },
                { name: "Tutor D", rating: 4.2, students: 18, achievement: -11, certifications: 1, experience: 3.5, pricePerHour: 42 },
                { name: "Tutor E", rating: 5.0, students: 38, achievement: 22, certifications: 3, experience: 7.5, pricePerHour: 63 }
            ]
        };

        let chartInstance = null;
        let currentTimePeriod = 3;
        let visibleDatasets = [true, true, true, true, true, true];

        function aggregateDataByRating(tutorData) {
            const ratingRange = 0.1;
            const ratings = [...new Set(tutorData.map(t => Math.round(t.rating * 10) / 10))].sort((a, b) => a - b);
            return ratings.map(rating => {
                const similarTutors = tutorData.filter(t => t.rating >= rating - ratingRange && t.rating <= rating + ratingRange);
                const count = similarTutors.length;
                return {
                    rating: rating.toFixed(1),
                    count: count,
                    avgStudents: count ? (similarTutors.reduce((sum, t) => sum + t.students, 0) / count).toFixed(1) : 0,
                    avgAchievement: count ? (similarTutors.reduce((sum, t) => sum + t.achievement, 0) / count).toFixed(1) : 0,
                    avgCertifications: count ? (similarTutors.reduce((sum, t) => sum + t.certifications, 0) / count).toFixed(1) : 0,
                    avgExperience: count ? (similarTutors.reduce((sum, t) => sum + t.experience, 0) / count).toFixed(1) : 0,
                    avgPrice: count ? (similarTutors.reduce((sum, t) => sum + t.pricePerHour, 0) / count).toFixed(2) : 0
                };
            });
        }

        function toggleView(view) {
            const graphContainer = document.getElementById('graphContainer');
            const tableContainer = document.getElementById('tableContainer');
            const priceContainer = document.getElementById('priceContainer');
            graphContainer.classList.add('hidden');
            tableContainer.classList.add('hidden');
            priceContainer.classList.add('hidden');

            if (view === 'graph') {
                graphContainer.classList.remove('hidden');
                graphContainer.classList.add('fade-in');
                if (!chartInstance) updateGraph();
            } else if (view === 'table') {
                tableContainer.classList.remove('hidden');
                tableContainer.classList.add('fade-in');
                populateTable();
            } else if (view === 'price') {
                priceContainer.classList.remove('hidden');
                priceContainer.classList.add('fade-in');
                suggestPrice();
            }
            setTimeout(() => {
                graphContainer.classList.remove('fade-in');
                tableContainer.classList.remove('fade-in');
                priceContainer.classList.remove('fade-in');
            }, 500);
        }

        function updateTimePeriod(value) {
            currentTimePeriod = parseInt(value);
            document.getElementById('timeValue').textContent = value;
            document.getElementById('tableTimeValue').textContent = value;
            document.getElementById('priceTimeValue').textContent = value;
            updateGraph();
            populateTable();
            if (!document.getElementById('priceContainer').classList.contains('hidden')) {
                suggestPrice();
            }
        }

        function updateTableTimePeriod(value) {
            currentTimePeriod = parseInt(value);
            document.getElementById('timeValue').textContent = value;
            document.getElementById('tableTimeValue').textContent = value;
            document.getElementById('priceTimeValue').textContent = value;
            populateTable();
        }

        function updatePriceTimePeriod(value) {
            currentTimePeriod = parseInt(value);
            document.getElementById('timeValue').textContent = value;
            document.getElementById('tableTimeValue').textContent = value;
            document.getElementById('priceTimeValue').textContent = value;
            suggestPrice();
        }

        function toggleDataset(checkbox) {
            const datasetIndex = parseInt(checkbox.dataset.dataset);
            visibleDatasets[datasetIndex] = checkbox.checked;
            updateGraph();
        }

        function updateGraph() {
            const graphType = document.getElementById('graphType').value;
            const ctx = document.getElementById('marketChart').getContext('2d');
            const tutorData = tutorDataByTime[currentTimePeriod];
            const aggregatedData = aggregateDataByRating(tutorData);
            const spinner = document.getElementById('spinner');
            const canvas = document.getElementById('marketChart');

            spinner.style.display = 'block';
            canvas.classList.add('hidden');

            if (chartInstance) {
                chartInstance.destroy();
            }

            setTimeout(() => {
                chartInstance = new Chart(ctx, {
                    type: graphType,
                    data: {
                        labels: aggregatedData.map(data => data.rating),
                        datasets: [
                            {
                                label: 'Number of Tutors',
                                data: visibleDatasets[0] ? aggregatedData.map(data => data.count) : [],
                                borderColor: 'rgba(75, 192, 192, 1)',
                                backgroundColor: 'rgba(75, 192, 192, 0.4)',
                                yAxisID: 'y',
                                tension: graphType === 'line' ? 0.3 : 0,
                                pointRadius: 5,
                                datalabels: { display: visibleDatasets[0], align: 'top', color: '#374151', font: { size: 10 } }
                            },
                            {
                                label: 'Average Students',
                                data: visibleDatasets[1] ? aggregatedData.map(data => data.avgStudents) : [],
                                borderColor: 'rgba(255, 99, 132, 1)',
                                backgroundColor: 'rgba(255, 99, 132, 0.4)',
                                yAxisID: 'y1',
                                tension: graphType === 'line' ? 0.3 : 0,
                                pointRadius: 5,
                                datalabels: { display: visibleDatasets[1], align: 'top', color: '#374151', font: { size: 10 } }
                            },
                            {
                                label: 'Average Achievement (%)',
                                data: visibleDatasets[2] ? aggregatedData.map(data => data.avgAchievement) : [],
                                borderColor: 'rgba(54, 162, 235, 1)',
                                backgroundColor: 'rgba(54, 162, 235, 0.4)',
                                yAxisID: 'y2',
                                tension: graphType === 'line' ? 0.3 : 0,
                                pointRadius: 5,
                                datalabels: { display: visibleDatasets[2], align: 'top', color: '#374151', font: { size: 10 } }
                            },
                            {
                                label: 'Average Price per Hour ($)',
                                data: visibleDatasets[3] ? aggregatedData.map(data => data.avgPrice) : [],
                                borderColor: 'rgba(255, 206, 86, 1)',
                                backgroundColor: 'rgba(255, 206, 86, 0.4)',
                                yAxisID: 'y3',
                                tension: graphType === 'line' ? 0.3 : 0,
                                pointRadius: 5,
                                datalabels: { display: visibleDatasets[3], align: 'top', color: '#374151', font: { size: 10 } }
                            },
                            {
                                label: 'Average Certifications',
                                data: visibleDatasets[4] ? aggregatedData.map(data => data.avgCertifications) : [],
                                borderColor: 'rgba(153, 102, 255, 1)',
                                backgroundColor: 'rgba(153, 102, 255, 0.4)',
                                yAxisID: 'y4',
                                tension: graphType === 'line' ? 0.3 : 0,
                                pointRadius: 5,
                                datalabels: { display: visibleDatasets[4], align: 'top', color: '#374151', font: { size: 10 } }
                            },
                            {
                                label: 'Average Experience (Years)',
                                data: visibleDatasets[5] ? aggregatedData.map(data => data.avgExperience) : [],
                                borderColor: 'rgba(255, 159, 64, 1)',
                                backgroundColor: 'rgba(255, 159, 64, 0.4)',
                                yAxisID: 'y5',
                                tension: graphType === 'line' ? 0.3 : 0,
                                pointRadius: 5,
                                datalabels: { display: visibleDatasets[5], align: 'top', color: '#374151', font: { size: 10 } }
                            }
                        ]
                    },
                    options: {
                        responsive: true,
                        animation: { duration: 1000, easing: 'easeInOutQuad' },
                        scales: {
                            y: {
                                type: 'linear',
                                display: visibleDatasets[0],
                                position: 'left',
                                title: { display: true, text: 'No. of Tutors' },
                                min: 0
                            },
                            y1: {
                                type: 'linear',
                                display: visibleDatasets[1],
                                position: 'right',
                                title: { display: true, text: 'Avg Students' },
                                grid: { drawOnChartArea: false },
                                min: 0
                            },
                            y2: {
                                type: 'linear',
                                display: visibleDatasets[2],
                                position: 'right',
                                title: { display: true, text: 'Avg Achievement (%)', padding: { top: 10, bottom: 10 } },
                                grid: { drawOnChartArea: false }
                            },
                            y3: {
                                type: 'linear',
                                display: visibleDatasets[3],
                                position: 'right',
                                title: { display: true, text: 'Avg Price ($)' },
                                grid: { drawOnChartArea: false },
                                min: 0
                            },
                            y4: {
                                type: 'linear',
                                display: visibleDatasets[4],
                                position: 'right',
                                title: { display: true, text: 'Avg Certifications' },
                                grid: { drawOnChartArea: false },
                                min: 0
                            },
                            y5: {
                                type: 'linear',
                                display: visibleDatasets[5],
                                position: 'right',
                                title: { display: true, text: 'Avg Experience (Years)' },
                                grid: { drawOnChartArea: false },
                                min: 0
                            },
                            x: {
                                title: { display: true, text: 'Rating' }
                            }
                        },
                        plugins: {
                            legend: { display: true, position: 'top' },
                            tooltip: {
                                mode: 'index',
                                intersect: false,
                                callbacks: {
                                    label: function(context) {
                                        let label = context.dataset.label || '';
                                        if (label) label += ': ';
                                        label += context.parsed.y;
                                        return label;
                                    }
                                }
                            },
                            datalabels: {
                                display: false
                            }
                        }
                    },
                    plugins: [ChartDataLabels]
                });

                spinner.style.display = 'none';
                canvas.classList.remove('hidden');
            }, 300);
        }

        function populateTable() {
            const tableBody = document.getElementById('marketTableBody');
            const tutorData = tutorDataByTime[currentTimePeriod];
            const aggregatedData = aggregateDataByRating(tutorData);
            tableBody.innerHTML = '';
            aggregatedData.forEach(data => {
                const row = document.createElement('tr');
                row.classList.add('border-b');
                const achievement = parseFloat(data.avgAchievement);
                const signClass = achievement >= 0 ? 'positive' : 'negative';
                const sign = achievement >= 0 ? '+' : '−';
                const achievementDisplay = `${sign}${Math.abs(achievement).toFixed(1)}`;
                row.innerHTML = `
                    <td class="text-gray-700">${data.rating}</td>
                    <td class="text-gray-700">${data.count}</td>
                    <td class="text-gray-700">${data.avgStudents}</td>
                    <td class="text-gray-700"><span class="${signClass}">${achievementDisplay}</span></td>
                    <td class="text-gray-700">${data.avgCertifications}</td>
                    <td class="text-gray-700">${data.avgExperience}</td>
                    <td class="text-gray-700">${data.avgPrice}</td>
                `;
                tableBody.appendChild(row);
            });
        }

        function suggestPrice() {
            const priceResult = document.getElementById('priceResult');
            const tutorData = tutorDataByTime[currentTimePeriod];

            // Simulate system data for the logged-in user by selecting a random tutor
            const randomTutor = tutorData[Math.floor(Math.random() * tutorData.length)];
            const username = randomTutor.name;
            const rating = randomTutor.rating;

            // Find tutors with similar ratings (within ±0.1)
            const ratingRange = 0.1;
            const similarTutors = tutorData.filter(tutor => 
                tutor.rating >= rating - ratingRange && tutor.rating <= rating + ratingRange
            );

            // Calculate average price of tutors with similar ratings
            const avgPrice = similarTutors.length > 0
                ? similarTutors.reduce((sum, tutor) => sum + tutor.pricePerHour, 0) / similarTutors.length
                : tutorData.reduce((sum, tutor) => sum + tutor.pricePerHour, 0) / tutorData.length;

            // Time period adjustment (longer periods increase price slightly)
            const timeFactor = 1 + (currentTimePeriod - 3) * 0.05;

            // Suggested price: Adjust average price by time factor
            const suggestedPrice = Math.round(avgPrice * timeFactor);

            // Ensure price is within a reasonable range
            const finalPrice = Math.max(20, Math.min(suggestedPrice, 100));

            // Personalized output
            priceResult.innerHTML = `
                <p class="text-green-600 font-semibold">Dear ${username},</p>
                <p class="text-gray-600">Your Rating: ${rating.toFixed(1)}</p>
                <p class="text-green-600 font-semibold">Based on your rating, your suggested hourly price is: $${finalPrice} (based on ${currentTimePeriod}-month market trends)</p>
                <p class="text-gray-600 text-sm mt-2">Breakdown:</p>
                <ul class="text-gray-600 text-sm list-disc list-inside">
                    <li>Matched with ${similarTutors.length} tutor(s) with ratings between ${Math.max(0, rating - ratingRange).toFixed(1)} and ${(rating + ratingRange).toFixed(1)}</li>
                    <li>Average price of similar tutors: $${avgPrice.toFixed(2)}</li>
                    <li>Time Adjustment: +${Math.round((timeFactor - 1) * 100)}% for ${currentTimePeriod}-month trends</li>
                </ul>
            `;
            priceResult.classList.remove('hidden');
        }
    </script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.2.0/dist/chartjs-plugin-datalabels.min.js"></script>
</body>
</html>
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Advanced Notes Dashboard</title>
  <link rel="stylesheet" href="../css/main.css">
  <link rel="stylesheet" href="../css/notes.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://unpkg.com/html-docx-js@0.3.1/dist/html-docx.min.js"></script>
</head>
<body>
  <!-- Header -->
  <header class="header">
    <div class="header-content">
      <div class="logo">
        <span>üìö</span>
        <span>Advanced Notes</span>
      </div>
      <div class="header-actions">
        <span id="save-status" class="save-status"></span>
        <button class="theme-toggle" onclick="toggleTheme()">
          <span class="theme-icon">üåô</span>
          <span class="theme-text">Dark Mode</span>
        </button>
      </div>
    </div>
  </header>

  <!-- Main Container -->
  <div class="main-container">
    <!-- Dashboard View -->
    <div class="dashboard" id="dashboard">
      <div class="dashboard-header">
        <h1 class="dashboard-title">My Notes</h1>
        <p class="dashboard-subtitle">Organize your thoughts and knowledge</p>
      </div>

      <!-- Stats Bar -->
      <div class="stats-bar">
        <div class="stat-item">
          <span class="stat-number" id="totalNotes">0</span>
          <span class="stat-label">Total Notes</span>
        </div>
        <div class="stat-item">
          <span class="stat-number" id="totalWords">0</span>
          <span class="stat-label">Total Words</span>
        </div>
        <div class="stat-item">
          <span class="stat-number" id="totalCourses">0</span>
          <span class="stat-label">Courses</span>
        </div>
        <div class="stat-item">
          <span class="stat-number" id="recentNotes">0</span>
          <span class="stat-label">This Week</span>
        </div>
      </div>

      <!-- Search and Filter Bar -->
      <div class="controls-bar">
        <div class="search-box">
          <span class="search-icon">üîç</span>
          <input type="text" class="search-input" id="searchInput" placeholder="Search notes...">
        </div>
        <div class="filter-buttons">
          <button class="filter-btn active" data-filter="all">All Notes</button>
          <button class="filter-btn" data-filter="recent">Recent</button>
          <button class="filter-btn" data-filter="favorites">Favorites</button>
          <button class="filter-btn" data-filter="media">Media Notes</button>
        </div>
        <select class="sort-select" id="sortSelect">
          <option value="date-desc">Newest First</option>
          <option value="date-asc">Oldest First</option>
          <option value="title">Title A-Z</option>
          <option value="course">By Course</option>
        </select>
      </div>

      <!-- Notes Grid -->
      <div class="notes-grid" id="notesGrid">
        <!-- New Note Card -->
        <div class="note-card new-note" onclick="createNewNote()">
          <div class="new-note-icon">‚ûï</div>
          <div class="new-note-text">Create New Note</div>
        </div>
      </div>
    </div>

    <!-- Editor View -->
    <div class="editor-container" id="editorContainer">
      <!-- Main Editor -->
      <div class="editor-main">
        <div class="editor-header">
          <h2 class="editor-title" id="editorTitle">New Note</h2>
          <div class="editor-actions">
            <button class="btn btn-icon" onclick="backToDashboard()" title="Back to Dashboard">
              ‚Üê
            </button>
            <button class="btn btn-secondary" onclick="duplicateNote()">
              <span>üìã</span> Duplicate
            </button>
            <div class="dropdown">
              <button class="btn btn-secondary dropdown-toggle" onclick="toggleExportMenu()">
                <span>üì•</span> Export
              </button>
              <div class="dropdown-menu" id="exportMenu">
                <button class="dropdown-item" onclick="exportNoteAsPDF()">
                  <span>üìÑ</span> Export as PDF
                </button>
                <button class="dropdown-item" onclick="exportNoteAsDoc()">
                  <span>üìù</span> Export as Word
                </button>
                <button class="dropdown-item" onclick="exportNoteAsMarkdown()">
                  <span>üìã</span> Export as Markdown
                </button>
                <button class="dropdown-item" onclick="exportNoteAsHTML()">
                  <span>üåê</span> Export as HTML
                </button>
              </div>
            </div>
            <button class="btn btn-secondary" onclick="toggleFavorite()" id="favoriteBtn">
              <span>‚≠ê</span>
            </button>
            <button class="btn btn-danger" onclick="deleteCurrentNote()">
              <span>üóëÔ∏è</span> Delete
            </button>
            <button class="btn btn-primary" onclick="saveNote()">
              <span>üíæ</span> Save
            </button>
          </div>
        </div>

        <!-- Form -->
        <div class="form-section">
          <div class="form-grid">
            <div class="form-group full-width">
              <label class="form-label">Title</label>
              <input type="text" class="form-input" id="noteTitle" placeholder="Enter note title">
            </div>
            <div class="form-group">
              <label class="form-label">Date</label>
              <input type="datetime-local" class="form-input" id="noteDate">
            </div>
            <div class="form-group">
              <label class="form-label">Course</label>
              <div class="input-with-suggestions">
                <input type="text" class="form-input" id="noteCourse" placeholder="e.g., Mathematics 101">
                <div class="suggestions-dropdown" id="courseSuggestions"></div>
              </div>
            </div>
            <div class="form-group">
              <label class="form-label">Tutor</label>
              <div class="input-with-suggestions">
                <input type="text" class="form-input" id="noteTutor" placeholder="e.g., Dr. Smith">
                <div class="suggestions-dropdown" id="tutorSuggestions"></div>
              </div>
            </div>
            <div class="form-group">
              <label class="form-label">Tags</label>
              <input type="text" class="form-input" id="noteTags" placeholder="e.g., exam, important, review">
            </div>
          </div>
        </div>

        <!-- Editor Toolbar -->
        <div class="editor-toolbar">
          <div class="toolbar-group">
            <button class="toolbar-btn" onclick="formatText('bold')" title="Bold (Ctrl+B)">
              <b>B</b>
            </button>
            <button class="toolbar-btn" onclick="formatText('italic')" title="Italic (Ctrl+I)">
              <i>I</i>
            </button>
            <button class="toolbar-btn" onclick="formatText('underline')" title="Underline (Ctrl+U)">
              <u>U</u>
            </button>
            <button class="toolbar-btn" onclick="formatText('strikeThrough')" title="Strikethrough">
              <s>S</s>
            </button>
          </div>
          <div class="toolbar-separator"></div>
          <div class="toolbar-group">
            <button class="toolbar-btn" onclick="formatText('subscript')" title="Subscript">
              X<sub>2</sub>
            </button>
            <button class="toolbar-btn" onclick="formatText('superscript')" title="Superscript">
              X<sup>2</sup>
            </button>
          </div>
          <div class="toolbar-separator"></div>
          <div class="toolbar-group">
            <button class="toolbar-btn" onclick="showHighlightColors()" title="Highlight">
              <span style="background: yellow; padding: 2px;">H</span>
            </button>
            <div class="highlight-colors" id="highlightColors">
              <button class="color-btn" style="background: #FFEB3B" onclick="formatText('hiliteColor', '#FFEB3B')"></button>
              <button class="color-btn" style="background: #FFC107" onclick="formatText('hiliteColor', '#FFC107')"></button>
              <button class="color-btn" style="background: #4CAF50" onclick="formatText('hiliteColor', '#4CAF50')"></button>
              <button class="color-btn" style="background: #2196F3" onclick="formatText('hiliteColor', '#2196F3')"></button>
              <button class="color-btn" style="background: #E91E63" onclick="formatText('hiliteColor', '#E91E63')"></button>
            </div>
          </div>
          <div class="toolbar-separator"></div>
          <div class="toolbar-group">
            <button class="toolbar-btn" onclick="formatText('insertUnorderedList')" title="Bullet List">
              ‚Ä¢
            </button>
            <button class="toolbar-btn" onclick="formatText('insertOrderedList')" title="Numbered List">
              1.
            </button>
            <button class="toolbar-btn" onclick="formatText('indent')" title="Indent">
              ‚Üí
            </button>
            <button class="toolbar-btn" onclick="formatText('outdent')" title="Outdent">
              ‚Üê
            </button>
          </div>
          <div class="toolbar-separator"></div>
          <div class="toolbar-group">
            <select class="toolbar-select" onchange="formatText('fontSize', this.value)">
              <option value="">Size</option>
              <option value="1">Small</option>
              <option value="3">Normal</option>
              <option value="5">Large</option>
              <option value="7">Huge</option>
            </select>
            <input type="color" class="color-input" id="textColor" onchange="formatText('foreColor', this.value)" title="Text Color">
          </div>
          <div class="toolbar-separator"></div>
          <div class="toolbar-group">
            <button class="toolbar-btn media-btn" onclick="openVoiceRecorder()" title="Voice Note">
              üé§
            </button>
            <button class="toolbar-btn media-btn" onclick="openVideoRecorder()" title="Video Note">
              üé•
            </button>
            <button class="toolbar-btn transcribe-btn" onclick="startTranscription()" title="Transcribe Speech">
              üéôÔ∏è
            </button>
            <button class="toolbar-btn tts-btn" onclick="openTextToSpeech()" title="Text to Speech">
              üîä
            </button>
            <button class="toolbar-btn" onclick="openBackgroundModal()" title="Background">
              üñºÔ∏è
            </button>
            <button class="toolbar-btn" onclick="removeNoteBackground()" title="Remove Background">
              üóëÔ∏è
            </button>
          </div>
          <div class="toolbar-separator"></div>
          <div class="toolbar-group">
            <button class="toolbar-btn" onclick="formatText('undo')" title="Undo (Ctrl+Z)">
              ‚Ü∂
            </button>
            <button class="toolbar-btn" onclick="formatText('redo')" title="Redo (Ctrl+Y)">
              ‚Ü∑
            </button>
          </div>
        </div>

        <!-- Content Editor -->
        <div class="editor-content-wrapper">
          <div contenteditable="true" class="form-textarea" id="noteContent" placeholder="Start writing your note..."></div>
          
          <!-- Media Container -->
          <div class="media-container" id="mediaContainer">
            <!-- Media items will be added here dynamically with transcribe buttons -->
          </div>
          
          <div class="editor-footer">
            <span id="wordCount">0 words</span>
            <span id="charCount">0 characters</span>
            <span id="autoSaveIndicator" class="auto-save-indicator">
              <span class="auto-save-dot"></span>
              Auto-save enabled
            </span>
            <span id="lastSaved">Not saved</span>
          </div>
        </div>

        <!-- Action Buttons -->
        <div class="editor-actions-bottom">
          <button class="btn btn-secondary" onclick="cancelEdit()">Cancel</button>
          <button class="btn btn-primary" onclick="saveAndClose()">Save & Close</button>
        </div>
      </div>

      <!-- History Sidebar -->
      <div class="history-sidebar">
        <div class="history-header">
          <h3 class="history-title">Notes History</h3>
          <button class="btn btn-icon-small" onclick="toggleHistorySidebar()" title="Toggle Sidebar">
            ‚áÑ
          </button>
        </div>
        <div class="history-search">
          <input type="text" class="history-search-input" id="historySearch" placeholder="Search history...">
        </div>
        <div class="history-cards" id="historyCards">
          <!-- History cards will be populated here -->
        </div>
      </div>
    </div>
  </div>

  <!-- Voice Recorder Modal -->
  <div class="modal" id="voiceRecorderModal">
    <div class="modal-overlay" onclick="closeVoiceRecorder()"></div>
    <div class="modal-content recorder-modal">
      <div class="modal-header">
        <h3>Record Voice Note</h3>
        <button class="modal-close" onclick="closeVoiceRecorder()">√ó</button>
      </div>
      <div class="modal-body">
        <div class="recorder-interface">
          <div class="waveform-container">
            <canvas id="voiceWaveform" width="400" height="100"></canvas>
          </div>
          <div class="recorder-timer" id="voiceTimer">00:00</div>
          <div class="recorder-controls">
            <button class="recorder-btn record-btn" id="voiceRecordBtn" onclick="toggleVoiceRecording()">
              <span class="record-icon">‚óè</span> Start Recording
            </button>
            <button class="recorder-btn pause-btn" id="voicePauseBtn" onclick="pauseVoiceRecording()" disabled>
              ‚è∏ Pause
            </button>
            <button class="recorder-btn stop-btn" id="voiceStopBtn" onclick="stopVoiceRecording()" disabled>
              ‚¨õ Stop
            </button>
          </div>
          <div class="recording-status" id="voiceStatus">Ready to record</div>
          <audio id="voicePlayback" controls style="display: none; width: 100%; margin-top: 20px;"></audio>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" onclick="closeVoiceRecorder()">Cancel</button>
        <button class="btn btn-primary" id="saveVoiceBtn" onclick="saveVoiceNote()" disabled>Save Voice Note</button>
      </div>
    </div>
  </div>

  <!-- Video Recorder Modal -->
  <div class="modal" id="videoRecorderModal">
    <div class="modal-overlay" onclick="closeVideoRecorder()"></div>
    <div class="modal-content recorder-modal large">
      <div class="modal-header">
        <h3>Record Video Note</h3>
        <button class="modal-close" onclick="closeVideoRecorder()">√ó</button>
      </div>
      <div class="modal-body">
        <div class="recorder-interface">
          <div class="video-container">
            <video id="videoPreview" autoplay muted></video>
            <video id="videoPlayback" controls style="display: none;"></video>
          </div>
          <div class="recorder-timer" id="videoTimer">00:00</div>
          <div class="recorder-controls">
            <button class="recorder-btn record-btn" id="videoRecordBtn" onclick="toggleVideoRecording()">
              <span class="record-icon">‚óè</span> Start Recording
            </button>
            <button class="recorder-btn pause-btn" id="videoPauseBtn" onclick="pauseVideoRecording()" disabled>
              ‚è∏ Pause
            </button>
            <button class="recorder-btn stop-btn" id="videoStopBtn" onclick="stopVideoRecording()" disabled>
              ‚¨õ Stop
            </button>
            <button class="recorder-btn camera-switch" onclick="switchCamera()" title="Switch Camera">
              üîÑ
            </button>
          </div>
          <div class="recording-status" id="videoStatus">Camera ready</div>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" onclick="closeVideoRecorder()">Cancel</button>
        <button class="btn btn-primary" id="saveVideoBtn" onclick="saveVideoNote()" disabled>Save Video Note</button>
      </div>
    </div>
  </div>

  <!-- Transcription Modal -->
  <div class="modal" id="transcriptionModal">
    <div class="modal-overlay" onclick="closeTranscription()"></div>
    <div class="modal-content transcription-modal">
      <div class="modal-header">
        <h3>Speech to Text Transcription</h3>
        <button class="modal-close" onclick="closeTranscription()">√ó</button>
      </div>
      <div class="modal-body">
        <div class="transcription-interface">
          <div class="transcription-visualization">
            <div class="voice-wave">
              <span class="wave-bar"></span>
              <span class="wave-bar"></span>
              <span class="wave-bar"></span>
              <span class="wave-bar"></span>
              <span class="wave-bar"></span>
            </div>
          </div>
          
          <div class="language-selector">
            <label for="transcriptionLang">Language:</label>
            <select id="transcriptionLang" class="form-select">
              <option value="en-US">English (US)</option>
              <option value="en-GB">English (UK)</option>
              <option value="es-ES">Spanish</option>
              <option value="fr-FR">French</option>
              <option value="de-DE">German</option>
              <option value="it-IT">Italian</option>
              <option value="pt-BR">Portuguese</option>
              <option value="ru-RU">Russian</option>
              <option value="zh-CN">Chinese (Simplified)</option>
              <option value="ja-JP">Japanese</option>
              <option value="ko-KR">Korean</option>
              <option value="ar-SA">Arabic</option>
            </select>
          </div>
          
          <div class="transcription-controls">
            <button class="transcription-btn" id="startTranscribeBtn" onclick="toggleTranscription()">
              <span class="mic-icon">üé§</span> Start Listening
            </button>
            <button class="transcription-btn secondary" onclick="clearTranscription()">
              Clear Text
            </button>
          </div>
          
          <div class="transcription-status" id="transcriptionStatus">Ready to transcribe</div>
          
          <div class="transcription-result">
            <label>Transcribed Text:</label>
            <div class="transcription-text" id="transcriptionText" contenteditable="true"></div>
            <div class="transcription-confidence" id="transcriptionConfidence"></div>
          </div>
          
          <div class="transcription-options">
            <label class="checkbox-label">
              <input type="checkbox" id="continuousTranscription" checked>
              Continuous transcription
            </label>
            <label class="checkbox-label">
              <input type="checkbox" id="punctuationMode">
              Auto-punctuation
            </label>
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" onclick="closeTranscription()">Cancel</button>
        <button class="btn btn-primary" onclick="insertTranscription()">Insert to Note</button>
      </div>
    </div>
  </div>

  <!-- Text to Speech Modal -->
  <div class="modal" id="ttsModal">
    <div class="modal-overlay" onclick="closeTextToSpeech()"></div>
    <div class="modal-content tts-modal">
      <div class="modal-header">
        <h3>Convert Text to Speech</h3>
        <button class="modal-close" onclick="closeTextToSpeech()">√ó</button>
      </div>
      <div class="modal-body">
        <div class="tts-interface">
          <div class="tts-text-input">
            <label>Text to Convert:</label>
            <textarea id="ttsText" class="form-textarea" placeholder="Enter or paste text here, or click 'Use Note Content' to convert your entire note..."></textarea>
            <button class="btn btn-secondary" onclick="useNoteContent()">Use Note Content</button>
          </div>
          
          <div class="tts-settings">
            <div class="tts-setting-group">
              <label for="ttsVoice">Voice:</label>
              <select id="ttsVoice" class="form-select">
                <!-- Voices will be populated dynamically -->
              </select>
            </div>
            
            <div class="tts-setting-group">
              <label for="ttsRate">Speed:</label>
              <div class="slider-container">
                <input type="range" id="ttsRate" min="0.5" max="2" value="1" step="0.1">
                <span id="ttsRateValue">1.0x</span>
              </div>
            </div>
            
            <div class="tts-setting-group">
              <label for="ttsPitch">Pitch:</label>
              <div class="slider-container">
                <input type="range" id="ttsPitch" min="0.5" max="2" value="1" step="0.1">
                <span id="ttsPitchValue">1.0</span>
              </div>
            </div>
            
            <div class="tts-setting-group">
              <label for="ttsVolume">Volume:</label>
              <div class="slider-container">
                <input type="range" id="ttsVolume" min="0" max="1" value="1" step="0.1">
                <span id="ttsVolumeValue">100%</span>
              </div>
            </div>
          </div>
          
          <div class="tts-controls">
            <button class="tts-btn play" id="ttsPlayBtn" onclick="playTextToSpeech()">
              ‚ñ∂Ô∏è Play
            </button>
            <button class="tts-btn pause" id="ttsPauseBtn" onclick="pauseTextToSpeech()" disabled>
              ‚è∏ Pause
            </button>
            <button class="tts-btn stop" id="ttsStopBtn" onclick="stopTextToSpeech()" disabled>
              ‚èπ Stop
            </button>
            <button class="tts-btn download" onclick="downloadAudio()">
              üíæ Save as Audio
            </button>
          </div>
          
          <div class="tts-progress">
            <div class="progress-bar">
              <div class="progress-fill" id="ttsProgress"></div>
            </div>
            <span id="ttsStatus">Ready</span>
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" onclick="closeTextToSpeech()">Close</button>
        <button class="btn btn-primary" onclick="saveAsAudioNote()">Save as Audio Note</button>
      </div>
    </div>
  </div>

  <!-- Transcribe Audio/Video Modal -->
  <div class="modal" id="mediaTranscriptionModal">
    <div class="modal-overlay" onclick="closeMediaTranscription()"></div>
    <div class="modal-content media-transcription-modal">
      <div class="modal-header">
        <h3>Transcribe Media</h3>
        <button class="modal-close" onclick="closeMediaTranscription()">√ó</button>
      </div>
      <div class="modal-body">
        <div class="media-transcription-interface">
          <div class="media-player" id="mediaPlayer">
            <!-- Media element will be inserted here -->
          </div>
          
          <div class="transcription-settings">
            <label for="mediaTranscriptionLang">Language:</label>
            <select id="mediaTranscriptionLang" class="form-select">
              <option value="en-US">English (US)</option>
              <option value="en-GB">English (UK)</option>
              <option value="es-ES">Spanish</option>
              <option value="fr-FR">French</option>
              <option value="de-DE">German</option>
              <option value="it-IT">Italian</option>
              <option value="pt-BR">Portuguese</option>
              <option value="ru-RU">Russian</option>
              <option value="zh-CN">Chinese (Simplified)</option>
              <option value="ja-JP">Japanese</option>
              <option value="ko-KR">Korean</option>
              <option value="ar-SA">Arabic</option>
            </select>
          </div>
          
          <div class="transcription-controls">
            <button class="btn btn-primary" onclick="startMediaTranscription()">
              Start Transcription
            </button>
          </div>
          
          <div class="transcription-progress">
            <div class="progress-bar">
              <div class="progress-fill" id="mediaTranscriptionProgress"></div>
            </div>
            <span id="mediaTranscriptionStatus">Ready to transcribe</span>
          </div>
          
          <div class="transcription-result">
            <label>Transcription Result:</label>
            <div class="transcription-text" id="mediaTranscriptionResult" contenteditable="true"></div>
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" onclick="closeMediaTranscription()">Cancel</button>
        <button class="btn btn-primary" onclick="insertMediaTranscription()">Insert to Note</button>
      </div>
    </div>
  </div>

  <!-- Background Modal -->
  <div class="modal" id="backgroundModal">
    <div class="modal-overlay" onclick="closeBackgroundModal()"></div>
    <div class="modal-content">
      <div class="modal-header">
        <h3>Select Background Pattern</h3>
        <button class="modal-close" onclick="closeBackgroundModal()">√ó</button>
      </div>
      <div class="modal-body">
        <div class="background-grid">
          <div class="background-option" onclick="setNoteBackground('math')">
            <img src="../pictures/Math wallpaper 1.jpeg" alt="Math">
            <span>Mathematics</span>
          </div>
          <div class="background-option" onclick="setNoteBackground('physics')">
            <img src="../pictures/Physics wall paper 1.jpeg" alt="Physics">
            <span>Physics</span>
          </div>
          <div class="background-option" onclick="setNoteBackground('biology')">
            <img src="../pictures/Biology wallpaper 1.jpeg" alt="Biology">
            <span>Biology</span>
          </div>
          <div class="background-option" onclick="setNoteBackground('chemistry')">
            <img src="../pictures/chemistry wall paper 2.jpeg" alt="Chemistry">
            <span>Chemistry</span>
          </div>
          <div class="background-option" onclick="setNoteBackground('geography')">
            <img src="../pictures/Geography wallpaper 1.jpeg" alt="Geography">
            <span>Geography</span>
          </div>
          <div class="background-option" onclick="setNoteBackground('history')">
            <img src="../pictures/History wallpaper 1.jpeg" alt="History">
            <span>History</span>
          </div>
          <div class="background-option" onclick="setNoteBackground('music')">
            <img src="../pictures/Music.jpeg" alt="Music">
            <span>Music</span>
          </div>
          <div class="background-option upload-option">
            <input type="file" id="uploadBackground" accept="image/*" onchange="uploadBackgroundImage()">
            <label for="uploadBackground">
              <span>üì§</span>
              <span>Upload Custom</span>
            </label>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script src="../js/notes.js"></script>
</body>
</html>
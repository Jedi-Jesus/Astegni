<!DOCTYPE html>
<html lang="en" data-theme="light">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ASTEGNI - View Tutor Profile</title>
    <!-- Preconnect for faster font loading -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <!-- Google Fonts - For Appearance Modal Font Selection -->
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Roboto:wght@400;500;700&family=Open+Sans:wght@400;600;700&family=Comic+Neue:wght@400;700&family=Caveat:wght@400;500;600;700&family=Patrick+Hand&family=Dancing+Script:wght@400;500;600;700&display=swap"
        rel="stylesheet">
    <!-- TailwindCSS CDN -->
    <script src="../js/config.js?v=20251217"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Animate.css for animations -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css" />
    <!-- Custom Styles -->
    <link rel="stylesheet" href="../css/root.css?v=3">
    <link rel="stylesheet" href="../css/root/profile-dropdown.css">
    <link rel="stylesheet" href="../css/find-tutors/navbar.css">
    <link rel="stylesheet" href="../css/shared/profile-responsive.css">
    <!-- admin.css removed - not needed for view pages, was causing tooltip transparency -->
    <link rel="stylesheet" href="../css/tutor-profile/tutor-profile.css?v=3">
    <link rel="stylesheet" href="../css/find-tutors/hero-section.css?v=3">
    <link rel="stylesheet" href="../css/view-tutor/view-tutor.css?v=13">
    <!-- Shared Modal Styles -->
    <link rel="stylesheet" href="../css/common-modals/access-restricted-modal.css">
    <link rel="stylesheet" href="../css/common-modals/add-role-modal.css">
    <link rel="stylesheet" href="../css/common-modals/coming-soon-modal.css">
    <link rel="stylesheet" href="../css/common-modals/promo-modal.css">
    <link rel="stylesheet" href="../css/common-modals/chat-modal.css">
    <!-- Standalone Chat Call Modal Styles -->
    <link rel="stylesheet" href="../css/common-modals/chat-call-modal.css">
    <link rel="stylesheet" href="../css/common-modals/view-request-modal.css">
    <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">

    <!-- Minimal inline styles -->
    <style>
        /* Compensate for fixed navbar */
        body {
            padding-top: 72px;
        }

        /* Profile header fixes */
        .profile-header-section {
            overflow: visible !important;
        }

        .profile-name {
            font-size: 2rem;
            font-weight: bold;
            color: var(--text-primary);
            margin-bottom: 0.5rem;
            white-space: normal !important;
            overflow: visible !important;
            text-overflow: clip !important;
            word-wrap: break-word;
        }

        /* Related Tutors Section - Fade-in styling */
        .related-tutors-section {
            margin-top: 3rem;
            margin-bottom: 3rem;
            opacity: 0;
            animation: fadeInSection 1s ease forwards;
            animation-delay: 0.3s;
        }

        @keyframes fadeInSection {
            from {
                opacity: 0;
                transform: translateY(20px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .related-tutors-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1.5rem;
            margin-top: 1.5rem;
        }

        .tutor-card-minimal {
            background: var(--card-bg);
            border-radius: 16px;
            padding: 1.5rem;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
            transition: all 0.3s ease;
            cursor: pointer;
            opacity: 0;
            animation: fadeInCard 0.6s ease forwards;
        }

        .tutor-card-minimal:nth-child(1) {
            animation-delay: 0.5s;
        }

        .tutor-card-minimal:nth-child(2) {
            animation-delay: 0.6s;
        }

        .tutor-card-minimal:nth-child(3) {
            animation-delay: 0.7s;
        }

        .tutor-card-minimal:nth-child(4) {
            animation-delay: 0.8s;
        }

        @keyframes fadeInCard {
            from {
                opacity: 0;
                transform: translateY(20px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .tutor-card-minimal:hover {
            transform: translateY(-8px);
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.15);
        }

        .tutor-card-minimal .tutor-avatar {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            object-fit: cover;
            margin: 0 auto 1rem;
            border: 3px solid var(--button-bg);
        }

        .tutor-card-minimal .tutor-name {
            font-size: 1.125rem;
            font-weight: 600;
            color: var(--heading);
            margin-bottom: 0.5rem;
            text-align: center;
        }

        .tutor-card-minimal .tutor-subjects {
            font-size: 0.875rem;
            color: var(--text-muted);
            text-align: center;
            margin-bottom: 0.75rem;
        }

        .tutor-card-minimal .tutor-rating {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            font-size: 0.875rem;
            color: #f59e0b;
            margin-bottom: 1rem;
        }

        .tutor-card-minimal .view-profile-btn {
            width: 100%;
            padding: 0.625rem;
            background: var(--button-bg);
            color: white;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .tutor-card-minimal .view-profile-btn:hover {
            background: var(--button-hover);
            transform: scale(1.05);
        }

        /* Pulse animation fallback for loading states */
        @keyframes pulse {

            0%,
            100% {
                opacity: 1;
            }

            50% {
                opacity: 0.5;
            }
        }

        .animate-pulse {
            animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }

        /* Similar Tutors Panel Styles - uses same tutor-card-minimal as related-tutors-section */
        #similar-panel .tutor-card-minimal {
            text-align: center;
        }

        #similar-panel .related-tutors-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1.5rem;
        }

        /* Empty state styling */
        .col-span-2 {
            grid-column: span 2;
        }

        #similar-panel .col-span-full {
            grid-column: 1 / -1;
        }

        /* Related tutors section text colors for dark mode */
        .related-tutors-section h2 {
            color: var(--heading);
        }

        .related-tutors-section .text-gray-600 {
            color: var(--text-secondary);
        }

        /* Right sidebar container - styles moved to view-tutor.css for proper responsive control */
        /* REMOVED: Inline styles were preventing responsive breakpoints from working */

        /* Main content animation when sidebar opens - only target the main section */
        section.py-8 {
            transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            transform: translateX(0);
            position: relative;
        }

        section.py-8.sidebar-active {
            transform: translateX(280px) !important;
        }

        /* Prevent nested sections from double-transforming */
        section.sidebar-active section {
            transform: none !important;
        }

        /* Specifically prevent these nested sections from shifting */
        .profile-header-section.sidebar-active,
        .related-tutors-section.sidebar-active,
        .bottom-widgets.sidebar-active,
        .hero-section.sidebar-active {
            transform: none !important;
        }

        /* Ad containers animation */
        .promo-container.sidebar-active,
        .ad-placeholder.sidebar-active {
            transform: translateX(280px) !important;
        }

        /* Body animation for full page push */
        body {
            transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        body.sidebar-active {
            overflow-x: hidden;
        }

        /* Story Ring Animation - Astegni Theme */
        @keyframes astegniPulse {
            0% {
                box-shadow: 0 0 0 0 rgba(79, 70, 229, 0.4);
            }

            70% {
                box-shadow: 0 0 0 15px rgba(79, 70, 229, 0);
            }

            100% {
                box-shadow: 0 0 0 0 rgba(79, 70, 229, 0);
            }
        }

        .story-ring-container:hover {
            transform: scale(1.05);
            transition: transform 0.3s ease;
            box-shadow: 0 10px 30px rgba(79, 70, 229, 0.3);
        }

        /* Story Viewer Modal */
        .story-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.95);
            z-index: 10000;
            animation: fadeIn 0.3s ease;
        }

        .story-modal.active {
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .story-content {
            max-width: 500px;
            max-height: 90vh;
            position: relative;
        }

        .story-image {
            width: 100%;
            height: auto;
            max-height: 85vh;
            object-fit: contain;
            border-radius: 12px;
        }

        .story-close {
            position: absolute;
            top: 20px;
            right: 20px;
            width: 40px;
            height: 40px;
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            color: white;
            font-size: 24px;
            transition: all 0.3s ease;
        }

        .story-close:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: scale(1.1);
        }

        /* Rating Tooltip Styles - Matching tutor-profile.html */
        .rating-tooltip-container {
            position: relative;
            display: inline-block;
            cursor: pointer;
        }

        .rating-tooltip {
            position: absolute;
            bottom: 120%;
            left: 50%;
            transform: translateX(-50%);
            background: var(--card-bg) !important;
            border: 1px solid rgba(var(--border-rgb), 0.2);
            border-radius: 16px;
            padding: 1.25rem;
            min-width: 320px;
            box-shadow: 0 12px 32px rgba(0, 0, 0, 0.15);
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
            z-index: 10000;
            pointer-events: none;
            backdrop-filter: none !important;
        }

        .rating-tooltip-container:hover .rating-tooltip {
            opacity: 1;
            visibility: visible;
            bottom: calc(100% + 10px);
            pointer-events: auto;
        }

        .rating-tooltip::before {
            content: '';
            position: absolute;
            top: 100%;
            left: 50%;
            transform: translateX(-50%);
            border: 8px solid transparent;
            border-top-color: var(--card-bg) !important;
            filter: drop-shadow(0 2px 2px rgba(0, 0, 0, 0.1));
        }

        /* Dark mode support - now handled by var(--card-bg) */

        /* Rating Metrics */
        .rating-metric {
            margin-bottom: 0.75rem;
        }

        .rating-metric:last-child {
            margin-bottom: 0;
        }

        .metric-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 0.25rem;
        }

        .metric-label {
            font-size: 0.8rem;
            color: var(--text-muted);
        }

        .metric-score {
            font-size: 0.8rem;
            font-weight: 600;
            color: #f59e0b;
        }

        .metric-bar {
            height: 6px;
            background: rgba(0, 0, 0, 0.1);
            border-radius: 3px;
            overflow: hidden;
        }

        [data-theme="dark"] .metric-bar {
            background: rgba(255, 255, 255, 0.1);
        }

        .metric-fill {
            height: 100%;
            background: linear-gradient(90deg, #f59e0b 0%, #d97706 100%);
            border-radius: 3px;
            transition: width 0.6s ease;
        }

        .story-progress {
            position: absolute;
            top: 10px;
            left: 10px;
            right: 10px;
            height: 3px;
            background: rgba(255, 255, 255, 0.3);
            border-radius: 2px;
        }

        .story-progress-bar {
            height: 100%;
            background: white;
            border-radius: 2px;
            width: 0;
            animation: storyProgress 5s linear forwards;
        }

        @keyframes storyProgress {
            from {
                width: 0;
            }

            to {
                width: 100%;
            }
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }

            to {
                opacity: 1;
            }
        }

        /* Story Panel Styles - Astegni Theme */
        .story-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.15);
        }

        .story-card img {
            transition: transform 0.3s ease;
        }

        .story-card:hover img {
            transform: scale(1.05);
        }

        .tutor-stories-grid {
            animation: fadeIn 0.6s ease;
        }

        /* Story Viewer Enhanced */
        .story-viewer-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.95);
            z-index: 10000;
            animation: fadeIn 0.3s ease;
        }

        .story-viewer-modal.active {
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .story-viewer-content {
            max-width: 500px;
            width: 90%;
            max-height: 90vh;
            position: relative;
        }

        .story-navigation {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            width: 100%;
            display: flex;
            justify-content: space-between;
            padding: 0 20px;
            pointer-events: none;
        }

        .story-nav-btn {
            width: 40px;
            height: 40px;
            background: rgba(255, 255, 255, 0.2);
            border: none;
            border-radius: 50%;
            color: white;
            font-size: 20px;
            cursor: pointer;
            pointer-events: all;
            transition: all 0.3s ease;
        }

        .story-nav-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: scale(1.1);
        }

        .story-viewer-modal .story-header {
            position: absolute;
            top: 20px;
            left: 20px;
            right: 20px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            z-index: 10;
        }

        .story-user-info {
            display: flex;
            align-items: center;
            gap: 10px;
            background: rgba(0, 0, 0, 0.5);
            padding: 8px 12px;
            border-radius: 25px;
            backdrop-filter: blur(10px);
        }

        .story-user-avatar {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            border: 2px solid white;
        }

        .story-user-details {
            color: white;
        }

        .story-username {
            font-weight: 600;
            font-size: 0.875rem;
            margin: 0;
        }

        .story-time {
            font-size: 0.75rem;
            opacity: 0.8;
            margin: 0;
        }

        /* Sidebar animation styles */
        #sidebar {
            transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        #sidebar.active {
            transform: translateX(0);
        }

        /* Responsive behavior */
        @media (max-width: 768px) {
            section.py-8.sidebar-active {
                transform: translateX(0) !important;
            }

            .promo-container.sidebar-active,
            .ad-placeholder.sidebar-active {
                transform: translateX(0) !important;
            }
        }

        /* Panel system */
        .panel-content {
            display: none;
        }

        .panel-content.active {
            display: block;
        }

        /* ============================================
           SUCCESS STORIES TICKER ANIMATION
           ============================================ */
        .success-ticker-container {
            height: 120px;
            overflow: hidden;
            position: relative;
            background: rgba(var(--button-bg-rgb), 0.02);
            border-radius: var(--radius-md);
        }

        .success-ticker,
        .subjects-ticker {
            animation: successTickerRoll 18s cubic-bezier(0.4, 0, 0.2, 1) infinite;
        }

        .success-story-item {
            display: flex;
            align-items: start;
            gap: 0.5rem;
            padding: 0.75rem;
            height: 120px;
            box-sizing: border-box;
            transition: background var(--transition-base);
        }

        .success-story-item:hover {
            background: rgba(var(--button-bg-rgb), 0.05);
        }

        /* Success Story Cards for Main Section - REMOVED: Now in css/view-tutor/view-tutor.css */
        /* These inline styles were conflicting with the external stylesheet */
        /* All .success-story, .story-student, .story-rating, .story-quote, .story-time styles moved to external CSS */

        @keyframes successTickerRoll {
            0% {
                transform: translateY(0);
            }

            14.28% {
                transform: translateY(0);
            }

            14.29% {
                transform: translateY(-120px);
            }

            28.57% {
                transform: translateY(-120px);
            }

            28.58% {
                transform: translateY(-240px);
            }

            42.86% {
                transform: translateY(-240px);
            }

            42.87% {
                transform: translateY(-360px);
            }

            57.14% {
                transform: translateY(-360px);
            }

            57.15% {
                transform: translateY(-480px);
            }

            71.43% {
                transform: translateY(-480px);
            }

            71.44% {
                transform: translateY(-600px);
            }

            85.71% {
                transform: translateY(-600px);
            }

            85.72% {
                transform: translateY(-720px);
            }

            99.99% {
                transform: translateY(-720px);
            }

            100% {
                transform: translateY(0);
            }
        }

        /* Pause animation on hover */
        .success-ticker-container:hover .success-ticker,
        .success-ticker-container:hover .subjects-ticker {
            animation-play-state: paused;
        }

        /* Shimmer animation for pricing boxes */
        @keyframes shimmer {
            0% {
                transform: translateX(-100%);
            }

            100% {
                transform: translateX(100%);
            }
        }
    </style>
    <!-- Profile Dropdown Fix - MUST load last -->
    <link rel="stylesheet" href="../css/view-tutor/profile-specific-fix.css">
</head>

<body class="font-sans">

    <!-- Navigation -->
    <nav class="navbar" role="navigation" aria-label="Main navigation">
        <div class="nav-container" style="max-width: 100%; padding: 0 1rem;">
            <div class="nav-brand">
                <button class="sidebar-toggle" id="hamburger" aria-label="Toggle sidebar">
                    <span class="hamburger">
                        <span></span>
                        <span></span>
                        <span></span>
                    </span>
                </button>
                <a href="../index.html" class="logo-container">
                    <div class="logo-text">
                        <span class="logo-main">Astegni</span>
                        <span class="logo-sub">View Tutor</span>
                    </div>
                    <span class="logo-badge">Beta</span>
                </a>
            </div>

            <!-- Right Section: Nav Menu + Actions -->
            <div class="nav-actions" style="display: flex; align-items: center; gap: 0.5rem; margin-right: 0;">
                <div class="nav-items" style="display: flex; gap: 0.25rem;">
                    <a class="nav-link" href="#" onclick="handleNavLinkClick(event, 'news')">
                        <span class="nav-icon">üì∞</span> News
                    </a>
                    <a class="nav-link" href="../branch/find-tutors.html">
                        <span class="nav-icon">üë®‚Äçüè´</span> Find Tutors
                    </a>
                    <a class="nav-link" href="../branch/videos.html">
                        <span class="nav-icon">üé¨</span> Videos
                    </a>
                    <a class="nav-link" href="#" onclick="handleNavLinkClick(event, 'store')">
                        <span class="nav-icon">üìö</span> Bookstore
                    </a>
                    <a class="nav-link" href="#" onclick="handleNavLinkClick(event, 'find-jobs')">
                        <span class="nav-icon">üíº</span> Find a Job
                    </a>
                </div>
                <!-- Profile container -->
                <div id="profile-container" class="profile-dropdown-container">
                    <button id="profile-dropdown-toggle" class="profile-dropdown-toggle"
                        onclick="toggleProfileDropdown()">
                        <img id="profile-pic" class="profile-pic" alt="Profile">
                        <span id="profile-name" class="profile-name"></span>
                        <svg class="dropdown-arrow" width="12" height="12" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd"
                                d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z"
                                clip-rule="evenodd"></path>
                        </svg>
                    </button>

                    <div id="profile-dropdown-menu" class="profile-dropdown-menu">
                        <!-- User info header - CLICKABLE to go to profile page -->
                        <a href="#" id="dropdown-profile-link" class="dropdown-header-link">
                            <div class="dropdown-header">
                                <img id="dropdown-profile-pic" class="profile-pic" alt="Profile">
                                <div class="dropdown-user-info">
                                    <span id="dropdown-user-name" class="dropdown-user-name"></span>
                                    <span id="dropdown-user-email" class="dropdown-user-email"></span>
                                    <span id="dropdown-user-role" class="dropdown-user-role"></span>
                                </div>
                                <svg class="dropdown-header-arrow" width="16" height="16" fill="currentColor"
                                    viewBox="0 0 20 20">
                                    <path fill-rule="evenodd"
                                        d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z"
                                        clip-rule="evenodd"></path>
                                </svg>
                            </div>
                        </a>

                        <div class="dropdown-divider"></div>

                        <!-- Deletion Countdown Banner (shown when role is scheduled for deletion) -->
                        <div id="deletion-countdown-banner" class="deletion-countdown-banner hidden">
                            <div class="countdown-content">
                                <div class="countdown-icon">
                                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                            d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                                    </svg>
                                </div>
                                <div class="countdown-text">
                                    <div class="countdown-title">Role Scheduled for Deletion</div>
                                    <div class="countdown-details">
                                        Your <span id="countdown-role-name" class="font-semibold"></span> role will be
                                        deleted in
                                        <span id="countdown-days" class="font-bold text-orange-600"></span> days
                                    </div>
                                </div>
                            </div>
                            <button onclick="openAddRoleModal()" class="countdown-restore-btn">
                                Restore Role
                            </button>
                        </div>

                        <div class="dropdown-divider" id="countdown-divider" style="display: none;"></div>

                        <!-- Role switcher (shown only if user has multiple roles) -->
                        <div id="role-switcher-section" class="role-switcher-section hidden">
                            <div class="dropdown-item-header">Switch Role</div>
                            <div id="role-options" class="role-options">
                                <!-- Role options will be dynamically added here -->
                            </div>
                            <div class="dropdown-divider"></div>
                        </div>

                        <div class="dropdown-divider"></div>

                        <button class="dropdown-item logout-item" onclick="showLogoutModal()">
                            <svg class="dropdown-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1">
                                </path>
                            </svg>
                            Logout
                        </button>
                    </div>
                </div>

                <!-- Notification Icon -->
                <button class="icon-btn" aria-label="Notifications">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9">
                        </path>
                    </svg>
                    <span class="notification-badge">3</span>
                </button>

                <!-- Theme Toggle -->
                <button id="theme-toggle-btn" class="icon-btn" aria-label="Toggle theme">
                    <svg id="theme-icon" class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z">
                        </path>
                    </svg>
                </button>
                <!-- Mobile Menu Button -->
                <button class="mobile-menu-btn" id="mobileMenuBtn" aria-label="Open mobile menu">
                    <span class="hamburger-line"></span>
                    <span class="hamburger-line"></span>
                    <span class="hamburger-line"></span>
                </button>
            </div>
        </div>
    </nav>

    <!-- Mobile Menu Overlay -->
    <div id="mobileMenuOverlay" class="mobile-menu-overlay hidden"></div>

    <!-- Mobile Slide-in Menu -->
    <div id="mobileMenu" class="mobile-menu hidden">
        <div class="mobile-menu-header">
            <div class="mobile-menu-logo">
                <span class="logo-main">Astegni</span>
                <span class="logo-badge">Beta</span>
            </div>
            <button class="mobile-menu-close" onclick="closeMobileMenu()">
                <svg width="24" height="24" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12">
                    </path>
                </svg>
            </button>
        </div>

        <div class="mobile-menu-content">
            <!-- Navigation Links -->
            <div class="mobile-nav-section">
                <a href="#" class="mobile-menu-link" onclick="handleNavLinkClick(event, 'news')">
                    <span class="nav-icon">üì∞</span> News
                </a>
                <a href="../branch/find-tutors.html" class="mobile-menu-link">
                    <span class="nav-icon">üë®‚Äçüè´</span> Find Tutors
                </a>
                <a href="../branch/videos.html" class="mobile-menu-link">
                    <span class="nav-icon">üé¨</span> Videos
                </a>
                <a href="#" class="mobile-menu-link" onclick="handleNavLinkClick(event, 'store')">
                    <span class="nav-icon">üìö</span> Bookstore
                </a>
                <a href="#" class="mobile-menu-link" onclick="handleNavLinkClick(event, 'find-jobs')">
                    <span class="nav-icon">üíº</span> Find a Job
                </a>
            </div>

            <!-- Profile Section -->
            <div class="mobile-profile-section">
                <div class="mobile-profile-header" id="mobile-profile-header" onclick="toggleMobileProfileDropdown()">
                    <img id="mobile-profile-pic" class="mobile-profile-pic" alt="Profile">
                    <div class="mobile-profile-info">
                        <span id="mobile-profile-name" class="mobile-profile-name"></span>
                        <span id="mobile-profile-role" class="mobile-profile-role"></span>
                    </div>
                    <svg class="mobile-dropdown-arrow" width="16" height="16" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd"
                            d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z"
                            clip-rule="evenodd"></path>
                    </svg>
                </div>
                <div class="mobile-profile-dropdown">
                    <a href="#" id="mobile-my-profile-link" class="mobile-dropdown-item">
                        <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
                        </svg>
                        My Profile
                    </a>
                    <div id="mobile-role-switcher" class="mobile-role-switcher hidden">
                        <div class="mobile-dropdown-divider"></div>
                        <div class="mobile-dropdown-label">Switch Role</div>
                        <div id="mobile-role-options"></div>
                    </div>
                    <div class="mobile-dropdown-divider"></div>
                    <button class="mobile-dropdown-item logout" onclick="showLogoutModal()">
                        <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1">
                            </path>
                        </svg>
                        Logout
                    </button>
                </div>
            </div>

            <!-- Theme Toggle -->
            <div class="mobile-theme-section">
                <button class="mobile-theme-toggle" onclick="toggleTheme()">
                    <svg class="theme-icon-sun" width="20" height="20" fill="none" stroke="currentColor"
                        viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z">
                        </path>
                    </svg>
                    <span>Toggle Theme</span>
                </button>
            </div>

            <!-- Notifications -->
            <div class="mobile-notifications-section">
                <button class="mobile-notifications-btn">
                    <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9">
                        </path>
                    </svg>
                    <span>Notifications</span>
                    <span class="mobile-notification-badge">3</span>
                </button>
            </div>
        </div>
    </div>

    <!-- Rotating Ad Section - 4 Placeholder Ads -->
    <div class="promo-container premium-promo" style="margin-top: 2rem;">
        <div class="promo-animation">
            <div class="pulse-ring"></div>
            <div class="pulse-ring"></div>
        </div>
        <div class="promo-content">
            <span class="promo-label">Featured</span>
            <h3 class="promo-title">Premium Advertising Space</h3>
            <p class="promo-text">Reach thousands of students, tutors, and parents across Ethiopia</p>
            <button class="promo-cta" onclick="event.stopPropagation(); openComingSoonModal('Advertising')">Learn More</button>
        </div>
        <div class="promo-visual">
            <div class="promo-circles">
                <div class="circle circle-1"></div>
                <div class="circle circle-2"></div>
                <div class="circle circle-3"></div>
            </div>
        </div>
    </div>

    <!-- Sidebar -->
    <aside id="sidebar" class="sidebar-container">
        <div class="sidebar-content">
            <div class="sidebar-nav">
                <h3>Tutor Profile</h3>

                <a href="#" onclick="switchPanel('overview'); return false;" class="sidebar-link active">
                    <span class="sidebar-icon">üë®‚Äçüè´</span>
                    <span>Dashboard</span>
                </a>
                <a href="#" onclick="switchPanel('stories'); return false;" class="sidebar-link">
                    <span class="sidebar-icon">üì∏</span>
                    <span>Stories</span>
                    <span class="badge-count" style="background: var(--button-bg);">24</span>
                </a>
                <a href="#" onclick="switchPanel('credentials'); return false;" class="sidebar-link">
                    <span class="sidebar-icon">üìú</span>
                    <span>Credentials</span>
                </a>
                <hr class="my-4 border-gray-300">
                <a href="#" onclick="switchPanel('packages'); return false;" class="sidebar-link">
                    <span class="sidebar-icon">üì¶</span>
                    <span>Packages</span>
                </a>
                <a href="#" onclick="switchPanel('reviews'); return false;" class="sidebar-link">
                    <span class="sidebar-icon">‚≠ê</span>
                    <span>Reviews & Ratings</span>
                    <span class="badge-count">234</span>
                </a>
                <hr class="my-4 border-gray-300">
                <a href="#" onclick="switchPanel('similar'); return false;" class="sidebar-link">
                    <span class="sidebar-icon">üë•</span>
                    <span>Similar Tutors</span>
                </a>
                <hr class="my-4 border-gray-300">
                <a href="#" onclick="switchPanel('settings'); return false;" class="sidebar-link">
                    <span class="sidebar-icon">‚öôÔ∏è</span>
                    <span>Settings</span>
                </a>
                <a href="#" onclick="showLogoutModal(); return false;"
                    class="sidebar-link text-red-500 hover:bg-red-50">
                    <span class="sidebar-icon">üö™</span>
                    <span>Logout</span>
                </a>
            </div>
        </div>
    </aside>

    <!-- Main Content -->
    <section class="py-8" style="padding-top: 1rem;">
        <div class="container mx-auto px-4">
            <!-- Main Content with Right Sidebar Layout -->
            <div class="flex gap-6">
                <!-- Left Content Area -->
                <div class="flex-1" style="min-width: 0;">
                    <!-- Panels Section -->
                    <div class="panels-container">
                        <!-- Overview Panel (Default) -->
                        <div id="overview-panel" class="panel-content active">

                            <!-- Hero Section -->
                            <section class="hero-section animate__animated animate__fadeIn mb-8">
                                <h2 class="hero-title">
                                    <span id="typedText">Excellence in Education, Delivered with Passion</span>
                                    <span id="cursor" class="cursor-blink">|</span>
                                </h2>
                                <p id="hero-subtitle" class="hero-subtitle">Empowering students through personalized
                                    learning and expert guidance</p>
                            </section>

                            <!-- Profile Header Section -->
                            <section class="profile-header-section mb-8">
                                <div class="cover-image-container relative">
                                    <img id="cover-img" src="../pictures/tutor cover.jpg" alt="Cover" class="cover-img"
                                        style="width: 100%; height: 280px; object-fit: cover; border-radius: 20px 20px 0 0;">
                                    <div class="cover-overlay"
                                        style="position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: linear-gradient(180deg, rgba(0,0,0,0.1) 0%, rgba(0,0,0,0.3) 100%);">
                                    </div>
                                </div>

                                <div class="profile-main-info"
                                    style="padding: 0 2rem 2rem 2rem; margin-top: -60px; position: relative; z-index: 5;">
                                    <div class="profile-info-wrapper"
                                        style="display: flex; gap: 2rem; align-items: flex-start;">
                                        <div class="profile-avatar-container"
                                            style="position: relative; flex-shrink: 0;">
                                            <!-- Story Ring Container -->
                                            <div class="story-ring-container" onclick="openStory()"
                                                style="position: relative; padding: 4px; background: var(--button-bg); border-radius: 50%; cursor: pointer; animation: astegniPulse 3s infinite;">
                                                <img id="profile-avatar" src="../pictures/tutor-male-young.jpg"
                                                    alt="Tutor Profile" class="profile-avatar"
                                                    style="width: 140px; height: 140px; border-radius: 50%; border: 4px solid var(--card-bg); box-shadow: 0 8px 24px rgba(0,0,0,0.15); object-fit: cover;">
                                            </div>
                                            <span class="online-indicator"
                                                style="position: absolute; bottom: 10px; right: 10px; width: 24px; height: 24px; background: #22c55e; border: 4px solid var(--card-bg); border-radius: 50%; box-shadow: 0 2px 8px rgba(34,197,94,0.4);"></span>
                                            <!-- Story Text -->
                                            <div class="story-text"
                                                style="text-align: center; margin-top: 8px; font-size: 0.875rem; color: var(--text-secondary); font-weight: 600;">
                                                View Story</div>
                                        </div>

                                        <div class="profile-details-section" style="flex: 1; padding-top: 1.5rem;">
                                            <div class="profile-name-row" style="margin-bottom: 1.25rem;">
                                                <h1 class="profile-name" id="tutorName" style="margin-bottom: 1rem;">
                                                    <span
                                                        style="color: var(--text-muted); font-size: 0.9rem; font-style: italic;">Loading
                                                        tutor name...</span>
                                                </h1>
                                                <div class="badges-row"
                                                    style="display: flex; flex-wrap: wrap; gap: 0.75rem; margin-bottom: 1rem; margin-top: 1rem;">
                                                    <!-- Badges will be populated dynamically (includes experience badge) -->
                                                </div>
                                            </div>

                                            <div class="rating-section" style="margin-bottom: 1rem;">
                                                <div class="rating-wrapper" id="rating-hover-trigger"
                                                    style="display: flex; align-items: center; gap: 0.75rem;">
                                                    <div class="rating-stars" id="rating-stars"
                                                        style="color: #f59e0b; font-size: 1.5rem; letter-spacing: 2px;">
                                                        ‚òÜ‚òÜ‚òÜ‚òÜ‚òÜ</div>
                                                    <span class="rating-value" id="tutor-rating"
                                                        style="font-size: 1.5rem; font-weight: 700; color: #f59e0b;">0.0</span>
                                                    <span class="rating-count" id="rating-count"
                                                        style="color: var(--text-secondary); font-size: 0.95rem; font-weight: 500;">(0
                                                        reviews)</span>

                                                    <!-- Rating Tooltip -->
                                                    <div class="rating-tooltip" id="rating-tooltip">
                                                        <h4
                                                            style="margin: 0 0 1rem 0; font-size: 0.9rem; font-weight: 600; color: var(--heading);">
                                                            Rating Breakdown</h4>

                                                        <div class="rating-metric">
                                                            <div class="metric-header">
                                                                <span class="metric-label">Discipline</span>
                                                                <span class="metric-score"
                                                                    id="rating-discipline">0.0</span>
                                                            </div>
                                                            <div class="metric-bar">
                                                                <div class="metric-fill" id="bar-discipline"
                                                                    style="width: 0%"></div>
                                                            </div>
                                                        </div>

                                                        <div class="rating-metric">
                                                            <div class="metric-header">
                                                                <span class="metric-label">Punctuality</span>
                                                                <span class="metric-score"
                                                                    id="rating-punctuality">0.0</span>
                                                            </div>
                                                            <div class="metric-bar">
                                                                <div class="metric-fill" id="bar-punctuality"
                                                                    style="width: 0%"></div>
                                                            </div>
                                                        </div>

                                                        <div class="rating-metric">
                                                            <div class="metric-header">
                                                                <span class="metric-label">Knowledge Level</span>
                                                                <span class="metric-score"
                                                                    id="rating-knowledge">0.0</span>
                                                            </div>
                                                            <div class="metric-bar">
                                                                <div class="metric-fill" id="bar-knowledge"
                                                                    style="width: 0%"></div>
                                                            </div>
                                                        </div>

                                                        <div class="rating-metric">
                                                            <div class="metric-header">
                                                                <span class="metric-label">Communication Skills</span>
                                                                <span class="metric-score"
                                                                    id="rating-communication">0.0</span>
                                                            </div>
                                                            <div class="metric-bar">
                                                                <div class="metric-fill" id="bar-communication"
                                                                    style="width: 0%"></div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>

                                            <div class="profile-location"
                                                style="display: flex; align-items: center; gap: 0.75rem; padding: 0.75rem 1rem; background: rgba(var(--button-bg-rgb), 0.05); border-radius: 12px; margin-bottom: 0.75rem;">
                                                <span class="location-icon" style="font-size: 1.25rem;">üìç</span>
                                                <span style="color: var(--text); font-size: 0.95rem;">
                                                    <span style="color: var(--text-muted); font-style: italic;">Loading
                                                        location...</span>
                                                </span>
                                            </div>

                                            <!-- Teaches At & Languages (Contact Info Style) -->
                                            <div class="profile-contact-info"
                                                style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 0.75rem; margin-bottom: 0.75rem;">
                                                <div id="teaches-at-container"
                                                    style="display: flex; align-items: center; gap: 0.75rem; padding: 0.75rem 1rem; background: rgba(var(--button-bg-rgb), 0.05); border-radius: 12px;">
                                                    <span style="font-size: 1.25rem;">üè´</span>
                                                    <div style="flex: 1;">
                                                        <div
                                                            style="font-size: 0.75rem; color: var(--text-muted); margin-bottom: 0.125rem;">
                                                            Teaches At</div>
                                                        <div id="tutor-teaches-at-field"
                                                            style="color: var(--text); font-size: 0.875rem; font-weight: 500;">
                                                            Not specified</div>
                                                    </div>
                                                </div>
                                                <div id="languages-container"
                                                    style="display: flex; align-items: center; gap: 0.75rem; padding: 0.75rem 1rem; background: rgba(var(--button-bg-rgb), 0.05); border-radius: 12px;">
                                                    <span style="font-size: 1.25rem;">üåê</span>
                                                    <div style="flex: 1;">
                                                        <div
                                                            style="font-size: 0.75rem; color: var(--text-muted); margin-bottom: 0.125rem;">
                                                            Languages</div>
                                                        <div id="tutor-languages-inline"
                                                            style="color: var(--text); font-size: 0.875rem; font-weight: 500;">
                                                            English, Amharic</div>
                                                    </div>
                                                </div>
                                            </div>

                                            <!-- Hobbies & Interests -->
                                            <div id="hobbies-display-container"
                                                style="display: flex; align-items: center; gap: 0.75rem; padding: 0.75rem 1rem; background: rgba(var(--button-bg-rgb), 0.05); border-radius: 12px; margin-bottom: 0.75rem;">
                                                <span style="font-size: 1.25rem;">üé®</span>
                                                <div style="flex: 1;">
                                                    <div
                                                        style="font-size: 0.75rem; color: var(--text-muted); margin-bottom: 0.125rem;">
                                                        Hobbies & Interests</div>
                                                    <div id="tutor-hobbies"
                                                        style="color: var(--text-muted); font-size: 0.875rem; font-weight: 500; font-style: italic;">
                                                        No hobbies yet</div>
                                                </div>
                                            </div>

                                            <!-- Social Links -->
                                            <div class="profile-social-links" id="social-links-container"
                                                style="display: flex; gap: 0.75rem; margin-top: 1.5rem; margin-bottom: 0.75rem; padding: 0.5rem 0;">
                                                <!-- Social links will be populated dynamically by JS with beautiful styling -->
                                            </div>

                                            <!-- Gender Card -->
                                            <div class="profile-contact-info"
                                                style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 0.75rem; margin-bottom: 0.75rem;">
                                                <div id="gender-container"
                                                    style="display: flex; align-items: center; gap: 0.75rem; padding: 0.75rem 1rem; background: rgba(var(--button-bg-rgb), 0.05); border-radius: 12px;">
                                                    <span style="font-size: 1.25rem;">üë§</span>
                                                    <div style="flex: 1;">
                                                        <div
                                                            style="font-size: 0.75rem; color: var(--text-muted); margin-bottom: 0.125rem;">
                                                            Gender</div>
                                                        <div id="tutor-gender"
                                                            style="color: var(--text); font-size: 0.875rem; font-weight: 500;">
                                                            Not specified</div>
                                                    </div>
                                                </div>
                                            </div>

                                            <!-- Social Links -->
                                            <div class="profile-social-links"
                                                style="display: flex; gap: 0.75rem; margin-top: 1.5rem; margin-bottom: 0.75rem; padding: 0.5rem 0;">
                                                <!-- Social links will be populated dynamically by JS with beautiful styling -->
                                            </div>

                                            <div class="profile-quote"
                                                style="background: linear-gradient(135deg, rgba(79,70,229,0.1) 0%, rgba(124,58,237,0.05) 100%); border-left: 4px solid #4f46e5; border-radius: 12px; padding: 1.25rem 1.5rem; margin-top: 1.5rem; position: relative; font-style: italic; color: var(--text); font-size: 1rem; line-height: 1.6; box-shadow: 0 2px 8px rgba(79,70,229,0.1);">
                                                <span style="color: var(--text-muted);">Quote will be loaded...</span>
                                            </div>

                                            <!-- Action Buttons -->
                                            <div class="profile-actions"
                                                style="display: flex; gap: 1rem; margin-top: 2rem; flex-wrap: wrap;">
                                                <button onclick="switchPanel('packages')" class="btn-primary"
                                                    style="flex: 1; min-width: 160px; padding: 0.875rem 1.5rem; font-weight: 600; border-radius: 12px; background: linear-gradient(135deg, #4f46e5 0%, #7c3aed 100%); color: white; border: none; box-shadow: 0 4px 12px rgba(79,70,229,0.3); cursor: pointer; transition: all 0.3s ease;">
                                                    üì¶ View package
                                                </button>
                                                <button onclick="connectTutor()" class="btn-secondary"
                                                    style="flex: 1; min-width: 160px; padding: 0.875rem 1.5rem; font-weight: 600; border-radius: 12px; background: transparent; color: var(--text); border: 2px solid rgba(var(--border-rgb), 0.3); cursor: pointer; transition: all 0.3s ease;">
                                                    üîó Connect
                                                </button>
                                                <button onclick="messageTutor()" class="btn-secondary"
                                                    style="flex: 1; min-width: 160px; padding: 0.875rem 1.5rem; font-weight: 600; border-radius: 12px; background: transparent; color: var(--text); border: 2px solid rgba(var(--border-rgb), 0.3); cursor: pointer; transition: all 0.3s ease;">
                                                    üí¨ Message
                                                </button>
                                                <button onclick="shareProfile()" class="btn-secondary"
                                                    style="flex: 1; min-width: 160px; padding: 0.875rem 1.5rem; font-weight: 600; border-radius: 12px; background: transparent; color: var(--text); border: 2px solid rgba(var(--border-rgb), 0.3); cursor: pointer; transition: all 0.3s ease;">
                                                    <i class="fas fa-share-alt"></i> Share
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </section>

                            <!-- About Section -->
                            <section
                                style="background: var(--card-bg); border-radius: 16px; padding: 2rem; margin-bottom: 2rem; box-shadow: 0 2px 8px rgba(0,0,0,0.08);">
                                <h3
                                    style="font-size: 1.5rem; font-weight: 700; margin-bottom: 1rem; color: var(--heading);">
                                    About This Tutor</h3>
                                <p style="color: var(--text); line-height: 1.7;">Loading profile information...</p>
                            </section>

                            <!-- Stats Cards -->
                            <div class="quick-stats-grid"
                                style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 1rem; margin-top: 2rem;">
                                <!-- Stats will be populated dynamically from database -->
                            </div>

                            <!-- Success Stories -->
                            <div class="card p-6 mb-8" style="margin-top: 2rem;">
                                <div
                                    style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem;">
                                    <h3 class="text-xl font-semibold" style="margin: 0;">üåü Success Stories
                                    </h3>
                                    <button
                                        class="px-4 py-2 text-sm bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition"
                                        onclick="switchPanel('reviews')" style="font-size: 0.875rem;">
                                        View All Reviews ‚Üí
                                    </button>
                                </div>
                                <div class="success-stories-grid">
                                    <!-- Success stories will be populated dynamically from featured reviews (students and parents) -->
                                </div>
                            </div>

                        </div>

                        <!-- Stories Panel -->
                        <div id="stories-panel" class="panel-content">
                            <div class="card p-6 mb-8">
                                <h3 class="text-2xl font-bold mb-6" style="color: var(--heading);">üì∏ Tutor's
                                    Stories</h3>
                                <p class="text-gray-600 mb-8">Educational moments and teaching highlights shared by
                                    Dr. Abebe Kebede</p>

                                <!-- Story Stats -->
                                <div class="story-stats"
                                    style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 1rem; margin-bottom: 2rem; padding: 1.5rem; background: var(--section-bg); border-radius: 12px;">
                                    <div style="text-align: center;">
                                        <div style="font-size: 1.875rem; font-weight: 700; color: var(--button-bg);">
                                            24</div>
                                        <div style="font-size: 0.875rem; color: var(--text-muted);">Total Stories
                                        </div>
                                    </div>
                                    <div style="text-align: center;">
                                        <div style="font-size: 1.875rem; font-weight: 700; color: #22c55e;">12.5K
                                        </div>
                                        <div style="font-size: 0.875rem; color: var(--text-muted);">Total Views
                                        </div>
                                    </div>
                                    <div style="text-align: center;">
                                        <div style="font-size: 1.875rem; font-weight: 700; color: #f59e0b;">847
                                        </div>
                                        <div style="font-size: 0.875rem; color: var(--text-muted);">Reactions</div>
                                    </div>
                                    <div style="text-align: center;">
                                        <div style="font-size: 1.875rem; font-weight: 700; color: #8b5cf6;">156
                                        </div>
                                        <div style="font-size: 0.875rem; color: var(--text-muted);">Comments</div>
                                    </div>
                                </div>

                                <!-- Tutor's Stories Grid -->
                                <div class="tutor-stories-grid"
                                    style="display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 1.5rem;">

                                    <!-- Story Card 1 - Math Tips -->
                                    <div class="story-card" onclick="openStoryViewer('story1')"
                                        style="background: var(--card-bg); border-radius: 12px; overflow: hidden; cursor: pointer; box-shadow: 0 2px 8px rgba(0,0,0,0.1); transition: all 0.3s ease;">
                                        <div style="position: relative;">
                                            <img src="../pictures/Math wallpaper 1.jpeg" alt="Math Tips"
                                                style="width: 100%; height: 250px; object-fit: cover;">
                                            <div
                                                style="position: absolute; top: 10px; left: 10px; background: var(--button-bg); color: white; padding: 4px 8px; border-radius: 6px; font-size: 0.75rem; font-weight: 600;">
                                                Math Tips
                                            </div>
                                            <div style="position: absolute; bottom: 10px; left: 10px; right: 10px;">
                                                <p
                                                    style="color: white; font-weight: 600; text-shadow: 0 2px 4px rgba(0,0,0,0.5); margin: 0;">
                                                    Solving Quadratic Equations</p>
                                                <p
                                                    style="color: rgba(255,255,255,0.9); font-size: 0.75rem; text-shadow: 0 2px 4px rgba(0,0,0,0.5); margin: 0;">
                                                    2 hours ago</p>
                                            </div>
                                        </div>
                                        <div style="padding: 0.75rem;">
                                            <div
                                                style="display: flex; justify-content: space-between; align-items: center;">
                                                <span style="font-size: 0.875rem; color: var(--text-muted);">üëÅÔ∏è
                                                    1.2K views</span>
                                                <span style="font-size: 0.875rem; color: var(--text-muted);">‚ù§Ô∏è
                                                    89</span>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Story Card 2 - Physics Experiment -->
                                    <div class="story-card" onclick="openStoryViewer('story2')"
                                        style="background: var(--card-bg); border-radius: 12px; overflow: hidden; cursor: pointer; box-shadow: 0 2px 8px rgba(0,0,0,0.1); transition: all 0.3s ease;">
                                        <div style="position: relative;">
                                            <img src="../pictures/Physics wallpaper 2.jpeg" alt="Physics"
                                                style="width: 100%; height: 250px; object-fit: cover;">
                                            <div
                                                style="position: absolute; top: 10px; left: 10px; background: #8b5cf6; color: white; padding: 4px 8px; border-radius: 6px; font-size: 0.75rem; font-weight: 600;">
                                                Physics Lab
                                            </div>
                                            <div style="position: absolute; bottom: 10px; left: 10px; right: 10px;">
                                                <p
                                                    style="color: white; font-weight: 600; text-shadow: 0 2px 4px rgba(0,0,0,0.5); margin: 0;">
                                                    Newton's Laws Demo</p>
                                                <p
                                                    style="color: rgba(255,255,255,0.9); font-size: 0.75rem; text-shadow: 0 2px 4px rgba(0,0,0,0.5); margin: 0;">
                                                    5 hours ago</p>
                                            </div>
                                        </div>
                                        <div style="padding: 0.75rem;">
                                            <div
                                                style="display: flex; justify-content: space-between; align-items: center;">
                                                <span style="font-size: 0.875rem; color: var(--text-muted);">üëÅÔ∏è 856
                                                    views</span>
                                                <span style="font-size: 0.875rem; color: var(--text-muted);">‚ù§Ô∏è
                                                    67</span>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Story Card 3 - Chemistry -->
                                    <div class="story-card" onclick="openStoryViewer('story3')"
                                        style="background: var(--card-bg); border-radius: 12px; overflow: hidden; cursor: pointer; box-shadow: 0 2px 8px rgba(0,0,0,0.1); transition: all 0.3s ease;">
                                        <div style="position: relative;">
                                            <img src="../pictures/Chemistry wallpaper 3.jpg" alt="Chemistry"
                                                style="width: 100%; height: 250px; object-fit: cover;">
                                            <div
                                                style="position: absolute; top: 10px; left: 10px; background: #22c55e; color: white; padding: 4px 8px; border-radius: 6px; font-size: 0.75rem; font-weight: 600;">
                                                Chemistry
                                            </div>
                                            <div style="position: absolute; bottom: 10px; left: 10px; right: 10px;">
                                                <p
                                                    style="color: white; font-weight: 600; text-shadow: 0 2px 4px rgba(0,0,0,0.5); margin: 0;">
                                                    Periodic Table Tricks</p>
                                                <p
                                                    style="color: rgba(255,255,255,0.9); font-size: 0.75rem; text-shadow: 0 2px 4px rgba(0,0,0,0.5); margin: 0;">
                                                    Yesterday</p>
                                            </div>
                                        </div>
                                        <div style="padding: 0.75rem;">
                                            <div
                                                style="display: flex; justify-content: space-between; align-items: center;">
                                                <span style="font-size: 0.875rem; color: var(--text-muted);">üëÅÔ∏è
                                                    2.3K views</span>
                                                <span style="font-size: 0.875rem; color: var(--text-muted);">‚ù§Ô∏è
                                                    124</span>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Story Card 4 - Study Tips -->
                                    <div class="story-card" onclick="openStoryViewer('story4')"
                                        style="background: var(--card-bg); border-radius: 12px; overflow: hidden; cursor: pointer; box-shadow: 0 2px 8px rgba(0,0,0,0.1); transition: all 0.3s ease;">
                                        <div style="position: relative;">
                                            <img src="../pictures/Biology wallpaper 1.jpeg" alt="Study Tips"
                                                style="width: 100%; height: 250px; object-fit: cover;">
                                            <div
                                                style="position: absolute; top: 10px; left: 10px; background: #f59e0b; color: white; padding: 4px 8px; border-radius: 6px; font-size: 0.75rem; font-weight: 600;">
                                                Study Tips
                                            </div>
                                            <div style="position: absolute; bottom: 10px; left: 10px; right: 10px;">
                                                <p
                                                    style="color: white; font-weight: 600; text-shadow: 0 2px 4px rgba(0,0,0,0.5); margin: 0;">
                                                    Exam Preparation Guide</p>
                                                <p
                                                    style="color: rgba(255,255,255,0.9); font-size: 0.75rem; text-shadow: 0 2px 4px rgba(0,0,0,0.5); margin: 0;">
                                                    2 days ago</p>
                                            </div>
                                        </div>
                                        <div style="padding: 0.75rem;">
                                            <div
                                                style="display: flex; justify-content: space-between; align-items: center;">
                                                <span style="font-size: 0.875rem; color: var(--text-muted);">üëÅÔ∏è
                                                    3.5K views</span>
                                                <span style="font-size: 0.875rem; color: var(--text-muted);">‚ù§Ô∏è
                                                    201</span>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Story Card 5 - Q&A Session -->
                                    <div class="story-card" onclick="openStoryViewer('story5')"
                                        style="background: var(--card-bg); border-radius: 12px; overflow: hidden; cursor: pointer; box-shadow: 0 2px 8px rgba(0,0,0,0.1); transition: all 0.3s ease;">
                                        <div style="position: relative;">
                                            <img src="../pictures/Geography wallpaper 1.jpeg" alt="Q&A"
                                                style="width: 100%; height: 250px; object-fit: cover;">
                                            <div
                                                style="position: absolute; top: 10px; left: 10px; background: #ef4444; color: white; padding: 4px 8px; border-radius: 6px; font-size: 0.75rem; font-weight: 600;">
                                                Q&A
                                            </div>
                                            <div style="position: absolute; bottom: 10px; left: 10px; right: 10px;">
                                                <p
                                                    style="color: white; font-weight: 600; text-shadow: 0 2px 4px rgba(0,0,0,0.5); margin: 0;">
                                                    Student Questions Answered</p>
                                                <p
                                                    style="color: rgba(255,255,255,0.9); font-size: 0.75rem; text-shadow: 0 2px 4px rgba(0,0,0,0.5); margin: 0;">
                                                    3 days ago</p>
                                            </div>
                                        </div>
                                        <div style="padding: 0.75rem;">
                                            <div
                                                style="display: flex; justify-content: space-between; align-items: center;">
                                                <span style="font-size: 0.875rem; color: var(--text-muted);">üëÅÔ∏è
                                                    1.8K views</span>
                                                <span style="font-size: 0.875rem; color: var(--text-muted);">‚ù§Ô∏è
                                                    95</span>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Story Card 6 - Success Story -->
                                    <div class="story-card" onclick="openStoryViewer('story6')"
                                        style="background: var(--card-bg); border-radius: 12px; overflow: hidden; cursor: pointer; box-shadow: 0 2px 8px rgba(0,0,0,0.1); transition: all 0.3s ease;">
                                        <div style="position: relative;">
                                            <img src="../pictures/History wallpaper 1.jpeg" alt="Success"
                                                style="width: 100%; height: 250px; object-fit: cover;">
                                            <div
                                                style="position: absolute; top: 10px; left: 10px; background: #3b82f6; color: white; padding: 4px 8px; border-radius: 6px; font-size: 0.75rem; font-weight: 600;">
                                                Success
                                            </div>
                                            <div style="position: absolute; bottom: 10px; left: 10px; right: 10px;">
                                                <p
                                                    style="color: white; font-weight: 600; text-shadow: 0 2px 4px rgba(0,0,0,0.5); margin: 0;">
                                                    Student Got 95% in Finals!</p>
                                                <p
                                                    style="color: rgba(255,255,255,0.9); font-size: 0.75rem; text-shadow: 0 2px 4px rgba(0,0,0,0.5); margin: 0;">
                                                    1 week ago</p>
                                            </div>
                                        </div>
                                        <div style="padding: 0.75rem;">
                                            <div
                                                style="display: flex; justify-content: space-between; align-items: center;">
                                                <span style="font-size: 0.875rem; color: var(--text-muted);">üëÅÔ∏è
                                                    4.2K views</span>
                                                <span style="font-size: 0.875rem; color: var(--text-muted);">‚ù§Ô∏è
                                                    312</span>
                                            </div>
                                        </div>
                                    </div>

                                </div>

                                <!-- Load More Button -->
                                <div style="margin-top: 2rem; text-align: center;">
                                    <button onclick="loadMoreStories()"
                                        style="padding: 0.75rem 2rem; background: transparent; color: var(--button-bg); border: 2px solid var(--button-bg); border-radius: 12px; font-weight: 600; cursor: pointer; transition: all 0.3s ease;">
                                        Load More Stories
                                    </button>
                                </div>

                            </div>
                        </div>

                        <!-- Packages Panel -->
                        <div id="packages-panel" class="panel-content">
                            <div class="card p-6 mb-8">
                                <h3 class="text-xl font-semibold mb-4">Teaching Packages</h3>
                                <div class="packages-grid grid grid-cols-1 md:grid-cols-3 gap-4">
                                    <!-- Packages will be populated dynamically from database via view-tutor-db-loader.js -->
                                    <div
                                        style="text-align: center; padding: 2rem; color: var(--text-muted); font-style: italic; grid-column: 1 / -1;">
                                        Loading packages...
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Reviews Panel -->
                        <div id="reviews-panel" class="panel-content">
                            <div class="card p-6 mb-8">
                                <h3 class="text-xl font-semibold mb-4">Recent Reviews</h3>
                                <div class="reviews-list">
                                    <!-- Reviews will be populated dynamically from database -->
                                    <div
                                        style="text-align: center; padding: 2rem; color: var(--text-muted); font-style: italic;">
                                        Loading reviews...
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Credentials Panel (Unified: Achievements, Certifications, Experience) -->
                        <div id="credentials-panel" class="panel-content">
                            <div class="mb-8">
                                <h1 class="text-3xl font-bold mb-2">üìú Credentials</h1>
                                <p class="text-gray-600">View academic certificates, achievements, and experience</p>
                            </div>

                            <!-- Credential Type Selector Cards -->
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                                <!-- Achievements Card -->
                                <div onclick="switchCredentialSection('achievement')" id="cred-card-achievement"
                                    class="credential-type-card active cursor-pointer card p-6 bg-gradient-to-br from-yellow-50 to-amber-50 border-yellow-200 hover:shadow-lg transition-all duration-200">
                                    <div class="flex items-center justify-between mb-3">
                                        <span class="text-3xl">üèÜ</span>
                                        <span
                                            class="text-xs font-semibold text-yellow-600 bg-yellow-100 px-2 py-1 rounded-full"
                                            id="achievement-count">0</span>
                                    </div>
                                    <h3 class="text-lg font-bold text-gray-800 mb-1">Achievements</h3>
                                    <p class="text-sm text-gray-600">Awards, honors & milestones</p>
                                </div>

                                <!-- Academic Card -->
                                <div onclick="switchCredentialSection('academic')" id="cred-card-academic"
                                    class="credential-type-card cursor-pointer card p-6 bg-gradient-to-br from-blue-50 to-indigo-50 border-blue-200 hover:shadow-lg transition-all duration-200">
                                    <div class="flex items-center justify-between mb-3">
                                        <span class="text-3xl">üéì</span>
                                        <span
                                            class="text-xs font-semibold text-blue-600 bg-blue-100 px-2 py-1 rounded-full"
                                            id="academic-count">0</span>
                                    </div>
                                    <h3 class="text-lg font-bold text-gray-800 mb-1">Academic</h3>
                                    <p class="text-sm text-gray-600">Degrees & certifications</p>
                                </div>

                                <!-- Experience Card -->
                                <div onclick="switchCredentialSection('experience')" id="cred-card-experience"
                                    class="credential-type-card cursor-pointer card p-6 bg-gradient-to-br from-green-50 to-emerald-50 border-green-200 hover:shadow-lg transition-all duration-200">
                                    <div class="flex items-center justify-between mb-3">
                                        <span class="text-3xl">üíº</span>
                                        <span
                                            class="text-xs font-semibold text-green-600 bg-green-100 px-2 py-1 rounded-full"
                                            id="experience-count">0</span>
                                    </div>
                                    <h3 class="text-lg font-bold text-gray-800 mb-1">Experience</h3>
                                    <p class="text-sm text-gray-600">Work history & credentials</p>
                                </div>
                            </div>

                            <!-- Credentials Grid (dynamically populated based on selected type) -->
                            <div class="card p-6">
                                <div class="mb-4 flex items-center justify-between">
                                    <h2 class="text-xl font-bold text-gray-800" id="current-cred-type-title">
                                        üèÜ Achievements
                                    </h2>
                                    <span class="text-sm text-gray-500" id="current-cred-count">0 credentials</span>
                                </div>

                                <div id="credentials-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                                    <!-- Credentials will be loaded dynamically -->
                                    <div class="text-center text-gray-500 py-12 col-span-full"
                                        id="credentials-empty-state">
                                        <div class="text-6xl mb-4">üìú</div>
                                        <p class="text-lg font-semibold mb-2">No credentials yet</p>
                                        <p class="text-sm">Check back later for updates</p>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Blog Panel -->
                        <div id="blog-panel" class="panel-content">
                            <section
                                style="background: var(--card-bg); border-radius: 16px; padding: 2rem; margin-bottom: 2rem; box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);">
                                <h2
                                    style="font-size: 1.75rem; font-weight: 700; margin-bottom: 1.5rem; color: var(--heading); display: flex; align-items: center; gap: 0.75rem;">
                                    <span>üìù</span> Tutor Blog Posts
                                </h2>

                                <!-- Blog Posts Grid (Dynamic - Loaded from Database) -->
                                <div id="tutor-blogs-container">
                                    <!-- Loading state -->
                                    <div style="text-align: center; padding: 3rem;">
                                        <i class="fas fa-spinner fa-spin"
                                            style="font-size: 2rem; color: var(--primary-color); margin-bottom: 1rem;"></i>
                                        <p style="color: var(--text-secondary);">Loading blog posts...</p>
                                    </div>
                                </div>
                            </section>
                        </div>

                        <!-- Similar Tutors Panel -->
                        <div id="similar-panel" class="panel-content">
                            <div class="card p-6 mb-8" style="background: var(--card-bg); border-radius: 16px;">
                                <h3 class="text-xl font-semibold mb-4" style="color: var(--heading);">Similar Tutors
                                </h3>
                                <p class="text-gray-600 mb-6" style="color: var(--text-secondary);">
                                    Discover other expert tutors in similar subjects and areas
                                </p>
                                <div class="grid related-tutors-grid"
                                    style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 1.5rem;">
                                    <!-- Loading State - will be replaced by JavaScript -->
                                    <div class="tutor-card-minimal" style="opacity: 0.6;">
                                        <div class="animate-pulse"
                                            style="display: flex; flex-direction: column; align-items: center;">
                                            <div
                                                style="width: 80px; height: 80px; background: var(--bg-secondary); border-radius: 50%; margin-bottom: 1rem;">
                                            </div>
                                            <div
                                                style="width: 120px; height: 16px; background: var(--bg-secondary); border-radius: 8px; margin-bottom: 0.5rem;">
                                            </div>
                                            <div
                                                style="width: 100px; height: 12px; background: var(--bg-secondary); border-radius: 6px; margin-bottom: 0.75rem;">
                                            </div>
                                            <div
                                                style="width: 80px; height: 12px; background: var(--bg-secondary); border-radius: 6px; margin-bottom: 1rem;">
                                            </div>
                                            <div
                                                style="width: 100%; height: 36px; background: var(--bg-secondary); border-radius: 8px;">
                                            </div>
                                        </div>
                                    </div>
                                    <div class="tutor-card-minimal" style="opacity: 0.6;">
                                        <div class="animate-pulse"
                                            style="display: flex; flex-direction: column; align-items: center;">
                                            <div
                                                style="width: 80px; height: 80px; background: var(--bg-secondary); border-radius: 50%; margin-bottom: 1rem;">
                                            </div>
                                            <div
                                                style="width: 120px; height: 16px; background: var(--bg-secondary); border-radius: 8px; margin-bottom: 0.5rem;">
                                            </div>
                                            <div
                                                style="width: 100px; height: 12px; background: var(--bg-secondary); border-radius: 6px; margin-bottom: 0.75rem;">
                                            </div>
                                            <div
                                                style="width: 80px; height: 12px; background: var(--bg-secondary); border-radius: 6px; margin-bottom: 1rem;">
                                            </div>
                                            <div
                                                style="width: 100%; height: 36px; background: var(--bg-secondary); border-radius: 8px;">
                                            </div>
                                        </div>
                                    </div>
                                    <!-- Dynamic content will be inserted here by JavaScript -->
                                </div>
                            </div>
                        </div>

                        <!-- Settings Panel -->
                        <div id="settings-panel" class="panel-content">
                            <div class="mb-8">
                                <h1 class="text-3xl font-bold mb-2">Settings</h1>
                                <p class="text-gray-600">Manage your account settings and preferences</p>
                            </div>

                            <!-- Account & Security Section -->
                            <div class="settings-section mb-8">
                                <h2 class="text-xl font-semibold mb-4 text-gray-700 flex items-center gap-2">
                                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"></path>
                                    </svg>
                                    Account & Security
                                </h2>

                                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                                    <!-- Verify Personal Info Card -->
                                    <div class="card p-6 cursor-pointer hover:shadow-lg transition-all duration-300 border-2 border-transparent hover:border-blue-500"
                                        onclick="openVerifyPersonalInfoModal()">
                                        <div class="flex flex-col items-center text-center">
                                            <div class="w-16 h-16 bg-gradient-to-br from-blue-500 to-purple-600 rounded-full flex items-center justify-center shadow-lg mb-4">
                                                <span class="text-3xl">üîê</span>
                                            </div>
                                            <h3 class="text-lg font-bold mb-2 text-gray-800">Verify Personal Info</h3>
                                            <p class="text-sm text-gray-600">Personal details and contact verification</p>
                                        </div>
                                    </div>

                                    <!-- Two-Factor Authentication Card -->
                                    <div class="card p-6 cursor-pointer hover:shadow-lg transition-all duration-300 border-2 border-transparent hover:border-indigo-500"
                                        onclick="openTwoFactorAuthModal()">
                                        <div class="flex flex-col items-center text-center">
                                            <div class="w-16 h-16 bg-gradient-to-br from-indigo-500 to-blue-600 rounded-full flex items-center justify-center shadow-lg mb-4">
                                                <span class="text-3xl">üõ°Ô∏è</span>
                                            </div>
                                            <h3 class="text-lg font-bold mb-2 text-gray-800">Two-Factor Auth</h3>
                                            <p class="text-sm text-gray-600">Extra security with 2FA</p>
                                            <span id="2fa-status-badge" class="mt-2 inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800">
                                                Not Enabled
                                            </span>
                                        </div>
                                    </div>

                                    <!-- Login Activity Card -->
                                    <div class="card p-6 cursor-pointer hover:shadow-lg transition-all duration-300 border-2 border-transparent hover:border-cyan-500"
                                        onclick="openLoginActivityModal()">
                                        <div class="flex flex-col items-center text-center">
                                            <div class="w-16 h-16 bg-gradient-to-br from-cyan-500 to-teal-600 rounded-full flex items-center justify-center shadow-lg mb-4">
                                                <span class="text-3xl">üì±</span>
                                            </div>
                                            <h3 class="text-lg font-bold mb-2 text-gray-800">Login Activity</h3>
                                            <p class="text-sm text-gray-600">Active sessions and history</p>
                                        </div>
                                    </div>

                                    <!-- Connected Accounts Card -->
                                    <div class="card p-6 cursor-pointer hover:shadow-lg transition-all duration-300 border-2 border-transparent hover:border-orange-500"
                                        onclick="openConnectedAccountsModal()">
                                        <div class="flex flex-col items-center text-center">
                                            <div class="w-16 h-16 bg-gradient-to-br from-orange-500 to-amber-600 rounded-full flex items-center justify-center shadow-lg mb-4">
                                                <span class="text-3xl">üîó</span>
                                            </div>
                                            <h3 class="text-lg font-bold mb-2 text-gray-800">Connected Accounts</h3>
                                            <p class="text-sm text-gray-600">Manage Google and other links</p>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Payments & Subscription Section -->
                            <div class="settings-section mb-8">
                                <h2 class="text-xl font-semibold mb-4 text-gray-700 flex items-center gap-2">
                                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"></path>
                                    </svg>
                                    Payments & Subscription
                                </h2>

                                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                                    <!-- Payment Method Card -->
                                    <div class="card p-6 cursor-pointer hover:shadow-lg transition-all duration-300 border-2 border-transparent hover:border-green-500"
                                        onclick="openPaymentMethodModal()">
                                        <div class="flex flex-col items-center text-center">
                                            <div class="w-16 h-16 bg-gradient-to-br from-green-500 to-emerald-600 rounded-full flex items-center justify-center shadow-lg mb-4">
                                                <span class="text-3xl">üí≥</span>
                                            </div>
                                            <h3 class="text-lg font-bold mb-2 text-gray-800">Payment Method</h3>
                                            <p class="text-sm text-gray-600">Manage your payment options</p>
                                        </div>
                                    </div>

                                    <!-- Subscription Card -->
                                    <div class="card p-6 cursor-pointer hover:shadow-lg transition-all duration-300 border-2 border-transparent hover:border-purple-500"
                                        onclick="openComingSoonModal('Subscription & Storage')">
                                        <div class="flex flex-col items-center text-center">
                                            <div class="w-16 h-16 bg-gradient-to-br from-purple-500 to-pink-600 rounded-full flex items-center justify-center shadow-lg mb-4">
                                                <span class="text-3xl">‚≠ê</span>
                                            </div>
                                            <h3 class="text-lg font-bold mb-2 text-gray-800">Subscription & Storage</h3>
                                            <p class="text-sm text-gray-600">Upgrade plan and unlock features</p>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Personalization Section -->
                            <div class="settings-section mb-8">
                                <h2 class="text-xl font-semibold mb-4 text-gray-700 flex items-center gap-2">
                                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 21a4 4 0 01-4-4V5a2 2 0 012-2h4a2 2 0 012 2v12a4 4 0 01-4 4zm0 0h12a2 2 0 002-2v-4a2 2 0 00-2-2h-2.343M11 7.343l1.657-1.657a2 2 0 012.828 0l2.829 2.829a2 2 0 010 2.828l-8.486 8.485M7 17h.01"></path>
                                    </svg>
                                    Personalization
                                </h2>

                                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                                    <!-- Appearance Card -->
                                    <div class="card p-6 cursor-pointer hover:shadow-lg transition-all duration-300 border-2 border-transparent hover:border-violet-500"
                                        onclick="openAppearanceModal()">
                                        <div class="flex flex-col items-center text-center">
                                            <div class="w-16 h-16 bg-gradient-to-br from-violet-500 to-purple-600 rounded-full flex items-center justify-center shadow-lg mb-4">
                                                <span class="text-3xl">üé®</span>
                                            </div>
                                            <h3 class="text-lg font-bold mb-2 text-gray-800">Appearance</h3>
                                            <p class="text-sm text-gray-600">Theme, font size, and display</p>
                                        </div>
                                    </div>

                                    <!-- Language Preferences Card -->
                                    <div class="card p-6 cursor-pointer hover:shadow-lg transition-all duration-300 border-2 border-transparent hover:border-sky-500"
                                        onclick="openComingSoonModal('Language Preferences')">
                                        <div class="flex flex-col items-center text-center">
                                            <div class="w-16 h-16 bg-gradient-to-br from-sky-500 to-blue-600 rounded-full flex items-center justify-center shadow-lg mb-4">
                                                <span class="text-3xl">üåê</span>
                                            </div>
                                            <h3 class="text-lg font-bold mb-2 text-gray-800">Language</h3>
                                            <p class="text-sm text-gray-600">UI language and translation</p>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Data & Privacy Section -->
                            <div class="settings-section mb-8">
                                <h2 class="text-xl font-semibold mb-4 text-gray-700 flex items-center gap-2">
                                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                                    </svg>
                                    Data & Privacy
                                </h2>

                                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                                    <!-- Export Data Card -->
                                    <div class="card p-6 cursor-pointer hover:shadow-lg transition-all duration-300 border-2 border-transparent hover:border-teal-500"
                                        onclick="openComingSoonModal('Export Data')">
                                        <div class="flex flex-col items-center text-center">
                                            <div class="w-16 h-16 bg-gradient-to-br from-teal-500 to-cyan-600 rounded-full flex items-center justify-center shadow-lg mb-4">
                                                <span class="text-3xl">üì¶</span>
                                            </div>
                                            <h3 class="text-lg font-bold mb-2 text-gray-800">Export Data</h3>
                                            <p class="text-sm text-gray-600">Download your personal data</p>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Feedback & Support Section -->
                            <div class="settings-section mb-8">
                                <h2 class="text-xl font-semibold mb-4 text-gray-700 flex items-center gap-2">
                                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"></path>
                                    </svg>
                                    Feedback & Support
                                </h2>

                                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                                    <!-- Review & Rate Astegni Card -->
                                    <div class="card p-6 cursor-pointer hover:shadow-lg transition-all duration-300 border-2 border-transparent hover:border-yellow-500"
                                        onclick="openReviewAstegniModal()">
                                        <div class="flex flex-col items-center text-center">
                                            <div class="w-16 h-16 bg-gradient-to-br from-yellow-500 to-orange-500 rounded-full flex items-center justify-center shadow-lg mb-4">
                                                <span class="text-3xl">‚≠ê</span>
                                            </div>
                                            <h3 class="text-lg font-bold mb-2 text-gray-800">Review Astegni</h3>
                                            <p class="text-sm text-gray-600">Share your feedback with us</p>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Danger Zone Section -->
                            <div class="settings-section">
                                <h2 class="text-xl font-semibold mb-4 text-red-600 flex items-center gap-2">
                                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path>
                                    </svg>
                                    Danger Zone
                                </h2>

                                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                                    <!-- Manage Roles Card -->
                                    <div class="card p-6 cursor-pointer hover:shadow-lg transition-all duration-300 border-2 border-transparent hover:border-rose-500"
                                        onclick="openManageRoleModal()">
                                        <div class="flex flex-col items-center text-center">
                                            <div class="w-16 h-16 bg-gradient-to-br from-rose-500 to-pink-600 rounded-full flex items-center justify-center shadow-lg mb-4">
                                                <span class="text-3xl">üóëÔ∏è</span>
                                            </div>
                                            <h3 class="text-lg font-bold mb-2 text-gray-800">Manage Roles</h3>
                                            <p class="text-sm text-gray-600">Deactivate or remove your role</p>
                                        </div>
                                    </div>

                                    <!-- Leave Astegni Card -->
                                    <div class="card p-6 cursor-pointer hover:shadow-lg transition-all duration-300 border-2 border-transparent hover:border-red-500"
                                        onclick="openLeaveAstegniModal()">
                                        <div class="flex flex-col items-center text-center">
                                            <div class="w-16 h-16 bg-gradient-to-br from-red-500 to-red-700 rounded-full flex items-center justify-center shadow-lg mb-4">
                                                <span class="text-3xl">üö™</span>
                                            </div>
                                            <h3 class="text-lg font-bold mb-2 text-gray-800">Leave Astegni</h3>
                                            <p class="text-sm text-gray-600">Delete account permanently</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>
                </div>

                <!-- Right Sidebar -->
                <div class="right-sidebar-container">
                    <div class="right-sidebar-content">

                        <!-- Ad Widget -->
                        <div class="sidebar-widget ad-widget card" style="padding: 1.5rem;">
                            <div class="widget-header"
                                style="margin-bottom: 0.75rem; display: flex; justify-content: flex-end;">
                                <span
                                    style="font-size: 0.65rem; color: var(--text-secondary); background: var(--bg-secondary); padding: 0.2rem 0.5rem; border-radius: 4px;">Ad</span>
                            </div>
                            <div class="promo-content" id="promo-container"
                                style="min-height: 170px; display: flex; flex-direction: column; align-items: center; justify-content: center; background: linear-gradient(135deg, var(--bg-secondary) 0%, var(--card-bg) 100%); border-radius: 12px; padding: 1.5rem 1rem 2rem; cursor: pointer; overflow: hidden; position: relative;">
                                <!-- Rotating Ad Messages -->
                                <div id="ad-message-container"
                                    style="text-align: center; position: relative; width: 100%; height: 90px; overflow: hidden;">
                                    <div class="ad-message active"
                                        style="position: absolute; width: 100%; transition: all 0.6s ease; opacity: 1; transform: scale(1);">
                                        <div style="font-size: 1.8rem; margin-bottom: 0.5rem;">üì£</div>
                                        <p style="font-size: 1rem; font-weight: 600; color: var(--heading);">Your Ad
                                            Goes Here</p>
                                    </div>
                                    <div class="ad-message"
                                        style="position: absolute; width: 100%; transition: all 0.6s ease; opacity: 0; transform: scale(0.8);">
                                        <div style="font-size: 1.8rem; margin-bottom: 0.5rem;">üéØ</div>
                                        <p style="font-size: 1rem; font-weight: 600; color: var(--heading);">Target
                                            Millions of Audience</p>
                                    </div>
                                    <div class="ad-message"
                                        style="position: absolute; width: 100%; transition: all 0.6s ease; opacity: 0; transform: scale(0.8);">
                                        <div style="font-size: 1.8rem; margin-bottom: 0.5rem;">üìà</div>
                                        <p style="font-size: 1rem; font-weight: 600; color: var(--heading);">Grow Your
                                            Business</p>
                                    </div>
                                    <div class="ad-message"
                                        style="position: absolute; width: 100%; transition: all 0.6s ease; opacity: 0; transform: scale(0.8);">
                                        <div style="font-size: 1.8rem; margin-bottom: 0.5rem;">üöÄ</div>
                                        <p style="font-size: 1rem; font-weight: 600; color: var(--heading);">Reach Your
                                            Audience</p>
                                    </div>
                                    <div class="ad-message"
                                        style="position: absolute; width: 100%; transition: all 0.6s ease; opacity: 0; transform: scale(0.8);">
                                        <div style="font-size: 1.8rem; margin-bottom: 0.5rem;">üíº</div>
                                        <p style="font-size: 1rem; font-weight: 600; color: var(--heading);">Advertise
                                            With Us</p>
                                    </div>
                                </div>
                                <!-- Ticker at bottom -->
                                <div id="ad-ticker"
                                    style="position: absolute; bottom: 0; left: 0; right: 0; height: 22px; background: rgba(0,0,0,0.05); overflow: hidden;">
                                    <div id="ad-ticker-content"
                                        style="position: absolute; white-space: nowrap; font-size: 0.7rem; color: var(--text-secondary); line-height: 22px;">
                                        <span style="padding: 0 2rem;">Reach millions of engaged learners</span>
                                        <span style="padding: 0 2rem;">Premium ad placements available</span>
                                        <span style="padding: 0 2rem;">Contact us to advertise</span>
                                        <span style="padding: 0 2rem;">Boost your brand visibility</span>
                                        <span style="padding: 0 2rem;">Reach millions of engaged learners</span>
                                        <span style="padding: 0 2rem;">Premium ad placements available</span>
                                    </div>
                                </div>
                            </div>
                            <style>
                                @keyframes tickerScroll {
                                    0% {
                                        transform: translateX(0);
                                    }

                                    100% {
                                        transform: translateX(-50%);
                                    }
                                }

                                #ad-ticker-content {
                                    animation: tickerScroll 20s linear infinite;
                                }

                                .ad-message {
                                    visibility: hidden;
                                }

                                .ad-message.active {
                                    opacity: 1 !important;
                                    transform: scale(1) !important;
                                    visibility: visible !important;
                                }

                                .ad-message.fade-out {
                                    opacity: 0 !important;
                                    transform: scale(0.8) !important;
                                    visibility: visible !important;
                                }
                            </style>
                            <script>
                                (function () {
                                    const messages = document.querySelectorAll('#ad-message-container .ad-message');
                                    let currentIndex = 0;

                                    function rotateMessages() {
                                        const prevIndex = currentIndex;
                                        currentIndex = (currentIndex + 1) % messages.length;

                                        // Fade out current
                                        messages[prevIndex].classList.remove('active');
                                        messages[prevIndex].classList.add('fade-out');

                                        // Fade in next
                                        messages[currentIndex].classList.add('active');

                                        // Hide previous after animation
                                        setTimeout(() => {
                                            messages[prevIndex].classList.remove('fade-out');
                                        }, 600);
                                    }

                                    setInterval(rotateMessages, 10000);
                                })();
                            </script>
                        </div>

                        <!-- Subjects Taught Widget with Ticker -->
                        <div class="sidebar-widget subjects-widget card" style="padding: 1.5rem;">
                            <div class="widget-header" style="margin-bottom: 1rem;">
                                <h3 style="font-size: 1.25rem; font-weight: 600; margin: 0; color: var(--heading);">
                                    üìö Subjects I Teach</h3>
                            </div>
                            <div class="success-ticker-container">
                                <div class="subjects-ticker">
                                    <!-- Subjects will be populated dynamically by view-tutor-db-loader.js -->
                                </div>
                            </div>
                        </div>

                        <!-- Pricing Widget - Populated by JS -->
                        <div class="sidebar-widget pricing-widget card"
                            style="padding: 1.5rem; background: linear-gradient(135deg, #10b981 0%, #059669 100%); color: white; border-radius: 16px;">
                            <!-- Content will be populated by view-tutor-db-loader.js -->
                        </div>

                        <!-- This Week Availability Widget - Populated by JS -->
                        <div class="sidebar-widget availability-widget card" style="padding: 1.5rem;">
                            <div class="widget-header"
                                style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                                <h3 style="font-size: 1.25rem; font-weight: 600; margin: 0; color: var(--heading);">
                                    üìÖ This Week</h3>
                            </div>
                            <div class="availability-schedule"
                                style="display: flex; flex-direction: column; gap: 0.5rem;">
                                <!-- Content will be populated by view-tutor-db-loader.js -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Related Tutors Section (Bottom Widgets) -->
        <section class="related-tutors-section">
            <div class="container mx-auto px-4">
                <div style="text-align: center; margin-bottom: 2rem;">
                    <h2 class="text-3xl font-bold mb-2" style="color: var(--heading);">Related Tutors</h2>
                    <p class="text-gray-600" style="color: var(--text-secondary);">
                        Discover more expert educators in similar subjects
                    </p>
                </div>

                <div class="related-tutors-grid">
                    <!-- Loading State - will be replaced by JavaScript -->
                    <div class="tutor-card-minimal" style="opacity: 0.6;">
                        <div class="animate-pulse" style="display: flex; flex-direction: column; align-items: center;">
                            <div
                                style="width: 80px; height: 80px; background: var(--bg-secondary); border-radius: 50%; margin-bottom: 1rem;">
                            </div>
                            <div
                                style="width: 120px; height: 16px; background: var(--bg-secondary); border-radius: 8px; margin-bottom: 0.5rem;">
                            </div>
                            <div
                                style="width: 100px; height: 12px; background: var(--bg-secondary); border-radius: 6px; margin-bottom: 0.75rem;">
                            </div>
                            <div
                                style="width: 80px; height: 12px; background: var(--bg-secondary); border-radius: 6px; margin-bottom: 1rem;">
                            </div>
                            <div
                                style="width: 100%; height: 36px; background: var(--bg-secondary); border-radius: 8px;">
                            </div>
                        </div>
                    </div>
                    <div class="tutor-card-minimal" style="opacity: 0.6;">
                        <div class="animate-pulse" style="display: flex; flex-direction: column; align-items: center;">
                            <div
                                style="width: 80px; height: 80px; background: var(--bg-secondary); border-radius: 50%; margin-bottom: 1rem;">
                            </div>
                            <div
                                style="width: 120px; height: 16px; background: var(--bg-secondary); border-radius: 8px; margin-bottom: 0.5rem;">
                            </div>
                            <div
                                style="width: 100px; height: 12px; background: var(--bg-secondary); border-radius: 6px; margin-bottom: 0.75rem;">
                            </div>
                            <div
                                style="width: 80px; height: 12px; background: var(--bg-secondary); border-radius: 6px; margin-bottom: 1rem;">
                            </div>
                            <div
                                style="width: 100%; height: 36px; background: var(--bg-secondary); border-radius: 8px;">
                            </div>
                        </div>
                    </div>
                    <div class="tutor-card-minimal" style="opacity: 0.6;">
                        <div class="animate-pulse" style="display: flex; flex-direction: column; align-items: center;">
                            <div
                                style="width: 80px; height: 80px; background: var(--bg-secondary); border-radius: 50%; margin-bottom: 1rem;">
                            </div>
                            <div
                                style="width: 120px; height: 16px; background: var(--bg-secondary); border-radius: 8px; margin-bottom: 0.5rem;">
                            </div>
                            <div
                                style="width: 100px; height: 12px; background: var(--bg-secondary); border-radius: 6px; margin-bottom: 0.75rem;">
                            </div>
                            <div
                                style="width: 80px; height: 12px; background: var(--bg-secondary); border-radius: 6px; margin-bottom: 1rem;">
                            </div>
                            <div
                                style="width: 100%; height: 36px; background: var(--bg-secondary); border-radius: 8px;">
                            </div>
                        </div>
                    </div>
                    <div class="tutor-card-minimal" style="opacity: 0.6;">
                        <div class="animate-pulse" style="display: flex; flex-direction: column; align-items: center;">
                            <div
                                style="width: 80px; height: 80px; background: var(--bg-secondary); border-radius: 50%; margin-bottom: 1rem;">
                            </div>
                            <div
                                style="width: 120px; height: 16px; background: var(--bg-secondary); border-radius: 8px; margin-bottom: 0.5rem;">
                            </div>
                            <div
                                style="width: 100px; height: 12px; background: var(--bg-secondary); border-radius: 6px; margin-bottom: 0.75rem;">
                            </div>
                            <div
                                style="width: 80px; height: 12px; background: var(--bg-secondary); border-radius: 6px; margin-bottom: 1rem;">
                            </div>
                            <div
                                style="width: 100%; height: 36px; background: var(--bg-secondary); border-radius: 8px;">
                            </div>
                        </div>
                    </div>
                    <!-- Dynamic content will be inserted here by JavaScript -->
                </div>
            </div>
        </section>

        <!-- Bottom Widgets Section -->
        <section class="bottom-widgets" style="margin-top: 3rem; margin-bottom: 3rem;">
            <div class="container mx-auto px-4">
                <div class="bottom-widgets-grid"
                    style="display: grid; grid-template-columns: repeat(auto-fit, minmax(320px, 1fr)); gap: 1.5rem;">

                    <!-- News Widget -->
                    <div class="sidebar-widget news-widget card" style="cursor: pointer; padding: 1.5rem;">
                        <div class="widget-header"
                            style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                            <h3 style="font-size: 1.25rem; font-weight: 600; margin: 0;">üì∞ Latest News</h3>
                            <a href="#" onclick="openComingSoonModal('news'); return false;"
                                style="color: var(--button-bg); text-decoration: none; font-size: 0.875rem;">View
                                All</a>
                        </div>

                        <div class="news-carousel" style="position: relative; overflow: hidden;">
                            <div class="news-card-container" id="newsCardContainer">
                                <div class="news-card active" data-news-index="0"
                                    style="opacity: 1; transition: opacity 0.5s ease;">
                                    <div class="news-card-header"
                                        style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.75rem;">
                                        <span class="news-category-badge"
                                            style="background: linear-gradient(135deg, #667eea, #764ba2); color: white; padding: 0.25rem 0.75rem; border-radius: 12px; font-size: 0.75rem; font-weight: 600;">Education</span>
                                        <span class="news-time"
                                            style="color: var(--text-muted); font-size: 0.875rem;">2h
                                            ago</span>
                                    </div>
                                    <div class="news-card-image" style="margin-bottom: 1rem;">
                                        <img src="https://images.unsplash.com/photo-1427504494785-3a9ca7044f45?w=400"
                                            alt="Education News"
                                            style="width: 100%; height: 200px; object-fit: cover; border-radius: 8px;">
                                    </div>
                                    <div class="news-card-content">
                                        <h4
                                            style="font-size: 1.125rem; font-weight: 600; margin-bottom: 0.5rem; color: var(--heading);">
                                            New Education Reforms Transform Ethiopian Schools</h4>
                                        <p
                                            style="color: var(--text); opacity: 0.8; font-size: 0.875rem; line-height: 1.6; margin-bottom: 1rem;">
                                            Latest educational initiatives are revolutionizing how students learn
                                            across
                                            Ethiopia...</p>
                                        <div class="news-stats" style="display: flex; gap: 1rem; flex-wrap: wrap;">
                                            <span class="news-stat"
                                                style="display: flex; align-items: center; gap: 0.25rem; font-size: 0.875rem; color: var(--text-muted);">üî•
                                                Trending</span>
                                            <span class="news-stat"
                                                style="display: flex; align-items: center; gap: 0.25rem; font-size: 0.875rem; color: var(--text-muted);">üëÅÔ∏è
                                                1.2k views</span>
                                            <span class="news-stat"
                                                style="display: flex; align-items: center; gap: 0.25rem; font-size: 0.875rem; color: var(--text-muted);">üí¨
                                                45 comments</span>
                                        </div>
                                    </div>
                                </div>
                                <div class="news-card" data-news-index="1"
                                    style="display: none; opacity: 0; transition: opacity 0.5s ease;">
                                    <div class="news-card-header"
                                        style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.75rem;">
                                        <span class="news-category-badge"
                                            style="background: linear-gradient(135deg, #f093fb, #f5576c); color: white; padding: 0.25rem 0.75rem; border-radius: 12px; font-size: 0.75rem; font-weight: 600;">Technology</span>
                                        <span class="news-time"
                                            style="color: var(--text-muted); font-size: 0.875rem;">5h
                                            ago</span>
                                    </div>
                                    <div class="news-card-image" style="margin-bottom: 1rem;">
                                        <img src="https://images.unsplash.com/photo-1488590528505-98d2b5aba04b?w=400"
                                            alt="Tech News"
                                            style="width: 100%; height: 200px; object-fit: cover; border-radius: 8px;">
                                    </div>
                                    <div class="news-card-content">
                                        <h4
                                            style="font-size: 1.125rem; font-weight: 600; margin-bottom: 0.5rem; color: var(--heading);">
                                            Digital Learning Platforms Surge in Popularity</h4>
                                        <p
                                            style="color: var(--text); opacity: 0.8; font-size: 0.875rem; line-height: 1.6; margin-bottom: 1rem;">
                                            Ethiopian students embrace online education tools for enhanced learning
                                            experiences...</p>
                                        <div class="news-stats" style="display: flex; gap: 1rem; flex-wrap: wrap;">
                                            <span class="news-stat"
                                                style="display: flex; align-items: center; gap: 0.25rem; font-size: 0.875rem; color: var(--text-muted);">üí°
                                                Innovation</span>
                                            <span class="news-stat"
                                                style="display: flex; align-items: center; gap: 0.25rem; font-size: 0.875rem; color: var(--text-muted);">üëÅÔ∏è
                                                890 views</span>
                                            <span class="news-stat"
                                                style="display: flex; align-items: center; gap: 0.25rem; font-size: 0.875rem; color: var(--text-muted);">üí¨
                                                32 comments</span>
                                        </div>
                                    </div>
                                </div>
                                <div class="news-card" data-news-index="2"
                                    style="display: none; opacity: 0; transition: opacity 0.5s ease;">
                                    <div class="news-card-header"
                                        style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.75rem;">
                                        <span class="news-category-badge"
                                            style="background: linear-gradient(135deg, #4facfe, #00f2fe); color: white; padding: 0.25rem 0.75rem; border-radius: 12px; font-size: 0.75rem; font-weight: 600;">Study
                                            Tips</span>
                                        <span class="news-time"
                                            style="color: var(--text-muted); font-size: 0.875rem;">1d
                                            ago</span>
                                    </div>
                                    <div class="news-card-image" style="margin-bottom: 1rem;">
                                        <img src="https://images.unsplash.com/photo-1522202176988-66273c2fd55f?w=400"
                                            alt="Study Tips"
                                            style="width: 100%; height: 200px; object-fit: cover; border-radius: 8px;">
                                    </div>
                                    <div class="news-card-content">
                                        <h4
                                            style="font-size: 1.125rem; font-weight: 600; margin-bottom: 0.5rem; color: var(--heading);">
                                            Top Study Techniques Every Student Should Know</h4>
                                        <p
                                            style="color: var(--text); opacity: 0.8; font-size: 0.875rem; line-height: 1.6; margin-bottom: 1rem;">
                                            Evidence-based study methods to boost your academic performance and
                                            retention...</p>
                                        <div class="news-stats" style="display: flex; gap: 1rem; flex-wrap: wrap;">
                                            <span class="news-stat"
                                                style="display: flex; align-items: center; gap: 0.25rem; font-size: 0.875rem; color: var(--text-muted);">üìö
                                                Featured</span>
                                            <span class="news-stat"
                                                style="display: flex; align-items: center; gap: 0.25rem; font-size: 0.875rem; color: var(--text-muted);">üëÅÔ∏è
                                                2.1k views</span>
                                            <span class="news-stat"
                                                style="display: flex; align-items: center; gap: 0.25rem; font-size: 0.875rem; color: var(--text-muted);">üí¨
                                                67 comments</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Bookstore Widget -->
                    <div class="sidebar-widget bookstore-widget card" onclick="openComingSoonModal('store')"
                        style="cursor: pointer; padding: 1.5rem; background: var(--card-bg); border-radius: 16px; transition: transform 0.3s ease, box-shadow 0.3s ease;"
                        onmouseover="this.style.transform='translateY(-4px)'; this.style.boxShadow='0 8px 16px rgba(0,0,0,0.1)'"
                        onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='none'">
                        <div class="widget-header"
                            style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                            <h3 style="font-size: 1.25rem; font-weight: 600; margin: 0; color: var(--heading);">üìö
                                Bookstore</h3>
                            <span
                                style="background: var(--button-bg); color: white; padding: 0.5rem 0.75rem; border-radius: 8px; font-size: 0.75rem; font-weight: 600;">Coming
                                Soon</span>
                        </div>

                        <!-- Bookstore Content -->
                        <div class="bookstore-content">
                            <div class="bookstore-main" style="text-align: center; margin-bottom: 1.5rem;">
                                <div class="bookstore-icon" style="font-size: 4rem; margin-bottom: 0.5rem;">üìñ</div>
                                <div class="bookstore-title-animated"
                                    style="position: relative; height: 2.5rem; overflow: hidden;">
                                    <div class="bookstore-title"
                                        style="font-size: 1.5rem; font-weight: bold; margin-bottom: 0.5rem; color: var(--heading); position: absolute; width: 100%; opacity: 1; transition: opacity 0.6s ease, transform 0.6s ease;">
                                        Educational Books</div>
                                </div>
                                <div class="bookstore-subtitle" style="font-size: 1rem; color: var(--text);">Buy, Sell &
                                    Rent Textbooks</div>
                            </div>
                            <div class="bookstore-features"
                                style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 1rem;">
                                <div class="feature-item"
                                    style="background: var(--highlight-bg); padding: 0.75rem; border-radius: 8px; text-align: center;">
                                    <span style="display: block; font-size: 1.5rem; margin-bottom: 0.25rem;">üìó</span>
                                    <span style="display: block; font-size: 0.875rem; color: var(--text);">New
                                        Books</span>
                                </div>
                                <div class="feature-item"
                                    style="background: var(--highlight-bg); padding: 0.75rem; border-radius: 8px; text-align: center;">
                                    <span style="display: block; font-size: 1.5rem; margin-bottom: 0.25rem;">üìò</span>
                                    <span style="display: block; font-size: 0.875rem; color: var(--text);">Used
                                        Books</span>
                                </div>
                                <div class="feature-item"
                                    style="background: var(--highlight-bg); padding: 0.75rem; border-radius: 8px; text-align: center;">
                                    <span style="display: block; font-size: 1.5rem; margin-bottom: 0.25rem;">üí∞</span>
                                    <span style="display: block; font-size: 0.875rem; color: var(--text);">Best
                                        Prices</span>
                                </div>
                                <div class="feature-item"
                                    style="background: var(--highlight-bg); padding: 0.75rem; border-radius: 8px; text-align: center;">
                                    <span style="display: block; font-size: 1.5rem; margin-bottom: 0.25rem;">üöö</span>
                                    <span style="display: block; font-size: 0.875rem; color: var(--text);">Fast
                                        Delivery</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Gamestore Widget -->
                    <div class="sidebar-widget gamestore-widget card" onclick="openComingSoonModal('gamestore')"
                        style="cursor: pointer; padding: 1.5rem; background: var(--card-bg); border-radius: 16px; transition: transform 0.3s ease, box-shadow 0.3s ease;"
                        onmouseover="this.style.transform='translateY(-4px)'; this.style.boxShadow='0 8px 16px rgba(0,0,0,0.1)'"
                        onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='none'">
                        <div class="widget-header"
                            style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                            <h3 style="font-size: 1.25rem; font-weight: 600; margin: 0; color: var(--heading);">üéÆ
                                Gamestore</h3>
                            <span
                                style="background: var(--button-bg); color: white; padding: 0.5rem 0.75rem; border-radius: 8px; font-size: 0.75rem; font-weight: 600;">Coming
                                Soon</span>
                        </div>
                        <div class="gamestore-content">
                            <div class="gamestore-main" style="text-align: center; margin-bottom: 1.5rem;">
                                <div class="gamestore-icon" style="font-size: 4rem; margin-bottom: 0.5rem;">üéÆ</div>
                                <div class="gamestore-title-animated"
                                    style="position: relative; height: 2.5rem; overflow: hidden;">
                                    <div class="gamestore-title"
                                        style="font-size: 1.5rem; font-weight: bold; margin-bottom: 0.5rem; color: var(--heading); position: absolute; width: 100%; opacity: 1; transition: opacity 0.6s ease, transform 0.6s ease;">
                                        Educational Games</div>
                                </div>
                                <div class="gamestore-subtitle" style="font-size: 1rem; color: var(--text);">Learn While
                                    Playing</div>
                            </div>
                            <div class="gamestore-features"
                                style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 1rem;">
                                <div class="feature-item"
                                    style="background: var(--highlight-bg); padding: 0.75rem; border-radius: 8px; text-align: center;">
                                    <span style="display: block; font-size: 1.5rem; margin-bottom: 0.25rem;">üßÆ</span>
                                    <span style="display: block; font-size: 0.875rem; color: var(--text);">Puzzle
                                        Games</span>
                                </div>
                                <div class="feature-item"
                                    style="background: var(--highlight-bg); padding: 0.75rem; border-radius: 8px; text-align: center;">
                                    <span style="display: block; font-size: 1.5rem; margin-bottom: 0.25rem;">üéØ</span>
                                    <span style="display: block; font-size: 0.875rem; color: var(--text);">Strategy
                                        Games</span>
                                </div>
                                <div class="feature-item"
                                    style="background: var(--highlight-bg); padding: 0.75rem; border-radius: 8px; text-align: center;">
                                    <span style="display: block; font-size: 1.5rem; margin-bottom: 0.25rem;">üèÜ</span>
                                    <span style="display: block; font-size: 0.875rem; color: var(--text);">Top
                                        Rated</span>
                                </div>
                                <div class="feature-item"
                                    style="background: var(--highlight-bg); padding: 0.75rem; border-radius: 8px; text-align: center;">
                                    <span style="display: block; font-size: 1.5rem; margin-bottom: 0.25rem;">üéÅ</span>
                                    <span style="display: block; font-size: 0.875rem; color: var(--text);">Free to
                                        Play</span>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
        </section>
    </section>

    <!-- Coming Soon Modal -->
    <div id="coming-soon-modal" class="modal hidden">
        <div class="modal-content enhanced coming-soon-content">
            <button class="modal-close-enhanced" onclick="closeModal('coming-soon-modal')">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12">
                    </path>
                </svg>
            </button>

            <div class="coming-soon-header">
                <div class="coming-soon-icon">
                    <svg class="w-16 h-16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z">
                        </path>
                    </svg>
                </div>
                <h3 class="modal-title">Coming Soon!</h3>
                <p class="modal-subtitle" id="coming-soon-message">We're working hard to bring you this feature. Stay
                    tuned!</p>
            </div>
        </div>
    </div>

    <!-- Ad Analytics Modal -->
    <div class="modal hidden" id="adAnalyticsModal">
        <div class="modal-overlay" onclick="closeAdAnalyticsModal()"></div>
        <div class="modal-content promo-analytics-modal">
            <div class="modal-header">
                <h2>Advertisement Analytics</h2>
                <button class="modal-close" onclick="closeAdAnalyticsModal()">√ó</button>
            </div>
            <div class="modal-body">
                <p>Premium advertising opportunities available. Contact us to learn more about promoting your content on
                    Astegni.</p>
            </div>
        </div>
    </div>

    <!-- ========================================== -->
    <!-- VIEW MODALS FOR ACHIEVEMENTS, CERTIFICATIONS, EXPERIENCE -->
    <!-- ========================================== -->

    <!-- View Achievement Modal -->
    <div id="viewAchievementModal" class="modal hidden">
        <div class="modal-content max-w-4xl">
            <div class="modal-header">
                <h2 class="text-2xl font-bold">üèÜ Achievement Details</h2>
                <button onclick="closeViewModal('achievement')" class="close-modal">&times;</button>
            </div>
            <div class="modal-body">
                <!-- View Mode Content -->
                <div class="view-content">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <!-- Left Column: Certificate/Icon & Status -->
                        <div>
                            <!-- Certificate Preview (shown when available) -->
                            <div id="view-ach-certificate-preview" class="mb-4">
                                <!-- Content will be populated by JavaScript -->
                            </div>

                            <!-- Icon fallback (shown when no certificate) -->
                            <div id="view-ach-icon-fallback" class="text-center mb-4">
                                <div class="text-8xl mb-4" id="view-ach-icon">üèÜ</div>
                            </div>

                            <div id="view-ach-status" class="text-center mb-4"></div>

                            <div class="text-sm text-gray-600 space-y-3 bg-gray-50 p-4 rounded">
                                <div>
                                    <label class="text-xs font-semibold text-gray-500 block mb-1">Category</label>
                                    <p id="view-ach-category" class="text-gray-800 font-semibold"></p>
                                </div>
                                <div>
                                    <label class="text-xs font-semibold text-gray-500 block mb-1">Year</label>
                                    <p id="view-ach-year" class="text-gray-800 font-semibold"></p>
                                </div>
                                <div>
                                    <label class="text-xs font-semibold text-gray-500 block mb-1">Issuing
                                        Organization</label>
                                    <p id="view-ach-issuer" class="text-gray-800 font-semibold"></p>
                                </div>
                            </div>
                        </div>

                        <!-- Right Column: Details -->
                        <div class="space-y-4">
                            <div>
                                <label class="text-sm font-semibold text-gray-600">Title</label>
                                <p id="view-ach-title" class="text-xl font-bold"></p>
                            </div>

                            <div>
                                <label class="text-sm font-semibold text-gray-600">Description</label>
                                <p id="view-ach-description" class="text-gray-700 whitespace-pre-line"></p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Edit Mode Content -->
                <div class="edit-content hidden">
                    <form id="editAchievementForm" class="space-y-4">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label class="block text-gray-700 font-semibold mb-2">Icon (Emoji)</label>
                                <input type="text" id="edit-ach-icon" name="icon" maxlength="2"
                                    class="w-full p-3 border-2 rounded-lg" placeholder="üèÜ">
                            </div>
                            <div>
                                <label class="block text-gray-700 font-semibold mb-2">Title *</label>
                                <input type="text" id="edit-ach-title" name="title" required
                                    class="w-full p-3 border-2 rounded-lg" placeholder="First Place Math Competition">
                            </div>
                        </div>

                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label class="block text-gray-700 font-semibold mb-2">Category *</label>
                                <select id="edit-ach-category" name="category" required
                                    class="w-full p-3 border-2 rounded-lg">
                                    <option value="">Select category</option>
                                    <option value="academic">Academic</option>
                                    <option value="teaching">Teaching</option>
                                    <option value="research">Research</option>
                                    <option value="leadership">Leadership</option>
                                    <option value="competition">Competition</option>
                                    <option value="publication">Publication</option>
                                    <option value="award">Award</option>
                                    <option value="community">Community Service</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-gray-700 font-semibold mb-2">Year</label>
                                <input type="number" id="edit-ach-year" name="year" min="1900" max="2100"
                                    class="w-full p-3 border-2 rounded-lg" placeholder="2024">
                            </div>
                        </div>

                        <div>
                            <label class="block text-gray-700 font-semibold mb-2">Issuing Organization</label>
                            <input type="text" id="edit-ach-issuer" name="issuer" class="w-full p-3 border-2 rounded-lg"
                                placeholder="Organization name">
                        </div>

                        <div>
                            <label class="block text-gray-700 font-semibold mb-2">Description</label>
                            <textarea id="edit-ach-description" name="description" rows="4"
                                class="w-full p-3 border-2 rounded-lg"
                                placeholder="Describe your achievement..."></textarea>
                        </div>

                        <div>
                            <label class="block text-gray-700 font-semibold mb-2">Replace Certificate (Optional)</label>
                            <input type="file" id="edit-ach-certificate" name="certificate" accept="image/*,.pdf"
                                class="w-full p-3 border-2 rounded-lg">
                            <p class="text-sm text-gray-500 mt-1">Leave empty to keep existing certificate</p>
                        </div>
                    </form>
                </div>

                <!-- Action Buttons -->
                <div class="flex gap-3 mt-6">
                    <button onclick="closeViewModal('achievement')" class="btn-secondary px-6">Close</button>
                </div>
            </div>
        </div>
    </div>

    <!-- View Certification Modal -->
    <div id="viewCertificationModal" class="modal hidden">
        <div class="modal-content max-w-4xl">
            <div class="modal-header">
                <h2 class="text-2xl font-bold">üìú Certification Details</h2>
                <button onclick="closeViewModal('certification')" class="close-modal">&times;</button>
            </div>
            <div class="modal-body">
                <!-- View Mode Content -->
                <div class="view-content">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <!-- Left Column: Certificate/Icon & Status -->
                        <div>
                            <!-- Certificate Preview (shown when available) -->
                            <div id="view-cert-certificate-preview" class="mb-4">
                                <!-- Content will be populated by JavaScript -->
                            </div>

                            <!-- Icon fallback (shown when no certificate) -->
                            <div id="view-cert-icon-fallback" class="text-center mb-4">
                                <div class="text-8xl mb-4">üìú</div>
                            </div>

                            <div id="view-cert-status" class="text-center mb-4"></div>

                            <div class="text-sm text-gray-600 space-y-3 bg-gray-50 p-4 rounded">
                                <div>
                                    <label class="text-xs font-semibold text-gray-500 block mb-1">Issue Date</label>
                                    <p id="view-cert-issue-date" class="text-gray-800 font-semibold"></p>
                                </div>
                                <div>
                                    <label class="text-xs font-semibold text-gray-500 block mb-1">Expiry Date</label>
                                    <p id="view-cert-expiry-date" class="text-gray-800 font-semibold"></p>
                                </div>
                                <div>
                                    <label class="text-xs font-semibold text-gray-500 block mb-1">Credential ID</label>
                                    <p id="view-cert-credential-id" class="text-gray-800 font-mono text-xs break-all">
                                    </p>
                                </div>
                            </div>
                        </div>

                        <!-- Right Column: Details -->
                        <div class="space-y-4">
                            <div>
                                <label class="text-sm font-semibold text-gray-600">Certification Name</label>
                                <p id="view-cert-name" class="text-xl font-bold"></p>
                            </div>

                            <div class="grid grid-cols-2 gap-4">
                                <div>
                                    <label class="text-sm font-semibold text-gray-600">Issuing Organization</label>
                                    <p id="view-cert-organization" class="text-gray-800"></p>
                                </div>
                                <div>
                                    <label class="text-sm font-semibold text-gray-600">Field of Study</label>
                                    <p id="view-cert-field" class="text-gray-800"></p>
                                </div>
                            </div>

                            <div>
                                <label class="text-sm font-semibold text-gray-600">Description</label>
                                <p id="view-cert-description" class="text-gray-700 whitespace-pre-line"></p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Edit Mode Content -->
                <div class="edit-content hidden">
                    <form id="editCertificationForm" class="space-y-4">
                        <div>
                            <label class="block text-gray-700 font-semibold mb-2">Certification Name *</label>
                            <input type="text" id="edit-cert-name" name="name" required
                                class="w-full p-3 border-2 rounded-lg">
                        </div>

                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label class="block text-gray-700 font-semibold mb-2">Issuing Organization *</label>
                                <input type="text" id="edit-cert-organization" name="issuing_organization" required
                                    class="w-full p-3 border-2 rounded-lg">
                            </div>
                            <div>
                                <label class="block text-gray-700 font-semibold mb-2">Field of Study</label>
                                <input type="text" id="edit-cert-field" name="field_of_study"
                                    class="w-full p-3 border-2 rounded-lg">
                            </div>
                        </div>

                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label class="block text-gray-700 font-semibold mb-2">Issue Date</label>
                                <input type="date" id="edit-cert-issue-date" name="issue_date"
                                    class="w-full p-3 border-2 rounded-lg">
                            </div>
                            <div>
                                <label class="block text-gray-700 font-semibold mb-2">Expiry Date</label>
                                <input type="date" id="edit-cert-expiry-date" name="expiry_date"
                                    class="w-full p-3 border-2 rounded-lg">
                            </div>
                        </div>

                        <div>
                            <label class="block text-gray-700 font-semibold mb-2">Credential ID</label>
                            <input type="text" id="edit-cert-credential-id" name="credential_id"
                                class="w-full p-3 border-2 rounded-lg">
                        </div>

                        <div>
                            <label class="block text-gray-700 font-semibold mb-2">Description</label>
                            <textarea id="edit-cert-description" name="description" rows="3"
                                class="w-full p-3 border-2 rounded-lg"></textarea>
                        </div>

                        <div>
                            <label class="block text-gray-700 font-semibold mb-2">Replace Certificate (Optional)</label>
                            <input type="file" id="edit-cert-certificate" name="certificate_image" accept="image/*,.pdf"
                                class="w-full p-3 border-2 rounded-lg">
                            <p class="text-sm text-gray-500 mt-1">Leave empty to keep existing certificate</p>
                        </div>
                    </form>
                </div>

                <!-- Action Buttons -->
                <div class="flex gap-3 mt-6">
                    <button onclick="closeViewModal('certification')" class="btn-secondary px-6">Close</button>
                </div>
            </div>
        </div>
    </div>

    <!-- View Experience Modal -->
    <div id="viewExperienceModal" class="modal hidden">
        <div class="modal-content max-w-4xl">
            <div class="modal-header">
                <h2 class="text-2xl font-bold">üíº Experience Details</h2>
                <button onclick="closeViewModal('experience')" class="close-modal">&times;</button>
            </div>
            <div class="modal-body">
                <!-- View Mode Content -->
                <div class="view-content">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <!-- Left Column: Certificate/Icon & Status -->
                        <div>
                            <!-- Certificate Preview (shown when available) -->
                            <div id="view-exp-certificate-preview" class="mb-4">
                                <!-- Content will be populated by JavaScript -->
                            </div>

                            <!-- Icon fallback (shown when no certificate) -->
                            <div id="view-exp-icon-fallback" class="text-center mb-4">
                                <div class="text-8xl mb-4">üíº</div>
                            </div>

                            <div id="view-exp-status" class="text-center mb-4"></div>

                            <div class="text-sm text-gray-600 space-y-3 bg-gray-50 p-4 rounded">
                                <div>
                                    <label class="text-xs font-semibold text-gray-500 block mb-1">Start Date</label>
                                    <p id="view-exp-start-date" class="text-gray-800 font-semibold"></p>
                                </div>
                                <div>
                                    <label class="text-xs font-semibold text-gray-500 block mb-1">End Date</label>
                                    <p id="view-exp-end-date" class="text-gray-800 font-semibold"></p>
                                </div>
                                <div>
                                    <label class="text-xs font-semibold text-gray-500 block mb-1">Employment
                                        Type</label>
                                    <p id="view-exp-employment-type" class="text-gray-800 font-semibold"></p>
                                </div>
                            </div>
                        </div>

                        <!-- Right Column: Details -->
                        <div class="space-y-4">
                            <div>
                                <label class="text-sm font-semibold text-gray-600">Job Title</label>
                                <p id="view-exp-job-title" class="text-xl font-bold"></p>
                            </div>

                            <div class="grid grid-cols-2 gap-4">
                                <div>
                                    <label class="text-sm font-semibold text-gray-600">Institution</label>
                                    <p id="view-exp-institution" class="text-gray-800"></p>
                                </div>
                                <div>
                                    <label class="text-sm font-semibold text-gray-600">Location</label>
                                    <p id="view-exp-location" class="text-gray-800"></p>
                                </div>
                            </div>

                            <div>
                                <label class="text-sm font-semibold text-gray-600">Description</label>
                                <p id="view-exp-description" class="text-gray-700 whitespace-pre-line"></p>
                            </div>

                            <div>
                                <label class="text-sm font-semibold text-gray-600">Key Responsibilities</label>
                                <p id="view-exp-responsibilities" class="text-gray-700 whitespace-pre-line"></p>
                            </div>

                            <div>
                                <label class="text-sm font-semibold text-gray-600">Achievements</label>
                                <p id="view-exp-achievements" class="text-gray-700 whitespace-pre-line"></p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Edit Mode Content -->
                <div class="edit-content hidden">
                    <form id="editExperienceForm" class="space-y-4">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label class="block text-gray-700 font-semibold mb-2">Job Title *</label>
                                <input type="text" id="edit-exp-job-title" name="job_title" required
                                    class="w-full p-3 border-2 rounded-lg">
                            </div>
                            <div>
                                <label class="block text-gray-700 font-semibold mb-2">Institution *</label>
                                <input type="text" id="edit-exp-institution" name="institution" required
                                    class="w-full p-3 border-2 rounded-lg">
                            </div>
                        </div>

                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label class="block text-gray-700 font-semibold mb-2">Location</label>
                                <input type="text" id="edit-exp-location" name="location"
                                    class="w-full p-3 border-2 rounded-lg" placeholder="City, Country">
                            </div>
                            <div>
                                <label class="block text-gray-700 font-semibold mb-2">Employment Type</label>
                                <select id="edit-exp-employment-type" name="employment_type"
                                    class="w-full p-3 border-2 rounded-lg">
                                    <option value="">Select type</option>
                                    <option value="Full-time">Full-time</option>
                                    <option value="Part-time">Part-time</option>
                                    <option value="Contract">Contract</option>
                                    <option value="Freelance">Freelance</option>
                                    <option value="Internship">Internship</option>
                                </select>
                            </div>
                        </div>

                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label class="block text-gray-700 font-semibold mb-2">Start Date *</label>
                                <input type="date" id="edit-exp-start-date" name="start_date" required
                                    class="w-full p-3 border-2 rounded-lg">
                            </div>
                            <div>
                                <label class="block text-gray-700 font-semibold mb-2">End Date</label>
                                <input type="date" id="edit-exp-end-date" name="end_date"
                                    class="w-full p-3 border-2 rounded-lg">
                                <label class="flex items-center mt-2">
                                    <input type="checkbox" id="edit-exp-is-current" name="is_current"
                                        onchange="toggleEndDate(this)" class="mr-2">
                                    <span class="text-sm">I currently work here</span>
                                </label>
                            </div>
                        </div>

                        <div>
                            <label class="block text-gray-700 font-semibold mb-2">Description</label>
                            <textarea id="edit-exp-description" name="description" rows="3"
                                class="w-full p-3 border-2 rounded-lg"></textarea>
                        </div>

                        <div>
                            <label class="block text-gray-700 font-semibold mb-2">Key Responsibilities</label>
                            <textarea id="edit-exp-responsibilities" name="responsibilities" rows="3"
                                class="w-full p-3 border-2 rounded-lg"></textarea>
                        </div>

                        <div>
                            <label class="block text-gray-700 font-semibold mb-2">Achievements</label>
                            <textarea id="edit-exp-achievements" name="achievements" rows="3"
                                class="w-full p-3 border-2 rounded-lg"></textarea>
                        </div>

                        <div>
                            <label class="block text-gray-700 font-semibold mb-2">Replace Certificate (Optional)</label>
                            <input type="file" id="edit-exp-certificate" name="certificate" accept="image/*,.pdf"
                                class="w-full p-3 border-2 rounded-lg">
                            <p class="text-sm text-gray-500 mt-1">Leave empty to keep existing certificate</p>
                        </div>
                    </form>
                </div>

                <!-- Action Buttons -->
                <div class="flex gap-3 mt-6">
                    <button onclick="closeViewModal('experience')" class="btn-secondary px-6">Close</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="../js/root/app.js"></script>
    <script src="../js/root/auth.js?v=20251217"></script>
    <script src="../js/root/nav.js"></script>

    <!-- Share Profile Manager (Must load early for onclick handlers) -->
    <script src="../js/common-modals/share-profile-manager.js?v=20260204k"></script>

    <!-- Access Restricted Modal - MUST load before ProfileCompletionGuard -->
    <script src="../js/common-modals/access-restricted-modal.js?v=20251229"></script>
    <script src="../js/root/profile-completion-guard.js?v=20251224"></script>
    <script src="../js/root/profile-system.js"></script>
    <!-- page-structure-manager.js removed - functionality is inline -->
    <!-- <script src="../js/page-structure/weather-manager.js"></script> -->
    <!-- Common Modal Loader for add-role, logout, coming-soon modals -->
    <script src="../modals/common-modals/common-modal-loader.js?v=20260204g"></script>
    <script src="../js/common-modals/coming-soon-modal.js?v=20260205"></script>
    <script src="../js/common-modals/ad-modal.js"></script>
    <script src="../js/common-modals/ad-rotation-manager.js"></script>
    <script src="../js/common-modals/logout-modal.js"></script>
    <!-- Deletion Countdown Banner - Shows role deletion warning in profile dropdown -->
    <script src="../js/common-modals/deletion-countdown-banner.js"></script>

    <!-- Protected API Wrapper (2FA protection for session requests) -->
    <script src="../js/common-modals/protected-api-wrapper.js"></script>

    <!-- Sidebar Toggle (shared) -->
    <script src="../js/shared/sidebar-toggle.js"></script>
    <!-- OLD LOADER REMOVED - Using view-tutor-db-loader.js instead (loaded at bottom) -->
    <!-- <script src="../js/view-tutor/view-tutor-loader.js"></script> -->

    <script>
        // Panel switching functionality
        async function switchPanel(panelName) {
            // 2FA-protected panels - require verification if user has 2FA enabled
            const protectedPanels = ['packages'];

            if (protectedPanels.includes(panelName)) {
                // Check if ProtectedAPI is available and require verification
                if (typeof ProtectedAPI !== 'undefined') {
                    const verified = await ProtectedAPI.requireVerification('view_tutor_packages');
                    if (!verified) {
                        console.log('2FA verification required for packages panel - access denied');
                        return; // Don't switch panel if verification failed/cancelled
                    }
                }
            }

            // Hide all panels
            document.querySelectorAll('.panel-content').forEach(panel => {
                panel.classList.remove('active');
            });

            // Show selected panel
            const panel = document.getElementById(panelName + '-panel');
            if (panel) {
                panel.classList.add('active');

                // Scroll to top of content area
                window.scrollTo({
                    top: 0,
                    behavior: 'smooth'
                });
            }

            // Update sidebar links - find the clicked link
            document.querySelectorAll('.sidebar-link').forEach(link => {
                link.classList.remove('active');

                // Check if this link's onclick contains the panel name
                const onclickAttr = link.getAttribute('onclick');
                if (onclickAttr && onclickAttr.includes(`'${panelName}'`)) {
                    link.classList.add('active');
                }
            });
        }

        // Tutor interaction functions

        function viewPackage() {
            alert('Opening package details modal...');
        }

        function requestSession() {
            alert('Opening session request modal...');
        }

        async function connectTutor() {
            const connectionManager = window.connectionManagerInstance;
            if (!connectionManager) {
                console.error('Connection manager not initialized');
                return;
            }

            // Get the tutor's user ID from the page
            const tutorUserId = window.currentTutorUserId;
            if (!tutorUserId) {
                console.error('Tutor user ID not found');
                connectionManager.showNotification('Unable to connect: Tutor information not found', 'error');
                return;
            }

            // Check if user is logged in
            const token = connectionManager.getToken();
            if (!token) {
                connectionManager.showNotification('Please log in to connect with tutors', 'error');
                // Open auth modal if available
                if (typeof openAuthModal === 'function') {
                    openAuthModal();
                }
                return;
            }

            // Get current connection status
            const currentStatus = connectionManager.currentConnectionStatus;
            const button = document.querySelector('button[onclick="connectTutor()"]');

            // Debug: Check if button was found
            console.log('üîç Connect button found:', button);
            console.log('üîç Current status:', currentStatus);

            if (!button && currentStatus !== 'connecting') {
                console.error('‚ùå Connect button not found!');
                connectionManager.showNotification('Button not found. Please refresh the page.', 'error');
                return;
            }

            try {
                // Check connection status to get direction info
                const statusInfo = await connectionManager.checkConnectionStatus(tutorUserId);

                if (currentStatus === 'accepted' || currentStatus === 'connected') {
                    // Already connected - show options to disconnect
                    const confirmDisconnect = confirm('You are already connected with this tutor. Do you want to disconnect?');
                    if (confirmDisconnect) {
                        await connectionManager.disconnectFromTutor(connectionManager.currentConnectionId);
                        connectionManager.showNotification('Disconnected successfully', 'success');

                        // Check status again to update button
                        const newStatus = await connectionManager.checkConnectionStatus(tutorUserId);
                        connectionManager.updateConnectionButtonUI(button, newStatus);
                    }
                } else if (currentStatus === 'pending' && statusInfo.direction === 'incoming') {
                    // Incoming request - accept it
                    if (button) {
                        button.disabled = true;
                        button.innerHTML = '‚è≥ Accepting...';
                    }

                    await connectionManager.acceptConnectionRequest(connectionManager.currentConnectionId);
                    connectionManager.showNotification('Connection accepted!', 'success');

                    // Update button UI
                    const newStatus = await connectionManager.checkConnectionStatus(tutorUserId);
                    const currentButton = document.querySelector('button[onclick="connectTutor()"]');
                    if (currentButton) {
                        connectionManager.updateConnectionButtonUI(currentButton, newStatus);
                    }
                } else if (currentStatus === 'pending' || currentStatus === 'connecting') {
                    // Outgoing pending request - dropdown handles the cancel action
                    // Just show a message that they can use the dropdown
                    connectionManager.showNotification('Click the dropdown arrow to cancel the connection request', 'info');
                } else {
                    // No connection or disconnected - send new request
                    if (button) {
                        button.disabled = true;
                        button.innerHTML = '‚è≥ Sending...';
                    }

                    const response = await connectionManager.sendConnectionRequest(tutorUserId);
                    connectionManager.showNotification('Connection request sent successfully!', 'success');

                    // Update button UI
                    const newStatus = await connectionManager.checkConnectionStatus(tutorUserId);
                    const currentButton = document.querySelector('button[onclick="connectTutor()"]');
                    if (currentButton) {
                        connectionManager.updateConnectionButtonUI(currentButton, newStatus);
                    }
                }
            } catch (error) {
                console.error('Connection error:', error);
                connectionManager.showNotification(error.message || 'Failed to process connection request', 'error');

                // Reset button on error
                if (button) {
                    button.disabled = false;
                    button.innerHTML = 'üîó Connect';
                }
            }
        }

        // shareProfile() is now handled by share-profile-manager.js

        function viewTutor(tutorId) {
            console.log('Viewing tutor:', tutorId);
            // In production, would navigate to the tutor's profile page
        }

        // Hero Section Typewriter Effect - uses hero_titles from database
        let heroTexts = []; // Will be populated from database
        let textIndex = 0;
        let charIndex = 0;
        let isDeleting = false;
        let typeSpeed = 100;
        let typewriterStarted = false;

        function typeWriter() {
            const typedElement = document.getElementById('typedText');
            if (!typedElement || heroTexts.length === 0) return;

            const currentText = heroTexts[textIndex];

            if (isDeleting) {
                typedElement.textContent = currentText.substring(0, charIndex - 1);
                charIndex--;
                typeSpeed = 50;
            } else {
                typedElement.textContent = currentText.substring(0, charIndex + 1);
                charIndex++;
                typeSpeed = 100;
            }

            if (!isDeleting && charIndex === currentText.length) {
                typeSpeed = 2000; // Pause at end
                isDeleting = true;
            } else if (isDeleting && charIndex === 0) {
                isDeleting = false;
                textIndex = (textIndex + 1) % heroTexts.length;
                typeSpeed = 500; // Pause before typing new text
            }

            setTimeout(typeWriter, typeSpeed);
        }

        // Function to start typewriter with tutor's hero_titles from database
        function startTypewriterWithData(titles) {
            if (typewriterStarted) return;

            if (titles && Array.isArray(titles) && titles.length > 0) {
                heroTexts = titles;
            } else {
                // Fallback if no titles from database
                heroTexts = ["Excellence in Education, Delivered with Passion"];
            }

            typewriterStarted = true;
            textIndex = 0;
            charIndex = 0;
            isDeleting = false;
            setTimeout(typeWriter, 500);
        }

        // Expose function globally so view-tutor-db-loader.js can call it
        window.startTypewriterWithData = startTypewriterWithData;

        // Theme toggle
        const themeToggle = document.getElementById('theme-toggle-btn');
        themeToggle?.addEventListener('click', () => {
            const html = document.documentElement;
            const currentTheme = html.getAttribute('data-theme');
            const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
            html.setAttribute('data-theme', newTheme);
            localStorage.setItem('theme', newTheme);
        });

        // Restore theme preference
        const savedTheme = localStorage.getItem('theme') || 'light';
        document.documentElement.setAttribute('data-theme', savedTheme);

        // Sidebar animation is now handled by sidebar-fix.js
        // which adds/removes 'sidebar-active' class to body and sections

        // Modal functions
        function openAdAnalyticsModal() {
            document.getElementById('adAnalyticsModal')?.classList.remove('hidden');
        }

        function closeAdAnalyticsModal() {
            document.getElementById('adAnalyticsModal')?.classList.add('hidden');
        }

        function closeModal(modalId) {
            const modal = document.getElementById(modalId);
            if (modal) {
                modal.classList.add('hidden');
                modal.classList.remove('active');
                modal.style.display = 'none';
            }
            // Restore body scroll
            document.body.style.overflow = '';
        }

        function openModal(modalId) {
            const modal = document.getElementById(modalId);
            if (modal) {
                modal.classList.remove('hidden');
                modal.classList.add('active');
                modal.style.display = 'flex';
            }
            // Prevent body scroll
            document.body.style.overflow = 'hidden';
        }

        function handleNavLinkClick(event, feature) {
            event.preventDefault();
            console.log('Navigating to:', feature);
            // In production, would handle navigation
        }
        // Story Functions
        function openStory() {
            const modal = document.getElementById('storyModal');
            if (modal) {
                modal.classList.add('active');
                // Auto close after 5 seconds
                setTimeout(() => {
                    closeStory();
                }, 5000);
            }
        }

        function closeStory() {
            const modal = document.getElementById('storyModal');
            if (modal) {
                modal.classList.remove('active');
            }
        }

        // Story Viewer Functions
        let currentStoryIndex = 0;
        const stories = [
            { id: 'tutor-story', user: 'Dr. Abebe', avatar: '../pictures/tutor-male-young.jpg', time: 'Now', image: '../pictures/Math wallpaper 1.jpeg' },
            { id: 'story2', user: 'Marta T.', avatar: '../pictures/student-teenage-girl.jpg', time: '2h ago', image: '../pictures/Chemistry wallpaper 3.jpg' },
            { id: 'story3', user: 'Sara M.', avatar: '../pictures/tutor-woman.jpg', time: '5h ago', image: '../pictures/Physics wallpaper 2.jpeg' },
            { id: 'story4', user: 'Yohannes K.', avatar: '../pictures/student-college-boy.jpg', time: '12h ago', image: '../pictures/Biology wallpaper 1.jpeg' },
            { id: 'story5', user: 'Daniel A.', avatar: '../pictures/tutor-image-14.jpeg', time: '8h ago', image: '../pictures/Geography wallpaper 1.jpeg' },
            { id: 'story6', user: 'Bekele T.', avatar: '../pictures/student-teenage-boy.jpg', time: '1d ago', image: '../pictures/History wallpaper 1.jpeg' }
        ];

        function openStoryViewer(storyId) {
            const storyIndex = stories.findIndex(s => s.id === storyId);
            if (storyIndex !== -1) {
                currentStoryIndex = storyIndex;
                showStoryInViewer(currentStoryIndex);
                document.getElementById('storyViewerModal').classList.add('active');
            }
        }

        function showStoryInViewer(index) {
            const story = stories[index];
            if (!story) return;

            const modal = document.getElementById('storyViewerModal');
            if (modal) {
                // Update user info
                modal.querySelector('.story-username').textContent = story.user;
                modal.querySelector('.story-time').textContent = story.time;
                modal.querySelector('.story-user-avatar').src = story.avatar;

                // Update story image
                modal.querySelector('.story-main-image').src = story.image;

                // Reset progress bar
                const progressBar = modal.querySelector('.story-progress-bar');
                if (progressBar) {
                    progressBar.style.animation = 'none';
                    setTimeout(() => {
                        progressBar.style.animation = 'storyProgress 5s linear forwards';
                    }, 10);
                }

                // Auto advance to next story after 5 seconds
                setTimeout(() => {
                    nextStory();
                }, 5000);
            }
        }

        function nextStory() {
            if (currentStoryIndex < stories.length - 1) {
                currentStoryIndex++;
                showStoryInViewer(currentStoryIndex);
            } else {
                closeStoryViewer();
            }
        }

        function prevStory() {
            if (currentStoryIndex > 0) {
                currentStoryIndex--;
                showStoryInViewer(currentStoryIndex);
            }
        }

        function closeStoryViewer() {
            document.getElementById('storyViewerModal').classList.remove('active');
        }

        // Filter stories by category
        function filterStories(category) {
            console.log('Filtering stories by:', category);
            // In production, this would filter the stories displayed
            alert(`Showing ${category} stories`);
        }

        // Load more stories
        function loadMoreStories() {
            console.log('Loading more stories...');
            // In production, this would fetch more stories from the API
            alert('Loading more stories...');
        }

        // Close story on ESC key
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                closeStory();
                closeStoryViewer();
            }
        });
    </script>
    <script src="../js/view-tutor/view-extension-modals.js"></script>

    <!-- Story Modal -->
    <div id="storyModal" class="story-modal" onclick="closeStory()">
        <div class="story-content" onclick="event.stopPropagation()">
            <div class="story-progress">
                <div class="story-progress-bar"></div>
            </div>
            <img src="../pictures/tutor-male-young.jpg" alt="Story" class="story-image">
            <div class="story-close" onclick="closeStory()">√ó</div>
        </div>
    </div>

    <!-- Enhanced Story Viewer Modal -->
    <div id="storyViewerModal" class="story-viewer-modal" onclick="closeStoryViewer()">
        <div class="story-viewer-content" onclick="event.stopPropagation()">
            <!-- Story Header with User Info -->
            <div class="story-header">
                <div class="story-user-info">
                    <img class="story-user-avatar" src="../pictures/tutor-male-young.jpg" alt="User">
                    <div class="story-user-details">
                        <p class="story-username">Dr. Abebe</p>
                        <p class="story-time">2h ago</p>
                    </div>
                </div>
                <button class="story-close" onclick="closeStoryViewer()"
                    style="position: static; background: rgba(255, 255, 255, 0.1); border: 2px solid rgba(255, 255, 255, 0.3);">√ó</button>
            </div>

            <!-- Progress Bar -->
            <div class="story-progress">
                <div class="story-progress-bar"></div>
            </div>

            <!-- Main Story Image -->
            <img class="story-main-image story-image" src="../pictures/Math wallpaper 1.jpeg" alt="Story">

            <!-- Navigation Buttons -->
            <div class="story-navigation">
                <button class="story-nav-btn" onclick="prevStory()">‚Äπ</button>
                <button class="story-nav-btn" onclick="nextStory()">‚Ä∫</button>
            </div>
        </div>
    </div>

    <!-- Package Details Modal - Modern Design -->
    <div id="packageDetailsModal" class="modal hidden"
        style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); backdrop-filter: blur(4px); z-index: 9999; display: none; align-items: center; justify-content: center;">
        <div class="modal-overlay" onclick="closePackageDetailsModal()"
            style="position: absolute; top: 0; left: 0; width: 100%; height: 100%;"></div>
        <div class="modal-content"
            style="position: relative; width: 95%; max-width: 700px; margin: 20px auto; background: var(--card-bg); border-radius: 24px; max-height: 90vh; overflow: hidden; box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25); animation: modalSlideIn 0.3s ease-out;">

            <!-- Modal Header -->
            <div style="background: var(--primary-color); padding: 24px 28px; position: relative;">
                <button class="modal-close" onclick="closePackageDetailsModal()"
                    style="position: absolute; top: 16px; right: 16px; background: rgba(255,255,255,0.2); border: none; width: 36px; height: 36px; border-radius: 50%; cursor: pointer; color: white; font-size: 1.25rem; display: flex; align-items: center; justify-content: center; transition: background 0.2s;">
                    <i class="fas fa-times"></i>
                </button>
                <h2
                    style="font-size: 1.5rem; font-weight: 700; color: white; margin: 0; display: flex; align-items: center; gap: 12px;">
                    <i class="fas fa-box-open"></i> Request Package
                </h2>
                <p style="color: rgba(255,255,255,0.85); margin: 8px 0 0 0; font-size: 0.9rem;">Review package details
                    and customize your request</p>
            </div>

            <!-- Scrollable Content -->
            <div style="padding: 24px 28px; max-height: calc(90vh - 180px); overflow-y: auto;">


                <!-- Student Information - For Parents Only (with child search) -->
                <div id="parentChildSelectionSection" class="modal-section"
                    style="background: var(--card-bg); border: 2px solid var(--primary-color); padding: 20px; border-radius: 16px; margin-bottom: 20px; display: none; position: relative; overflow: visible;">
                    <div
                        style="position: absolute; top: -12px; left: 20px; background: var(--primary-color); color: white; padding: 4px 12px; border-radius: 20px; font-size: 0.75rem; font-weight: 600;">
                        <i class="fas fa-child"></i> FOR PARENT
                    </div>
                    <h3
                        style="font-size: 1rem; font-weight: 600; margin: 8px 0 16px 0; color: var(--text-color); display: flex; align-items: center; gap: 8px;">
                        <i class="fas fa-user-graduate" style="color: var(--primary-color);"></i> Select Your Child
                    </h3>

                    <!-- Child Search Input -->
                    <div style="position: relative; margin-bottom: 16px;">
                        <div style="position: relative;">
                            <input type="text" id="childSearchInput" placeholder="Search your children by name..."
                                autocomplete="off"
                                style="width: 100%; padding: 14px 14px 14px 44px; border: 2px solid var(--border-color); border-radius: 12px; font-size: 0.95rem; transition: all 0.2s; background: var(--bg-color); color: var(--text-color);">
                            <i class="fas fa-search"
                                style="position: absolute; left: 16px; top: 50%; transform: translateY(-50%); color: var(--text-muted); font-size: 1rem;"></i>
                            <div id="childSearchSpinner"
                                style="display: none; position: absolute; right: 16px; top: 50%; transform: translateY(-50%);">
                                <i class="fas fa-spinner fa-spin" style="color: var(--primary-color);"></i>
                            </div>
                        </div>

                        <!-- Search Results Dropdown -->
                        <div id="childSearchResults"
                            style="display: none; position: absolute; top: 100%; left: 0; right: 0; background: var(--card-bg); border: 2px solid var(--border-color); border-top: none; border-radius: 0 0 12px 12px; max-height: 220px; overflow-y: auto; z-index: 100; box-shadow: 0 8px 24px rgba(0,0,0,0.15);">
                        </div>
                    </div>

                    <!-- Selected Child Display -->
                    <div id="selectedChildDisplay"
                        style="display: none; background: rgba(var(--primary-rgb), 0.08); padding: 16px; border-radius: 12px; border: 2px solid var(--primary-color);">
                        <div style="display: flex; align-items: center; gap: 14px;">
                            <img id="selectedChildAvatar" src="" alt="Child"
                                style="width: 52px; height: 52px; border-radius: 50%; object-fit: cover; border: 3px solid var(--primary-color); box-shadow: 0 4px 12px rgba(0,0,0,0.1);">
                            <div style="flex: 1;">
                                <h4 id="selectedChildName"
                                    style="font-weight: 600; color: var(--text-color); margin: 0; font-size: 1rem;">
                                </h4>
                                <p id="selectedChildGrade"
                                    style="font-size: 0.85rem; color: var(--text-muted); margin: 4px 0 0 0;"></p>
                            </div>
                            <button type="button" onclick="clearSelectedChild()"
                                style="background: #ef4444; color: white; border: none; padding: 10px 16px; border-radius: 10px; cursor: pointer; font-size: 0.85rem; font-weight: 500; display: flex; align-items: center; gap: 6px; transition: transform 0.2s, box-shadow 0.2s;">
                                <i class="fas fa-sync-alt"></i> Change
                            </button>
                        </div>
                    </div>

                    <!-- Hidden inputs -->
                    <input type="hidden" id="selectedChildId" value="">
                    <input type="hidden" id="detailsStudentName" value="">
                    <input type="hidden" id="detailsGradeLevel" value="">

                    <!-- No Children Message -->
                    <div id="noChildrenMessage"
                        style="display: none; text-align: center; padding: 24px; background: #fef3c7; border-radius: 12px;">
                        <i class="fas fa-user-plus" style="font-size: 2.5rem; color: #f59e0b; margin-bottom: 12px;"></i>
                        <p style="font-weight: 600; color: #92400e; margin: 0 0 6px 0; font-size: 1rem;">No Children
                            Added Yet</p>
                        <p style="font-size: 0.85rem; color: #a16207; margin: 0 0 16px 0;">Add children to your profile
                            to request tutoring</p>
                        <a href="/profile-pages/parent-profile.html"
                            style="display: inline-flex; align-items: center; gap: 8px; background: #f59e0b; color: white; padding: 10px 20px; border-radius: 10px; text-decoration: none; font-size: 0.9rem; font-weight: 500; transition: transform 0.2s;">
                            <i class="fas fa-plus"></i> Add Children
                        </a>
                    </div>
                </div>

                <!-- Package Details Display -->
                <div id="packageDetailsContent" style="margin-bottom: 24px;">
                    <!-- Will be populated by JavaScript -->
                </div>

                <!-- Schedule Preferences Section -->
                <div class="modal-section"
                    style="background: var(--card-bg); border: 2px solid var(--border-color); padding: 20px; border-radius: 16px; margin-bottom: 20px;">
                    <h3
                        style="font-size: 1rem; font-weight: 600; margin: 0 0 16px 0; color: var(--text-color); display: flex; align-items: center; gap: 8px;">
                        <i class="fas fa-calendar-alt" style="color: var(--primary-color);"></i> Schedule Preferences
                    </h3>

                    <!-- Schedule Type -->
                    <div style="margin-bottom: 16px;">
                        <label
                            style="display: block; font-weight: 500; margin-bottom: 8px; font-size: 0.875rem; color: var(--text-color);">Schedule
                            Type</label>
                        <select id="scheduleType" onchange="toggleScheduleFields()"
                            style="width: 100%; padding: 12px 16px; border: 2px solid var(--border-color); border-radius: 10px; font-size: 0.9rem; background: var(--bg-color); color: var(--text-color); cursor: pointer; transition: border-color 0.2s;">
                            <option value="">-- Select schedule type --</option>
                            <option value="recurring">Recurring (Weekly schedule)</option>
                            <option value="specific_dates">Specific Dates</option>
                        </select>
                    </div>

                    <!-- Recurring Schedule Options -->
                    <div id="recurringScheduleFields" style="display: none; animation: fadeIn 0.3s ease;">
                        <!-- Year Range -->
                        <div style="margin-bottom: 16px;">
                            <label
                                style="display: block; font-weight: 500; margin-bottom: 10px; font-size: 0.875rem; color: var(--text-color);">Year(s)</label>
                            <div style="display: flex; gap: 12px; flex-wrap: wrap;">
                                <label
                                    style="display: flex; align-items: center; gap: 8px; cursor: pointer; padding: 8px 16px; border: 2px solid var(--border-color); border-radius: 8px; transition: all 0.2s; background: var(--bg-color);">
                                    <input type="checkbox" name="yearRange" value="2024"
                                        style="width: 18px; height: 18px; accent-color: var(--primary-color);">
                                    <span style="font-size: 0.9rem; color: var(--text-color);">2024</span>
                                </label>
                                <label
                                    style="display: flex; align-items: center; gap: 8px; cursor: pointer; padding: 8px 16px; border: 2px solid var(--primary-color); border-radius: 8px; transition: all 0.2s; background: rgba(var(--primary-rgb), 0.1);">
                                    <input type="checkbox" name="yearRange" value="2025" checked
                                        style="width: 18px; height: 18px; accent-color: var(--primary-color);">
                                    <span
                                        style="font-size: 0.9rem; color: var(--text-color); font-weight: 500;">2025</span>
                                </label>
                                <label
                                    style="display: flex; align-items: center; gap: 8px; cursor: pointer; padding: 8px 16px; border: 2px solid var(--border-color); border-radius: 8px; transition: all 0.2s; background: var(--bg-color);">
                                    <input type="checkbox" name="yearRange" value="2026"
                                        style="width: 18px; height: 18px; accent-color: var(--primary-color);">
                                    <span style="font-size: 0.9rem; color: var(--text-color);">2026</span>
                                </label>
                            </div>
                        </div>

                        <!-- Months -->
                        <div style="margin-bottom: 16px;">
                            <label
                                style="display: block; font-weight: 500; margin-bottom: 10px; font-size: 0.875rem; color: var(--text-color);">Month(s)</label>
                            <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 8px;">
                                <label
                                    style="display: flex; align-items: center; gap: 6px; cursor: pointer; padding: 8px 10px; border: 1px solid var(--border-color); border-radius: 8px; font-size: 0.85rem; background: var(--bg-color); color: var(--text-color); transition: all 0.2s;">
                                    <input type="checkbox" name="months" value="January"
                                        style="accent-color: var(--primary-color);"> Jan
                                </label>
                                <label
                                    style="display: flex; align-items: center; gap: 6px; cursor: pointer; padding: 8px 10px; border: 1px solid var(--border-color); border-radius: 8px; font-size: 0.85rem; background: var(--bg-color); color: var(--text-color); transition: all 0.2s;">
                                    <input type="checkbox" name="months" value="February"
                                        style="accent-color: var(--primary-color);"> Feb
                                </label>
                                <label
                                    style="display: flex; align-items: center; gap: 6px; cursor: pointer; padding: 8px 10px; border: 1px solid var(--border-color); border-radius: 8px; font-size: 0.85rem; background: var(--bg-color); color: var(--text-color); transition: all 0.2s;">
                                    <input type="checkbox" name="months" value="March"
                                        style="accent-color: var(--primary-color);"> Mar
                                </label>
                                <label
                                    style="display: flex; align-items: center; gap: 6px; cursor: pointer; padding: 8px 10px; border: 1px solid var(--border-color); border-radius: 8px; font-size: 0.85rem; background: var(--bg-color); color: var(--text-color); transition: all 0.2s;">
                                    <input type="checkbox" name="months" value="April"
                                        style="accent-color: var(--primary-color);"> Apr
                                </label>
                                <label
                                    style="display: flex; align-items: center; gap: 6px; cursor: pointer; padding: 8px 10px; border: 1px solid var(--border-color); border-radius: 8px; font-size: 0.85rem; background: var(--bg-color); color: var(--text-color); transition: all 0.2s;">
                                    <input type="checkbox" name="months" value="May"
                                        style="accent-color: var(--primary-color);"> May
                                </label>
                                <label
                                    style="display: flex; align-items: center; gap: 6px; cursor: pointer; padding: 8px 10px; border: 1px solid var(--border-color); border-radius: 8px; font-size: 0.85rem; background: var(--bg-color); color: var(--text-color); transition: all 0.2s;">
                                    <input type="checkbox" name="months" value="June"
                                        style="accent-color: var(--primary-color);"> Jun
                                </label>
                                <label
                                    style="display: flex; align-items: center; gap: 6px; cursor: pointer; padding: 8px 10px; border: 1px solid var(--border-color); border-radius: 8px; font-size: 0.85rem; background: var(--bg-color); color: var(--text-color); transition: all 0.2s;">
                                    <input type="checkbox" name="months" value="July"
                                        style="accent-color: var(--primary-color);"> Jul
                                </label>
                                <label
                                    style="display: flex; align-items: center; gap: 6px; cursor: pointer; padding: 8px 10px; border: 1px solid var(--border-color); border-radius: 8px; font-size: 0.85rem; background: var(--bg-color); color: var(--text-color); transition: all 0.2s;">
                                    <input type="checkbox" name="months" value="August"
                                        style="accent-color: var(--primary-color);"> Aug
                                </label>
                                <label
                                    style="display: flex; align-items: center; gap: 6px; cursor: pointer; padding: 8px 10px; border: 1px solid var(--border-color); border-radius: 8px; font-size: 0.85rem; background: var(--bg-color); color: var(--text-color); transition: all 0.2s;">
                                    <input type="checkbox" name="months" value="September"
                                        style="accent-color: var(--primary-color);"> Sep
                                </label>
                                <label
                                    style="display: flex; align-items: center; gap: 6px; cursor: pointer; padding: 8px 10px; border: 1px solid var(--border-color); border-radius: 8px; font-size: 0.85rem; background: var(--bg-color); color: var(--text-color); transition: all 0.2s;">
                                    <input type="checkbox" name="months" value="October"
                                        style="accent-color: var(--primary-color);"> Oct
                                </label>
                                <label
                                    style="display: flex; align-items: center; gap: 6px; cursor: pointer; padding: 8px 10px; border: 1px solid var(--border-color); border-radius: 8px; font-size: 0.85rem; background: var(--bg-color); color: var(--text-color); transition: all 0.2s;">
                                    <input type="checkbox" name="months" value="November"
                                        style="accent-color: var(--primary-color);"> Nov
                                </label>
                                <label
                                    style="display: flex; align-items: center; gap: 6px; cursor: pointer; padding: 8px 10px; border: 1px solid var(--border-color); border-radius: 8px; font-size: 0.85rem; background: var(--bg-color); color: var(--text-color); transition: all 0.2s;">
                                    <input type="checkbox" name="months" value="December"
                                        style="accent-color: var(--primary-color);"> Dec
                                </label>
                            </div>
                        </div>

                        <!-- Days of Week -->
                        <div style="margin-bottom: 16px;">
                            <label
                                style="display: block; font-weight: 500; margin-bottom: 10px; font-size: 0.875rem; color: var(--text-color);">Day(s)
                                of Week</label>
                            <div style="display: flex; gap: 8px; flex-wrap: wrap;">
                                <label
                                    style="display: flex; align-items: center; justify-content: center; cursor: pointer; padding: 10px 14px; border: 2px solid var(--border-color); border-radius: 10px; font-size: 0.85rem; font-weight: 500; background: var(--bg-color); color: var(--text-color); transition: all 0.2s; min-width: 50px;">
                                    <input type="checkbox" name="days" value="Monday" style="display: none;"> Mon
                                </label>
                                <label
                                    style="display: flex; align-items: center; justify-content: center; cursor: pointer; padding: 10px 14px; border: 2px solid var(--border-color); border-radius: 10px; font-size: 0.85rem; font-weight: 500; background: var(--bg-color); color: var(--text-color); transition: all 0.2s; min-width: 50px;">
                                    <input type="checkbox" name="days" value="Tuesday" style="display: none;"> Tue
                                </label>
                                <label
                                    style="display: flex; align-items: center; justify-content: center; cursor: pointer; padding: 10px 14px; border: 2px solid var(--border-color); border-radius: 10px; font-size: 0.85rem; font-weight: 500; background: var(--bg-color); color: var(--text-color); transition: all 0.2s; min-width: 50px;">
                                    <input type="checkbox" name="days" value="Wednesday" style="display: none;"> Wed
                                </label>
                                <label
                                    style="display: flex; align-items: center; justify-content: center; cursor: pointer; padding: 10px 14px; border: 2px solid var(--border-color); border-radius: 10px; font-size: 0.85rem; font-weight: 500; background: var(--bg-color); color: var(--text-color); transition: all 0.2s; min-width: 50px;">
                                    <input type="checkbox" name="days" value="Thursday" style="display: none;"> Thu
                                </label>
                                <label
                                    style="display: flex; align-items: center; justify-content: center; cursor: pointer; padding: 10px 14px; border: 2px solid var(--border-color); border-radius: 10px; font-size: 0.85rem; font-weight: 500; background: var(--bg-color); color: var(--text-color); transition: all 0.2s; min-width: 50px;">
                                    <input type="checkbox" name="days" value="Friday" style="display: none;"> Fri
                                </label>
                                <label
                                    style="display: flex; align-items: center; justify-content: center; cursor: pointer; padding: 10px 14px; border: 2px solid var(--border-color); border-radius: 10px; font-size: 0.85rem; font-weight: 500; background: var(--bg-color); color: var(--text-color); transition: all 0.2s; min-width: 50px;">
                                    <input type="checkbox" name="days" value="Saturday" style="display: none;"> Sat
                                </label>
                                <label
                                    style="display: flex; align-items: center; justify-content: center; cursor: pointer; padding: 10px 14px; border: 2px solid var(--border-color); border-radius: 10px; font-size: 0.85rem; font-weight: 500; background: var(--bg-color); color: var(--text-color); transition: all 0.2s; min-width: 50px;">
                                    <input type="checkbox" name="days" value="Sunday" style="display: none;"> Sun
                                </label>
                            </div>
                        </div>
                    </div>

                    <!-- Specific Dates Option -->
                    <div id="specificDatesField"
                        style="display: none; margin-bottom: 16px; animation: fadeIn 0.3s ease;">
                        <label
                            style="display: block; font-weight: 500; margin-bottom: 12px; font-size: 0.875rem; color: var(--text-color);">
                            <i class="fas fa-calendar-week" style="color: var(--primary-color); margin-right: 6px;"></i>
                            Select Date(s)
                        </label>

                        <!-- Date Range Picker -->
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-bottom: 12px;">
                            <div>
                                <label
                                    style="font-size: 0.8rem; color: var(--text-secondary); display: block; margin-bottom: 4px;">
                                    From Date <span style="color: #ef4444;">*</span>
                                </label>
                                <input type="date" id="specificDateFrom" onchange="handleSpecificDateFromChange()"
                                    style="width: 100%; padding: 12px 16px; border: 2px solid var(--border-color); border-radius: 10px; font-size: 0.9rem; background: var(--bg-color); color: var(--text-color);">
                            </div>
                            <div>
                                <label
                                    style="font-size: 0.8rem; color: var(--text-secondary); display: block; margin-bottom: 4px;">
                                    To Date <span style="font-size: 0.7rem; font-style: italic;">(Optional)</span>
                                </label>
                                <input type="date" id="specificDateTo" onchange="handleSpecificDateToChange()"
                                    style="width: 100%; padding: 12px 16px; border: 2px solid var(--border-color); border-radius: 10px; font-size: 0.9rem; background: var(--bg-color); color: var(--text-color);">
                            </div>
                        </div>

                        <!-- Info Note -->
                        <p
                            style="font-size: 0.8rem; color: var(--text-secondary); margin-bottom: 12px; padding: 10px 14px; background: rgba(var(--primary-rgb), 0.08); border-left: 3px solid var(--primary-color); border-radius: 6px;">
                            <i class="fas fa-lightbulb" style="color: var(--primary-color);"></i>
                            <strong>Tip:</strong> Select <strong>From Date</strong> to add a single date, then
                            optionally select <strong>To Date</strong> to add a date range.
                        </p>

                        <!-- Add Another Date Button -->
                        <button type="button" onclick="addAnotherSpecificDate()"
                            style="padding: 10px 20px; background: var(--primary-color); color: white; border: none; border-radius: 8px; font-size: 0.85rem; font-weight: 500; cursor: pointer; margin-bottom: 12px; display: inline-flex; align-items: center; gap: 6px;">
                            <i class="fas fa-plus"></i> Add Another Date/Range
                        </button>

                        <!-- Selected Dates List -->
                        <div id="selectedDatesList" style="margin-top: 12px;">
                            <!-- Selected dates will appear here -->
                        </div>

                        <!-- Hidden input for form submission -->
                        <input type="hidden" id="specificDates" value="">
                    </div>

                    <!-- Time Range -->
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px; margin-top: 16px;">
                        <div>
                            <label
                                style="display: block; font-weight: 500; margin-bottom: 8px; font-size: 0.875rem; color: var(--text-color);">Preferred
                                Start Time</label>
                            <input type="time" id="startTime" value="09:00"
                                style="width: 100%; padding: 12px 16px; border: 2px solid var(--border-color); border-radius: 10px; font-size: 0.9rem; background: var(--bg-color); color: var(--text-color);">
                        </div>
                        <div>
                            <label
                                style="display: block; font-weight: 500; margin-bottom: 8px; font-size: 0.875rem; color: var(--text-color);">Preferred
                                End Time</label>
                            <input type="time" id="endTime" value="17:00"
                                style="width: 100%; padding: 12px 16px; border: 2px solid var(--border-color); border-radius: 10px; font-size: 0.9rem; background: var(--bg-color); color: var(--text-color);">
                        </div>
                    </div>
                </div>

                <!-- Counter Offer Price Section -->
                <div class="modal-section"
                    style="background: var(--card-bg); border: 2px solid var(--border-color); padding: 20px; border-radius: 16px; margin-bottom: 20px;">
                    <h3
                        style="font-size: 1rem; font-weight: 600; margin: 0 0 16px 0; color: var(--text-color); display: flex; align-items: center; gap: 8px;">
                        <i class="fas fa-hand-holding-usd" style="color: var(--primary-color);"></i> Your Offer
                        (Optional)
                    </h3>

                    <p style="font-size: 0.85rem; color: var(--text-secondary); margin: 0 0 16px 0; line-height: 1.5;">
                        Want to propose a different price? Enter your counter-offer below. The tutor will review and
                        respond to your request.
                    </p>

                    <div style="display: flex; align-items: center; gap: 12px;">
                        <div style="flex: 1; position: relative;">
                            <span
                                style="position: absolute; left: 16px; top: 50%; transform: translateY(-50%); font-weight: 600; color: var(--text-secondary); font-size: 0.9rem;">ETB</span>
                            <input type="number" id="counterOfferPrice" min="0" step="10" placeholder="Enter your offer"
                                style="width: 100%; padding: 14px 16px 14px 55px; border: 2px solid var(--border-color); border-radius: 10px; font-size: 1rem; font-weight: 600; background: var(--bg-color); color: var(--text-color); transition: border-color 0.2s;"
                                onfocus="this.style.borderColor='var(--primary-color)'"
                                onblur="this.style.borderColor='var(--border-color)'">
                        </div>
                        <span style="font-size: 0.85rem; color: var(--text-secondary); white-space: nowrap;">per
                            session</span>
                    </div>

                    <!-- Reference Price Display -->
                    <div id="counterOfferReference"
                        style="margin-top: 12px; padding: 12px 16px; background: rgba(var(--primary-rgb), 0.08); border-radius: 10px; display: flex; align-items: center; justify-content: space-between;">
                        <span style="font-size: 0.85rem; color: var(--text-secondary);">
                            <i class="fas fa-info-circle" style="color: var(--primary-color); margin-right: 6px;"></i>
                            Tutor's listed price:
                        </span>
                        <span id="listedPriceDisplay"
                            style="font-weight: 700; color: var(--primary-color); font-size: 1rem;">ETB 0</span>
                    </div>
                </div>

            </div>

            <!-- Action Buttons - Fixed at bottom -->
            <div
                style="padding: 20px 28px; background: var(--card-bg); border-top: 2px solid var(--border-color); display: flex; gap: 12px;">
                <button onclick="submitPackageRequest()" id="submitPackageBtn"
                    style="flex: 1; padding: 16px; background: var(--primary-color); color: white; border: none; border-radius: 12px; font-weight: 600; font-size: 1rem; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 10px; transition: transform 0.2s, box-shadow 0.2s; box-shadow: 0 4px 14px rgba(var(--primary-rgb), 0.4);">
                    <i class="fas fa-paper-plane"></i> Send Request
                </button>
                <button type="button" onclick="closePackageDetailsModal()"
                    style="padding: 16px 28px; background: var(--bg-color); color: var(--text-color); border: 2px solid var(--border-color); border-radius: 12px; font-weight: 600; cursor: pointer; transition: all 0.2s;">
                    Cancel
                </button>
            </div>
        </div>
    </div>

    <style>
        /* Modal Animation */
        @keyframes modalSlideIn {
            from {
                opacity: 0;
                transform: translateY(-20px) scale(0.95);
            }

            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }

            to {
                opacity: 1;
            }
        }

        /* Modal hover effects */
        #packageDetailsModal .modal-close:hover {
            background: rgba(255, 255, 255, 0.3) !important;
        }

        #packageDetailsModal input:focus,
        #packageDetailsModal select:focus,
        #packageDetailsModal textarea:focus {
            border-color: var(--primary-color) !important;
            outline: none;
            box-shadow: 0 0 0 3px rgba(var(--primary-rgb), 0.15);
        }

        #packageDetailsModal button:hover:not(:disabled) {
            transform: translateY(-2px);
        }

        #packageDetailsModal #submitPackageBtn:hover {
            box-shadow: 0 6px 20px rgba(var(--primary-rgb), 0.5) !important;
        }

        /* Day checkbox toggle styling */
        #packageDetailsModal input[name="days"]:checked+span,
        #packageDetailsModal label:has(input[name="days"]:checked) {
            background: var(--primary-color) !important;
            border-color: var(--primary-color) !important;
            color: white !important;
        }
    </style>

    <!-- Database Loader - Loads all tutor data from API -->
    <script src="../js/view-tutor/view-tutor-db-loader.js?v=5"></script>

    <!-- Connection Manager - Handles connection requests -->
    <script src="../js/view-tutor/connection-manager.js?v=20251218"></script>

    <!-- Session Request Handler -->
    <script src="../js/view-tutor/session-request-handler.js?v=3"></script>

    <!-- View Tutor Credentials Manager - Handles credentials display (read-only) -->
    <script src="../js/view-tutor/view-tutor-credentials.js"></script>

    <!-- View Tutor Blogs Manager - Loads and displays blog posts -->
    <script src="../js/view-tutor/view-tutor-blogs.js"></script>

    <!-- Initialize ViewTutorDBLoader -->
    <script>
        // Initialize and load tutor data
        document.addEventListener('DOMContentLoaded', async () => {
            // Get tutor ID from URL parameter
            const urlParams = new URLSearchParams(window.location.search);
            const tutorId = urlParams.get('id') || 1;

            console.log(`üîÑ Initializing ViewTutorDBLoader for tutor ID: ${tutorId}`);

            // Initialize the database loader with tutor ID
            const loader = new ViewTutorDBLoader(tutorId);
            await loader.init();

            // Initialize tutor blogs
            if (typeof window.loadTutorBlogs === 'function') {
                await window.loadTutorBlogs(tutorId);
                console.log('‚úÖ Initialized tutor blogs for profile_id:', tutorId);
            }

            // Initialize tutor credentials (read-only view)
            if (typeof window.initializeViewTutorCredentials === 'function') {
                await window.initializeViewTutorCredentials(tutorId);
                console.log('‚úÖ Initialized tutor credentials for profile_id:', tutorId);
            }

            console.log('‚úÖ ViewTutorDBLoader initialization complete');
        });
    </script>

    <!-- Initialize Connection Manager -->
    <script>
        // Initialize connection manager and check connection status
        document.addEventListener('DOMContentLoaded', async () => {
            // Create global connection manager instance
            window.connectionManagerInstance = new ConnectionManager();

            // Get tutor ID from URL parameter
            const urlParams = new URLSearchParams(window.location.search);
            const tutorId = urlParams.get('id') || 1;

            // Wait for tutor data to load, then get the user_id
            // The ViewTutorDBLoader sets window.currentTutorData
            const checkTutorDataLoaded = setInterval(async () => {
                if (window.currentTutorData && window.currentTutorData.user_id) {
                    clearInterval(checkTutorDataLoaded);

                    // Store tutor user ID globally
                    window.currentTutorUserId = window.currentTutorData.user_id;

                    console.log(`‚úÖ Connection Manager: Checking connection status for tutor user ID: ${window.currentTutorUserId}`);

                    // Check connection status
                    const connectionStatus = await window.connectionManagerInstance.checkConnectionStatus(window.currentTutorUserId);

                    console.log('Connection status:', connectionStatus);

                    // Update connect button UI
                    const connectButton = document.querySelector('button[onclick="connectTutor()"]');
                    if (connectButton) {
                        window.connectionManagerInstance.updateConnectionButtonUI(connectButton, connectionStatus);
                    }
                }
            }, 100); // Check every 100ms until tutor data is loaded

            // Timeout after 10 seconds
            setTimeout(() => {
                clearInterval(checkTutorDataLoaded);
            }, 10000);
        });
    </script>

    <!-- Widget Animations Script -->
    <script>
        // ============================================
        //   BOOKSTORE WIDGET - FADE IN/OUT ANIMATION
        // ============================================
        (function () {
            const bookstoreTitles = [
                { icon: 'üìñ', text: 'Educational Books', emoji: 'üìö' },
                { icon: 'üìö', text: 'Fiction & Novels', emoji: 'üìñ' },
                { icon: 'üî¨', text: 'Science Textbooks', emoji: 'üß™' },
                { icon: 'üìê', text: 'Mathematics Books', emoji: '‚ûó' },
                { icon: 'üî•', text: 'Trending Books', emoji: 'üî•' },
                { icon: 'üí∞', text: 'Special Discounts', emoji: 'üè∑Ô∏è' },
                { icon: 'üéÅ', text: 'Bundle Deals', emoji: 'üì¶' },
                { icon: '‚ú®', text: 'Coming Soon!', emoji: 'üéâ' }
            ];

            let currentBookIndex = 0;
            const bookstoreTitleContainer = document.querySelector('.bookstore-title-animated');
            const bookstoreIcon = document.querySelector('.bookstore-icon');

            if (bookstoreTitleContainer && bookstoreIcon) {
                const titleElement = bookstoreTitleContainer.querySelector('.bookstore-title');

                function animateBookstoreTitle() {
                    // Fade out
                    titleElement.style.opacity = '0';
                    titleElement.style.transform = 'translateY(-10px)';

                    setTimeout(() => {
                        // Update content
                        currentBookIndex = (currentBookIndex + 1) % bookstoreTitles.length;
                        const currentTitle = bookstoreTitles[currentBookIndex];
                        titleElement.textContent = currentTitle.text;
                        bookstoreIcon.textContent = currentTitle.icon;

                        // Fade in
                        titleElement.style.transform = 'translateY(10px)';
                        setTimeout(() => {
                            titleElement.style.opacity = '1';
                            titleElement.style.transform = 'translateY(0)';
                        }, 50);
                    }, 600);
                }

                // Start animation every 3 seconds
                setInterval(animateBookstoreTitle, 3000);
            }
        })();

        // ============================================
        //   GAMESTORE WIDGET - FADE IN/OUT ANIMATION
        // ============================================
        (function () {
            const gamestoreTitles = [
                { icon: 'üéÆ', text: 'Educational Games', emoji: 'üéÆ' },
                { icon: 'üßÆ', text: 'Puzzle Games', emoji: 'üß©' },
                { icon: 'üéØ', text: 'Strategy Games', emoji: '‚ôüÔ∏è' },
                { icon: 'üèÜ', text: 'Top Rated Games', emoji: '‚≠ê' },
                { icon: 'üî•', text: 'Trending Games', emoji: 'üî•' },
                { icon: 'üí∞', text: 'Special Discounts', emoji: 'üè∑Ô∏è' },
                { icon: 'üéÅ', text: 'Bundle Deals', emoji: 'üì¶' },
                { icon: '‚ú®', text: 'Coming Soon!', emoji: 'üéâ' }
            ];

            let currentGameIndex = 0;
            const gamestoreTitleContainer = document.querySelector('.gamestore-title-animated');
            const gamestoreIcon = document.querySelector('.gamestore-icon');

            if (gamestoreTitleContainer && gamestoreIcon) {
                const titleElement = gamestoreTitleContainer.querySelector('.gamestore-title');

                function animateGamestoreTitle() {
                    // Fade out
                    titleElement.style.opacity = '0';
                    titleElement.style.transform = 'translateY(-10px)';

                    setTimeout(() => {
                        // Update content
                        currentGameIndex = (currentGameIndex + 1) % gamestoreTitles.length;
                        const currentTitle = gamestoreTitles[currentGameIndex];
                        titleElement.textContent = currentTitle.text;
                        gamestoreIcon.textContent = currentTitle.icon;

                        // Fade in
                        titleElement.style.transform = 'translateY(10px)';
                        setTimeout(() => {
                            titleElement.style.opacity = '1';
                            titleElement.style.transform = 'translateY(0)';
                        }, 50);
                    }, 600);
                }

                // Start animation every 3 seconds
                setInterval(animateGamestoreTitle, 3000);
            }
        })();
    </script>

    <!-- Chat Modal Container -->
    <div id="chat-modal-container"></div>

    <!-- Chat Modal Script -->
    <script src="../js/common-modals/chat-modal.js"></script>
    <!-- Standalone Chat Call Modal JavaScript -->
    <script src="../js/common-modals/chat-call-modal.js"></script>
    <script src="../js/common-modals/view-request-modal.js"></script>

    <!-- Load Chat Modal HTML and Initialize -->
    <script>
        // Load chat modal HTML dynamically
        (function loadChatModal() {
            fetch('../modals/common-modals/chat-modal.html')
                .then(response => response.text())
                .then(html => {
                    document.getElementById('chat-modal-container').innerHTML = html;
                    // Re-initialize chat modal after HTML is loaded
                    if (typeof ChatModalManager !== 'undefined') {
                        ChatModalManager.init();
                    }
                })
                .catch(err => console.log('Chat modal will load on demand:', err.message));
        })();

        // Load standalone chat call modal HTML dynamically
        (function loadChatCallModal() {
            fetch('../modals/common-modals/chat-call-modal.html')
                .then(response => response.text())
                .then(html => {
                    document.body.insertAdjacentHTML('beforeend', html);
                    console.log('‚úÖ Standalone Chat Call Modal loaded for view-tutor');
                })
                .catch(err => console.error('Failed to load chat-call-modal:', err));
        })();

        // Message tutor function - opens chat modal with the viewed tutor
        function messageTutor() {
            // Check if user is authenticated
            const token = localStorage.getItem('access_token') || localStorage.getItem('token');
            if (!token) {
                if (window.openAuthModal) {
                    window.openAuthModal('login');
                } else {
                    alert('Please log in to message this tutor');
                }
                return;
            }

            // Get tutor data from the global variable set by view-tutor-db-loader.js
            const tutorData = window.currentTutorData;
            if (!tutorData) {
                console.error('Tutor data not loaded yet');
                alert('Please wait for the profile to load');
                return;
            }

            console.log('Opening chat with tutor:', tutorData);

            // Build target user object for chat modal
            const targetUser = {
                id: tutorData.user_id,
                user_id: tutorData.user_id,
                profile_id: tutorData.id,
                full_name: tutorData.full_name || `${tutorData.first_name || ''} ${tutorData.father_name || ''}`.trim(),
                name: tutorData.full_name || `${tutorData.first_name || ''} ${tutorData.father_name || ''}`.trim(),
                profile_picture: tutorData.profile_picture,
                avatar: tutorData.profile_picture,
                role: 'tutor',
                profile_type: 'tutor',
                is_online: tutorData.is_online || false
            };

            console.log('Target user for chat:', targetUser);

            // Open chat modal with the tutor
            if (typeof ChatModalManager !== 'undefined' && typeof ChatModalManager.open === 'function') {
                ChatModalManager.open(targetUser);
                console.log('Chat modal opened for tutor:', targetUser.full_name);
            } else {
                console.error('ChatModalManager not available');
                alert('Chat feature is not available. Please refresh the page.');
            }
        }
    </script>

    <!-- Ad Rotation Manager -->
    <script src="../js/common-modals/ad-rotation-manager.js"></script>
    <!-- Appearance Manager - Theme & Color Palette Sync -->
    <script src="../js/common-modals/appearance-manager.js?v=20260127"></script>

    <!-- Currency Utilities for dynamic currency display -->
    <script src="../js/utils/currency-utils.js"></script>

    <!-- Settings Panel Modal Scripts -->
    <script src="../js/tutor-profile/settings-panel-personal-verification.js"></script>
    <script src="../js/tutor-profile/payment-method-modal.js"></script>
    <!-- Subscription Modal JavaScript (Dynamic - fetches plans based on role) -->
    <script src="../js/common-modals/subscription-modal.js"></script>
    <!-- Extended Settings Manager (2FA, Login Activity, Connected Accounts, etc.) -->
    <script src="../js/common-modals/settings-manager.js?v=20251225"></script>
    <!-- Two-Factor Authentication Manager -->
    <script src="../js/common-modals/tfa-manager.js?v=20251227"></script>
    <!-- Role Manager -->
    <script src="../js/common-modals/role-manager.js?v=20260126"></script>
    <script src="../js/common-modals/review-astegni-manager.js"></script>

    <!-- Load Settings Modals HTML -->
    <script>
        // Load verify-personal-info-modal
        fetch('../modals/common-modals/verify-personal-info-modal.html')
            .then(response => response.text())
            .then(html => {
                let container = document.getElementById('modal-container');
                if (!container) {
                    container = document.createElement('div');
                    container.id = 'modal-container';
                    document.body.appendChild(container);
                }
                container.insertAdjacentHTML('beforeend', html);
                console.log('[OK] Verify Personal Info Modal loaded');
            })
            .catch(error => console.error('Failed to load verify-personal-info-modal:', error));

        // Load payment-method-modal
        fetch('../modals/common-modals/payment-method-modal.html')
            .then(response => response.text())
            .then(html => {
                let container = document.getElementById('modal-container');
                if (!container) {
                    container = document.createElement('div');
                    container.id = 'modal-container';
                    document.body.appendChild(container);
                }
                container.insertAdjacentHTML('beforeend', html);
                console.log('[OK] Payment Method Modal loaded');
            })
            .catch(error => console.error('Failed to load payment-method-modal:', error));

        // Load leave-astegni-modal
        fetch('../modals/common-modals/leave-astegni-modal.html')
            .then(response => response.text())
            .then(html => {
                let container = document.getElementById('modal-container');
                if (!container) {
                    container = document.createElement('div');
                    container.id = 'modal-container';
                    document.body.appendChild(container);
                }
                container.insertAdjacentHTML('beforeend', html);
                console.log('[OK] Leave Astegni Modal loaded');
            })
            .catch(error => console.error('Failed to load leave-astegni-modal:', error));

        // Load manage-role-modal
        fetch('../modals/common-modals/manage-role-modal.html')
            .then(response => response.text())
            .then(html => {
                let container = document.getElementById('modal-container');
                if (!container) {
                    container = document.createElement('div');
                    container.id = 'modal-container';
                    document.body.appendChild(container);
                }
                container.insertAdjacentHTML('beforeend', html);
                console.log('[OK] Manage Role Modal loaded');
            })
            .catch(error => console.error('Failed to load manage-role-modal:', error));

        // Load subscription-modal
        fetch('../modals/common-modals/subscription-modal.html')
            .then(response => response.text())
            .then(html => {
                let container = document.getElementById('modal-container');
                if (!container) {
                    container = document.createElement('div');
                    container.id = 'modal-container';
                    document.body.appendChild(container);
                }
                container.insertAdjacentHTML('beforeend', html);
                console.log('[OK] Subscription Modal loaded');
            })
            .catch(error => console.error('Failed to load subscription-modal:', error));

        // Load appearance-modal
        fetch('../modals/common-modals/appearance-modal.html')
            .then(response => response.text())
            .then(html => {
                let container = document.getElementById('modal-container');
                if (!container) {
                    container = document.createElement('div');
                    container.id = 'modal-container';
                    document.body.appendChild(container);
                }
                container.insertAdjacentHTML('beforeend', html);
                console.log('[OK] Appearance Modal loaded');
            })
            .catch(error => console.error('Failed to load appearance-modal:', error));

        // Load connected-accounts-modal
        fetch('../modals/common-modals/connected-accounts-modal.html')
            .then(response => response.text())
            .then(html => {
                let container = document.getElementById('modal-container');
                if (!container) {
                    container = document.createElement('div');
                    container.id = 'modal-container';
                    document.body.appendChild(container);
                }
                container.insertAdjacentHTML('beforeend', html);
                console.log('[OK] Connected Accounts Modal loaded');
            })
            .catch(error => console.error('Failed to load connected-accounts-modal:', error));

        // Load review-astegni-modal
        fetch('../modals/common-modals/review-astegni-modal.html')
            .then(response => response.text())
            .then(html => {
                let container = document.getElementById('modal-container');
                if (!container) {
                    container = document.createElement('div');
                    container.id = 'modal-container';
                    document.body.appendChild(container);
                }
                container.insertAdjacentHTML('beforeend', html);
                console.log('[OK] Review Astegni Modal loaded');
            })
            .catch(error => console.error('Failed to load review-astegni-modal:', error));
    </script>

    <!-- Share Profile Manager - MOVED EARLIER (after nav.js) to ensure onclick handlers work -->
</body>

</html>
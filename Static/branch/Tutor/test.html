<!DOCTYPE html>
<html lang="en" data-theme="light">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ASTEGNI - Tutor Profile</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- Preload cover photo for faster loading -->
  <link rel="preload" href="../pictures/cover_photo.png" as="image">
  <!-- Font Awesome 4.x for icons -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  <link href="css/root_theme.css" rel="stylesheet" />
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    /* Root variables for consistent theming */
    :root {
      --color: #FFE082;
      --text: #78350F;
      --heading: #92400E;
      --nav-link: #78350F;
      --nav-link-hover: #D97706;
      --button-bg: #F59E0B;
      --button-text: #FFFFFF;
      --button-hover: #D97706;
      --button-active: #92400E;
      --highlight: #FFFFFF;
      --footer-bg: #E5E7EB;
      --footer-text: #78350F;
      --search-heading: #F59E0B;
      --modal-bg: #FFFFFF;
      --modal-text: #78350F;
      --bg-light: #FAFAFA;
      --bg-dark: #1E1E1E;
      --border: #E5E7EB;
    }

    /* Dark theme variables */
    [data-theme="dark"] {
      --background: #1E1E1E;
      --text: #E0E0E0;
      --heading: #FBC02D;
      --nav-link: #E0E0E0;
      --nav-link-hover: #FFD54F;
      --button-bg: #FFD54F;
      --button-text: #1E1E1E;
      --button-hover: #E6BF45;
      --button-active: #FFB300;
      --highlight: #424242;
      --footer-bg: #424242;
      --footer-text: #E0E0E0;
      --search-heading: #FBC02D;
      --modal-bg: #2D3748;
      --modal-text: #E0E0E0;
      --bg-light: #2D3748;
      --bg-dark: #1E1E1E;
      --border: #4B5563;
    }

    /* Base body styles */
    body {
      background-color: var(--background);
      color: var(--text);
      font-family: sans-serif;
    }

    body.modal-open {
      overflow: hidden;
      /* Prevent scrolling when modal is open */
    }

    /* General modal styles */
    .modal {
      display: block;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.7);
      /* Semi-transparent overlay */
      justify-content: center;
      align-items: center;
      z-index: 1000;
      overflow: auto;
    }

    /* Hide modal when hidden class is applied */
    .modal.hidden {
      display: none;
    }

    /* Modal content base styles */
    .modal-content {
      background-color: var(--modal-bg);
      color: var(--modal-text);
      padding: 24px;
      border-radius: 8px;
      width: 90%;
      max-width: 600px;
      max-height: 80vh;
      overflow-y: auto;
      position: relative;
      border: 1px solid var(--border);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
    }

    /* Modal close button */
    .modal-close {
      position: absolute;
      top: 16px;
      right: 16px;
      cursor: pointer;
      font-size: 1.5rem;
      font-weight: 700;
      color: var(--text);
      background: none;
      border: none;
      transition: color 0.2s ease;
    }

    .modal-close:hover {
      color: var(--button-hover);
    }

    /* Modal inputs, selects, and textareas */
    .modal-content input,
    .modal-content select,
    .modal-content textarea {
      background-color: var(--bg-light);
      color: var(--modal-text);
      border: 1px solid var(--border);
      border-radius: 4px;
      padding: 8px;
      width: 100%;
      box-sizing: border-box;
    }

    .modal-content input::placeholder,
    .modal-content textarea::placeholder {
      color: var(--modal-text);
      opacity: 0.6;
    }

    /* Modal labels */
    .modal-content label {
      word-break: break-word;
      color: var(--modal-text);
    }

    /* Focus states for accessibility */
    .modal:focus {
      outline: none;
    }

    .modal-content input:focus,
    .modal-content select:focus,
    .modal-content textarea:focus {
      outline: 2px solid var(--button-bg);
      outline-offset: 2px;
    }

    .tooltip {
      position: absolute;
      background-color: var(--modal-bg);
      color: var(--modal-text);
      padding: 4px 8px;
      border-radius: 4px;
      font-size: 12px;
      z-index: 10;
      display: none;
    }

    .icon-wrapper:hover .tooltip {
      display: block;
    }

    /* Notes modal specific styles */
    .notes-modal-container {
      display: flex;
      gap: 16px;
      max-width: 90vw;
      max-height: 80vh;
      overflow: hidden;
      position: relative;
      background-color: var(--modal-bg);
      border-radius: 8px;
      padding: 24px;
    }

    .notes-modal-container>.flex-1 {
      flex: 1;
      overflow-y: auto;
      padding-right: 16px;
    }

    .notes-history {
      width: 33%;
      max-height: 70vh;
      overflow-y: auto;
      background-color: var(--bg-light);
      border-left: 1px solid var(--border);
      padding: 16px;
      transition: transform 0.3s ease;
    }

    .notes-history.hidden {
      transform: translateX(100%);
    }

    .history-toggle-btn {
      position: absolute;
      top: 16px;
      right: 16px;
      z-index: 10;
      background-color: var(--button-bg);
      color: var(--button-text);
      padding: 8px;
      border-radius: 4px;
      border: none;
      cursor: pointer;
    }

    .history-toggle-btn:hover {
      background-color: var(--button-hover);
    }

    /* Editor toolbar for notes modal */
    .editor-toolbar {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(40px, 1fr));
      gap: 8px;
      margin-bottom: 16px;
      padding: 8px;
      background-color: var(--bg-light);
      border: 1px solid var(--border);
      border-radius: 8px;
    }

    .editor-toolbar button,
    .editor-toolbar select,
    .editor-toolbar input {
      padding: 8px;
      border: none;
      background-color: var(--button-bg);
      color: var(--button-text);
      border-radius: 4px;
      cursor: pointer;
      transition: background-color 0.2s;
    }

    .editor-toolbar button:hover,
    .editor-toolbar select:hover,
    .editor-toolbar input:hover {
      background-color: var(--button-hover);
    }

    #note-content {
      min-height: 200px;
      background-size: cover;
      background-position: center;
      border: 1px solid var(--border);
      border-radius: 8px;
      padding: 16px;
      color: var(--modal-text);
    }

    /* Video player modal specific styles */
    .video-player-modal {
      max-width: 900px;
      width: 90%;
      max-height: 80vh;
      overflow-y: auto;
    }

    .video-player-modal .video-container {
      position: relative;
      padding-bottom: 62.5%;
      /* Adjusted aspect ratio */
      height: 0;
      overflow: hidden;
      background: #000;
      margin-bottom: 16px;
      border-radius: 8px;
    }

    .video-player-modal video {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
    }

    .video-player-modal .controls {
      position: absolute;
      top: 8px;
      right: 8px;
      display: flex;
      flex-direction: column;
      gap: 8px;
      padding: 8px;
      background: rgba(0, 0, 0, 0.5);
      border-radius: 0 0 0 8px;
    }

    .video-player-modal .controls button {
      background: none;
      border: none;
      color: #FFFFFF;
      font-size: 1.5rem;
      cursor: pointer;
      transition: color 0.2s;
    }

    .video-player-modal .controls button:hover {
      color: var(--button-hover);
    }

    .video-player-modal .more-menu-content {
      background-color: var(--modal-bg);
      border: 1px solid var(--border);
      border-radius: 4px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
      min-width: 150px;
      padding: 8px 0;
      z-index: 50;
    }

    .video-player-modal .more-menu-content button {
      display: block;
      width: 100%;
      padding: 8px 12px;
      text-align: left;
      font-size: 1rem;
      color: var(--modal-text);
      background: none;
      border: none;
      cursor: pointer;
    }

    .video-player-modal .more-menu-content button:hover {
      background-color: var(--button-hover);
    }

    /* Responsive adjustments */
    @media (max-width: 640px) {
      .modal-content {
        width: 95%;
        padding: 16px;
      }

      .notes-modal-container {
        flex-direction: column;
        gap: 8px;
      }

      .notes-history {
        width: 100%;
        max-height: 40vh;
      }

      .video-player-modal {
        max-width: 95%;
      }
    }

    /* Additional modal-specific styles */
    .tab-content.hidden {
      display: none;
    }

    .tab-content {
      display: block;
    }

    .school-suggestions {
      position: absolute;
      background-color: var(--modal-bg);
      border: 1px solid var(--border);
      width: 100%;
      max-height: 150px;
      overflow-y: auto;
      z-index: 10;
    }

    .school-suggestions div {
      padding: 8px;
      cursor: pointer;
    }

    .school-suggestions div:hover {
      background-color: var(--button-hover);
    }

    /* CTA buttons within modals */
    .modal-content .cta-button {
      background-color: var(--button-bg);
      color: var(--button-text);
      padding: 8px 16px;
      border-radius: 4px;
      border: none;
      cursor: pointer;
      transition: background-color 0.2s;
    }

    .modal-content .cta-button:hover {
      background-color: var(--button-hover);
    }

    /* Ensure consistent button styling */
    button:not(.modal-close):not(.history-toggle-btn):not(.editor-toolbar button) {
      background-color: var(--button-bg);
      color: var(--button-text);
      padding: 8px 16px;
      border-radius: 4px;
      border: none;
      cursor: pointer;
      transition: background-color 0.2s;
    }

    button:not(.modal-close):not(.history-toggle-btn):not(.editor-toolbar button):hover {
      background-color: var(--button-hover);
    }
  </style>
</head>

<body>

  <!-- Navigation -->
  <nav class="p-4 sticky top-0 z-10 shadow-sm bg-[var(--modal-bg)]">
    <div class="container mx-auto flex justify-between items-center">
      <a href="index.html" class="text-2xl font-bold nav-company-name text-[var(--heading)]">ASTEGNI</a>
      <div class="hidden md:flex space-x-6 items-center" id="desktop-nav">
        <a href="index.html" class="text-[var(--nav-link)] hover:text-[var(--nav-link-hover)]">Home</a>
        <a href="find-tutors.html" class="text-[var(--nav-link)] hover:text-[var(--nav-link-hover)]">Find Tutors</a>
        <a href="reels.html" class="text-[var(--nav-link)] hover:text-[var(--nav-link-hover)]">Reels</a>
        <a href="#" onclick="openNotesModal()"
          class="text-[var(--nav-link)] hover:text-[var(--nav-link-hover)]">Notes</a>
        <a href="#" onclick="openToolsModal()"
          class="text-[var(--nav-link)] hover:text-[var(--nav-link-hover)]">Tools</a>
        <div class="relative">
          <button id="profile-dropdown-btn" class="text-[var(--nav-link)] hover:text-[var(--nav-link-hover)]">My
            Profile</button>
          <div id="profile-dropdown"
            class="hidden absolute right-0 mt-2 w-48 bg-[var(--modal-bg)] rounded-lg shadow-lg border border-[var(--border)]">
            <button onclick="openQuizModal()"
              class="block w-full text-left px-4 py-2 text-[var(--text)] hover:bg-[var(--button-hover)]">Take a
              Quiz</button>
            <button id="get-certified-btn"
              class="block w-full text-left px-4 py-2 text-[var(--text)] hover:bg-[var(--button-hover)]">Get
              Certified</button>
            <button id="manage-finance-btn"
              class="block w-full text-left px-4 py-2 text-[var(--text)] hover:bg-[var(--button-hover)]">Manage
              Finances</button>
            <button onclick="openRateAstegniModal()"
              class="block w-full text-left px-4 py-2 text-[var(--text)] hover:bg-[var(--button-hover)]">Comment and
              Rate ASTEGNI</button>
            <button onclick="openShareProfileModal()"
              class="block w-full text-left px-4 py-2 text-[var(--text)] hover:bg-[var(--button-hover)]">Share
              Profile</button>
          </div>
        </div>
        <button id="notification-bell" class="relative focus:outline-none" onclick="openNotificationModal()">
          <svg class="w-6 h-6 text-[var(--text)]" fill="none" stroke="currentColor" viewBox="0 0 24 24"
            xmlns="http://www.w3.org/2000/svg">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
              d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6 6 0 00-12 0v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 01-6 0v-1m6 0H9">
            </path>
          </svg>
          <span id="notification-dot" class="absolute top-0 right-0 w-2 h-2 bg-red-500 rounded-full hidden"></span>
        </button>
        <button id="theme-toggle" class="cta-button px-4 py-2 rounded-lg">Toggle Theme</button>
      </div>
      <button id="menu-btn" class="md:hidden focus:outline-none">
        <svg class="w-6 h-6 text-[var(--text)]" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16m-7 6h7"></path>
        </svg>
      </button>
    </div>
    <div id="mobile-menu"
      class="hidden md:hidden bg-[var(--highlight)] mt-2 rounded-lg shadow border border-[var(--border)]">
      <a href="index.html" class="block py-2 px-4 text-[var(--text)] hover:bg-[var(--button-hover)]">Home</a>
      <a href="find-tutors.html" class="block py-2 px-4 text-[var(--text)] hover:bg-[var(--button-hover)]">Find
        Tutors</a>
      <a href="reels.html" class="block py-2 px-4 text-[var(--text)] hover:bg-[var(--button-hover)]">Reels</a>
      <button onclick="openNotesModal()"
        class="block py-2 px-4 text-[var(--text)] hover:bg-[var(--button-hover)] w-full text-left">Notes</button>
      <button onclick="openToolsModal()"
        class="block py-2 px-4 text-[var(--text)] hover:bg-[var(--button-hover)] w-full text-left">Tools</button>
      <button id="mobile-profile-dropdown-btn"
        class="block py-2 px-4 text-[var(--text)] hover:bg-[var(--button-hover)] w-full text-left">My Profile</button>
      <div id="mobile-profile-dropdown"
        class="hidden bg-[var(--modal-bg)] mt-1 rounded-lg border border-[var(--border)]">
        <button onclick="openQuizModal()"
          class="block w-full text-left px-4 py-2 text-[var(--text)] hover:bg-[var(--button-hover)]">Take a
          Quiz</button>
        <button id="mobile-get-certified-btn"
          class="block w-full text-left px-4 py-2 text-[var(--text)] hover:bg-[var(--button-hover)]">Get
          Certified</button>
        <button id="mobile-manage-finance-btn"
          class="block w-full text-left px-4 py-2 text-[var(--text)] hover:bg-[var(--button-hover)]">Manage
          Finances</button>
        <button onclick="openRateAstegniModal()"
          class="block w-full text-left px-4 py-2 text-[var(--text)] hover:bg-[var(--button-hover)]">Comment and Rate
          ASTEGNI</button>
        <button onclick="openShareProfileModal()"
          class="block w-full text-left px-4 py-2 text-[var(--text)] hover:bg-[var(--button-hover)]">Share
          Profile</button>
      </div>
      <button id="mobile-notification-bell"
        class="block py-2 px-4 text-[var(--text)] hover:bg-[var(--button-hover)] w-full text-left relative"
        onclick="openNotificationModal()">
        Notifications
        <span id="mobile-notification-dot" class="absolute top-2 right-4 w-2 h-2 bg-red-500 rounded-full hidden"></span>
      </button>
      <button id="mobile-theme-toggle" class="cta-button block py-2 px-4 w-full text-left">Toggle Theme</button>
    </div>
  </nav>

  <!-- Tutor Profile Section -->
  <section class="py-16 bg-[var(--background)]">
    <div class="container mx-auto px-4 flex flex-col lg:flex-row gap-8">
      <!-- Main Content (Tutor Profile) -->
      <div class="lg:w-3/4">
        <!-- Cover and Profile Photo -->
        <div id="cover-photo" class="mb-6 relative">
          <img src="../pictures/cover_photo.png" id="cover-image" alt="Cover Photo"
            class="w-full h-[150px] object-cover rounded-lg" loading="lazy">
          <img src="../pictures/profile_picture.png" id="profile-picture" alt="Tutor Profile Picture"
            class="w-24 h-24 rounded-full border-4 border-[var(--modal-bg)] absolute -bottom-12 left-4" loading="lazy">
          <span class="icon-wrapper absolute bottom-4 right-4">
            <i class="fa fa-pencil pencil-icon text-[var(--text)] hover:text-[var(--button-hover)] cursor-pointer"
              onclick="openUploadCoverPhotoModal()"></i>
            <span class="tooltip bg-[var(--modal-bg)] text-[var(--text)]">Edit Cover Photo</span>
          </span>
          <span class="icon-wrapper absolute bottom-4 left-28">
            <i class="fa fa-pencil pencil-icon text-[var(--text)] hover:text-[var(--button-hover)] cursor-pointer"
              onclick="openUploadProfilePhotoModal()"></i>
            <span class="tooltip bg-[var(--modal-bg)] text-[var(--text)]">Edit Profile Picture</span>
          </span>
        </div>
        <div class="p-6 bg-[var(--modal-bg)] rounded-lg shadow-lg">
          <div class="flex flex-col md:flex-row gap-4 mb-4">
            <div class="profile-details w-full">
              <h2 id="tutor-name" class="text-2xl font-bold text-[var(--heading)] inline-flex items-center">
                Your name
                <span class="ml-2 w-5 h-5 bg-blue-500 text-white rounded-full flex items-center justify-center"
                  title="Verified Tutor">
                  <svg class="w-4 h-4" fill="white" viewBox="0 0 20 20">
                    <path
                      d="M16.707 5.293a1 1 0 00-1.414 0L8 12.586l-3.293-3.293a1 1 0 00-1.414 1.414l4 4a1 1 0 001.414 0l8-8a1 1 0 000-1.414z" />
                  </svg>
                </span>
              </h2>
              <div class="flex gap-4">
                <p id="verification-status" class="text-sm italic text-red-500">Unverified</p>
                <p id="activation-status" class="text-sm italic text-red-500">Deactivated</p>
              </div>
              <div class="flex flex-col items-start mb-4">
                <div class="relative w-16 h-16 progress-circle">
                  <svg class="w-full h-full" viewBox="0 0 100 100">
                    <circle cx="50" cy="50" r="45" stroke="[var(--border)]" stroke-width="8" fill="none" />
                    <circle id="rating-arc" cx="50" cy="50" r="45" stroke="#EF4444" stroke-width="8" fill="none"
                      stroke-linecap="round" stroke-dasharray="283" stroke-dashoffset="283" />
                  </svg>
                  <div class="absolute inset-0 flex items-center justify-center font-bold text-sm text-[var(--text)]"
                    id="rating-label">N/A</div>
                </div>
                <span id="tutor-rating-stars" class="text-yellow-500 mt-1">No rating</span>
              </div>
              <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-4">
                <div class="flex flex-col">
                  <p class="text-[var(--text)]"><span id="follower-number">0</span> Followers</p>
                  <p id="tutor-gender" class="text-[var(--text)]">Gender: Male</p>
                  <p id="tutor-phone" class="text-[var(--text)]">Phone: Not set</p>
                  <p id="tutor-email" class="text-[var(--text)]">Email: Not set</p>
                  <p id="tutor-address" class="text-[var(--text)]">Address: Not set</p>
                  <p id="tutor-school" class="text-[var(--text)]">Teaches at: Under verification</p>
                  <p id="tutor-quote" class="text-[var(--text)]">Quote: not set</p>
                </div>
              </div>
              <div class="w-full md:w-2/3">
                <div class="section-title-container relative">
                  <h3 class="text-2xl font-bold text-[var(--heading)]">About Me</h3>
                  <span class="icon-wrapper absolute top-0 right-0">
                    <i class="fa fa-pencil pencil-icon text-[var(--text)] hover:text-[var(--button-hover)] cursor-pointer"
                      onclick="openEditAboutMeModal()"></i>
                    <span class="tooltip bg-[var(--modal-bg)] text-[var(--text)]">Edit bio</span>
                  </span>
                </div>
                <p id="tutor-bio" class="text-[var(--text)] mt-4">Experienced tutor with a passion for teaching Math and
                  Physics.</p>
                <div class="section-title-container relative mt-6">
                  <h3 class="text-2xl font-bold text-[var(--heading)]">Certifications</h3>
                  <span class="icon-wrapper absolute top-0 right-0">
                    <i class="fa fa-pencil pencil-icon text-[var(--text)] hover:text-[var(--button-hover)] cursor-pointer"
                      onclick="openEditCertificationsModal()"></i>
                    <span class="tooltip bg-[var(--modal-bg)] text-[var(--text)]">Add certifications</span>
                  </span>
                </div>
                <div id="tutor-certifications" class="text-[var(--text)] mt-4">
                  <p>BSc in Physics from School A (2020)</p>
                </div>
                <div class="section-title-container relative mt-6">
                  <h3 class="text-2xl font-bold text-[var(--heading)]">Socials</h3>
                  <span class="icon-wrapper absolute top-0 right-0">
                    <i class="fa fa-pencil pencil-icon text-[var(--text)] hover:text-[var(--button-hover)] cursor-pointer"
                      onclick="openEditSocialsModal()"></i>
                    <span class="tooltip bg-[var(--modal-bg)] text-[var(--text)]">Add socials</span>
                  </span>
                </div>
                <div id="view-profile-socials" class="text-[var(--text)] mt-4"></div>
              </div>
            </div>
          </div>
          <div class="flex flex-wrap gap-2 mb-6">
            <button onclick="openEditProfileModal()" class="cta-button px-4 py-2 rounded-lg flex items-center">
              <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"
                xmlns="http://www.w3.org/2000/svg">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                  d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z">
                </path>
              </svg>
              Edit Profile
            </button>
            <button onclick="openRequestedSessionsModal()" class="cta-button px-4 py-2 rounded-lg">Requested
              Sessions</button>
          </div>
          <!-- Sponsorship Placeholder -->
          <div id="sponsorship-placeholder-2" class="rounded-lg shadow-lg p-4 text-center bg-[var(--highlight)]">
            <h3 class="text-xl font-semibold mb-2 text-[var(--heading)]">Sponsor Our Platform</h3>
            <img src="https://via.placeholder.com/728x90" class="mx-auto mb-4 rounded" alt="Sponsorship Placeholder">
            <p class="text-[var(--text)]">Interested in sponsoring ASTEGNI? Contact us at <a
                href="mailto:info@astegni.et" class="underline hover:text-[var(--button-hover)]">info@astegni.et</a>
              Sunspear!</p>
          </div>
        </div>
      </div>
      <!-- Advertisement Sidebar -->
      <aside class="lg:w-1/4 hidden lg:block sticky top-20 self-start">
        <div
          class="ad-placeholder bg-[var(--highlight)] border border-[var(--border)] rounded-lg p-4 text-center text-[var(--text)]"
          style="width: 300px; height: 250px;">Advertisement (300x250)</div>
        <div
          class="ad-placeholder bg-[var(--highlight)] border border-[var(--border)] rounded-lg p-4 text-center text-[var(--text)]"
          style="width: 300px; height: 250px;">Advertisement (300x250)</div>
        <div
          class="ad-placeholder bg-[var(--highlight)] border border-[var(--border)] rounded-lg p-4 text-center text-[var(--text)]"
          style="width: 300px; height: 250px;">Advertisement (300x250)</div>
      </aside>
    </div>
  </section>

  <!-- Modals -->

  <!-- Notes Modal -->
  <div id="notes-modal" class="modal hidden" role="dialog" aria-labelledby="notesModalTitle" aria-hidden="true"
    tabindex="-1">
    <div class="modal-content notes-modal-container">
      <button class="modal-close" onclick="closeNotesModal()" aria-label="Close Notes Modal">&times;</button>
      <div class="flex-1">
        <div class="flex justify-between items-center mb-4">
          <h3 id="notesModalTitle" class="text-2xl font-bold text-[var(--heading)]">Take a Note</h3>
          <button onclick="newNote()" class="cta-button p-2" title="New Note">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"
              xmlns="http://www.w3.org/2000/svg">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path>
            </svg>
          </button>
        </div>
        <label class="block mb-2 text-[var(--text)]">Date</label>
        <input type="date" id="note-date" class="w-full p-2 mb-4">
        <label class="block mb-2 text-[var(--text)]">Tutor Name</label>
        <div class="relative mb-4">
          <input type="text" id="note-tutor" class="w-full p-2" placeholder="Search for tutor">
          <div id="note-tutor-suggestions" class="school-suggestions hidden"></div>
        </div>
        <label class="block mb-2 text-[var(--text)]">Course</label>
        <div class="relative mb-4">
          <input type="text" id="note-course" class="w-full p-2" placeholder="Search for course">
          <div id="note-course-suggestions" class="school-suggestions hidden"></div>
        </div>
        <label class="block mb-2 text-[var(--text)]">Title</label>
        <input type="text" id="note-title" class="w-full p-2 mb-4" placeholder="Note title">
        <label class="block mb-2 text-[var(--text)]">Note</label>
        <div class="editor-toolbar mb-2">
          <button onclick="formatText('bold')" title="Bold"><b>B</b></button>
          <button onclick="formatText('italic')" title="Italic"><i>I</i></button>
          <button onclick="formatText('underline')" title="Underline"><u>U</u></button>
          <button onclick="formatText('hiliteColor', '#FFFF00')" title="Highlight">H</button>
          <button onclick="formatText('strikeThrough')" title="Strikethrough"><s>S</s></button>
          <select onchange="formatText('fontSize', this.value)" title="Font Size">
            <option value="">Font Size</option>
            <option value="3">Normal</option>
            <option value="4">Large</option>
            <option value="5">Larger</option>
          </select>
          <input type="color" id="font-color" onchange="formatText('foreColor', this.value)" title="Font Color">
          <button onclick="formatText('undo')" title="Undo">âŸ²</button>
          <button onclick="formatText('redo')" title="Redo">âŸ³</button>
          <button onclick="openBackgroundModal()" title="Background Image">ðŸ–¼</button>
          <button onclick="removeNoteBackground()" title="Remove Background">ðŸ—‘</button>
        </div>
        <div id="note-content" contenteditable="true" class="w-full p-2 mb-4"></div>
        <div class="flex flex-col gap-2 mb-6">
          <button onclick="saveNote()" class="cta-button px-4 py-2 w-full">Save Note</button>
          <button onclick="closeNotesModal()" class="cta-button px-4 py-2 w-full">Close</button>
        </div>
      </div>
      <div id="notes-history" class="notes-history hidden">
        <h4 class="text-lg font-semibold mb-2 text-[var(--text)]">Notes History</h4>
        <div id="notes-history-content"></div>
      </div>
      <button onclick="toggleNotesHistory()" class="history-toggle-btn" title="Toggle History">
        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16m-7 6h7"></path>
        </svg>
      </button>
    </div>
  </div>

  <!-- Background Image Modal -->
  <div id="background-modal" class="modal hidden" role="dialog" aria-labelledby="backgroundModalTitle"
    aria-hidden="true" tabindex="-1">
    <div class="modal-content">
      <button class="modal-close" onclick="closeBackgroundModal()" aria-label="Close Background Modal">&times;</button>
      <h3 id="backgroundModalTitle" class="text-2xl font-bold mb-4 text-[var(--heading)]">Select Background Image</h3>
      <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-4">
        <img src="../pictures/Math wallpaper 1.jpeg" class="background-image cursor-pointer rounded-lg"
          onclick="setNoteBackground('math')" alt="Math Background">
        <img src="../pictures/Physics wall paper 1.jpeg" class="background-image cursor-pointer rounded-lg"
          onclick="setNoteBackground('physics')" alt="Physics Background">
        <img src="../pictures/Biology wallpaper 3.jpeg" class="background-image cursor-pointer rounded-lg"
          onclick="setNoteBackground('biology')" alt="Biology Background">
        <img src="../pictures/chemistry wall paper.jpeg" class="background-image cursor-pointer rounded-lg"
          onclick="setNoteBackground('chemistry')" alt="Chemistry Background">
        <img src="../pictures/Geography wallpaper 1.jpeg" class="background-image cursor-pointer rounded-lg"
          onclick="setNoteBackground('geography')" alt="Geography Background">
        <img src="../pictures/History wallpaper 1.jpeg" class="background-image cursor-pointer rounded-lg"
          onclick="setNoteBackground('history')" alt="History Background">
        <img src="../pictures/Music.jpeg" class="background-image cursor-pointer rounded-lg"
          onclick="setNoteBackground('music')" alt="Music Background">
        <img src="../pictures/Theology Wallpaper 1.jpg" class="background-image cursor-pointer rounded-lg"
          onclick="setNoteBackground('Theology')" alt="Theology Background">
        <div class="flex items-center justify-center">
          <input type="file" id="upload-background" accept="image/*" class="hidden" onchange="uploadBackgroundImage()">
          <button onclick="document.getElementById('upload-background').click()" class="cta-button px-4 py-2">Upload
            Image</button>
        </div>
      </div>
      <button onclick="closeBackgroundModal()" class="mt-4 text-[var(--text)] hover:underline">Close</button>
    </div>
  </div>

  <!-- Tools Modal -->
  <div id="tools-modal" class="modal hidden" role="dialog" aria-labelledby="toolsModalTitle" aria-hidden="true"
    tabindex="-1">
    <div class="modal-content">
      <button class="modal-close" onclick="closeToolsModal()" aria-label="Close Tools Modal">&times;</button>
      <h3 id="toolsModalTitle" class="text-2xl font-bold mb-4 text-[var(--heading)]">Tools</h3>
      <p class="text-[var(--text)] mb-4">Coming soon!</p>
      <button onclick="closeToolsModal()" class="mt-4 text-[var(--text)] hover:underline">Close</button>
    </div>
  </div>

  <!-- Quiz Modal -->
  <div id="quiz-modal" class="modal hidden" role="dialog" aria-labelledby="quizModalTitle" aria-hidden="true"
    tabindex="-1">
    <div class="modal-content">
      <button class="modal-close" onclick="closeQuizModal()" aria-label="Close Quiz Modal">&times;</button>
      <h3 id="quizModalTitle" class="text-2xl font-bold mb-4 text-[var(--heading)]">Take a Quiz</h3>
      <p class="text-[var(--text)] mb-4">Are you ready to take your quiz? This test takes up to 30 minutes and elevates
        your portfolio.</p>
      <div class="flex gap-2">
        <button onclick="startQuiz()" class="cta-button px-4 py-2 flex-1">Ready</button>
        <button onclick="closeQuizModal()" class="cta-button px-4 py-2 flex-1">Next Time</button>
      </div>
    </div>
  </div>

  <!-- Get Certified Modal -->
  <div id="getCertifiedModal" class="modal hidden" role="dialog" aria-labelledby="getCertifiedModalTitle"
    aria-hidden="true" tabindex="-1">
    <div class="modal-content">
      <button class="modal-close" onclick="closeModal('getCertifiedModal')"
        aria-label="Close Get Certified Modal">&times;</button>
      <h2 id="getCertifiedModalTitle" class="text-2xl font-bold mb-4 text-[var(--heading)]">Get Certified</h2>
      <p class="text-[var(--text)] mb-4">Coming Soon!</p>
      <div class="flex justify-end">
        <button onclick="closeModal('getCertifiedModal')" class="cta-button px-4 py-2">Close</button>
      </div>
    </div>
  </div>

  <!-- Manage Finances Modal -->
  <div id="manageFinanceModal" class="modal hidden" role="dialog" aria-labelledby="manageFinanceModalTitle"
    aria-hidden="true" tabindex="-1">
    <div class="modal-content flex">
      <button class="modal-close" onclick="closeModal('manageFinanceModal')"
        aria-label="Close Manage Finances Modal">&times;</button>
      <div class="w-1/4 border-r pr-4">
        <nav class="space-y-2">
          <button
            class="tab-btn block w-full text-left px-4 py-2 text-sm font-semibold text-[var(--text)] hover:bg-[var(--button-hover)] rounded-md"
            data-tab="payment-details">Payment Details</button>
          <button
            class="tab-btn block w-full text-left px-4 py-2 text-sm font-semibold text-[var(--text)] hover:bg-[var(--button-hover)] rounded-md"
            data-tab="verification">Verification</button>
          <button
            class="tab-btn block w-full text-left px-4 py-2 text-sm font-semibold text-[var(--text)] hover:bg-[var(--button-hover)] rounded-md"
            data-tab="subscription">Subscription</button>
          <button
            class="tab-btn block w-full text-left px-4 py-2 text-sm font-semibold text-[var(--text)] hover:bg-[var(--button-hover)] rounded-md"
            data-tab="income">Income</button>
          <button
            class="tab-btn block w-full text-left px-4 py-2 text-sm font-semibold text-[var(--text)] hover:bg-[var(--button-hover)] rounded-md"
            data-tab="bills">Bills</button>
          <button
            class="tab-btn block w-full text-left px-4 py-2 text-sm font-semibold text-[var(--text)] hover:bg-[var(--button-hover)] rounded-md"
            data-tab="analytics">Analytics</button>
          <button
            class="tab-btn block w-full text-left px-4 py-2 text-sm font-semibold text-[var(--text)] hover:bg-[var(--button-hover)] rounded-md"
            data-tab="set-package">Set Package</button>
          <button
            class="tab-btn block w-full text-left px-4 py-2 text-sm font-semibold text-[var(--text)] hover:bg-[var(--button-hover)] rounded-md"
            data-tab="view-package">View Package</button>
          <button
            class="tab-btn block w-full text-left px-4 py-2 text-sm font-semibold text-[var(--text)] hover:bg-[var(--button-hover)] rounded-md"
            data-tab="leave-astegni">Leave Astegni</button>
        </nav>
      </div>
      <div class="w-3/4 pl-6">
        <div id="payment-details" class="tab-content">
          <h3 class="text-xl font-semibold mb-4 text-[var(--heading)]">Payment Details</h3>
          <div class="space-y-4">
            <div>
              <label class="block text-sm font-medium text-[var(--text)]">Bank Name</label>
              <select id="bankName" class="w-full p-2">
                <option value="cbe">Commercial Bank of Ethiopia</option>
                <option value="awash">Awash International Bank</option>
                <option value="dashen">Dashen Bank</option>
                <option value="abyssinia">Bank of Abyssinia</option>
                <option value="wegagen">Wegagen Bank</option>
                <option value="hibret">Hibret Bank</option>
                <option value="nib">Nib International Bank</option>
                <option value="coop">Cooperative Bank of Oromia</option>
                <option value="zemen">Zemen Bank</option>
                <option value="telebirr">Tele Birr</option>
              </select>
            </div>
            <div>
              <label class="block text-sm font-medium text-[var(--text)]">Account Number</label>
              <input id="accountNumber" type="text" class="w-full p-2" placeholder="Enter account number">
            </div>
            <button type="submit" class="cta-button px-4 py-2">Save</button>
          </div>
        </div>
        <div id="verification" class="tab-content hidden">
          <h3 class="text-xl font-semibold mb-4 text-[var(--heading)]">Verification</h3>
          <div class="space-y-8">
            <div>
              <h4 class="text-lg font-semibold mb-4 text-[var(--text)]">Tutor Verification</h4>
              <div class="border p-4 rounded-md bg-[var(--bg-light)]">
                <h5 class="text-md font-semibold text-[var(--text)]">Get Verified</h5>
                <p class="text-[var(--text)]">Price: 990 ETB</p>
                <p class="text-[var(--text)]"><strong>Name:</strong> <span id="tutor-name">Not set</span></p>
                <p class="text-[var(--text)]"><strong>Gender:</strong> <span id="tutor-gender">Not set</span></p>
                <p class="text-[var(--text)]"><strong>Phone:</strong> <span id="tutor-phone">Not set</span></p>
                <p class="text-[var(--text)]"><strong>Email:</strong> <span id="tutor-email">Not set</span></p>
                <p class="text-[var(--text)]"><strong>Quote:</strong> <span id="tutor-quote">Not set</span></p>
                <p class="text-[var(--text)]"><strong>Address:</strong> <span id="tutor-address">Not set</span></p>
                <p class="text-[var(--text)]"><strong>Teaches at:</strong> <span id="tutor-school">Not set</span></p>
                <p class="text-[var(--text)]"><strong>Verification Status:</strong> <span
                    id="tutor-verification-status">Not Verified</span></p>
                <div class="mt-2 flex space-x-2">
                  <button id="get-verified-btn" class="cta-button px-4 py-2">Get Verified</button>
                  <button id="edit-verify-profile-btn" class="cta-button px-4 py-2">Edit Profile</button>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div id="subscription" class="tab-content hidden">
          <h3 class="text-xl font-semibold mb-4 text-[var(--heading)]">Subscription</h3>
          <div class="space-y-8">
            <div>
              <h4 class="text-lg font-semibold mb-4 text-[var(--text)]">Standard Subscription</h4>
              <div class="grid grid-cols-2 gap-4">
                <div class="border p-4 rounded-md bg-[var(--bg-light)]">
                  <h5 class="text-md font-semibold text-[var(--text)]">1 Month (Basic)</h5>
                  <p class="text-[var(--text)]">Price: 390 ETB</p>
                  <p class="text-[var(--text)]">Page Search Visibility: Standard</p>
                  <p class="text-[var(--text)]">Video Search Visibility: Standard</p>
                  <div class="mt-2 flex space-x-2">
                    <button class="subscribe-btn cta-button px-4 py-2" data-price="390" data-type="page"
                      data-duration="1-month" data-visibility="Standard">Subscribe</button>
                    <button class="cancel-btn cta-button px-4 py-2 bg-red-600 hover:bg-red-700 hidden" data-price="390"
                      data-type="page" data-duration="1-month">Cancel Subscription</button>
                  </div>
                </div>
                <div class="border p-4 rounded-md bg-[var(--bg-light)]">
                  <h5 class="text-md font-semibold text-[var(--text)]">3 Months</h5>
                  <p class="text-[var(--text)]">Price: <s>1170 ETB</s> 1000 ETB</p>
                  <p class="text-[var(--text)]">Page Search Visibility: Enhanced</p>
                  <p class="text-[var(--text)]">Video Search Visibility: Enhanced</p>
                  <div class="mt-2 flex space-x-2">
                    <button class="subscribe-btn cta-button px-4 py-2" data-price="1000" data-type="page"
                      data-duration="3-months" data-visibility="Enhanced">Subscribe</button>
                    <button class="cancel-btn cta-button px-4 py-2 bg-red-600 hover:bg-red-700 hidden" data-price="1000"
                      data-type="page" data-duration="3-months">Cancel Subscription</button>
                  </div>
                </div>
                <div class="border p-4 rounded-md bg-[var(--bg-light)]">
                  <h5 class="text-md font-semibold text-[var(--text)]">6 Months</h5>
                  <p class="text-[var(--text)]">Price: <s>2360 ETB</s> 2100 ETB</p>
                  <p class="text-[var(--text)]">Page Search Visibility: Premium</p>
                  <p class="text-[var(--text)]">Video Search Visibility: Premium</p>
                  <div class="mt-2 flex space-x-2">
                    <button class="subscribe-btn cta-button px-4 py-2" data-price="2100" data-type="page"
                      data-duration="6-months" data-visibility="Premium">Subscribe</button>
                    <button class="cancel-btn cta-button px-4 py-2 bg-red-600 hover:bg-red-700 hidden" data-price="2100"
                      data-type="page" data-duration="6-months">Cancel Subscription</button>
                  </div>
                </div>
                <div class="border p-4 rounded-md bg-[var(--bg-light)]">
                  <h5 class="text-md font-semibold text-[var(--text)]">12 Months</h5>
                  <p class="text-[var(--text)]">Price: <s>4680 ETB</s> 4000 ETB</p>
                  <p class="text-[var(--text)]">Page Search Visibility: Top Tier</p>
                  <p class="text-[var(--text)]">Video Search Visibility: Top Tier</p>
                  <div class="mt-2 flex space-x-2">
                    <button class="subscribe-btn cta-button px-4 py-2" data-price="4000" data-type="page"
                      data-duration="12-months" data-visibility="Top Tier">Subscribe</button>
                    <button class="cancel-btn cta-button px-4 py-2 bg-red-600 hover:bg-red-700 hidden" data-price="4000"
                      data-type="page" data-duration="12-months">Cancel Subscription</button>
                  </div>
                </div>
              </div>
            </div>
            <div>
              <h4 class="text-lg font-semibold mb-4 text-[var(--text)]">Premium Subscription</h4>
              <div class="grid grid-cols-2 gap-4">
                <div class="border p-4 rounded-md bg-[var(--bg-light)]">
                  <h5 class="text-md font-semibold text-[var(--text)]">24 Hours</h5>
                  <p class="text-[var(--text)]">Price: 300 ETB</p>
                  <p class="text-[var(--text)]">Page Search Visibility: Boosted</p>
                  <p class="text-[var(--text)]">Video Search Visibility: Boosted</p>
                  <div class="mt-2 flex space-x-2">
                    <button class="subscribe-btn cta-button px-4 py-2" data-price="300" data-type="ad"
                      data-duration="24-hours" data-visibility="Boosted">Subscribe</button>
                    <button class="cancel-btn cta-button px-4 py-2 bg-red-600 hover:bg-red-700 hidden" data-price="300"
                      data-type="ad" data-duration="24-hours">Cancel Subscription</button>
                  </div>
                </div>
                <div class="border p-4 rounded-md bg-[var(--bg-light)]">
                  <h5 class="text-md font-semibold text-[var(--text)]">3 Days</h5>
                  <p class="text-[var(--text)]">Price: 500 ETB</p>
                  <p class="text-[var(--text)]">Page Search Visibility: Boosted</p>
                  <p class="text-[var(--text)]">Video Search Visibility: Boosted</p>
                  <div class="mt-2 flex space-x-2">
                    <button class="subscribe-btn cta-button px-4 py-2" data-price="500" data-type="ad"
                      data-duration="3-days" data-visibility="Boosted">Subscribe</button>
                    <button class="cancel-btn cta-button px-4 py-2 bg-red-600 hover:bg-red-700 hidden" data-price="500"
                      data-type="ad" data-duration="3-days">Cancel Subscription</button>
                  </div>
                </div>
                <div class="border p-4 rounded-md bg-[var(--bg-light)]">
                  <h5 class="text-md font-semibold text-[var(--text)]">1 Week</h5>
                  <p class="text-[var(--text)]">Price: 700 ETB</p>
                  <p class="text-[var(--text)]">Page Search Visibility: Boosted</p>
                  <p class="text-[var(--text)]">Video Search Visibility: Boosted</p>
                  <div class="mt-2 flex space-x-2">
                    <button class="subscribe-btn cta-button px-4 py-2" data-price="700" data-type="ad"
                      data-duration="1-week" data-visibility="Boosted">Subscribe</button>
                    <button class="cancel-btn cta-button px-4 py-2 bg-red-600 hover:bg-red-700 hidden" data-price="700"
                      data-type="ad" data-duration="1-week">Cancel Subscription</button>
                  </div>
                </div>
                <div class="border p-4 rounded-md bg-[var(--bg-light)]">
                  <h5 class="text-md font-semibold text-[var(--text)]">2 Weeks</h5>
                  <p class="text-[var(--text)]">Price: 900 ETB</p>
                  <p class="text-[var(--text)]">Page Search Visibility: Boosted</p>
                  <p class="text-[var(--text)]">Video Search Visibility: Boosted</p>
                  <div class="mt-2 flex space-x-2">
                    <button class="subscribe-btn cta-button px-4 py-2" data-price="900" data-type="ad"
                      data-duration="2-weeks" data-visibility="Boosted">Subscribe</button>
                    <button class="cancel-btn cta-button px-4 py-2 bg-red-600 hover:bg-red-700 hidden" data-price="900"
                      data-type="ad" data-duration="2-weeks">Cancel Subscription</button>
                  </div>
                </div>
                <div class="border p-4 rounded-md bg-[var(--bg-light)]">
                  <h5 class="text-md font-semibold text-[var(--text)]">1 Month</h5>
                  <p class="text-[var(--text)]">Price: <s>1250 ETB</s> 1200 ETB</p>
                  <p class="text-[var(--text)]">Page Search Visibility: Premium</p>
                  <p class="text-[var(--text)]">Video Search Visibility: Premium</p>
                  <div class="mt-2 flex space-x-2">
                    <button class="subscribe-btn cta-button px-4 py-2" data-price="1200" data-type="ad"
                      data-duration="1-month" data-visibility="Premium">Subscribe</button>
                    <button class="cancel-btn cta-button px-4 py-2 bg-red-600 hover:bg-red-700 hidden" data-price="1200"
                      data-type="ad" data-duration="1-month">Cancel Subscription</button>
                  </div>
                </div>
                <div class="border p-4 rounded-md bg-[var(--bg-light)]">
                  <h5 class="text-md font-semibold text-[var(--text)]">3 Months (Recommended)</h5>
                  <p class="text-[var(--text)]">Price: <s>3750 ETB</s> 3200 ETB</p>
                  <p class="text-[var(--text)]">Page Search Visibility: Premium</p>
                  <p class="text-[var(--text)]">Video Search Visibility: Premium</p>
                  <div class="mt-2 flex space-x-2">
                    <button class="subscribe-btn cta-button px-4 py-2" data-price="3200" data-type="ad"
                      data-duration="3-months" data-visibility="Premium">Subscribe</button>
                    <button class="cancel-btn cta-button px-4 py-2 bg-red-600 hover:bg-red-700 hidden" data-price="3200"
                      data-type="ad" data-duration="3-months">Cancel Subscription</button>
                  </div>
                </div>
                <div class="border p-4 rounded-md bg-[var(--bg-light)]">
                  <h5 class="text-md font-semibold text-[var(--text)]">6 Months</h5>
                  <p class="text-[var(--text)]">Price: <s>7500 ETB</s> 7000 ETB</p>
                  <p class="text-[var(--text)]">Page Search Visibility: Premium</p>
                  <p class="text-[var(--text)]">Video Search Visibility: Premium</p>
                  <div class="mt-2 flex space-x-2">
                    <button class="subscribe-btn cta-button px-4 py-2" data-price="7000" data-type="ad"
                      data-duration="6-months" data-visibility="Premium">Subscribe</button>
                    <button class="cancel-btn cta-button px-4 py-2 bg-red-600 hover:bg-red-700 hidden" data-price="7000"
                      data-type="ad" data-duration="6-months">Cancel Subscription</button>
                  </div>
                </div>
                <div class="border p-4 rounded-md bg-[var(--bg-light)]">
                  <h5 class="text-md font-semibold text-[var(--text)]">12 Months</h5>
                  <p class="text-[var(--text)]">Price: <s>15000 ETB</s> 12000 ETB</p>
                  <p class="text-[var(--text)]">Page Search Visibility: Top Tier</p>
                  <p class="text-[var(--text)]">Video Search Visibility: Top Tier</p>
                  <div class="mt-2 flex space-x-2">
                    <button class="subscribe-btn cta-button px-4 py-2" data-price="12000" data-type="ad"
                      data-duration="12-months" data-visibility="Top Tier">Subscribe</button>
                    <button class="cancel-btn cta-button px-4 py-2 bg-red-600 hover:bg-red-700 hidden"
                      data-price="12000" data-type="ad" data-duration="12-months">Cancel Subscription</button>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div id="income" class="tab-content hidden">
          <h3 class="text-xl font-semibold mb-4 text-[var(--heading)]">Generated Income</h3>
          <div class="flex items-center mb-4">
            <span id="totalIncome" class="mr-2 text-[var(--text)]">Total Income: â˜…â˜…â˜…</span>
            <button id="toggleIncome" class="text-[var(--nav-link)] hover:text-[var(--nav-link-hover)]">
              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                  d="M15 12a3 3 0 11-6 0 3 3 0 016 0zm6 0c0 5.523-4.477 10-10 10S1 17.523 1 12 5.477 2 11 2s10 4.477 10 10z">
                </path>
              </svg>
            </button>
          </div>
          <div id="incomeDetails">
            <table class="w-full border-collapse">
              <thead>
                <tr class="bg-[var(--bg-light)]">
                  <th class="p-2 text-[var(--text)]">Customer</th>
                  <th class="p-2 text-[var(--text)]">Customer Type</th>
                  <th class="p-2 text-[var(--text)]">Service</th>
                  <th class="p-2 text-[var(--text)]">Amount</th>
                  <th class="p-2 text-[var(--text)]">Subscription Type</th>
                  <th class="p-2 text-[var(--text)]">Pending</th>
                  <th class="p-2 text-[var(--text)]">Actions</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td class="p-2 text-[var(--text)]">John Doe</td>
                  <td class="p-2 text-[var(--text)]">Parent</td>
                  <td class="p-2 text-[var(--text)]">Tutoring</td>
                  <td class="p-2 text-[var(--text)]">4000 ETB</td>
                  <td class="p-2 text-[var(--text)]">Page (6 Months)</td>
                  <td class="p-2 text-[var(--text)]">0 ETB</td>
                  <td class="p-2">
                    <button class="text-[var(--nav-link)] hover:text-[var(--nav-link-hover)] mr-2">View Profile</button>
                    <button class="text-green-600 hover:text-green-700">Generate Invoice</button>
                  </td>
                </tr>
                <tr>
                  <td class="p-2 text-[var(--text)]">Jane Smith</td>
                  <td class="p-2 text-[var(--text)]">Student</td>
                  <td class="p-2 text-[var(--text)]">Tutoring</td>
                  <td class="p-2 text-[var(--text)]">3500 ETB</td>
                  <td class="p-2 text-[var(--text)]">Premium (3 Months)</td>
                  <td class="p-2 text-[var(--text)]">0 ETB</td>
                  <td class="p-2">
                    <button class="text-[var(--nav-link)] hover:text-[var(--nav-link-hover)] mr-2">View Profile</button>
                    <button class="text-green-600 hover:text-green-700">Generate Invoice</button>
                  </td>
                </tr>
              </tbody>
            </table>
            <button class="cta-button px-4 py-2 mt-4">Generate Invoice for All</button>
          </div>
        </div>
        <div id="bills" class="tab-content hidden">
          <h3 class="text-xl font-semibold mb-4 text-[var(--heading)]">Bills</h3>
          <table class="w-full border-collapse">
            <thead>
              <tr class="bg-[var(--bg-light)]">
                <th class="p-2 text-[var(--text)]">Favorite</th>
                <th class="p-2 text-[var(--text)]">Payer Name</th>
                <th class="p-2 text-[var(--text)]">Payer Type</th>
                <th class="p-2 text-[var(--text)]">Bill Type</th>
                <th class="p-2 text-[var(--text)]">Amount</th>
                <th class="p-2 text-[var(--text)]">To Whom</th>
                <th class="p-2 text-[var(--text)]">Pending</th>
                <th class="p-2 text-[var(--text)]">Date</th>
                <th class="p-2 text-[var(--text)]">Actions</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="p-2"><button class="text-yellow-500 hover:text-yellow-600">â˜…</button></td>
                <td class="p-2 text-[var(--text)]">Tutor Inc.</td>
                <td class="p-2 text-[var(--text)]">Company</td>
                <td class="p-2 text-[var(--text)]">Subscription</td>
                <td class="p-2 text-[var(--text)]">500 ETB</td>
                <td class="p-2 text-[var(--text)]">Platform</td>
                <td class="p-2 text-[var(--text)]">0 ETB</td>
                <td class="p-2 text-[var(--text)]">2025-07-01</td>
                <td class="p-2">
                  <button class="text-[var(--nav-link)] hover:text-[var(--nav-link-hover)] mr-2">View Profile</button>
                  <button class="text-green-600 hover:text-green-700">Download Invoice</button>
                </td>
              </tr>
              <tr>
                <td class="p-2"><button class="text-yellow-500 hover:text-yellow-600">â˜…</button></td>
                <td class="p-2 text-[var(--text)]">Ad Corp</td>
                <td class="p-2 text-[var(--text)]">Company</td>
                <td class="p-2 text-[var(--text)]">Advertisement</td>
                <td class="p-2 text-[var(--text)]">750 ETB</td>
                <td class="p-2 text-[var(--text)]">Ad Platform</td>
                <td class="p-2 text-[var(--text)]">250 ETB</td>
                <td class="p-2 text-[var(--text)]">2025-07-10</td>
                <td class="p-2">
                  <button class="text-[var(--nav-link)] hover:text-[var(--nav-link-hover)] mr-2">View Profile</button>
                  <button class="text-green-600 hover:text-green-700">Download Invoice</button>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
        <div id="analytics" class="tab-content hidden">
          <h3 class="text-xl font-semibold mb-4 text-[var(--heading)]">Income and Payments Analytics</h3>
          <select id="analyticsPeriod" class="w-full p-2 mb-4">
            <option value="1-day">1 Day</option>
            <option value="3-days">3 Days</option>
            <option value="1-week">1 Week</option>
            <option value="2-weeks">2 Weeks</option>
            <option value="1-month">1 Month</option>
            <option value="3-months">3 Months</option>
            <option value="6-months">6 Months</option>
            <option value="1-year">1 Year</option>
          </select>
          <div>
            <p class="mb-2 text-[var(--text)]">Total Income: 7500 ETB</p>
            <p class="mb-2 text-[var(--text)]">Total Payments: 3000 ETB</p>
            <canvas id="analyticsChart" class="w-full h-64"></canvas>
          </div>
        </div>
        <div id="set-package" class="tab-content hidden">
          <h3 class="text-xl font-semibold mb-4 text-[var(--heading)]">Set Package</h3>
          <div id="coursesContainer" class="space-y-4">
            <div class="course-entry border p-4 rounded-md bg-[var(--bg-light)]">
              <div class="flex justify-between items-center mb-2">
                <h4 class="text-md font-semibold text-[var(--text)]">Course</h4>
                <button type="button" class="remove-course-btn text-red-600 hover:text-red-800">
                  <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12">
                    </path>
                  </svg>
                </button>
              </div>
              <div class="grid grid-cols-2 gap-4">
                <div>
                  <label class="block text-sm font-medium text-[var(--text)]">Course Name</label>
                  <input type="text" class="course-name w-full p-2" placeholder="Enter course name" required>
                </div>
                <div>
                  <label class="block text-sm font-medium text-[var(--text)]">Payment Frequency</label>
                  <select class="payment-frequency w-full p-2" required>
                    <option value="2-weeks">2 Weeks</option>
                    <option value="monthly">Monthly</option>
                  </select>
                </div>
                <div>
                  <label class="block text-sm font-medium text-[var(--text)]">Hourly Rate (ETB)</label>
                  <input type="number" class="hourly-rate w-full p-2" placeholder="Enter hourly rate" min="0" required>
                </div>
                <div>
                  <label class="block text-sm font-medium text-[var(--text)]">Discounts (%)</label>
                  <div class="grid grid-cols-3 gap-2">
                    <input type="number" class="discount-3months w-full p-2" placeholder="3 Months" min="0" max="100"
                      value="0">
                    <input type="number" class="discount-6months w-full p-2" placeholder="6 Months" min="0" max="100"
                      value="0">
                    <input type="number" class="discount-yearly w-full p-2" placeholder="Yearly" min="0" max="100"
                      value="0">
                  </div>
                </div>
              </div>
            </div>
          </div>
          <button type="button" id="addCourseBtn"
            class="flex items-center text-[var(--nav-link)] hover:text-[var(--nav-link-hover)] mt-4">
            <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path>
            </svg>
            Add Course
          </button>
          <div>
            <label class="block text-sm font-medium text-[var(--text)]">Bank Name</label>
            <select id="updateBankName" class="w-full p-2">
              <option value="cbe">Commercial Bank of Ethiopia</option>
              <option value="awash">Awash International Bank</option>
              <option value="dashen">Dashen Bank</option>
              <option value="abyssinia">Bank of Abyssinia</option>
              <option value="wegagen">Wegagen Bank</option>
              <option value="hibret">Hibret Bank</option>
              <option value="nib">Nib International Bank</option>
              <option value="coop">Cooperative Bank of Oromia</option>
              <option value="zemen">Zemen Bank</option>
              <option value="telebirr">Tele Birr</option>
            </select>
          </div>
          <div>
            <label class="block text-sm font-medium text-[var(--text)]">Account Number</label>
            <input id="updateAccountNumber" type="text" class="w-full p-2" placeholder="Enter account number">
          </div>
          <div>
            <label class="flex items-center text-[var(--text)]">
              <input id="samePaymentDetails" type="checkbox" class="mr-2">
              <span class="text-sm font-medium">Use same payment details for receiving payments</span>
            </label>
          </div>
          <button type="submit" class="cta-button px-4 py-2">Update</button>
        </div>
        <div id="view-package" class="tab-content hidden">
          <h3 class="text-xl font-semibold mb-4 text-[var(--heading)]">View Package</h3>
          <div class="mb-4">
            <label class="block text-sm font-medium text-[var(--text)]">Days per Week (Set by Parent/Student)</label>
            <input type="number" id="days-per-week" class="w-full p-2" placeholder="Enter days per week" min="1" max="7"
              value="3">
          </div>
          <div class="mb-4">
            <label class="block text-sm font-medium text-[var(--text)]">Hours per Day</label>
            <input type="number" id="hours-per-day" class="w-full p-2" placeholder="Enter hours per day" min="1"
              max="24" value="1">
          </div>
          <button id="calculate-fees" class="cta-button px-4 py-2 mb-4">Calculate Fees</button>
          <div id="coursesDisplay" class="space-y-4">
            <p class="text-[var(--text)]">No courses have been set.</p>
          </div>
          <div class="mt-4">
            <h4 class="text-lg font-semibold mb-2 text-[var(--text)]">Payment Details</h4>
            <p class="text-[var(--text)]"><strong>Bank Name:</strong> <span id="displayBankName">Not set</span></p>
            <p class="text-[var(--text)]"><strong>Account Number:</strong> <span id="displayAccountNumber">Not
                set</span></p>
          </div>
        </div>
        <div id="leave-astegni" class="tab-content hidden">
          <h3 class="text-xl font-semibold mb-4 text-[var(--heading)]">Leave Astegni</h3>
          <p class="text-[var(--text)] mb-4">Are you sure you want to leave Astegni? This action will unverify and
            deactivate your account.</p>
          <button id="leaveAstegniBtn" class="cta-button px-4 py-2 bg-red-600 hover:bg-red-700">Confirm Leave</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Switch to Plan Modal -->
  <div id="manageSubscriptionModal" class="modal hidden" role="dialog" aria-labelledby="manageSubscriptionModalTitle"
    aria-hidden="true" tabindex="-1">
    <div class="modal-content">
      <button class="modal-close" onclick="closeModal('manageSubscriptionModal')"
        aria-label="Close Switch to Plan Modal">&times;</button>
      <h3 id="manageSubscriptionModalTitle" class="text-xl font-bold mb-4 text-[var(--heading)]">Switch to Plan</h3>
      <div id="subscriptionOptions" class="space-y-4"></div>
      <button onclick="closeModal('manageSubscriptionModal')" class="cta-button px-4 py-2 mt-4">Close</button>
    </div>
  </div>

  <!-- Unsubscribe Modal: Step 1 (Reasons) -->
  <div id="unsubscribeModal1" class="modal hidden" role="dialog" aria-labelledby="unsubscribeModal1Title"
    aria-hidden="true" tabindex="-1">
    <div class="modal-content">
      <button class="modal-close" onclick="closeModal('unsubscribeModal1')"
        aria-label="Close Unsubscribe Reasons Modal">&times;</button>
      <h2 id="unsubscribeModal1Title" class="text-xl font-bold mb-4 text-[var(--heading)]">Why did you come to this
        decision? ðŸ˜¢</h2>
      <div class="space-y-2">
        <label class="flex items-center text-[var(--text)]"><input type="checkbox" name="unsubscribeReason"
            value="notUseful" class="mr-2"> Service not useful</label>
        <label class="flex items-center text-[var(--text)]"><input type="checkbox" name="unsubscribeReason"
            value="tooExpensive" class="mr-2"> Too expensive</label>
        <label class="flex items-center text-[var(--text)]"><input type="checkbox" name="unsubscribeReason"
            value="foundAlternative" class="mr-2"> Found an alternative</label>
        <label class="flex items-center text-[var(--text)]"><input type="checkbox" name="unsubscribeReason"
            value="privacyConcerns" class="mr-2"> Privacy concerns</label>
        <label class="flex items-center text-[var(--text)]"><input type="checkbox" name="unsubscribeReason"
            value="notSatisfied" class="mr-2"> Not satisfied with features</label>
        <label class="flex items-center text-[var(--text)]"><input type="checkbox" name="unsubscribeReason"
            value="other" id="unsubscribeOther" class="mr-2"> Other</label>
        <textarea id="otherText" class="w-full p-2 hidden" placeholder="Please specify"></textarea>
      </div>
      <div class="flex gap-2 mt-4">
        <button id="unsubscribeSubmitBtn" class="cta-button px-4 py-2">Submit</button>
        <button id="unsubscribeCancelBtn1" class="cta-button px-4 py-2">Cancel</button>
      </div>
    </div>
  </div>

  <!-- Unsubscribe Modal: Step 2 (First Confirmation) -->
  <div id="unsubscribeConfirm1" class="modal hidden" role="dialog" aria-labelledby="unsubscribeConfirm1Title"
    aria-hidden="true" tabindex="-1">
    <div class="modal-content">
      <button class="modal-close" onclick="closeModal('unsubscribeConfirm1')"
        aria-label="Close Unsubscribe Confirmation Modal">&times;</button>
      <h2 id="unsubscribeConfirm1Title" class="text-xl font-bold mb-4 text-[var(--heading)]">Confirm Unsubscription</h2>
      <p id="unsubscribeFirstConfirmText" class="text-[var(--text)] mb-4">This decision will deactivate your
        subscription.</p>
      <div class="flex gap-2">
        <button id="unsubscribeYesBtn1" class="cta-button px-4 py-2">Yes</button>
        <button id="unsubscribeCancelBtn2" class="cta-button px-4 py-2">No</button>
      </div>
    </div>
  </div>

  <!-- Unsubscribe Modal: Step 3 (Second Confirmation) -->
  <div id="unsubscribeConfirm2" class="modal hidden" role="dialog" aria-labelledby="unsubscribeConfirm2Title"
    aria-hidden="true" tabindex="-1">
    <div class="modal-content">
      <button class="modal-close" onclick="closeModal('unsubscribeConfirm2')"
        aria-label="Close Unsubscribe Fee Confirmation Modal">&times;</button>
      <h2 id="unsubscribeConfirm2Title" class="text-xl font-bold mb-4 text-[var(--heading)]">Confirm Cancellation Fee
      </h2>
      <p id="unsubscribeSecondConfirmText" class="text-[var(--text)] mb-4">Subscription cancellation has a fee of 5%.
        Are you still sure to cancel subscription?</p>
      <div class="flex gap-2">
        <button id="unsubscribeYesBtn2" class="cta-button px-4 py-2">Yes</button>
        <button id="unsubscribeCancelBtn3" class="cta-button px-4 py-2">No</button>
      </div>
    </div>
  </div>

  <!-- Unsubscribe Modal: Step 4 (Password) -->
  <div id="unsubscribePasswordModal" class="modal hidden" role="dialog" aria-labelledby="unsubscribePasswordModalTitle"
    aria-hidden="true" tabindex="-1">
    <div class="modal-content">
      <button class="modal-close" onclick="closeModal('unsubscribePasswordModal')"
        aria-label="Close Unsubscribe Password Modal">&times;</button>
      <h2 id="unsubscribePasswordModalTitle" class="text-xl font-bold mb-4 text-[var(--heading)]">Confirm Cancellation
      </h2>
      <label class="block mb-2 text-[var(--text)]">Enter Password: <input type="password" id="unsubscribePassword"
          class="w-full p-2"></label>
      <div class="flex gap-2 mt-4">
        <button id="unsubscribeSubmitPasswordBtn" class="cta-button px-4 py-2">Submit</button>
        <button id="unsubscribeCancelBtn4" class="cta-button px-4 py-2">Cancel</button>
      </div>
    </div>
  </div>

  <!-- Unsubscribe Modal: Step 5 (Final Message) -->
  <div id="unsubscribeModal3" class="modal hidden" role="dialog" aria-labelledby="unsubscribeModal3Title"
    aria-hidden="true" tabindex="-1">
    <div class="modal-content">
      <button class="modal-close" onclick="closeModal('unsubscribeModal3')"
        aria-label="Close Unsubscribe Final Modal">&times;</button>
      <h2 id="unsubscribeModal3Title" class="text-xl font-bold mb-4 text-[var(--heading)]">See you soon!</h2>
      <p class="text-[var(--text)] mb-4">Enjoy your break, and weâ€™ll be here when youâ€™re ready to return. ðŸ‘‹</p>
      <button id="unsubscribeCloseBtn" class="cta-button px-4 py-2">Close</button>
    </div>
  </div>

  <!-- Delete Modal: Step 1 (Reasons) -->
  <div id="deleteModal1" class="modal hidden" role="dialog" aria-labelledby="deleteModal1Title" aria-hidden="true"
    tabindex="-1">
    <div class="modal-content">
      <button class="modal-close" onclick="closeModal('deleteModal1')"
        aria-label="Close Delete Reasons Modal">&times;</button>
      <h2 id="deleteModal1Title" class="text-xl font-bold mb-4 text-[var(--heading)]">Why did you come to this decision?
        ðŸ˜”</h2>
      <div class="space-y-2">
        <label class="flex items-center text-[var(--text)]"><input type="checkbox" name="deleteReason" value="notUseful"
            class="mr-2"> Service not useful</label>
        <label class="flex items-center text-[var(--text)]"><input type="checkbox" name="deleteReason"
            value="tooExpensive" class="mr-2"> Too expensive</label>
        <label class="flex items-center text-[var(--text)]"><input type="checkbox" name="deleteReason"
            value="foundAlternative" class="mr-2"> Found an alternative</label>
        <label class="flex items-center text-[var(--text)]"><input type="checkbox" name="deleteReason"
            value="privacyConcerns" class="mr-2"> Privacy concerns</label>
        <label class="flex items-center text-[var(--text)]"><input type="checkbox" name="deleteReason"
            value="notSatisfied" class="mr-2"> Not satisfied with features</label>
        <label class="flex items-center text-[var(--text)]"><input type="checkbox" name="deleteReason" value="other"
            id="deleteOther" class="mr-2"> Other</label>
        <textarea id="otherTextDelete" class="w-full p-2 hidden" placeholder="Please specify"></textarea>
      </div>
      <div class="flex gap-2 mt-4">
        <button id="deleteSubmitBtn" class="cta-button px-4 py-2">Submit</button>
        <button id="deleteCancelBtn1" class="cta-button px-4 py-2">Cancel</button>
      </div>
    </div>
  </div>

  <!-- Delete Modal: Step 2 (Verification Check) -->
  <div id="deleteVerifyModal" class="modal hidden" role="dialog" aria-labelledby="deleteVerifyModalTitle"
    aria-hidden="true" tabindex="-1">
    <div class="modal-content">
      <button class="modal-close" onclick="closeModal('deleteVerifyModal')"
        aria-label="Close Delete Verification Modal">Ã—</button>
      <h2 id="deleteVerifyModalTitle" class="text-xl font-bold mb-4 text-[var(--heading)]">Are you sure you want to
        leave Astegni?</h2>
      <p id="deleteVerifyText" class="text-[var(--text)] mb-4">This decision will unverify and deactivate your account.
        A 15% verification fee (0 ETB) will be charged if applicable.</p>
      <div class="flex gap-2 mt-4">
        <button id="deleteYesBtn1" class="cta-button px-4 py-2">Yes</button>
        <button id="deleteCancelBtn2" class="cta-button px-4 py-2">No</button>
      </div>
    </div>
  </div>

  <!-- Delete Modal: Step 3 (Password) -->
  <div id="deletePasswordModal" class="modal hidden" role="dialog" aria-labelledby="deletePasswordModalTitle"
    aria-hidden="true" tabindex="-1">
    <div class="modal-content">
      <button class="modal-close" onclick="closeModal('deletePasswordModal')"
        aria-label="Close Delete Password Modal">Ã—</button>
      <h2 id="deletePasswordModalTitle" class="text-xl font-bold mb-4 text-[var(--heading)]">Confirm Account Deletion
      </h2>
      <label class="block mb-2 text-[var(--text)]">Enter Password: <input type="password" id="deletePassword"
          class="w-full p-2"></label>
      <div class="flex gap-2 mt-4">
        <button id="deleteSubmitPasswordBtn" class="cta-button px-4 py-2">Submit</button>
        <button id="deleteCancelBtn3" class="cta-button px-4 py-2">Cancel</button>
      </div>
    </div>
  </div>

  <!-- Delete Modal: Step 4 (Final Message) -->
  <div id="deleteModal2" class="modal hidden" role="dialog" aria-labelledby="deleteModal2Title" aria-hidden="true"
    tabindex="-1">
    <div class="modal-content">
      <button class="modal-close" onclick="closeModal('deleteModal2')" aria-label="Close Delete Final Modal">Ã—</button>
      <h2 id="deleteModal2Title" class="text-xl font-bold mb-4 text-[var(--heading)]">Goodbye!</h2>
      <p class="text-[var(--text)] mb-4">Your account has been deactivated. Weâ€™re sad to see you go, but thank you for
        being part of Astegni. ðŸ™</p>
      <button id="deleteCloseBtn" class="cta-button px-4 py-2">Close</button>
    </div>
  </div>

  <!-- Edit Profile Modal -->
  <div id="edit-profile-modal" class="modal hidden" role="dialog" aria-labelledby="editProfileModalTitle"
    aria-hidden="true" tabindex="-1">
    <div class="modal-content">
      <button class="modal-close" onclick="closeModal('edit-profile-modal')"
        aria-label="Close Edit Profile Modal">Ã—</button>
      <h2 id="editProfileModalTitle" class="text-2xl font-bold mb-4 text-[var(--heading)]">Edit Profile</h2>
      <div class="space-y-4">
        <div>
          <label class="block text-sm font-medium text-[var(--text)]">Name</label>
          <input id="edit-name" type="text" class="w-full p-2" placeholder="Enter your name">
        </div>
        <div>
          <label class="block text-sm font-medium text-[var(--text)]">Gender</label>
          <select id="edit-gender" class="w-full p-2">
            <option value="male">Male</option>
            <option value="female">Female</option>
            <option value="other">Other</option>
          </select>
        </div>
        <div>
          <label class="block text-sm font-medium text-[var(--text)]">Phone</label>
          <input id="edit-phone" type="tel" class="w-full p-2" placeholder="Enter phone number">
        </div>
        <div>
          <label class="block text-sm font-medium text-[var(--text)]">Email</label>
          <input id="edit-email" type="email" class="w-full p-2" placeholder="Enter email address">
        </div>
        <div>
          <label class="block text-sm font-medium text-[var(--text)]">Address</label>
          <input id="edit-address" type="text" class="w-full p-2" placeholder="Enter address">
        </div>
        <div>
          <label class="block text-sm font-medium text-[var(--text)]">Quote</label>
          <input id="edit-quote" type="text" class="w-full p-2" placeholder="Enter your quote">
        </div>
        <div class="flex gap-2">
          <button onclick="saveProfile()" class="cta-button px-4 py-2">Save</button>
          <button onclick="closeModal('edit-profile-modal')" class="cta-button px-4 py-2">Cancel</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Request School Modal -->
  <div id="request-school-modal" class="modal hidden" role="dialog" aria-labelledby="requestSchoolModalTitle"
    aria-hidden="true" tabindex="-1">
    <div class="modal-content">
      <button class="modal-close" onclick="closeModal('request-school-modal')"
        aria-label="Close Request School Modal">Ã—</button>
      <h2 id="requestSchoolModalTitle" class="text-2xl font-bold mb-4 text-[var(--heading)]">Request School</h2>
      <div class="space-y-4">
        <div>
          <label class="block text-sm font-medium text-[var(--text)]">School Name</label>
          <input id="school-name" type="text" class="w-full p-2" placeholder="Enter school name">
        </div>
        <div>
          <label class="block text-sm font-medium text-[var(--text)]">School Address</label>
          <input id="school-address" type="text" class="w-full p-2" placeholder="Enter school address">
        </div>
        <div>
          <label class="block text-sm font-medium text-[var(--text)]">School Contact</label>
          <input id="school-contact" type="tel" class="w-full p-2" placeholder="Enter school contact">
        </div>
        <div class="flex gap-2">
          <button onclick="submitSchoolRequest()" class="cta-button px-4 py-2">Submit</button>
          <button onclick="closeModal('request-school-modal')" class="cta-button px-4 py-2">Cancel</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Edit About Me Modal -->
  <div id="edit-about-me-modal" class="modal hidden" role="dialog" aria-labelledby="editAboutMeModalTitle"
    aria-hidden="true" tabindex="-1">
    <div class="modal-content">
      <button class="modal-close" onclick="closeModal('edit-about-me-modal')"
        aria-label="Close Edit About Me Modal">Ã—</button>
      <h2 id="editAboutMeModalTitle" class="text-2xl font-bold mb-4 text-[var(--heading)]">Edit About Me</h2>
      <div class="space-y-4">
        <div>
          <label class="block text-sm font-medium text-[var(--text)]">Bio</label>
          <textarea id="edit-bio" class="w-full p-2" rows="5" placeholder="Enter your bio"></textarea>
        </div>
        <div class="flex gap-2">
          <button onclick="saveAboutMe()" class="cta-button px-4 py-2">Save</button>
          <button onclick="closeModal('edit-about-me-modal')" class="cta-button px-4 py-2">Cancel</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Edit Certifications Modal -->
  <div id="edit-certifications-modal" class="modal hidden" role="dialog" aria-labelledby="editCertificationsModalTitle"
    aria-hidden="true" tabindex="-1">
    <div class="modal-content">
      <button class="modal-close" onclick="closeModal('edit-certifications-modal')"
        aria-label="Close Edit Certifications Modal">Ã—</button>
      <h2 id="editCertificationsModalTitle" class="text-2xl font-bold mb-4 text-[var(--heading)]">Edit Certifications
      </h2>
      <div id="certifications-container" class="space-y-4">
        <div class="certification-entry">
          <div class="flex justify-between items-center mb-2">
            <h4 class="text-md font-semibold text-[var(--text)]">Certification</h4>
            <button class="remove-certification-btn text-red-600 hover:text-red-800">
              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
              </svg>
            </button>
          </div>
          <input type="text" class="certification-name w-full p-2 mb-2" placeholder="Enter certification name">
          <input type="text" class="certification-year w-full p-2" placeholder="Enter year">
        </div>
      </div>
      <button onclick="addCertificationField()"
        class="flex items-center text-[var(--nav-link)] hover:text-[var(--nav-link-hover)] mt-4">
        <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path>
        </svg>
        Add Certification
      </button>
      <div class="flex gap-2 mt-4">
        <button onclick="saveCertifications()" class="cta-button px-4 py-2">Save</button>
        <button onclick="closeModal('edit-certifications-modal')" class="cta-button px-4 py-2">Cancel</button>
      </div>
    </div>
  </div>

  <!-- Edit Socials Modal -->
  <div id="edit-socials-modal" class="modal hidden" role="dialog" aria-labelledby="editSocialsModalTitle"
    aria-hidden="true" tabindex="-1">
    <div class="modal-content">
      <button class="modal-close" onclick="closeModal('edit-socials-modal')"
        aria-label="Close Edit Socials Modal">Ã—</button>
      <h2 id="editSocialsModalTitle" class="text-2xl font-bold mb-4 text-[var(--heading)]">Edit Socials</h2>
      <div id="socials-container" class="space-y-4">
        <div class="social-entry">
          <div class="flex justify-between items-center mb-2">
            <h4 class="text-md font-semibold text-[var(--text)]">Social Link</h4>
            <button class="remove-social-btn text-red-600 hover:text-red-800">
              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
              </svg>
            </button>
          </div>
          <input type="text" class="social-platform w-full p-2 mb-2" placeholder="Enter platform (e.g., Twitter)">
          <input type="url" class="social-url w-full p-2" placeholder="Enter URL">
        </div>
      </div>
      <button onclick="addSocialField()"
        class="flex items-center text-[var(--nav-link)] hover:text-[var(--nav-link-hover)] mt-4">
        <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path>
        </svg>
        Add Social
      </button>
      <div class="flex gap-2 mt-4">
        <button onclick="saveSocials()" class="cta-button px-4 py-2">Save</button>
        <button onclick="closeModal('edit-socials-modal')" class="cta-button px-4 py-2">Cancel</button>
      </div>
    </div>
  </div>

  <!-- Upload Cover Photo Modal -->
  <div id="upload-cover-photo-modal" class="modal hidden" role="dialog" aria-labelledby="uploadCoverPhotoModalTitle"
    aria-hidden="true" tabindex="-1">
    <div class="modal-content">
      <button class="modal-close" onclick="closeModal('upload-cover-photo-modal')"
        aria-label="Close Upload Cover Photo Modal">Ã—</button>
      <h2 id="uploadCoverPhotoModalTitle" class="text-2xl font-bold mb-4 text-[var(--heading)]">Upload Cover Photo</h2>
      <div class="space-y-4">
        <input type="file" id="cover-photo-upload" accept="image/*" class="w-full p-2">
        <div class="flex gap-2">
          <button onclick="uploadCoverPhoto()" class="cta-button px-4 py-2">Upload</button>
          <button onclick="closeModal('upload-cover-photo-modal')" class="cta-button px-4 py-2">Cancel</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Upload Profile Photo Modal -->
  <div id="upload-profile-photo-modal" class="modal hidden" role="dialog" aria-labelledby="uploadProfilePhotoModalTitle"
    aria-hidden="true" tabindex="-1">
    <div class="modal-content">
      <button class="modal-close" onclick="closeModal('upload-profile-photo-modal')"
        aria-label="Close Upload Profile Photo Modal">Ã—</button>
      <h2 id="uploadProfilePhotoModalTitle" class="text-2xl font-bold mb-4 text-[var(--heading)]">Upload Profile Photo
      </h2>
      <div class="space-y-4">
        <input type="file" id="profile-photo-upload" accept="image/*" class="w-full p-2">
        <div class="flex gap-2">
          <button onclick="uploadProfilePhoto()" class="cta-button px-4 py-2">Upload</button>
          <button onclick="closeModal('upload-profile-photo-modal')" class="cta-button px-4 py-2">Cancel</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Rate Astegni Modal -->
  <div id="rate-astegni-modal" class="modal hidden" role="dialog" aria-labelledby="rateAstegniModalTitle"
    aria-hidden="true" tabindex="-1">
    <div class="modal-content">
      <button class="modal-close" onclick="closeModal('rate-astegni-modal')"
        aria-label="Close Rate Astegni Modal">Ã—</button>
      <h2 id="rateAstegniModalTitle" class="text-2xl font-bold mb-4 text-[var(--heading)]">Comment and Rate ASTEGNI</h2>
      <div class="space-y-4">
        <div>
          <label class="block text-sm font-medium text-[var(--text)]">Rating</label>
          <div id="rating-stars" class="flex gap-1">
            <span class="star cursor-pointer text-yellow-500" data-value="1">â˜…</span>
            <span class="star cursor-pointer text-yellow-500" data-value="2">â˜…</span>
            <span class="star cursor-pointer text-yellow-500" data-value="3">â˜…</span>
            <span class="star cursor-pointer text-yellow-500" data-value="4">â˜…</span>
            <span class="star cursor-pointer text-yellow-500" data-value="5">â˜…</span>
          </div>
        </div>
        <div>
          <label class="block text-sm font-medium text-[var(--text)]">Comment</label>
          <textarea id="rate-comment" class="w-full p-2" rows="5" placeholder="Enter your comment"></textarea>
        </div>
        <div class="flex gap-2">
          <button onclick="submitRating()" class="cta-button px-4 py-2">Submit</button>
          <button onclick="closeModal('rate-astegni-modal')" class="cta-button px-4 py-2">Cancel</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Share Profile Modal -->
  <div id="share-profile-modal" class="modal hidden" role="dialog" aria-labelledby="shareProfileModalTitle"
    aria-hidden="true" tabindex="-1">
    <div class="modal-content">
      <button class="modal-close" onclick="closeModal('share-profile-modal')"
        aria-label="Close Share Profile Modal">Ã—</button>
      <h2 id="shareProfileModalTitle" class="text-2xl font-bold mb-4 text-[var(--heading)]">Share Profile</h2>
      <div class="space-y-4">
        <p class="text-[var(--text)]">Share your profile link:</p>
        <input id="profile-link" type="text" class="w-full p-2" readonly
          value="https://astegni.et/profile/your-profile">
        <div class="flex gap-2">
          <button onclick="copyProfileLink()" class="cta-button px-4 py-2">Copy Link</button>
          <button onclick="shareViaEmail()" class="cta-button px-4 py-2">Share via Email</button>
          <button onclick="closeModal('share-profile-modal')" class="cta-button px-4 py-2">Cancel</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Notification Modal -->
  <div id="notification-modal" class="modal hidden" role="dialog" aria-labelledby="notificationModalTitle"
    aria-hidden="true" tabindex="-1">
    <div class="modal-content">
      <button class="modal-close" onclick="closeModal('notification-modal')"
        aria-label="Close Notification Modal">Ã—</button>
      <h2 id="notificationModalTitle" class="text-2xl font-bold mb-4 text-[var(--heading)]">Notifications</h2>
      <div id="notification-list" class="space-y-4">
        <p class="text-[var(--text)]">No new notifications.</p>
      </div>
      <button onclick="closeModal('notification-modal')" class="cta-button px-4 py-2 mt-4">Close</button>
    </div>
  </div>

  <!-- Requested Sessions Modal -->
  <div id="requested-sessions-modal" class="modal hidden" role="dialog" aria-labelledby="requestedSessionsModalTitle"
    aria-hidden="true" tabindex="-1">
    <div class="modal-content">
      <button class="modal-close" onclick="closeModal('requested-sessions-modal')"
        aria-label="Close Requested Sessions Modal">Ã—</button>
      <h2 id="requestedSessionsModalTitle" class="text-2xl font-bold mb-4 text-[var(--heading)]">Requested Sessions</h2>
      <div id="sessions-list" class="space-y-4">
        <p class="text-[var(--text)]">No requested sessions.</p>
      </div>
      <button onclick="closeModal('requested-sessions-modal')" class="cta-button px-4 py-2 mt-4">Close</button>
    </div>
  </div>

  <!-- Chat Modal -->
  <div id="chat-modal" class="modal hidden" role="dialog" aria-labelledby="chatModalTitle" aria-hidden="true"
    tabindex="-1">
    <div class="modal-content max-w-md max-h-[80vh] overflow-y-auto">
      <button class="modal-close" onclick="closeChatModal()" aria-label="Close Chat Modal">Ã—</button>
      <div class="flex justify-between items-center mb-4">
        <h3 id="chatModalTitle" class="text-2xl font-bold text-[var(--heading)]">Chat</h3>
        <div class="flex gap-2">
          <button onclick="viewSenderDetails()" class="cta-button px-2 py-1">View Sender</button>
          <button id="view-child-btn" onclick="viewChildDetails()" class="cta-button px-2 py-1 hidden">View
            Child</button>
        </div>
      </div>
      <div id="chat-messages" class="mb-4 max-h-64 overflow-y-auto p-2 bg-[var(--bg-light)] rounded-lg"></div>
      <textarea id="chat-input" class="w-full p-2 border border-[var(--border)] rounded-lg mb-4 text-[var(--text)]"
        rows="3" placeholder="Type your message"></textarea>
      <div class="flex gap-2">
        <button onclick="sendMessage()" class="cta-button px-4 py-2 flex-1">Send</button>
        <button onclick="closeChatModal()" class="cta-button px-4 py-2 flex-1">Close</button>
      </div>
    </div>
  </div>

  <!-- Footer -->
  <footer class="bg-[var(--footer-bg)] text-[var(--footer-text)] py-8">
    <div class="container mx-auto px-4">
      <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
        <div>
          <h4 class="text-lg font-semibold mb-4 text-[var(--footer-text)]">About ASTEGNI</h4>
          <p class="text-[var(--footer-text)]">ASTEGNI is a platform connecting students with qualified tutors for
            personalized learning experiences.</p>
        </div>
        <div>
          <h4 class="text-lg font-semibold mb-4 text-[var(--footer-text)]">Quick Links</h4>
          <ul class="space-y-2">
            <li><a href="index.html"
                class="text-[var(--footer-text)] hover:text-[var(--nav-link-hover)] hover:underline">Home</a></li>
            <li><a href="find-tutors.html"
                class="text-[var(--footer-text)] hover:text-[var(--nav-link-hover)] hover:underline">Find Tutors</a>
            </li>
            <li><a href="#" onclick="openNotesModal()"
                class="text-[var(--footer-text)] hover:text-[var(--nav-link-hover)] hover:underline">Notes</a></li>
            <li><a href="#" onclick="openToolsModal()"
                class="text-[var(--footer-text)] hover:text-[var(--nav-link-hover)] hover:underline">Tools</a></li>
          </ul>
        </div>
        <div>
          <h4 class="text-lg font-semibold mb-4 text-[var(--footer-text)]">Contact Us</h4>
          <p class="text-[var(--footer-text)]">Email: <a href="mailto:info@astegni.et"
              class="hover:text-[var(--nav-link-hover)] hover:underline">info@astegni.et</a></p>
          <p class="text-[var(--footer-text)]">Phone: +251-912-345-678</p>
        </div>
        <div>
          <h4 class="text-lg font-semibold mb-4 text-[var(--footer-text)]">Follow Us</h4>
          <div class="flex gap-4">
            <div class="relative">
              <a href="#" class="text-[var(--footer-text)] hover:text-[var(--nav-link-hover)]"
                aria-label="Follow on Facebook">
                <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24">
                  <path
                    d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm4.5 7.09h-2.07c-.28 0-.5.22-.5.5v1.41h2.57l-.34 2.59h-2.23v6.41h-2.59v-6.41H9.5v-2.59h1.84V9.59c0-1.81 1.1-2.8 2.71-2.8h1.95v2.3z" />
                </svg>
                <span class="tooltip bg-[var(--modal-bg)] text-[var(--text)]">Facebook</span>
              </a>
            </div>
            <div class="relative">
              <a href="#" class="text-[var(--footer-text)] hover:text-[var(--nav-link-hover)]"
                aria-label="Follow on LinkedIn">
                <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24">
                  <path
                    d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2.5 16.5h-2v-7h2v7zm-1-7.9c-.7 0-1.2-.6-1.2-1.3 1.2.6 1.2 1.3 0 1.3zm9.5 7.9h-2v-4c0-.9-.3-1.5-1.1-1.5-.6 0-1 .4-1.1 1v4.5h-2v-7h2v1.1c.3-.5.9-.8 1.6-.8 1.2 0 2.1.7 2.1 2.2v4.5z" />
                </svg>
                <span class="tooltip bg-[var(--modal-bg)] text-[var(--text)]">LinkedIn</span>
              </a>
            </div>
            <div class="relative">
              <a href="#" class="text-[var(--footer-text)] hover:text-[var(--nav-link-hover)]"
                aria-label="Follow on Twitter">
                <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24">
                  <path
                    d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z" />
                </svg>
                <span class="tooltip bg-[var(--modal-bg)] text-[var(--text)]">Twitter</span>
              </a>
            </div>
          </div>
        </div>
      </div>
      <div class="mt-8 text-center">
        <p class="text-[var(--footer-text)]">Â© 2025 ASTEGNI. All rights reserved.</p>
      </div>
    </div>
  </footer>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      // All your JavaScript code here

      // Theme Toggle
      const themeToggle = document.getElementById('theme-toggle');
      const mobileThemeToggle = document.getElementById('mobile-theme-toggle');
      const html = document.documentElement;

      function toggleTheme() {
        const currentTheme = html.getAttribute('data-theme') === 'dark' ? 'light' : 'dark';
        html.setAttribute('data-theme', currentTheme);
        localStorage.setItem('theme', currentTheme);
      }

      themeToggle.addEventListener('click', toggleTheme);
      mobileThemeToggle.addEventListener('click', toggleTheme);

      // Initialize theme based on localStorage or system preference
      const savedTheme = localStorage.getItem('theme') || (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light');
      html.setAttribute('data-theme', savedTheme);

      // Mobile Menu Toggle
      const menuBtn = document.getElementById('menu-btn');
      const mobileMenu = document.getElementById('mobile-menu');

      menuBtn.addEventListener('click', () => {
        mobileMenu.classList.toggle('hidden');
      });

      // Profile Dropdown
      const profileDropdownBtn = document.getElementById('profile-dropdown-btn');
      const profileDropdown = document.getElementById('profile-dropdown');
      const mobileProfileDropdownBtn = document.getElementById('mobile-profile-dropdown-btn');
      const mobileProfileDropdown = document.getElementById('mobile-profile-dropdown');

      profileDropdownBtn.addEventListener('click', () => {
        profileDropdown.classList.toggle('hidden');
      });

      mobileProfileDropdownBtn.addEventListener('click', () => {
        mobileProfileDropdown.classList.toggle('hidden');
      });

      // Modal Functions
      function openModal(modalId) {
        document.getElementById(modalId).classList.remove('hidden');
      }
      function closeModal(modalId) {
        document.getElementById(modalId).classList.add('hidden');
      }


      //Notes Modal Functions
      
     let notesArray = []; // Mock data storage
    let currentNoteIndex = null; // Track note being edited

    function openNotesModal() {
      document.getElementById('notes-modal').classList.remove('hidden');
      document.body.classList.add('modal-open'); // Prevent body scroll
      newNote();
      renderNotesHistory();
    }

    function closeNotesModal() {
      document.getElementById('notes-modal').classList.add('hidden');
      document.body.classList.remove('modal-open'); // Restore body scroll
    }

    function toggleNotesHistory() {
      const history = document.getElementById('notes-history');
      history.classList.toggle('hidden');
    }

    function newNote() {
      document.getElementById('note-date').value = '';
      document.getElementById('note-tutor').value = '';
      document.getElementById('note-course').value = '';
      document.getElementById('note-title').value = '';
      document.getElementById('note-content').innerHTML = '';
      document.getElementById('note-content').style.backgroundImage = '';
      document.getElementById('note-content').dataset.background = '';
      currentNoteIndex = null;
    }

    function formatText(command, value = null) {
      document.execCommand(command, false, value);
      document.getElementById('note-content').focus();
    }

    function openBackgroundModal() {
      document.getElementById('background-modal').classList.remove('hidden');
    }

    function closeBackgroundModal() {
      document.getElementById('background-modal').classList.add('hidden');
    }

    function setNoteBackground(background) {
      const noteContent = document.getElementById('note-content');
      const backgroundMap = {
        math: 'pictures/math.jpg',
        physics: 'pictures/physics.jpg',
        biology: 'pictures/biology.jpg',
        chemistry: 'pictures/chemistry.jpg',
        geography: 'pictures/geography.jpg',
        history: 'pictures/history.jpg',
        music: 'pictures/music.jpg'
      };
      const backgroundUrl = backgroundMap[background] || background;
      noteContent.style.backgroundImage = `url(${backgroundUrl})`;
      noteContent.style.backgroundSize = 'cover';
      noteContent.style.backgroundPosition = 'center';
      noteContent.dataset.background = background;
      closeBackgroundModal();
    }

    function uploadBackgroundImage() {
      const fileInput = document.getElementById('upload-background');
      const file = fileInput.files[0];
      if (file) {
        const reader = new FileReader();
        reader.onload = function (e) {
          setNoteBackground(e.target.result);
        };
        reader.readAsDataURL(file);
      }
    }

    function removeNoteBackground() {
      const noteContent = document.getElementById('note-content');
      noteContent.style.backgroundImage = '';
      noteContent.dataset.background = '';
    }

    function saveNote() {
      const note = {
        date: document.getElementById('note-date').value,
        tutor: document.getElementById('note-tutor').value,
        course: document.getElementById('note-course').value,
        title: document.getElementById('note-title').value,
        content: document.getElementById('note-content').innerHTML,
        background: document.getElementById('note-content').dataset.background || ''
      };

      if (currentNoteIndex !== null) {
        notesArray[currentNoteIndex] = note;
      } else {
        notesArray.push(note);
      }

      renderNotesHistory();
      closeNotesModal();
    }

    function renderNotesHistory() {
      const historyContent = document.getElementById('notes-history-content');
      historyContent.innerHTML = '';

      notesArray.forEach((note, index) => {
        const noteCard = document.createElement('div');
        noteCard.className = 'note-card p-3 mb-2 rounded-lg bg-white dark:bg-gray-800 shadow-md';
        
        if (note.background) {
          const backgroundMap = {
            math: 'pictures/math.jpg',
            physics: 'pictures/physics.jpg',
            biology: 'pictures/biology.jpg',
            chemistry: 'pictures/chemistry.jpg',
            geography: 'pictures/geography.jpg',
            history: 'pictures/history.jpg',
            music: 'pictures/music.jpg'
          };
          const backgroundUrl = backgroundMap[note.background] || note.background;
          noteCard.style.backgroundImage = `url(${backgroundUrl})`;
          noteCard.style.backgroundSize = 'cover';
          noteCard.style.backgroundPosition = 'center';
        }

        noteCard.innerHTML = `
          <h5 class="font-semibold text-gray-900 dark:text-white">${note.title || 'Untitled'}</h5>
          <p class="text-sm text-gray-600 dark:text-gray-300">${note.date || 'No date'}</p>
          <p class="text-sm text-gray-600 dark:text-gray-300">${note.course || 'No course'}</p>
          <button onclick="loadNote(${index})" class="text-blue-600 hover:underline">View</button>
          <button onclick="deleteNote(${index})" class="text-red-600 hover:underline ml-2">Delete</button>
        `;
        historyContent.appendChild(noteCard);
      });
    }

    function loadNote(index) {
      const note = notesArray[index];
      document.getElementById('note-date').value = note.date;
      document.getElementById('note-tutor').value = note.tutor;
      document.getElementById('note-course').value = note.course;
      document.getElementById('note-title').value = note.title;
      document.getElementById('note-content').innerHTML = note.content;

      const noteContent = document.getElementById('note-content');
      if (note.background) {
        const backgroundMap = {
          math: 'pictures/math.jpg',
          physics: 'pictures/physics.jpg',
          biology: 'pictures/biology.jpg',
          chemistry: 'pictures/chemistry.jpg',
          geography: 'pictures/geography.jpg',
          history: 'pictures/history.jpg',
          music: 'pictures/music.jpg'
        };
        const backgroundUrl = backgroundMap[note.background] || note.background;
        noteContent.style.backgroundImage = `url(${backgroundUrl})`;
        noteContent.style.backgroundSize = 'cover';
        noteContent.style.backgroundPosition = 'center';
        noteContent.dataset.background = note.background;
      } else {
        noteContent.style.backgroundImage = '';
        noteContent.dataset.background = '';
      }

      currentNoteIndex = index;
      document.getElementById('notes-modal').classList.remove('hidden');
      document.body.classList.add('modal-open');
    }

    function deleteNote(index) {
      notesArray.splice(index, 1);
      renderNotesHistory();
    }


      // Tools Modal
      function openToolsModal() {
        openModal('tools-modal');
      }

      function closeToolsModal() {
        closeModal('tools-modal');
      }

      // Quiz Modal
      function openQuizModal() {
        openModal('quiz-modal');
      }

      function closeQuizModal() {
        closeModal('quiz-modal');
      }

      function startQuiz() {
        alert('Quiz started!');
        closeQuizModal();
      }

      // Get Certified Button
      document.getElementById('get-certified-btn').addEventListener('click', () => {
        openModal('getCertifiedModal');
        // Set focus to the modal for accessibility
        document.getElementById('getCertifiedModal').focus();
      });

      // Close Get Certified Modal
      document.getElementById('closeGetCertifiedModal').addEventListener('click', () => {
        closeModal('getCertifiedModal');
        // Restore focus to the triggering button
        document.getElementById('get-certified-btn').focus();
      });

      // Close modal on Escape key
      document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape' && document.getElementById('getCertifiedModal').style.display === 'flex') {
          closeModal('getCertifiedModal');
          document.getElementById('get-certified-btn').focus();
        }
      });

      // Close modal on outside click
      document.getElementById('getCertifiedModal').addEventListener('click', (e) => {
        if (e.target === document.getElementById('getCertifiedModal')) {
          closeModal('getCertifiedModal');
          document.getElementById('get-certified-btn').focus();
        }
      });








      // Store courses, payment details, subscription state, profile, and verification status
      let courses = [];
      let bankDetails = { bankName: 'Not set', accountNumber: 'Not set' };
      let activeSubscriptions = {};
      let profile = {
        name: 'Not set',
        gender: 'Not set',
        phone: 'Not set',
        email: 'Not set',
        quote: 'Not set',
        address: 'Not set',
        school: 'Not set'
      };
      let verificationStatus = 'Not Verified';
      let currentUnsubscribe = null;
      let isAccountDeleted = false;
      let pendingSchools = []; // Track requested schools
      // Mock data from parent/student profile
      let parentStudentRequest = { daysPerWeek: 3, hoursPerDay: 1 }; // Default values
      // Temporary storage for profile data during school request
      let tempProfile = null;

      // Subscription plans data
      const subscriptionPlans = {
        page: [
          { duration: '1-month', price: 390, visibility: 'Standard', originalPrice: 390 },
          { duration: '3-months', price: 1000, visibility: 'Enhanced', originalPrice: 1170 },
          { duration: '6-months', price: 2100, visibility: 'Premium', originalPrice: 2360 },
          { duration: '12-months', price: 4000, visibility: 'Top Tier', originalPrice: 4680 }
        ],
        ad: [
          { duration: '24-hours', price: 300, visibility: 'Boosted', originalPrice: 300 },
          { duration: '3-days', price: 500, visibility: 'Boosted', originalPrice: 500 },
          { duration: '1-week', price: 700, visibility: 'Boosted', originalPrice: 700 },
          { duration: '2-weeks', price: 900, visibility: 'Boosted', originalPrice: 900 },
          { duration: '1-month', price: 1200, visibility: 'Premium', originalPrice: 1250 },
          { duration: '3-months', price: 3200, visibility: 'Premium', originalPrice: 3750 },
          { duration: '6-months', price: 7000, visibility: 'Premium', originalPrice: 7500 },
          { duration: '12-months', price: 12000, visibility: 'Top Tier', originalPrice: 15000 }
        ]
      };

      // Track previous school value to detect changes
      let previousSchool = profile.school;

      // Levenshtein distance function for typo tolerance
      function levenshteinDistance(a, b) {
        const matrix = [];
        for (let i = 0; i <= b.length; i++) {
          matrix[i] = [i];
        }
        for (let j = 0; j <= a.length; j++) {
          matrix[0][j] = j;
        }
        for (let i = 1; i <= b.length; i++) {
          for (let j = 1; j <= a.length; j++) {
            if (b.charAt(i - 1) === a.charAt(j - 1)) {
              matrix[i][j] = matrix[i - 1][j - 1];
            } else {
              matrix[i][j] = Math.min(
                matrix[i - 1][j - 1] + 1, // substitution
                matrix[i][j - 1] + 1,     // insertion
                matrix[i - 1][j] + 1      // deletion
              );
            }
          }
        }
        return matrix[b.length][a.length];
      }

      // Tutor Profile Modal Toggle
      function openManageFinances() {
        document.getElementById('manageFinanceModal').style.display = 'flex';
        showTab('payment-details');
      }

      // Modal Show/Hide Functions
      function showModal(modalId) {
        document.getElementById(modalId).style.display = 'flex';
      }

      function closeModal(modalId) {
        document.getElementById(modalId).style.display = 'none';
      }

      // Tab Navigation
      function showTab(tabId) {
        document.querySelectorAll('.tab-content').forEach(tab => tab.classList.add('hidden'));
        document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('bg-gray-100'));
        const selectedTab = document.getElementById(tabId);
        if (selectedTab) selectedTab.classList.remove('hidden');
        const selectedBtn = document.querySelector(`.tab-btn[data-tab="${tabId}"]`);
        if (selectedBtn) selectedBtn.classList.add('bg-gray-100');
      }

      // Initialize Tab Event Listeners
      document.addEventListener('DOMContentLoaded', () => {
        document.querySelectorAll('.tab-btn').forEach(button => {
          button.addEventListener('click', () => {
            const tabId = button.getAttribute('data-tab');
            showTab(tabId);
          });
        });
      });

      // Edit Profile Form Submission
      function saveProfile() {
        const name = document.getElementById('profile-name').value;
        const gender = document.getElementById('profile-gender').value;
        const phone = document.getElementById('profile-phone').value;
        const email = document.getElementById('profile-email').value;
        const quote = document.getElementById('profile-quote').value;
        const address = document.getElementById('profile-address').value;
        const school = document.getElementById('profile-school').value;
        const idFile = document.getElementById('id-input').files[0];

        if (!name || !gender || !phone || !email || !address || !school) {
          alert('Please fill in all required fields.');
          return;
        }
        if (idFile && idFile.size > 5 * 1024 * 1024) {
          document.getElementById('id-error').classList.remove('hidden');
          return;
        }

        // Store profile data temporarily
        tempProfile = { name, gender, phone, email, quote, address, school };

        // Check if school is not in mock or pending schools (with typo tolerance)
        const mockSchools = ['Addis Ababa University', 'Unity University', 'St. Mary School', 'Hillside School'];
        const isSystemSchool = mockSchools.some(s => s.toLowerCase() === school.toLowerCase() || levenshteinDistance(s.toLowerCase(), school.toLowerCase()) <= 2);
        const isPendingSchool = pendingSchools.some(s => s.toLowerCase() === school.toLowerCase() || levenshteinDistance(s.toLowerCase(), school.toLowerCase()) <= 2);

        if (!isSystemSchool && !isPendingSchool) {
          document.getElementById('request-school-name').value = school;
          showModal('request-school-modal');
        } else {
          // Save profile immediately if school is in system or pending
          profile = tempProfile;
          tempProfile = null;
          closeModal('edit-verify-profile-modal');
          updateVerificationCard();
          alert('Profile updated successfully!');
          previousSchool = school;
        }
      }

      // Verification Card Update
      function updateVerificationCard() {
        document.getElementById('tutor-name').textContent = profile.name;
        document.getElementById('tutor-gender').textContent = profile.gender;
        document.getElementById('tutor-phone').textContent = profile.phone;
        document.getElementById('tutor-email').textContent = profile.email;
        document.getElementById('tutor-quote').textContent = profile.quote;
        document.getElementById('tutor-address').textContent = profile.address;
        // Check if school is in mock system and append "(pending)" if not
        const mockSchools = ['Addis Ababa University', 'Unity University', 'St. Mary School', 'Hillside School'];
        const schoolDisplay = mockSchools.includes(profile.school) ? profile.school : `${profile.school} (pending)`;
        document.getElementById('tutor-school').textContent = schoolDisplay;
        document.getElementById('tutor-verification-status').textContent = verificationStatus;
        // Show "Get Verified" button only if tutor data is not set or school has changed
        const isTutorDataNotSet = Object.values(profile).some(value => value === 'Not set');
        const hasSchoolChanged = profile.school !== previousSchool;
        document.getElementById('get-verified-btn').style.display = (isTutorDataNotSet || hasSchoolChanged) ? 'inline-block' : 'none';
      }

      // Get Verified Button
      document.getElementById('get-verified-btn').addEventListener('click', () => {
        // Validate payment details
        if (!bankDetails.bankName || bankDetails.bankName === 'Not set' || !bankDetails.accountNumber || bankDetails.accountNumber === 'Not set') {
          alert('Please fill in all required data first. Set your payment details in the Payment Details tab.');
          return;
        }

        // Check profile fields, ID, and selfie status
        const name = profile.name;
        const gender = profile.gender;
        const phone = profile.phone;
        const email = profile.email;
        const address = profile.address;
        const school = profile.school;
        const idFile = document.getElementById('id-input').files[0];
        const faceScanStatus = document.getElementById('face-scan-status').textContent;

        // If any validation fails, show alert and do not proceed
        if (!name || !gender || !phone || !email || !address || !school || !idFile || idFile.size > 5 * 1024 * 1024 || faceScanStatus !== 'Selfie captured successfully!') {
          alert('Please fill in all required data first. Complete your profile, upload an ID document, and capture a selfie in the Edit Profile section.');
          return;
        }

        // If all validations pass, set status to "Under Verification"
        verificationStatus = 'Under Verification';
        updateVerificationCard();
        alert('Verification request submitted! Your profile is now under verification.');
      });

      // Payment Details Form Submission
      document.getElementById('paymentDetailsForm').addEventListener('submit', (e) => {
        e.preventDefault();
        const bankName = document.getElementById('bankName').value;
        const accountNumber = document.getElementById('accountNumber').value;
        if (bankName && accountNumber) {
          bankDetails.bankName = bankName;
          bankDetails.accountNumber = accountNumber;
          alert('Payment details saved successfully!');
          if (document.getElementById('samePaymentDetails').checked) {
            document.getElementById('updateBankName').value = bankName;
            document.getElementById('updateAccountNumber').value = accountNumber;
          }
          displayCourses();
        } else {
          alert('Please fill in all payment details.');
        }
      });

      // Auto-fill Payment Details
      document.getElementById('samePaymentDetails').addEventListener('change', (e) => {
        const bankName = document.getElementById('bankName').value;
        const accountNumber = document.getElementById('accountNumber').value;
        const updateBankName = document.getElementById('updateBankName');
        const updateAccountNumber = document.getElementById('updateAccountNumber');
        if (e.target.checked) {
          updateBankName.value = bankName;
          updateAccountNumber.value = accountNumber;
          updateBankName.disabled = true;
          updateAccountNumber.disabled = true;
        } else {
          updateBankName.disabled = false;
          updateAccountNumber.disabled = false;
        }
      });

      // Add Course Functionality
      document.getElementById('addCourseBtn').addEventListener('click', () => {
        const coursesContainer = document.getElementById('coursesContainer');
        const courseTemplate = coursesContainer.querySelector('.course-entry').cloneNode(true);
        courseTemplate.querySelector('.course-name').value = '';
        courseTemplate.querySelector('.payment-frequency').value = '2-weeks';
        courseTemplate.querySelector('.hourly-rate').value = '';
        courseTemplate.querySelector('.discount-3months').value = '0';
        courseTemplate.querySelector('.discount-6months').value = '0';
        courseTemplate.querySelector('.discount-yearly').value = '0';
        courseTemplate.querySelector('.remove-course-btn').classList.remove('hidden');
        coursesContainer.appendChild(courseTemplate);
        updateRemoveButtons();
      });

      // Remove Course Functionality
      function updateRemoveButtons() {
        const removeButtons = document.querySelectorAll('.remove-course-btn');
        const courseEntries = document.querySelectorAll('.course-entry');
        removeButtons.forEach((btn, index) => {
          btn.classList.toggle('hidden', courseEntries.length === 1);
          btn.onclick = () => {
            if (courseEntries.length > 1) {
              btn.closest('.course-entry').remove();
              updateRemoveButtons();
            }
          };
        });
      }

      // Initialize Remove Buttons
      updateRemoveButtons();

      // Set Package Form Submission
      document.getElementById('setPackageForm').addEventListener('submit', (e) => {
        e.preventDefault();
        const courseEntries = document.querySelectorAll('.course-entry');
        let valid = true;
        courses = [];
        courseEntries.forEach(entry => {
          const courseName = entry.querySelector('.course-name').value;
          const paymentFrequency = entry.querySelector('.payment-frequency').value;
          const hourlyRate = parseFloat(entry.querySelector('.hourly-rate').value);
          const discount3Months = parseFloat(entry.querySelector('.discount-3months').value) || 0;
          const discount6Months = parseFloat(entry.querySelector('.discount-6months').value) || 0;
          const discountYearly = parseFloat(entry.querySelector('.discount-yearly').value) || 0;

          if (!courseName || isNaN(hourlyRate) || hourlyRate < 0 ||
            discount3Months < 0 || discount3Months > 100 ||
            discount6Months < 0 || discount6Months > 100 ||
            discountYearly < 0 || discountYearly > 100) {
            valid = false;
            alert('Please fill in all required fields with valid values for each course.');
          } else {
            courses.push({
              courseName,
              feeType: 'hourly',
              paymentFrequency,
              hourlyRate,
              discount3Months,
              discount6Months,
              discountYearly
            });
          }
        });
        if (valid) {
          bankDetails.bankName = document.getElementById('updateBankName').value;
          bankDetails.accountNumber = document.getElementById('updateAccountNumber').value || 'Not set';
          alert('Package updated successfully!');
          displayCourses();
        }
      });

      function displayCourses() {
        const coursesDisplay = document.getElementById('coursesDisplay');
        const daysPerWeek = parseInt(document.getElementById('days-per-week').value) || parentStudentRequest.daysPerWeek;
        const hoursPerDay = parseInt(document.getElementById('hours-per-day').value) || parentStudentRequest.hoursPerDay;
        const hoursPerWeek = daysPerWeek * hoursPerDay;

        coursesDisplay.innerHTML = '';
        if (courses.length === 0) {
          coursesDisplay.innerHTML = '<p class="text-gray-600">No courses have been set.</p>';
        } else {
          courses.forEach((course, index) => {
            const courseDiv = document.createElement('div');
            courseDiv.className = 'border p-4 rounded-md bg-gray-50';
            const weeksPerCycle = course.paymentFrequency === '2-weeks' ? 2 : 4;
            const basePricePerCycle = course.hourlyRate * hoursPerWeek * weeksPerCycle;
            const priceShortTerm = basePricePerCycle * (1 - course.discount3Months / 100);
            const price3Months = basePricePerCycle * (1 - course.discount3Months / 100);
            const price6Months = basePricePerCycle * (1 - course.discount6Months / 100);
            const priceYearly = basePricePerCycle * (1 - course.discountYearly / 100);

            courseDiv.innerHTML = `
                        <h4 class="text-md font-semibold mb-2">Course ${index + 1}: ${course.courseName}</h4>
                        <p><strong>Fee Type:</strong> Hourly</p>
                        <p><strong>Payment Frequency:</strong> ${course.paymentFrequency === '2-weeks' ? '2 Weeks' : 'Monthly'}</p>
                        <p><strong>Availability:</strong> ${daysPerWeek} days/week, ${hoursPerDay} hours/day (${hoursPerWeek} hours/week)</p>
                        <p><strong>Price (${course.paymentFrequency === '2-weeks' ? '2 Weeks' : '1 Month'}):</strong> 
                            ${course.discount3Months > 0 ? `<s>${basePricePerCycle.toFixed(2)} ETB</s> ` : ''}${priceShortTerm.toFixed(2)} ETB 
                            ${course.discount3Months > 0 ? `(${course.discount3Months}% discount)` : ''}
                        </p>
                        <p><strong>Price (3 Months):</strong> 
                            ${course.discount3Months > 0 ? `<s>${basePricePerCycle.toFixed(2)} ETB</s> ` : ''}${price3Months.toFixed(2)} ETB 
                            ${course.discount3Months > 0 ? `(${course.discount3Months}% discount)` : ''}
                        </p>
                        <p><strong>Price (6 Months):</strong> 
                            ${course.discount6Months > 0 ? `<s>${basePricePerCycle.toFixed(2)} ETB</s> ` : ''}${price6Months.toFixed(2)} ETB 
                            ${course.discount6Months > 0 ? `(${course.discount6Months}% discount)` : ''}
                        </p>
                        <p><strong>Price (Yearly):</strong> 
                            ${course.discountYearly > 0 ? `<s>${basePricePerCycle.toFixed(2)} ETB</s> ` : ''}${priceYearly.toFixed(2)} ETB 
                            ${course.discountYearly > 0 ? `(${course.discountYearly}% discount)` : ''}
                        </p>
                    `;
            coursesDisplay.appendChild(courseDiv);
          });
        }
        document.getElementById('displayBankName').textContent = bankDetails.bankName;
        document.getElementById('displayAccountNumber').textContent = bankDetails.accountNumber;
      }

      // Calculate Fees Button
      document.getElementById('calculate-fees').addEventListener('click', () => {
        const daysPerWeek = parseInt(document.getElementById('days-per-week').value);
        const hoursPerDay = parseInt(document.getElementById('hours-per-day').value);
        if (isNaN(daysPerWeek) || isNaN(hoursPerDay) || daysPerWeek < 1 || daysPerWeek > 7 || hoursPerDay < 1 || hoursPerDay > 24) {
          alert('Please enter valid values for days per week (1-7) and hours per day (1-24).');
          return;
        }
        parentStudentRequest = { daysPerWeek, hoursPerDay };
        displayCourses();
      });

      // Subscription Button Handling
      document.querySelectorAll('.subscribe-btn').forEach(button => {
        button.addEventListener('click', (e) => {
          // Check verification status before allowing subscription
          if (verificationStatus !== 'Verified') {
            alert('You must be verified to subscribe to a plan. Please complete verification in the Edit Profile section.');
            return;
          }

          if (button.textContent === 'Switch to Plan') {
            const type = button.getAttribute('data-type');
            const currentDuration = button.getAttribute('data-duration');
            openManageSubscriptionModal(type, currentDuration);
          } else {
            const price = parseFloat(button.getAttribute('data-price'));
            const type = button.getAttribute('data-type');
            const duration = button.getAttribute('data-duration');
            // Cancel any existing page subscription if subscribing to an ad plan
            if (type === 'ad' && activeSubscriptions['page']) {
              const oldPageSubscribeBtn = document.querySelector(`.subscribe-btn[data-type="page"][data-duration="${activeSubscriptions['page'].duration}"]`);
              if (oldPageSubscribeBtn) {
                oldPageSubscribeBtn.textContent = 'Subscribe';
                oldPageSubscribeBtn.classList.remove('bg-blue-500', 'hover:bg-blue-600');
                oldPageSubscribeBtn.classList.add('bg-blue-600', 'hover:bg-blue-700');
                oldPageSubscribeBtn.parentElement.querySelector('.cancel-btn').classList.add('hidden');
                delete activeSubscriptions['page'];
              }
            }
            button.textContent = 'Switch to Plan';
            button.classList.remove('bg-blue-600', 'hover:bg-blue-700');
            button.classList.add('bg-blue-500', 'hover:bg-blue-600');
            const cancelBtn = button.parentElement.querySelector('.cancel-btn');
            cancelBtn.classList.remove('hidden');
            activeSubscriptions[type] = { duration, price };
            alert(`Subscribed to ${type} plan for ${duration} at ${price} ETB!`);
          }
        });
      });

      // Cancel Subscription Button Handling
      document.querySelectorAll('.cancel-btn').forEach(button => {
        button.addEventListener('click', () => {
          const price = parseFloat(button.getAttribute('data-price'));
          const type = button.getAttribute('data-type');
          const duration = button.getAttribute('data-duration');
          currentUnsubscribe = { button, price, type, duration };
          unsubscribe();
        });
      });

      // Switch to Plan Modal Handling
      function openManageSubscriptionModal(type, currentDuration) {
        // Check verification status before allowing plan switch
        if (verificationStatus !== 'Verified') {
          alert('You must be verified to switch plans. Please complete verification in the Edit Profile section.');
          return;
        }

        const modal = document.getElementById('manageSubscriptionModal');
        const optionsContainer = document.getElementById('subscriptionOptions');
        optionsContainer.innerHTML = '';
        const plans = subscriptionPlans[type].filter(plan => plan.duration !== currentDuration);
        if (plans.length === 0) {
          optionsContainer.innerHTML = '<p class="text-gray-600">No other plans available.</p>';
        } else {
          plans.forEach(plan => {
            const planDiv = document.createElement('div');
            planDiv.className = 'border p-4 rounded-md bg-gray-50';
            planDiv.innerHTML = `
                        <h5 class="text-md font-semibold">${plan.duration.replace('-', ' ')}${plan.duration === '1-month' && type === 'page' ? ' (Basic)' : ''}</h5>
                        <p>Price: ${plan.originalPrice !== plan.price ? `<s>${plan.originalPrice} ETB</s> ${plan.price} ETB` : `${plan.price} ETB`}</p>
                        <p>Page Search Visibility: ${plan.visibility}</p>
                        <p>Video Search Visibility: ${plan.visibility}</p>
                        <button class="switch-plan-btn mt-2 bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 transition duration-200" 
                                data-type="${type}" 
                                data-duration="${plan.duration}" 
                                data-price="${plan.price}" 
                                data-visibility="${plan.visibility}">
                            Switch to Plan
                        </button>
                    `;
            optionsContainer.appendChild(planDiv);
          });
        }
        modal.style.display = 'flex';
        document.querySelectorAll('.switch-plan-btn').forEach(btn => {
          btn.addEventListener('click', () => {
            const newType = btn.getAttribute('data-type');
            const newDuration = btn.getAttribute('data-duration');
            const newPrice = parseFloat(btn.getAttribute('data-price'));
            // Cancel the current plan without payment or questioning
            const oldSubscribeBtn = document.querySelector(`.subscribe-btn[data-type="${newType}"][data-duration="${activeSubscriptions[newType]?.duration}"]`);
            if (oldSubscribeBtn) {
              oldSubscribeBtn.textContent = 'Subscribe';
              oldSubscribeBtn.classList.remove('bg-blue-500', 'hover:bg-blue-600');
              oldSubscribeBtn.classList.add('bg-blue-600', 'hover:bg-blue-700');
              oldSubscribeBtn.parentElement.querySelector('.cancel-btn').classList.add('hidden');
              delete activeSubscriptions[newType];
              // Cancel any existing page subscription if switching to an ad plan
              if (newType === 'ad' && activeSubscriptions['page']) {
                const oldPageSubscribeBtn = document.querySelector(`.subscribe-btn[data-type="page"][data-duration="${activeSubscriptions['page'].duration}"]`);
                if (oldPageSubscribeBtn) {
                  oldPageSubscribeBtn.textContent = 'Subscribe';
                  oldPageSubscribeBtn.classList.remove('bg-blue-500', 'hover:bg-blue-600');
                  oldPageSubscribeBtn.classList.add('bg-blue-600', 'hover:bg-blue-700');
                  oldPageSubscribeBtn.parentElement.querySelector('.cancel-btn').classList.add('hidden');
                  delete activeSubscriptions['page'];
                }
              }
              // Activate the new plan
              const newSubscribeBtn = document.querySelector(`.subscribe-btn[data-type="${newType}"][data-duration="${newDuration}"]`);
              if (newSubscribeBtn) {
                newSubscribeBtn.textContent = 'Switch to Plan';
                newSubscribeBtn.classList.remove('bg-blue-600', 'hover:bg-blue-700');
                newSubscribeBtn.classList.add('bg-blue-500', 'hover:bg-blue-600');
                newSubscribeBtn.parentElement.querySelector('.cancel-btn').classList.remove('hidden');
              }
              activeSubscriptions[newType] = { duration: newDuration, price: newPrice };
              alert(`Switched to ${newType} plan for ${newDuration} at ${newPrice} ETB!`);
              closeModal('manageSubscriptionModal');
            }
          });
        });
      }

      // Unsubscribe Flow
      function unsubscribe() {
        showModal('unsubscribeModal1');
      }

      // Unsubscribe Modal Step 1: Reasons
      document.getElementById('unsubscribeOther').addEventListener('change', (e) => {
        document.getElementById('otherText').style.display = e.target.checked ? 'block' : 'none';
      });

      document.getElementById('unsubscribeSubmitBtn').addEventListener('click', () => {
        const reasons = Array.from(document.querySelectorAll('input[name="unsubscribeReason"]:checked')).map(input => input.value);
        const otherText = document.getElementById('otherText').value;
        if (reasons.length === 0) {
          alert('Please select at least one reason.');
          return;
        }
        if (reasons.includes('other') && !otherText) {
          alert('Please specify the reason for "Other".');
          return;
        }
        closeModal('unsubscribeModal1');
        document.getElementById('unsubscribeFirstConfirmText').textContent = `This decision will deactivate your ${currentUnsubscribe.type} subscription for ${currentUnsubscribe.duration}.`;
        showModal('unsubscribeConfirm1');
      });

      document.getElementById('unsubscribeCancelBtn1').addEventListener('click', () => {
        closeModal('unsubscribeModal1');
        currentUnsubscribe = null;
      });

      // Unsubscribe Modal Step 2: First Confirmation
      document.getElementById('unsubscribeYesBtn1').addEventListener('click', () => {
        closeModal('unsubscribeConfirm1');
        const fee = currentUnsubscribe.price * 0.05;
        document.getElementById('unsubscribeSecondConfirmText').textContent = `Subscription cancellation has a fee of 5% (${fee.toFixed(2)} ETB). Are you still sure to cancel subscription?`;
        showModal('unsubscribeConfirm2');
      });

      document.getElementById('unsubscribeCancelBtn2').addEventListener('click', () => {
        closeModal('unsubscribeConfirm1');
        currentUnsubscribe = null;
      });

      // Unsubscribe Modal Step 3: Second Confirmation
      document.getElementById('unsubscribeYesBtn2').addEventListener('click', () => {
        closeModal('unsubscribeConfirm2');
        showModal('unsubscribePasswordModal');
      });

      document.getElementById('unsubscribeCancelBtn3').addEventListener('click', () => {
        closeModal('unsubscribeConfirm2');
        currentUnsubscribe = null;
      });

      // Unsubscribe Modal Step 4: Password
      document.getElementById('unsubscribeSubmitPasswordBtn').addEventListener('click', () => {
        const password = document.getElementById('unsubscribePassword').value;
        if (!password) {
          alert('Please enter your password.');
          return;
        }
        // Mock password check
        if (password === 'password123') {
          closeModal('unsubscribePasswordModal');
          const { button, type, duration } = currentUnsubscribe;
          button.textContent = 'Subscribe';
          button.classList.remove('bg-blue-500', 'hover:bg-blue-600');
          button.classList.add('bg-blue-600', 'hover:bg-blue-700');
          button.parentElement.querySelector('.cancel-btn').classList.add('hidden');
          delete activeSubscriptions[type];
          showModal('unsubscribeModal3');
          currentUnsubscribe = null;
        } else {
          alert('Incorrect password.');
        }
      });

      document.getElementById('unsubscribeCancelBtn4').addEventListener('click', () => {
        closeModal('unsubscribePasswordModal');
        currentUnsubscribe = null;
      });

      // Unsubscribe Modal Step 5: Final Message
      document.getElementById('unsubscribeCloseBtn').addEventListener('click', () => {
        closeModal('unsubscribeModal3');
      });

      // Delete Account Flow
      document.getElementById('leaveAstegniBtn').addEventListener('click', () => {
        if (isAccountDeleted) {
          alert('Your account is already deleted.');
          return;
        }
        showModal('deleteModal1');
      });

      // Delete Modal Step 1: Reasons
      document.getElementById('deleteOther').addEventListener('change', (e) => {
        document.getElementById('otherTextDelete').style.display = e.target.checked ? 'block' : 'none';
      });

      document.getElementById('deleteSubmitBtn').addEventListener('click', () => {
        const reasons = Array.from(document.querySelectorAll('input[name="deleteReason"]:checked')).map(input => input.value);
        const otherText = document.getElementById('otherTextDelete').value;
        if (reasons.length === 0) {
          alert('Please select at least one reason.');
          return;
        }
        if (reasons.includes('other') && !otherText) {
          alert('Please specify the reason for "Other".');
          return;
        }
        closeModal('deleteModal1');
        // Check verification status and calculate fee
        const verificationFee = verificationStatus === 'Verified' ? 990 * 0.15 : 0;
        document.getElementById('deleteVerifyText').textContent = `This decision will unverify and deactivate your account. A 15% verification fee (${verificationFee.toFixed(2)} ETB) will be charged if applicable.`;
        showModal('deleteVerifyModal');
      });

      document.getElementById('deleteCancelBtn1').addEventListener('click', () => {
        closeModal('deleteModal1');
      });

      // Delete Modal Step 2: Verification Check
      document.getElementById('deleteYesBtn').addEventListener('click', () => {
        closeModal('deleteVerifyModal');
        // Check for active subscriptions
        if (Object.keys(activeSubscriptions).length > 0) {
          showModal('deleteSubscriptionCheckModal');
        } else {
          showModal('deleteConfirm2');
        }
      });

      document.getElementById('deleteCancelBtn2').addEventListener('click', () => {
        closeModal('deleteVerifyModal');
      });

      // Delete Modal Step 3: Subscription Check
      document.getElementById('deleteCancelBtn3').addEventListener('click', () => {
        closeModal('deleteSubscriptionCheckModal');
      });

      // Delete Modal Step 4: Password
      document.getElementById('deleteSubmitPasswordBtn').addEventListener('click', () => {
        const password = document.getElementById('deletePassword').value;
        if (!password) {
          alert('Please enter your password.');
          return;
        }
        // Mock password check
        if (password === 'password123') {
          closeModal('deleteConfirm2');
          isAccountDeleted = true;
          verificationStatus = 'Not Verified';
          activeSubscriptions = {};
          profile = {
            name: 'Not set',
            gender: 'Not set',
            phone: 'Not set',
            email: 'Not set',
            quote: 'Not set',
            address: 'Not set',
            school: 'Not set'
          };
          updateVerificationCard();
          showModal('deleteModal3');
        } else {
          alert('Incorrect password.');
        }
      });

      document.getElementById('deleteCancelBtn4').addEventListener('click', () => {
        closeModal('deleteConfirm2');
      });

      // Delete Modal Step 5: Final Message
      document.getElementById('deleteCloseBtn').addEventListener('click', () => {
        closeModal('deleteModal3');
      });

      // Analytics Chart
      let analyticsChart = null;
      function updateAnalyticsChart() {
        const ctx = document.getElementById('analyticsChart').getContext('2d');
        const period = document.getElementById('analyticsPeriod').value;
        let labels, incomeData, paymentData;

        switch (period) {
          case '1-day':
            labels = ['Day 1'];
            incomeData = [7500];
            paymentData = [3000];
            break;
          case '3-days':
            labels = ['Day 1', 'Day 2', 'Day 3'];
            incomeData = [2500, 3000, 2000];
            paymentData = [1000, 1200, 800];
            break;
          case '1-week':
            labels = ['Day 1', 'Day 2', 'Day 3', 'Day 4', 'Day 5', 'Day 6', 'Day 7'];
            incomeData = [1000, 1200, 1100, 1300, 1400, 1100, 900];
            paymentData = [400, 500, 450, 550, 600, 400, 300];
            break;
          case '2-weeks':
            labels = Array.from({ length: 14 }, (_, i) => `Day ${i + 1}`);
            incomeData = Array(14).fill(0).map(() => Math.random() * 1000 + 500);
            paymentData = Array(14).fill(0).map(() => Math.random() * 400 + 100);
            break;
          case '1-month':
            labels = Array.from({ length: 30 }, (_, i) => `Day ${i + 1}`);
            incomeData = Array(30).fill(0).map(() => Math.random() * 1000 + 500);
            paymentData = Array(30).fill(0).map(() => Math.random() * 400 + 100);
            break;
          case '3-months':
            labels = ['Month 1', 'Month 2', 'Month 3'];
            incomeData = [7500, 8000, 7000];
            paymentData = [3000, 3200, 2800];
            break;
          case '6-months':
            labels = ['Month 1', 'Month 2', 'Month 3', 'Month 4', 'Month 5', 'Month 6'];
            incomeData = [7500, 8000, 7000, 7200, 7600, 7400];
            paymentData = [3000, 3200, 2800, 2900, 3100, 3000];
            break;
          case '1-year':
            labels = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];
            incomeData = [7500, 8000, 7000, 7200, 7600, 7400, 7800, 7900, 7700, 7500, 7300, 7400];
            paymentData = [3000, 3200, 2800, 2900, 3100, 3000, 3100, 3200, 3000, 2900, 2800, 3000];
            break;
          default:
            labels = ['Day 1'];
            incomeData = [7000];
            paymentData = [3000];
        }

        if (analyticsChart) {
          analyticsChart.destroy();
        }

        analyticsChart = new Chart(ctx, {
          type: 'line',
          data: {
            labels: labels,
            datasets: [
              {
                label: 'Income (ETB)',
                data: incomeData,
                borderColor: 'rgb(75, 192, 192)',
                fill: false
              },
              {
                label: 'Payments (ETB)',
                data: paymentData,
                borderColor: 'rgb(255, 99, 132)',
                fill: false
              }
            ]
          },
          options: {
            responsive: true,
            maintainAspectRatio: false
          }
        });
      }

      document.getElementById('analyticsPeriod').addEventListener('change', updateAnalyticsChart);

      // Toggle Income Visibility
      document.getElementById('toggleIncome').addEventListener('click', () => {
        const totalIncome = document.getElementById('totalIncome');
        totalIncome.textContent = totalIncome.textContent.includes('â˜…â˜…â˜…') ? 'Total Income: 7500 ETB' : 'Total Income: â˜…â˜…â˜…';
      });

      // Open Manage Finances Modal
      document.getElementById('manage-finance-btn').addEventListener('click', openManageFinances);

      // Close Manage Finances Modal
      document.getElementById('closeModal').addEventListener('click', () => {
        closeModal('manageFinanceModal');
      });

      // Close Manage Subscription Modal
      document.getElementById('closeManageModal').addEventListener('click', () => {
        closeModal('manageSubscriptionModal');
      });

      // Edit Profile Modal Handling
      document.getElementById('edit-verify-profile-btn').addEventListener('click', () => {
        document.getElementById('profile-name').value = profile.name !== 'Not set' ? profile.name : '';
        document.getElementById('profile-gender').value = profile.gender !== 'Not set' ? profile.gender : '';
        document.getElementById('profile-phone').value = profile.phone !== 'Not set' ? profile.phone : '';
        document.getElementById('profile-email').value = profile.email !== 'Not set' ? profile.email : '';
        document.getElementById('profile-quote').value = profile.quote !== 'Not set' ? profile.quote : '';
        document.getElementById('profile-address').value = profile.address !== 'Not set' ? profile.address : '';
        document.getElementById('profile-school').value = profile.school !== 'Not set' ? profile.school : '';
        document.getElementById('face-scan-status').textContent = 'No selfie captured.';
        document.getElementById('id-preview').innerHTML = '';
        showModal('edit-verify-profile-modal');
      });

      // Save Profile Button
      document.getElementById('saveProfileBtn').addEventListener('click', saveProfile);

      // Cancel Profile Button
      document.getElementById('cancelProfileBtn').addEventListener('click', () => {
        closeModal('edit-verify-profile-modal');
      });

      // School Search with Suggestions
      document.getElementById('profile-school').addEventListener('input', (e) => {
        const input = e.target.value.toLowerCase();
        const suggestionsContainer = document.getElementById('school-suggestions');
        const mockSchools = ['Addis Ababa University', 'Unity University', 'St. Mary School', 'Hillside School'];
        suggestionsContainer.innerHTML = '';
        const requestSchoolBtn = document.getElementById('request-school-btn');
        requestSchoolBtn.classList.add('hidden');

        if (input) {
          const filteredSchools = mockSchools.filter(school =>
            school.toLowerCase().includes(input) || levenshteinDistance(school.toLowerCase(), input) <= 2
          );
          if (filteredSchools.length > 0) {
            filteredSchools.forEach(school => {
              const div = document.createElement('div');
              div.className = 'p-2 hover:bg-gray-100 cursor-pointer';
              div.textContent = school;
              div.onclick = () => {
                document.getElementById('profile-school').value = school;
                suggestionsContainer.classList.add('hidden');
              };
              suggestionsContainer.appendChild(div);
            });
            suggestionsContainer.classList.remove('hidden');
          } else {
            suggestionsContainer.classList.add('hidden');
            requestSchoolBtn.classList.remove('hidden');
          }
        } else {
          suggestionsContainer.classList.add('hidden');
        }
      });

      // Request School Listing
      document.getElementById('request-school-btn').addEventListener('click', () => {
        document.getElementById('request-school-name').value = document.getElementById('profile-school').value;
        showModal('request-school-modal');
      });

      // Submit School Request
      document.getElementById('submitSchoolRequestBtn').addEventListener('click', () => {
        const schoolName = document.getElementById('request-school-name').value;
        const phone = document.getElementById('request-school-phone').value;
        const email = document.getElementById('request-school-email').value;
        const location = document.getElementById('request-school-location').value;

        if (!schoolName || !phone || !email || !location) {
          alert('Please fill in all required fields.');
          return;
        }

        // Add to pending schools
        pendingSchools.push(schoolName);
        closeModal('request-school-modal');
        if (tempProfile) {
          profile = tempProfile;
          tempProfile = null;
          closeModal('edit-verify-profile-modal');
          updateVerificationCard();
          alert('Profile updated and school request submitted successfully!');
          previousSchool = profile.school;
        } else {
          alert('School request submitted successfully!');
        }
      });

      // Cancel School Request
      document.getElementById('cancelSchoolRequestBtn').addEventListener('click', () => {
        closeModal('request-school-modal');
        if (tempProfile) {
          document.getElementById('profile-school').value = previousSchool;
          tempProfile = null;
        }
      });

      // Use My Location
      document.getElementById('use-my-location').addEventListener('click', () => {
        if (navigator.geolocation) {
          navigator.geolocation.getCurrentPosition(
            (position) => {
              const { latitude, longitude } = position.coords;
              // Mock geocoding
              document.getElementById('profile-address').value = `Lat: ${latitude.toFixed(4)}, Lon: ${longitude.toFixed(4)}`;
              document.getElementById('location-error').classList.add('hidden');
            },
            () => {
              document.getElementById('location-error').classList.remove('hidden');
            }
          );
        } else {
          document.getElementById('location-error').classList.remove('hidden');
        }
      });

      // ID File Upload
      document.getElementById('id-input').addEventListener('change', (e) => {
        const file = e.target.files[0];
        const idError = document.getElementById('id-error');
        const idPreview = document.getElementById('id-preview');
        idPreview.innerHTML = '';
        idError.classList.add('hidden');

        if (file) {
          if (file.size > 5 * 1024 * 1024) {
            idError.classList.remove('hidden');
            return;
          }
          if (file.type.startsWith('image/')) {
            const img = document.createElement('img');
            img.src = URL.createObjectURL(file);
            img.className = 'w-full h-32 object-cover rounded-md';
            idPreview.appendChild(img);
          } else if (file.type === 'application/pdf') {
            idPreview.innerHTML = `<p>Uploaded PDF: ${file.name}</p>`;
          }
        }
      });

      // Face Scan
      document.getElementById('face-scan-btn').addEventListener('click', () => {
        // Mock face scan
        document.getElementById('face-scan-status').textContent = 'Selfie captured successfully!';
      });


      // Rate ASTEGNI Modal
      function openRateAstegniModal() {
        openModal('rate-astegni-modal');
      }

      function closeRateAstegniModal() {
        closeModal('rate-astegni-modal');
      }

      function submitAstegniRating() {
        const usability = document.getElementById('usability-rating').value;
        const service = document.getElementById('service-rating').value;
        const comment = document.getElementById('astegni-comment').value;
        // Simulate submission
        alert(`Rating submitted: Usability ${usability}/5, Service ${service}/5, Comment: ${comment}`);
        closeRateAstegniModal();
      }

      // Share Profile Modal
      function openShareProfileModal() {
        openModal('share-profile-modal');
      }

      function closeShareProfileModal() {
        closeModal('share-profile-modal');
      }

      function copyProfileLink() {
        const link = document.getElementById('profile-link');
        link.select();
        document.execCommand('copy');
        alert('Profile link copied!');
      }

      // Notification Modal
      function openNotificationModal() {
        document.getElementById('notification-dot').classList.add('hidden');
        document.getElementById('mobile-notification-dot').classList.add('hidden');
        openModal('notification-modal');
      }

      function closeNotificationModal() {
        closeModal('notification-modal');
      }

      function openUploadCoverPhotoModal() {
        openModal('upload-cover-photo-modal');
        const fileInput = document.getElementById('cover-photo-file');
        fileInput.value = '';
        const preview = document.getElementById('cover-photo-preview');
        preview.innerHTML = '';
        fileInput.addEventListener('change', () => {
          const file = fileInput.files[0];
          if (file && file.size <= 5 * 1024 * 1024 && ['image/jpeg', 'image/png'].includes(file.type)) {
            const reader = new FileReader();
            reader.onload = () => {
              preview.innerHTML = `<img src="${reader.result}" alt="Cover Preview">`;
            };
            reader.readAsDataURL(file);
            document.getElementById('cover-photo-error').classList.add('hidden');
          } else {
            preview.innerHTML = '';
            document.getElementById('cover-photo-error').classList.remove('hidden');
          }
        });
      }




      function closeUploadCoverPhotoModal() {
        closeModal('upload-cover-photo-modal');
      }

      function submitCoverPhoto() {
        const fileInput = document.getElementById('cover-photo-file');
        const file = fileInput.files[0];
        if (file && file.size <= 5 * 1024 * 1024 && ['image/jpeg', 'image/png'].includes(file.type)) {
          const reader = new FileReader();
          reader.onload = () => {
            document.getElementById('cover-photo').style.backgroundImage = `url(${reader.result})`;
          };
          reader.readAsDataURL(file);
          closeUploadCoverPhotoModal();
        } else {
          document.getElementById('cover-photo-error').classList.remove('hidden');
        }
      }

      // Upload Profile Photo Modal
      function openUploadProfilePhotoModal() {
        openModal('upload-profile-photo-modal');
        const fileInput = document.getElementById('profile-photo-file');
        fileInput.value = '';
        const preview = document.getElementById('profile-photo-preview');
        preview.innerHTML = '';
        fileInput.addEventListener('change', () => {
          const file = fileInput.files[0];
          if (file && file.size <= 5 * 1024 * 1024 && ['image/jpeg', 'image/png'].includes(file.type)) {
            const reader = new FileReader();
            reader.onload = () => {
              preview.innerHTML = `<img src="${reader.result}" alt="Profile Preview">`;
            };
            reader.readAsDataURL(file);
            document.getElementById('profile-photo-error').classList.add('hidden');
          } else {
            preview.innerHTML = '';
            document.getElementById('profile-photo-error').classList.remove('hidden');
          }
        });
      }

      function closeUploadProfilePhotoModal() {
        closeModal('upload-profile-photo-modal');
      }

      function submitProfilePhoto() {
        const fileInput = document.getElementById('profile-photo-file');
        const file = fileInput.files[0];
        if (file && file.size <= 5 * 1024 * 1024 && ['image/jpeg', 'image/png'].includes(file.type)) {
          const reader = new FileReader();
          reader.onload = () => {
            document.getElementById('profile-picture').src = reader.result;
          };
          reader.readAsDataURL(file);
          closeUploadProfilePhotoModal();
        } else {
          document.getElementById('profile-photo-error').classList.remove('hidden');
        }
      }

      // Edit About Me Modal
      function openEditAboutMeModal() {
        document.getElementById('about-me-input').value = document.getElementById('tutor-bio').textContent;
        openModal('edit-about-me-modal');
      }

      function closeEditAboutMeModal() {
        closeModal('edit-about-me-modal');
      }

      function submitAboutMe() {
        const bio = document.getElementById('about-me-input').value;
        document.getElementById('tutor-bio').textContent = bio;
        closeEditAboutMeModal();
      }

      // Edit Certifications Modal
      function openEditCertificationsModal() {
        openModal('edit-certifications-modal');
      }

      function closeEditCertificationsModal() {
        closeModal('edit-certifications-modal');
      }

      function addCertification() {
        const container = document.getElementById('certifications-container');
        const entry = container.querySelector('.certification-entry').cloneNode(true);
        entry.querySelector('.cert-school').value = '';
        entry.querySelector('.cert-subject').value = '';
        entry.querySelector('.cert-type').value = '';
        entry.querySelector('.cert-date').value = '';
        entry.querySelector('.cert-file').value = '';
        entry.querySelector('button').classList.remove('hidden');
        container.appendChild(entry);
      }

      function removeCertification(btn) {
        if (document.querySelectorAll('.certification-entry').length > 1) {
          btn.parentElement.remove();
        }
      }

      function submitCertifications() {
        const entries = document.querySelectorAll('.certification-entry');
        const certifications = Array.from(entries).map(entry => ({
          school: entry.querySelector('.cert-school').value,
          subject: entry.querySelector('.cert-subject').value,
          type: entry.querySelector('.cert-type').value,
          date: entry.querySelector('.cert-date').value,
          file: entry.querySelector('.cert-file').files[0],
        }));
        // Simulate submission
        const certContainer = document.getElementById('tutor-certifications');
        certContainer.innerHTML = certifications.map(c => `<p>${c.type} in ${c.subject} from ${c.school} (${c.date})</p>`).join('');
        closeEditCertificationsModal();
      }

      // Edit Socials Modal
      function openEditSocialsModal() {
        openModal('edit-socials-modal');
      }

      function closeEditSocialsModal() {
        closeModal('edit-socials-modal');
      }

      function addSocialLink() {
        const container = document.getElementById('socials-container');
        const entry = container.querySelector('.social-entry').cloneNode(true);
        entry.querySelector('.social-link').value = '';
        entry.querySelector('button').classList.remove('hidden');
        container.appendChild(entry);
      }

      function removeSocialLink(index) {
        const entries = document.querySelectorAll('.social-entry');
        if (entries.length > 1) {
          entries[index].remove();
        }
      }

      function submitSocials() {
        const links = Array.from(document.querySelectorAll('.social-link')).map(input => input.value).filter(link => link);
        const socialsContainer = document.getElementById('view-profile-socials');
        socialsContainer.innerHTML = links.map(link => `<a href="${link}" target="_blank" class="text-blue-500 hover:underline">${link}</a>`).join('');
        closeEditSocialsModal();
      }



      // Edit Profile Modal
      function openEditProfileModal() {
        document.getElementById('profile-name').value = document.getElementById('tutor-name').textContent;
        document.getElementById('profile-gender').value = document.getElementById('tutor-gender').textContent.replace('Gender: ', '');
        document.getElementById('profile-phone').value = document.getElementById('tutor-phone').textContent.replace('Phone: ', '');
        document.getElementById('profile-email').value = document.getElementById('tutor-email').textContent.replace('Email: ', '');
        document.getElementById('profile-address').value = document.getElementById('tutor-address').textContent.replace('Address: ', '');
        document.getElementById('profile-school').value = document.getElementById('tutor-school').textContent.replace('Teaches at: ', '');
        document.getElementById('profile-quote').value = document.getElementById('quote').textContent;
        openModal('edit-profile-modal');
      }

      function closeEditProfileModal() {
        closeModal('edit-profile-modal');
      }

      function getLocation() {
        if (navigator.geolocation) {
          navigator.geolocation.getCurrentPosition(
            position => {
              document.getElementById('profile-address').value = `Lat: ${position.coords.latitude}, Lon: ${position.coords.longitude}`;
              document.getElementById('location-error').classList.add('hidden');
            },
            () => {
              document.getElementById('location-error').classList.remove('hidden');
            }
          );
        } else {
          document.getElementById('location-error').classList.remove('hidden');
        }
      }

      function captureSelfie() {
        alert('Selfie capture not implemented.');
        document.getElementById('face-scan-status').textContent = 'Selfie captured.';
      }



      function openVerifyConfirmModal() {
        document.getElementById('verify-name').textContent = `Name: ${document.getElementById('profile-name').value}`;
        document.getElementById('verify-gender').textContent = `Gender: ${document.getElementById('profile-gender').value}`;
        document.getElementById('verify-phone').textContent = `Phone: ${document.getElementById('profile-phone').value}`;
        document.getElementById('verify-email').textContent = `Email: ${document.getElementById('profile-email').value}`;
        document.getElementById('verify-quote').textContent = `Quote: ${document.getElementById('profile-quote').value}`;
        document.getElementById('verify-address').textContent = `Address: ${document.getElementById('profile-address').value}`;
        document.getElementById('verify-school').textContent = `Teaches at: ${document.getElementById('profile-school').value}`;
        const courses = Array.from(document.querySelectorAll('.course-entry')).map(entry =>
          `${entry.querySelector('.course-name').value} (${entry.querySelector('.course-fee').value} ${entry.querySelector('.course-fee-type').value})`
        ).join(', ');
        document.getElementById('verify-courses').textContent = `Courses: ${courses || 'Not set'}`;
        document.getElementById('verify-bank').textContent = `Bank: ${document.getElementById('bank-select').value}`;
        document.getElementById('verify-account').textContent = `Account: ${document.getElementById('bank-account').value}`;
        openModal('verify-confirm-modal');
      }

      function closeVerifyConfirmModal() {
        closeModal('verify-confirm-modal');
      }

      function submitVerification() {
        document.getElementById('tutor-name').textContent = document.getElementById('profile-name').value;
        document.getElementById('tutor-gender').textContent = `Gender: ${document.getElementById('profile-gender').value}`;
        document.getElementById('tutor-phone').textContent = `Phone: ${document.getElementById('profile-phone').value}`;
        document.getElementById('tutor-email').textContent = `Email: ${document.getElementById('profile-email').value}`;
        document.getElementById('tutor-address').textContent = `Address: ${document.getElementById('profile-address').value}`;
        document.getElementById('tutor-school').textContent = `Teaches at: ${document.getElementById('profile-school').value}`;
        document.getElementById('quote').textContent = document.getElementById('profile-quote').value;
        const courses = Array.from(document.querySelectorAll('.course-entry')).map(entry =>
          `${entry.querySelector('.course-name').value} (${entry.querySelector('.course-fee').value} ${entry.querySelector('.course-fee-type').value})`
        ).join(', ');
        document.getElementById('courses').textContent = `Courses: ${courses || 'Not set'}`;
        document.getElementById('tutor-bank').textContent = `Bank: ${document.getElementById('bank-select').value}`;
        document.getElementById('payment-account').textContent = `Account Number: ${document.getElementById('bank-account').value}`;
        closeVerifyConfirmModal();
        closeEditProfileModal();
        openPaymentModal();
      }
      // Requested Sessions Modal
      function openRequestedSessionsModal() {
        openModal('requested-sessions-modal');
      }

      function closeRequestedSessionsModal() {
        closeModal('requested-sessions-modal');
      }

      function openChatModal(studentId) {
        document.getElementById('chat-student-name').textContent = `Chat with ${studentId}`;
        document.getElementById('chat-modal').dataset.studentId = studentId;
        openModal('chat-modal');
      }

      function closeChatModal() {
        closeModal('chat-modal');
      }

      function sendMessage() {
        const message = document.getElementById('chat-input').value;
        const chatMessages = document.getElementById('chat-messages');
        const messageDiv = document.createElement('div');
        messageDiv.className = 'p-2 border-b';
        messageDiv.textContent = `You: ${message}`;
        chatMessages.appendChild(messageDiv);
        document.getElementById('chat-input').value = '';
      }

      function viewSenderDetails() {
        alert('Viewing sender details for ' + document.getElementById('chat-modal').dataset.studentId);
      }

      function viewChildDetails() {
        alert('Viewing child details');
      }

      function startVideoCall(studentId) {
        alert(`Starting video call with ${studentId}`);
      }

      function viewParentDetails(parentId) {
        document.getElementById('parent-name').textContent = `Name: ${parentId}`;
        openModal('parent-modal');
      }

      function viewStudentDetails(studentId) {
        document.getElementById('student-details-modal').dataset.studentId = studentId;
        document.getElementById('student-detail-name').textContent = `Name: ${studentId}`;
        closeRequestedSessionsModal(); // Close the requested sessions modal
        openModal('student-details-modal');
      }

      function confirmSession(studentId) {
        alert(`Session confirmed for ${studentId}`);
      }

      function rejectSession(studentId) {
        alert(`Session rejected for ${studentId}`);
      }


      
      async function loadVideos() {
    const videoCarousel = document.getElementById('video-carousel');
    const videos = await fetchData('/api/videos');
    if (videos.length === 0) {
        videoCarousel.innerHTML = '<p class="no-results">No videos available</p>';
        return;
    }
    videoCarousel.innerHTML = '';
    videos.forEach((video, index) => {
        const videoContainer = document.createElement('div');
        videoContainer.className = `video-container ${index === 0 ? 'active' : ''}`;
        videoContainer.innerHTML = `
            <video src="${video.url}" poster="${video.thumbnail_url}" controls></video>
            <h3>${video.title}</h3>
            <p>${video.description || ''}</p>
            <div class="video-controls">
                <div class="interaction-buttons">
                    <button onclick="openModal('share-modal')">Share</button>
                    <button onclick="openModal('comment-modal')">Comment</button>
                </div>
                <div class="comment-list"></div>
            </div>
        `;
        videoCarousel.appendChild(videoContainer);
    });
    let currentVideo = 0;
    const videoContainers = videoCarousel.querySelectorAll('.video-container');
    function rotateVideos() {
        videoContainers.forEach((container, index) => {
            container.classList.toggle('active', index === currentVideo);
        });
        currentVideo = (currentVideo + 1) % videoContainers.length;
    }
    setInterval(rotateVideos, 8000);
}

      // Initialize
      updateVerificationCard();
      displayCourses();
      updateAnalyticsChart();
    });


  </script>
<!DOCTYPE html>
<html lang="en" data-theme="light">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ASTEGNI - User Profile</title>
    <!-- TailwindCSS CDN -->
    <script src="../js/config.js?v202602252204"></script>
    <!-- Active Role Guard - Prevents access to deactivated roles -->
    <script src="../js/root/active-role-guard.js?v202602252204"></script>
    <!-- Preconnect for faster font loading -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <!-- Google Fonts - For Appearance Modal Font Selection -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Roboto:wght@400;500;700&family=Open+Sans:wght@400;600;700&family=Comic+Neue:wght@400;700&family=Caveat:wght@400;500;600;700&family=Patrick+Hand&family=Dancing+Script:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Animate.css for animations -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css" />
    <!-- Custom Styles -->
    <link rel="stylesheet" href="../css/root.css?v202602252204">
    <link rel="stylesheet" href="../css/find-tutors/navbar.css?v202602252204">
    <link rel="stylesheet" href="../css/shared/profile-responsive.css?v202602252204">
    <link rel="stylesheet" href="../css/admin-profile/admin.css?v202602252204">
    <link rel="stylesheet" href="../css/tutor-profile/right-widgets.css?v202602252204">
    <link rel="stylesheet" href="../css/tutor-profile/tutor-profile.css?v202602252204">
    <link rel="stylesheet" href="../css/find-tutors/hero-section.css?v202602252204">
    <link rel="stylesheet" href="../admin-pages/css/admin-pages/recommended-topics-widget.css">
    <!-- Shared Modal Styles -->
    <link rel="stylesheet" href="../css/common-modals/add-role-modal.css?v202602252204">
    <link rel="stylesheet" href="../css/common-modals/coming-soon-modal.css?v202602252204">
    <link rel="stylesheet" href="../css/common-modals/ad-modal.css?v202602252204">
    <link rel="stylesheet" href="../css/common-modals/appearance-modal.css?v202602252204">
    <link rel="stylesheet" href="../css/common-modals/chat-modal.css?v202602252204">
    <link rel="stylesheet" href="../css/common-modals/community-modal.css?v202602252204">
    <link rel="stylesheet" href="../css/common-modals/universal-upload-modal.css?v202602252204">
    <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">

    <!-- Minimal inline styles - only for profile-specific fixes -->
    <style>
        /* Compensate for fixed navbar */
        body {
            padding-top: 72px;
        }

        /* Fix overflow hidden that clips tooltip */
        .profile-header-section {
            overflow: visible !important;
        }

        /* Fix name truncation - allow full name to display */
        .profile-name {
            font-size: 2rem;
            font-weight: bold;
            color: var(--text-primary);
            margin-bottom: 0.5rem;
            white-space: nowrap !important;
            overflow: hidden !important;
            text-overflow: ellipsis !important;
            max-width: 100%;
        }

        .profile-main-info {
            overflow: visible !important;
        }

        .profile-details-section {
            overflow: visible !important;
        }

        /* Rating Tooltip - Force visibility on hover */
        .profile-header-section .rating-section,
        .rating-section {
            position: relative !important;
            overflow: visible !important;
            display: inline-block !important;
        }

        .profile-header-section .rating-wrapper,
        .rating-wrapper {
            position: relative !important;
            display: inline-block !important;
            cursor: pointer !important;
            overflow: visible !important;
        }

        .rating-tooltip {
            position: absolute !important;
            top: 110% !important;
            left: 50% !important;
            transform: translateX(-50%) !important;
            background: var(--card-bg) !important;
            border: 1px solid rgba(0, 0, 0, 0.1) !important;
            border-radius: 12px !important;
            padding: 1rem !important;
            min-width: 280px !important;
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.15) !important;
            opacity: 0 !important;
            visibility: hidden !important;
            transition: all 0.3s ease !important;
            z-index: 99999 !important;
            pointer-events: none !important;
        }

        .profile-header-section .rating-wrapper:hover .rating-tooltip,
        .rating-wrapper:hover .rating-tooltip,
        #rating-hover-trigger:hover #rating-tooltip {
            opacity: 1 !important;
            visibility: visible !important;
            top: calc(100% + 10px) !important;
            pointer-events: auto !important;
            display: block !important;
        }

        .rating-tooltip::before {
            content: '' !important;
            position: absolute !important;
            top: -8px !important;
            left: 50% !important;
            transform: translateX(-50%) !important;
            border-left: 8px solid transparent !important;
            border-right: 8px solid transparent !important;
            border-bottom: 8px solid var(--card-bg) !important;
        }

        /* Dark mode support */
        [data-theme="dark"] .rating-tooltip {
            background: #1f2937 !important;
            border-color: #374151 !important;
        }

        [data-theme="dark"] .rating-tooltip::before {
            border-bottom-color: #1f2937 !important;
        }

        /* Fix ALL parent containers that might clip tooltip */
        .panels-container,
        .panel-content,
        .profile-header,
        .profile-avatar-container,
        .profile-name-row,
        .cover-image-container {
            overflow: visible !important;
        }

        /* ============================================
           ENHANCED PROFILE HEADER SECTION STYLES
           ============================================ */

        .profile-header-section {
            background: var(--card-bg);
            border-radius: 20px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
            margin-bottom: 2rem;
            position: relative;
            overflow: visible !important;
            transition: all 0.3s ease;
        }

        .profile-header-section:hover {
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.12);
        }

        /* Enhanced Cover Image */
        .cover-image-container {
            position: relative;
            height: 280px;
            border-radius: 20px 20px 0 0;
            overflow: hidden;
        }

        .cover-img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.5s ease;
        }

        .cover-image-container:hover .cover-img {
            transform: scale(1.05);
        }

        .cover-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(180deg,
                rgba(0, 0, 0, 0.1) 0%,
                rgba(0, 0, 0, 0.3) 100%
            );
            pointer-events: none;
        }

        .cover-upload-btn {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border: none;
            border-radius: 12px;
            padding: 0.75rem;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            z-index: 10;
        }

        .cover-upload-btn:hover {
            background: white;
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(0, 0, 0, 0.2);
        }

        .cover-upload-btn svg {
            width: 20px;
            height: 20px;
            color: #4f46e5;
        }

        /* Enhanced Profile Info Section */
        .profile-main-info {
            padding: 0 2rem 2rem 2rem;
            margin-top: -60px;
            position: relative;
            z-index: 5;
        }

        .profile-info-wrapper {
            display: flex;
            gap: 2rem;
            align-items: flex-start;
        }

        /* Enhanced Avatar */
        .profile-avatar-container {
            position: relative;
            flex-shrink: 0;
        }

        .profile-avatar {
            width: 140px;
            height: 140px;
            border-radius: 50%;
            border: 5px solid var(--card-bg);
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.15);
            object-fit: cover;
            transition: all 0.3s ease;
        }

        .profile-avatar-container:hover .profile-avatar {
            transform: scale(1.05);
            box-shadow: 0 12px 32px rgba(0, 0, 0, 0.2);
        }

        .online-indicator {
            position: absolute;
            bottom: 10px;
            right: 10px;
            width: 24px;
            height: 24px;
            background: #22c55e;
            border: 4px solid var(--card-bg);
            border-radius: 50%;
            box-shadow: 0 2px 8px rgba(34, 197, 94, 0.4);
            animation: pulse-indicator 2s ease-in-out infinite;
        }

        @keyframes pulse-indicator {
            0%, 100% { box-shadow: 0 2px 8px rgba(34, 197, 94, 0.4); }
            50% { box-shadow: 0 2px 16px rgba(34, 197, 94, 0.8); }
        }

        .avatar-upload-btn {
            position: absolute;
            bottom: 5px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border: none;
            border-radius: 8px;
            padding: 0.5rem;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            opacity: 0;
        }

        .profile-avatar-container:hover .avatar-upload-btn {
            opacity: 1;
        }

        @media (hover: none) {
            .avatar-upload-btn {
                opacity: 1;
                pointer-events: auto;
            }
        }

        .avatar-upload-btn:hover {
            background: white;
            transform: translateX(-50%) translateY(-2px);
        }

        .avatar-upload-btn svg {
            width: 16px;
            height: 16px;
            color: #4f46e5;
        }

        /* Enhanced Profile Details */
        .profile-details-section {
            flex: 1;
            padding-top: 0.5rem;
        }

        .profile-name-row {
            margin-bottom: 1rem;
        }

        .profile-name {
            font-size: 2.25rem;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 0.75rem;
            line-height: 1.2;
            background: linear-gradient(135deg, var(--text-primary) 0%, var(--heading) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .badges-row {
            display: flex;
            flex-wrap: wrap;
            gap: 0.75rem;
            margin-bottom: 1rem;
        }

        .profile-badge {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-size: 0.875rem;
            font-weight: 600;
            transition: all 0.3s ease;
            cursor: default;
        }

        .profile-badge.verified {
            background: linear-gradient(135deg, #22c55e 0%, #16a34a 100%);
            color: white;
            box-shadow: 0 4px 12px rgba(34, 197, 94, 0.3);
        }

        .profile-badge.verified:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(34, 197, 94, 0.4);
        }

        .profile-badge.member {
            background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
            color: white;
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3);
        }

        .profile-badge.member:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(59, 130, 246, 0.4);
        }

        .profile-badge.active {
            background: linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%);
            color: white;
            box-shadow: 0 4px 12px rgba(139, 92, 246, 0.3);
        }

        .profile-badge.active:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(139, 92, 246, 0.4);
        }

        /* Enhanced Rating Section */
        .rating-value {
            font-size: 2rem;
            font-weight: 700;
            color: #f59e0b;
            text-shadow: 0 2px 4px rgba(245, 158, 11, 0.2);
        }

        .rating-stars {
            color: #f59e0b;
            font-size: 1.5rem;
            letter-spacing: 2px;
            text-shadow: 0 2px 4px rgba(245, 158, 11, 0.2);
        }

        .rating-count {
            color: var(--text-secondary);
            font-size: 0.95rem;
            font-weight: 500;
        }

        .rating-label {
            color: var(--text-secondary);
            font-size: 0.875rem;
            margin-top: 0.25rem;
        }

        /* Enhanced Location/Info Items */
        .profile-location {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.75rem 1rem;
            background: rgba(var(--button-bg-rgb), 0.05);
            border-radius: 12px;
            margin-bottom: 0.75rem;
            transition: all 0.3s ease;
        }

        .profile-location:hover {
            background: rgba(var(--button-bg-rgb), 0.1);
            transform: translateX(5px);
        }

        .location-icon {
            font-size: 1.25rem;
        }

        .profile-location span:last-child {
            color: var(--text);
            font-size: 0.95rem;
        }

        /* Enhanced About Me / Info Grid Section */
        .profile-info-grid {
            background: rgba(var(--button-bg-rgb), 0.03);
            border-radius: 16px;
            padding: 1.5rem;
            margin-top: 1.5rem;
            border: 1px solid rgba(var(--border-rgb), 0.1);
        }

        .info-item {
            display: flex;
            align-items: baseline;
            gap: 0.5rem;
            margin-bottom: 1rem;
        }

        .info-item:last-child {
            margin-bottom: 0;
        }

        .info-label {
            font-weight: 600;
            color: var(--heading);
            font-size: 0.95rem;
            min-width: 100px;
        }

        .info-value {
            color: var(--text);
            font-size: 0.95rem;
        }

        .info-description {
            margin-top: 1rem;
            padding-top: 1rem;
            border-top: 1px solid rgba(var(--border-rgb), 0.1);
        }

        .info-description p {
            color: var(--text);
            line-height: 1.7;
            font-size: 0.95rem;
        }

        /* Enhanced Quote Section */
        .profile-quote {
            background: linear-gradient(135deg, rgba(79, 70, 229, 0.1) 0%, rgba(124, 58, 237, 0.05) 100%);
            border-left: 4px solid #4f46e5;
            border-radius: 12px;
            padding: 1.25rem 1.5rem;
            margin-top: 1.5rem;
            position: relative;
            font-style: italic;
            color: var(--text);
            font-size: 1rem;
            line-height: 1.6;
            box-shadow: 0 2px 8px rgba(79, 70, 229, 0.1);
        }

        .profile-quote::before {
            content: '"';
            position: absolute;
            top: -10px;
            left: 15px;
            font-size: 3rem;
            color: #4f46e5;
            opacity: 0.3;
            font-family: Georgia, serif;
        }

        .profile-quote span {
            position: relative;
            z-index: 1;
        }

        /* Enhanced Profile Actions */
        .profile-actions {
            display: flex;
            gap: 1rem;
            margin-top: 2rem;
            flex-wrap: wrap;
        }

        .profile-actions .btn-primary,
        .profile-actions .btn-secondary {
            flex: 1;
            min-width: 160px;
            padding: 0.875rem 1.5rem;
            font-weight: 600;
            border-radius: 12px;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }

        .profile-actions .btn-primary {
            background: linear-gradient(135deg, #4f46e5 0%, #7c3aed 100%);
            color: white;
            border: none;
            box-shadow: 0 4px 12px rgba(79, 70, 229, 0.3);
        }

        .profile-actions .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(79, 70, 229, 0.4);
        }

        .profile-actions .btn-secondary {
            background: transparent;
            color: var(--text);
            border: 2px solid rgba(var(--border-rgb), 0.3);
        }

        .profile-actions .btn-secondary:hover {
            background: rgba(var(--button-bg-rgb), 0.05);
            border-color: var(--button-bg);
            transform: translateY(-2px);
        }

        /* Enhanced Connections Section */
        .profile-connections {
            margin-top: 1.5rem;
            padding: 1.5rem;
            background: rgba(var(--button-bg-rgb), 0.03);
            border-radius: 16px;
            border: 1px solid rgba(var(--border-rgb), 0.1);
        }

        .connections-header h4 {
            font-weight: 600;
            font-size: 0.95rem;
            color: var(--heading);
            display: flex;
            align-items: center;
        }

        .connections-stats {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 1rem;
            text-align: center;
        }

        .stat-box {
            padding: 1rem;
            background: var(--card-bg);
            border-radius: 12px;
            transition: all 0.3s ease;
            border: 1px solid rgba(var(--border-rgb), 0.1);
        }

        .stat-box:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
        }

        .stat-box div:first-child {
            font-size: 1.75rem;
            font-weight: 700;
            color: var(--heading);
            margin-bottom: 0.25rem;
        }

        .stat-box div:last-child {
            font-size: 0.8rem;
            color: var(--text-muted);
        }

        /* Responsive Design */
        @media (max-width: 1024px) {
            .profile-avatar-container {
                width: 140px;
                height: 140px;
                flex-shrink: 0;
            }

            .profile-avatar {
                width: 140px;
                height: 140px;
                aspect-ratio: 1 / 1;
                object-fit: cover;
            }
        }

        @media (max-width: 768px) {
            .profile-info-wrapper {
                flex-direction: column;
                align-items: center;
                text-align: center;
            }

            .profile-avatar-container {
                width: 120px;
                height: 120px;
                flex-shrink: 0;
            }

            .profile-avatar {
                width: 120px;
                height: 120px;
                aspect-ratio: 1 / 1;
                object-fit: cover;
            }

            .profile-name {
                display: block !important;
                font-size: 1.75rem;
            }

            .badges-row {
                justify-content: center;
            }

            .profile-location {
                justify-content: center;
            }

            .info-item {
                flex-direction: column;
                text-align: center;
                gap: 0.25rem;
            }

            .info-label {
                min-width: auto;
            }

            .profile-actions {
                flex-direction: column;
            }

            .profile-actions .btn-primary,
            .profile-actions .btn-secondary {
                width: 100%;
            }

            .connections-stats {
                grid-template-columns: 1fr;
            }
        }

        /* ============================================
           STUDY TIPS TICKER ANIMATION
           ============================================ */
        .activity-ticker-container {
            height: 95px;
            overflow: hidden;
            position: relative;
            background: rgba(var(--button-bg-rgb), 0.02);
            border-radius: var(--radius-md);
        }

        .activity-ticker {
            animation: tickerRoll 18s cubic-bezier(0.4, 0, 0.2, 1) infinite;
        }

        .activity-item {
            display: flex;
            align-items: start;
            gap: 0.5rem;
            padding: 0.75rem;
            height: 95px;
            box-sizing: border-box;
            transition: background var(--transition-base);
        }

        .activity-item:hover {
            background: rgba(var(--button-bg-rgb), 0.05);
        }

        @keyframes tickerRoll {
            0% {
                transform: translateY(0);
            }
            16.66% {
                transform: translateY(0);
            }
            20% {
                transform: translateY(-95px);
            }
            36.66% {
                transform: translateY(-95px);
            }
            40% {
                transform: translateY(-190px);
            }
            56.66% {
                transform: translateY(-190px);
            }
            60% {
                transform: translateY(-285px);
            }
            76.66% {
                transform: translateY(-285px);
            }
            80% {
                transform: translateY(-380px);
            }
            96.66% {
                transform: translateY(-380px);
            }
            100% {
                transform: translateY(-475px);
            }
        }

        /* Pause animation on hover */
        .activity-ticker-container:hover .activity-ticker {
            animation-play-state: paused;
        }

        /* ============================================
           FIX: Prevent profile-header-section from moving with sidebar
           ============================================ */
        .profile-header-section.sidebar-active {
            transform: none !important;
        }

        .panel-content section.sidebar-active {
            transform: none !important;
        }

        /* ============================================
           ENGAGEMENT FILTER STYLES
           ============================================ */

        .engagement-filter-btn {
            background: var(--card-bg);
            color: var(--text);
            border: 2px solid var(--border);
        }

        .engagement-filter-btn:hover {
            background: var(--highlight-bg);
            border-color: var(--button-bg);
            color: var(--button-bg);
        }

        .engagement-filter-btn.active {
            background: linear-gradient(135deg, #4f46e5 0%, #7c3aed 100%);
            color: white;
            border-color: transparent;
            box-shadow: 0 4px 12px rgba(79, 70, 229, 0.3);
        }

        .engagement-type-btn {
            background: var(--card-bg);
            color: var(--text-muted);
            border: 1px solid var(--border);
        }

        .engagement-type-btn:hover {
            background: var(--highlight-bg);
            color: var(--text);
            border-color: #3b82f6;
        }

        .engagement-type-btn.active {
            background: #3b82f6;
            color: white;
            border-color: #3b82f6;
            box-shadow: 0 2px 8px rgba(59, 130, 246, 0.3);
        }

        /* Engagement Card Styles - Fix glitching */
        .engagement-card {
            /* Override admin.css .card:hover background-color transition */
            background-color: var(--card-bg) !important;
            /* Only transition specific properties to avoid glitching */
            transition: transform 0.2s ease, box-shadow 0.2s ease !important;
            /* Prevent will-change from causing repaints */
            will-change: auto;
        }

        .engagement-card:hover {
            /* Keep background stable - no color change */
            background-color: var(--card-bg) !important;
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1) !important;
        }
    </style>
    <!-- Profile Dropdown Fix - MUST load last -->
    <link rel="stylesheet" href="../css/user-profile/profile-specific-fix.css?v202602252204">
</head>

<body class="font-sans">
    <!-- <Loading Screen> -->
    <div id="loading-screen" class="loading-screen">
        <div class="loader">
            <div class="loader-circle"></div>
            <div class="loader-circle"></div>
            <div class="loader-circle"></div>
        </div>
        <h2 class="loading-text">ASTEGNI</h2>
    </div>
    <script>
        // Hide loading screen only after page fully loads
        window.addEventListener('load', function() {
            // Wait for all resources (images, styles, scripts) to fully load
            setTimeout(() => {
                const loadingScreen = document.getElementById("loading-screen");
                if (loadingScreen) {
                    loadingScreen.classList.add("fade-out");
                    setTimeout(() => {
                        loadingScreen.style.display = "none";
                    }, 600);
                }
            }, 300); // Reduced delay since we're already waiting for full load
        });

        // Fallback: Force hide after 10 seconds if something goes wrong
        setTimeout(() => {
            const loadingScreen = document.getElementById("loading-screen");
            if (loadingScreen && loadingScreen.style.display !== "none") {
                loadingScreen.classList.add("fade-out");
                setTimeout(() => {
                    loadingScreen.style.display = "none";
                }, 600);
            }
        }, 10000);
    </script>

    <!-- Navigation -->
    <nav class="navbar" role="navigation" aria-label="Main navigation">
        <div class="nav-container" style="max-width: 100%; padding: 0 1rem;">
            <div class="nav-brand">
                <button class="sidebar-toggle" id="hamburger" aria-label="Toggle sidebar">
                    <span class="hamburger">
                        <span></span>
                        <span></span>
                        <span></span>
                    </span>
                </button>
                <a href="../index.html" class="logo-container">
                    <div class="logo-text">
                        <span class="logo-main">Astegni</span>
                    </div>
                    <span class="logo-badge">Beta</span>
                </a>
            </div>

            <!-- Right Section: Nav Menu + Actions -->
            <div class="nav-actions" style="display: flex; align-items: center; gap: 0.5rem; margin-right: 0;">
                <div class="nav-items" style="display: flex; gap: 0.25rem;">
                    <a class="nav-link" href="#" onclick="handleNavLinkClick(event, 'news')">
                        <span class="nav-icon">üì∞</span> News
                    </a>
                    <a class="nav-link" href="../branch/find-tutors.html">
                        <span class="nav-icon">üë®‚Äçüè´</span> Find Tutors
                    </a>
                    <a class="nav-link" href="../branch/videos.html">
                        <span class="nav-icon">üé¨</span> Videos
                    </a>
                    <a class="nav-link" href="#" onclick="handleNavLinkClick(event, 'store')">
                        <span class="nav-icon">üìö</span> Bookstore
                    </a>
                    <a class="nav-link" href="#" onclick="handleNavLinkClick(event, 'find-jobs')">
                        <span class="nav-icon">üíº</span> Find a Job
                    </a>
                </div>
                <!-- Profile container -->
                <div id="profile-container" class="profile-dropdown-container">
                    <button id="profile-dropdown-toggle" class="profile-dropdown-toggle"
                        onclick="toggleProfileDropdown()">
                        <img id="profile-pic" class="profile-pic" alt="Profile">
                        <span id="navbar-profile-name" class="profile-name"></span>
                        <svg class="dropdown-arrow" width="12" height="12" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd"
                                d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z"
                                clip-rule="evenodd"></path>
                        </svg>
                    </button>

                    <div id="profile-dropdown-menu" class="profile-dropdown-menu">
                        <!-- User info header - CLICKABLE to go to profile page -->
                        <a href="#" id="dropdown-profile-link" class="dropdown-header-link">
                            <div class="dropdown-header">
                                <img id="dropdown-profile-pic" class="profile-pic" alt="Profile">
                                <div class="dropdown-user-info">
                                    <span id="dropdown-user-name" class="dropdown-user-name"></span>
                                    <span id="dropdown-user-email" class="dropdown-user-email"></span>
                                    <span id="dropdown-user-role" class="dropdown-user-role"></span>
                                </div>
                                <svg class="dropdown-header-arrow" width="16" height="16" fill="currentColor" viewBox="0 0 20 20">
                                    <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                                </svg>
                            </div>
                        </a>

                        <div class="dropdown-divider"></div>

                        <!-- Deletion Countdown Banner (shown when role is scheduled for deletion) -->
                        <div id="deletion-countdown-banner" class="deletion-countdown-banner hidden">
                            <div class="countdown-content">
                                <div class="countdown-icon">
                                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                                    </svg>
                                </div>
                                <div class="countdown-text">
                                    <div class="countdown-title">Role Scheduled for Deletion</div>
                                    <div class="countdown-details">
                                        Your <span id="countdown-role-name" class="font-semibold"></span> role will be deleted in
                                        <span id="countdown-days" class="font-bold text-orange-600"></span> days
                                    </div>
                                </div>
                            </div>
                            <button onclick="openAddRoleModal()" class="countdown-restore-btn">
                                Restore Role
                            </button>
                        </div>

                        <div class="dropdown-divider" id="countdown-divider" style="display: none;"></div>

                        <!-- Role switcher (shown only if user has multiple roles) -->
                        <div id="role-switcher-section" class="role-switcher-section hidden">
                            <div class="dropdown-item-header">Switch Role</div>
                            <div id="role-options" class="role-options">
                                <!-- Role options will be dynamically added here -->
                            </div>
                            <div class="dropdown-divider"></div>
                        </div>

                        <div class="dropdown-divider"></div>

                        <button class="dropdown-item logout-item" onclick="showLogoutModal()">
                            <svg class="dropdown-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1">
                                </path>
                            </svg>
                            Logout
                        </button>
                    </div>
                </div>

                <!-- Notification Icon -->
                <button class="icon-btn" aria-label="Notifications">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9">
                        </path>
                    </svg>
                    <span class="notification-badge">2</span>
                </button>

                <!-- Theme Toggle -->
                <button id="theme-toggle-btn" class="icon-btn" aria-label="Toggle theme">
                    <svg id="theme-icon" class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z">
                        </path>
                    </svg>
                </button>
                <!-- Mobile Menu Button -->
                <button class="mobile-menu-btn" id="mobileMenuBtn" aria-label="Open mobile menu">
                    <span class="hamburger-line"></span>
                    <span class="hamburger-line"></span>
                    <span class="hamburger-line"></span>
                </button>
            </div>
        </div>
    </nav>

    <!-- Mobile Menu Overlay -->
    <div id="mobileMenuOverlay" class="mobile-menu-overlay hidden"></div>

    <!-- Mobile Slide-in Menu -->
    <div id="mobileMenu" class="mobile-menu hidden">
        <div class="mobile-menu-header">
            <div class="mobile-menu-logo">
                <span class="logo-main">Astegni</span>
                <span class="logo-badge">Beta</span>
            </div>
            <button class="mobile-menu-close" onclick="closeMobileMenu()">
                <svg width="24" height="24" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                </svg>
            </button>
        </div>

        <div class="mobile-menu-content">
            <!-- Navigation Links -->
            <div class="mobile-nav-section">
                <a href="#" class="mobile-menu-link" onclick="handleNavLinkClick(event, 'news')">
                    <span class="nav-icon">üì∞</span> News
                </a>
                <a href="../branch/find-tutors.html" class="mobile-menu-link">
                    <span class="nav-icon">üë®‚Äçüè´</span> Find Tutors
                </a>
                <a href="../branch/videos.html" class="mobile-menu-link">
                    <span class="nav-icon">üé¨</span> Videos
                </a>
                <a href="#" class="mobile-menu-link" onclick="handleNavLinkClick(event, 'store')">
                    <span class="nav-icon">üìö</span> Bookstore
                </a>
                <a href="#" class="mobile-menu-link" onclick="handleNavLinkClick(event, 'find-jobs')">
                    <span class="nav-icon">üíº</span> Find a Job
                </a>
            </div>

            <!-- Profile Section -->
            <div class="mobile-profile-section">
                <button class="mobile-profile-header" id="mobile-profile-header" onclick="toggleMobileProfileDropdown()">
                    <img id="mobile-profile-pic" class="mobile-profile-pic" alt="Profile">
                    <div class="mobile-profile-info">
                        <span id="mobile-profile-name" class="mobile-profile-name"></span>
                        <span id="mobile-profile-role" class="mobile-profile-role">User</span>
                    </div>
                    <svg class="mobile-dropdown-arrow" width="16" height="16" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                    </svg>
                </button>

                <div class="mobile-profile-dropdown">
                    <div class="mobile-profile-dropdown-content">
                    <a href="../profile-pages/user-profile.html" class="mobile-dropdown-item">
                        <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
                        </svg>
                        My Profile
                    </a>
                    <div id="mobile-role-switcher-section" class="mobile-role-switcher-section hidden">
                        <div class="mobile-dropdown-divider"></div>
                        <div class="mobile-role-switcher-header">Switch Role</div>
                        <div id="mobile-role-options"></div>
                    </div>
                    <div class="mobile-dropdown-divider"></div>
                    <button class="mobile-dropdown-item logout" onclick="showLogoutModal()">
                        <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"></path>
                        </svg>
                        Logout
                    </button>
                    </div>
                </div>
            </div>

            <!-- Theme Toggle -->
            <div class="mobile-theme-section">
                <button class="mobile-theme-toggle" onclick="toggleTheme()">
                    <svg class="theme-icon-sun" width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"></path>
                    </svg>
                    <span>Toggle Theme</span>
                </button>
            </div>

            <!-- Notifications -->
            <div class="mobile-notifications-section">
                <button class="mobile-notifications-btn">
                    <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"></path>
                    </svg>
                    <span>Notifications</span>
                    <span class="mobile-notification-badge">2</span>
                </button>
            </div>
        </div>
    </div>

    <!-- Rotating Ad Section - 4 Placeholder Ads -->
    <div class="leaderboard-banner premium-promo" style="margin-top: 2rem;" data-placement="leaderboard_banner" data-profile-type="user" data-location="user_profile">
        <!-- Ads will be loaded dynamically via adRotationManager -->
    </div>

    <!-- Sidebar -->
    <aside id="sidebar" class="sidebar-container">
        <div class="sidebar-content">
            <div class="sidebar-nav">
                <h3>User Dashboard</h3>

                <a href="#" onclick="switchPanel('dashboard'); return false;" class="sidebar-link active">
                    <span class="sidebar-icon">üè†</span>
                    <span>Dashboard</span>
                </a>
                <hr class="my-4 border-gray-300">
                <a href="#" onclick="switchPanel('my-engagements'); return false;" class="sidebar-link">
                    <span class="sidebar-icon">‚ù§Ô∏è</span>
                    <span>My Engagements</span>
                    <span class="badge-count">12</span>
                </a>
                <hr class="my-4 border-gray-300">
                <a href="#" onclick="switchPanel('earnings-investments'); return false;" class="sidebar-link">
                    <span class="sidebar-icon"
                        style="font-family: 'Times New Roman', serif; font-weight: bold; font-size: 1.1rem;">‚Ñ∞</span>
                    <span>Earnings & Investments</span>
                </a>
                <hr class="my-4 border-gray-300">
                <a href="#" onclick="switchPanel('settings'); return false;" class="sidebar-link">
                    <span class="sidebar-icon">‚öôÔ∏è</span>
                    <span>Settings</span>
                </a>
                <a href="#" onclick="showLogoutModal(); return false;" class="sidebar-link text-red-500 hover:bg-red-50">
                    <span class="sidebar-icon">üö™</span>
                    <span>Logout</span>
                </a>
            </div>
        </div>
    </aside>

    <!-- Main Content -->
    <section class="py-8" style="padding-top: 1rem;">
        <div class="container mx-auto px-4">

            <!-- Hero Section -->
            <section class="hero-section animate__animated animate__fadeIn">
                <h2 class="hero-title">
                    <span id="typedText">Discover & Connect with Expert Tutors</span>
                    <span id="cursor" class="cursor-blink">|</span>
                </h2>
                <p id="hero-subtitle" class="hero-subtitle">Explore educational content and find the perfect tutor for your needs</p>
                <div class="hero-stats">
                    <div class="stat-item animate__animated animate__fadeInUp" style="animation-delay: 0.2s">
                        <span class="stat-number" data-target="0" data-suffix="">0</span><span class="stat-currency"></span>
                        <span class="stat-label">Total Earnings</span>
                    </div>
                    <div class="stat-item animate__animated animate__fadeInUp" style="animation-delay: 0.3s">
                        <span class="stat-number" data-target="18" data-suffix="">0</span>
                        <span class="stat-label">Total Likes</span>
                    </div>
                    <div class="stat-item animate__animated animate__fadeInUp" style="animation-delay: 0.4s">
                        <span class="stat-number" data-target="12" data-suffix="">0</span>
                        <span class="stat-label">Engagements</span>
                    </div>
                </div>
            </section>

            <!-- Main Content with Widgets -->
            <div class="flex gap-6">
                <!-- Left Content Area -->
                <div class="flex-1" style="min-width: 0;">
                    <!-- Panels Section -->
                    <div class="panels-container">
                        <!-- Dashboard Panel (Default) -->
                        <div id="dashboard-panel" class="panel-content active">

                            <!-- Profile Header Section (Only visible in Dashboard) -->
                            <section class="profile-header-section mb-8">
                                <div class="cover-image-container relative">
                                    <img id="cover-img" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='1200' height='300'%3E%3Crect width='1200' height='300' fill='%23e5e7eb'/%3E%3Ctext x='50%25' y='50%25' text-anchor='middle' dy='.3em' fill='%239ca3af' font-family='sans-serif' font-size='20'%3E1200x300%3C/text%3E%3C/svg%3E"
                                        alt="Cover" class="cover-img">
                                    <div class="cover-overlay"></div>
                                    <!-- Cover Upload Button -->
                                    <button onclick="openUniversalUploadModal('cover')" class="cover-upload-btn">
                                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                d="M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z">
                                            </path>
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                d="M15 13a3 3 0 11-6 0 3 3 0 016 0z"></path>
                                        </svg>
                                    </button>
                                </div>

                                <div class="profile-main-info">
                                    <div class="profile-info-wrapper">
                                        <div class="profile-avatar-container">
                                            <img id="profile-avatar" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='150' height='150'%3E%3Crect width='150' height='150' fill='%23e5e7eb'/%3E%3Ctext x='50%25' y='50%25' text-anchor='middle' dy='.3em' fill='%239ca3af' font-family='sans-serif' font-size='16'%3E150x150%3C/text%3E%3C/svg%3E"
                                                alt="User Profile" class="profile-avatar">
                                            <span class="online-indicator"></span>
                                            <!-- Profile Picture Upload Button -->
                                            <button onclick="openUniversalUploadModal('profile')" class="avatar-upload-btn">
                                                <svg class="w-4 h-4" fill="none" stroke="currentColor"
                                                    viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round"
                                                        stroke-width="2"
                                                        d="M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z">
                                                    </path>
                                                    <path stroke-linecap="round" stroke-linejoin="round"
                                                        stroke-width="2" d="M15 13a3 3 0 11-6 0 3 3 0 016 0z"></path>
                                                </svg>
                                            </button>
                                        </div>

                                        <div class="profile-details-section">
                                            <div class="profile-name-row">
                                                <h1 class="profile-name" id="profile-name">User Name</h1>
                                                <p id="profile-username" style="color: var(--text-muted); font-size: 1rem; margin-top: 0.25rem;">@username</p>
                                                <div class="badges-row">
                                                    <span class="profile-badge verified" id="verification-badge">‚úî
                                                        Verified User</span>
                                                    <span class="profile-badge member">üë§ Active Member</span>
                                                </div>
                                            </div>

                                            <div class="profile-location">
                                                <span class="location-icon">üìç</span>
                                                <span id="user-location">Addis Ababa, Ethiopia</span>
                                            </div>

                                            <!-- Email (always shown) -->
                                            <div class="profile-location" id="email-container">
                                                <span class="location-icon">‚úâÔ∏è</span>
                                                <span id="user-email">email@example.com</span>
                                            </div>

                                            <!-- Phone (optional) -->
                                            <div class="profile-location" id="phone-container" style="display: none;">
                                                <span class="location-icon">üìû</span>
                                                <span id="user-phone">+251 912 345 678</span>
                                            </div>

                                            <!-- Hobbies & Interests -->
                                            <div id="hobbies-display-container"
                                                style="display: flex; align-items: center; gap: 0.75rem; padding: 0.75rem 1rem; background: rgba(var(--button-bg-rgb), 0.05); border-radius: 12px; margin-bottom: 0.75rem;">
                                                <span style="font-size: 1.25rem;">üé®</span>
                                                <div style="flex: 1;">
                                                    <div
                                                        style="font-size: 0.75rem; color: var(--text-muted); margin-bottom: 0.125rem;">
                                                        Hobbies & Interests</div>
                                                    <div id="user-hobbies"
                                                        style="color: var(--text-muted); font-size: 0.875rem; font-weight: 500; font-style: italic;">
                                                        No hobbies yet</div>
                                                </div>
                                            </div>

                                            <!-- Social Links -->
                                            <div class="profile-social-links" id="social-links-container"
                                                style="display: flex; gap: 0.75rem; margin-top: 1.5rem; margin-bottom: 0.75rem; padding: 0.5rem 0;">
                                                <!-- Social links will be populated dynamically by JS with beautiful styling -->
                                            </div>

                                            <!-- About Me Info (without bio) -->
                                            <div class="profile-info-grid">
                                                <div class="info-item">
                                                    <span class="info-label">Member Since:</span>
                                                    <span class="info-value" id="user-joined">January 2025</span>
                                                </div>
                                                <div class="info-item">
                                                    <span class="info-label">Interests:</span>
                                                    <span class="info-value" id="user-interests">Education, Learning</span>
                                                </div>
                                            </div>

                                            <div class="profile-quote">
                                                <span id="user-quote">"Learning is a journey, not a destination."</span>
                                            </div>

                                            <!-- Connections Section -->
                                            <div class="profile-connections" style="margin-top: 1.5rem;">
                                                <div class="connections-header"
                                                    style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                                                    <h4
                                                        style="font-weight: 600; font-size: 0.95rem; color: var(--heading);">
                                                        <span style="margin-right: 0.5rem;">üìä</span>Activity Stats
                                                    </h4>
                                                </div>
                                                <div class="connections-stats"
                                                    style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 1rem; text-align: center;">
                                                    <div class="stat-box" onclick="openCommunityModalTab('connections')" style="padding: 0.75rem; background: rgba(var(--button-bg-rgb), 0.05); border-radius: var(--radius-md); cursor: pointer; transition: all 0.3s ease;">
                                                        <div style="font-size: 1.5rem; font-weight: 700; color: var(--heading);"
                                                            id="connections-count">0</div>
                                                        <div
                                                            style="font-size: 0.75rem; color: var(--text-muted); margin-top: 0.25rem;">
                                                            Connections</div>
                                                    </div>
                                                    <div class="stat-box" onclick="openCommunityModalTab('pending')" style="padding: 0.75rem; background: rgba(var(--button-bg-rgb), 0.05); border-radius: var(--radius-md); cursor: pointer; transition: all 0.3s ease;">
                                                        <div style="font-size: 1.5rem; font-weight: 700; color: var(--heading);"
                                                            id="pending-requests-count">0</div>
                                                        <div
                                                            style="font-size: 0.75rem; color: var(--text-muted); margin-top: 0.25rem;">
                                                            Pending Requests</div>
                                                    </div>
                                                    <div class="stat-box" onclick="openCommunityModalTab('received')" style="padding: 0.75rem; background: rgba(var(--button-bg-rgb), 0.05); border-radius: var(--radius-md); cursor: pointer; transition: all 0.3s ease;">
                                                        <div style="font-size: 1.5rem; font-weight: 700; color: var(--heading);"
                                                            id="received-requests-count">0</div>
                                                        <div
                                                            style="font-size: 0.75rem; color: var(--text-muted); margin-top: 0.25rem;">
                                                            Received Requests</div>
                                                    </div>
                                                </div>
                                            </div>

                                            <div class="profile-actions">
                                                <button onclick="openEditProfileModal()" class="btn-primary">
                                                    <span class="mr-2">‚úèÔ∏è</span>
                                                    Edit Profile
                                                </button>
                                                <button onclick="openChatModal()" class="btn-secondary ml-2">
                                                    <span class="mr-2">üí¨</span>
                                                    Message
                                                </button>
                                                <button onclick="shareProfile(event)" class="btn-secondary ml-2">
                                                    <span class="mr-2">üîó</span>
                                                    Share Profile
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </section>

                            <!-- Bio Section (Separate from profile header) -->
                            <section class="bio-section mb-8" style="background: var(--card-bg); border-radius: 20px; box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08); padding: 2rem;">
                                <div style="display: flex; align-items: center; gap: 0.75rem; margin-bottom: 1rem;">
                                    <span style="font-size: 1.5rem;">üìù</span>
                                    <h3 style="font-size: 1.25rem; font-weight: 600; color: var(--heading); margin: 0;">About Me</h3>
                                </div>
                                <p id="user-bio" style="color: var(--text-primary); line-height: 1.6; font-size: 1rem;">
                                    Exploring educational content and connecting with expert tutors on Astegni platform.
                                </p>
                            </section>

                            <!-- Page Header -->
                            <div class="mb-8 animate-fadeIn">
                                <h1 class="text-3xl font-bold mb-2">User Dashboard</h1>
                                <p class="text-gray-600">Overview of your engagements, saved content, and activity</p>
                            </div>

                            <!-- Activity Overview Cards -->
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-8">
                                <div class="card p-4">
                                    <div class="flex items-center gap-3 mb-2">
                                        <span class="text-3xl">‚ù§Ô∏è</span>
                                        <h3 class="text-lg font-semibold">Total Engagements</h3>
                                    </div>
                                    <p class="text-2xl font-bold text-red-600" id="stat-total-engagements">12</p>
                                    <span class="text-sm text-gray-500">Likes & Saves</span>
                                </div>

                                <div class="card p-4">
                                    <div class="flex items-center gap-3 mb-2">
                                        <span class="text-3xl">üí∞</span>
                                        <h3 class="text-lg font-semibold">Total Earnings</h3>
                                    </div>
                                    <p class="text-2xl font-bold text-purple-600" id="stat-total-earnings"><span class="earnings-amount">0</span> <span class="earnings-currency"></span></p>
                                    <span class="text-sm text-gray-500">All time</span>
                                </div>

                                <div class="card p-4">
                                    <div class="flex items-center gap-3 mb-2">
                                        <span class="text-3xl">üìà</span>
                                        <h3 class="text-lg font-semibold">This Month</h3>
                                    </div>
                                    <p class="text-2xl font-bold text-green-600" id="stat-monthly-earnings"><span class="earnings-amount">0</span> <span class="earnings-currency"></span></p>
                                    <span class="text-sm text-gray-500">Current month</span>
                                </div>
                            </div>

                            <!-- Recent Activity Section -->
                            <div class="card p-6 mb-8">
                                <h3 class="text-xl font-semibold mb-4">Recent Activity</h3>
                                <div class="text-center py-12">
                                    <i class="fas fa-clock text-5xl mb-4 text-gray-300"></i>
                                    <p class="text-gray-500 text-lg mb-2">No recent activity</p>
                                    <p class="text-sm text-gray-400">Your recent interactions will appear here</p>
                                </div>
                            </div>
                        </div>

                        <!-- My Engagements Panel -->
                        <div id="my-engagements-panel" class="panel-content hidden">
                            <div class="mb-8">
                                <h1 class="text-3xl font-bold mb-2">My Engagements</h1>
                                <p class="text-gray-600">All your likes, saves, shares, comments, and viewing history</p>
                            </div>

                            <!-- Engagement Filters -->
                            <div class="card p-6 mb-6">
                                <div class="flex flex-wrap gap-4 mb-4">
                                    <!-- Main Filter Buttons -->
                                    <button onclick="filterEngagements('likes')"
                                            class="engagement-filter-btn active px-4 py-2 rounded-lg font-medium transition-colors"
                                            data-filter="likes">
                                        ‚ù§Ô∏è Likes
                                    </button>
                                    <button onclick="filterEngagements('saved')"
                                            class="engagement-filter-btn px-4 py-2 rounded-lg font-medium transition-colors"
                                            data-filter="saved">
                                        üîñ Saved
                                    </button>
                                    <button onclick="filterEngagements('favorites')"
                                            class="engagement-filter-btn px-4 py-2 rounded-lg font-medium transition-colors"
                                            data-filter="favorites">
                                        ‚≠ê Favorites
                                    </button>
                                    <button onclick="filterEngagements('comments')"
                                            class="engagement-filter-btn px-4 py-2 rounded-lg font-medium transition-colors"
                                            data-filter="comments">
                                        üí¨ Comments
                                    </button>
                                    <button onclick="filterEngagements('shares')"
                                            class="engagement-filter-btn px-4 py-2 rounded-lg font-medium transition-colors"
                                            data-filter="shares">
                                        üîó Shares
                                    </button>
                                    <button onclick="filterEngagements('viewing-history')"
                                            class="engagement-filter-btn px-4 py-2 rounded-lg font-medium transition-colors"
                                            data-filter="viewing-history">
                                        üïí Viewing History
                                    </button>
                                </div>
                            </div>

                            <!-- Engagement Content -->
                            <div class="card p-6">
                                <div id="engagement-results">
                                    <p class="text-gray-500">Loading engagement content...</p>
                                </div>
                            </div>
                        </div>

                        <!-- Earnings & Investments Panel -->
                        <div id="earnings-investments-panel" class="panel-content hidden">
                            <div class="mb-8">
                                <h1 class="text-3xl font-bold mb-2">Earnings & Investments</h1>
                                <p class="text-gray-600">Track your income streams and investment portfolio</p>
                            </div>

                            <!-- Tabs -->
                            <div class="flex gap-4 mb-6 border-b border-gray-200">
                                <button onclick="switchEarningsTab('earnings')" id="earnings-tab"
                                    class="earnings-tab-btn px-6 py-3 font-semibold text-blue-600 border-b-2 border-blue-600 transition-all">
                                    Earnings
                                </button>
                                <button onclick="switchEarningsTab('investments')" id="investments-tab"
                                    class="earnings-tab-btn px-6 py-3 font-semibold text-gray-500 hover:text-gray-700 transition-all">
                                    Investments
                                </button>
                            </div>

                            <!-- Earnings Tab Content -->
                            <div id="earnings-tab-content" class="earnings-tab-content">
                                <!-- Summary Cards (2 Cards: Total, Affiliate) -->
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
                                    <div onclick="toggleEarningsSection('total')"
                                        class="card p-6 bg-gradient-to-br from-green-50 to-emerald-50 border-green-200 cursor-pointer hover:shadow-lg transition-all duration-200 active-earnings-card">
                                        <div class="flex items-center justify-between mb-2">
                                            <span class="text-green-600 text-2xl">üí∞</span>
                                            <span class="text-xs text-green-600 font-semibold">ALL SOURCES</span>
                                        </div>
                                        <p class="text-sm text-gray-600 mb-1">Total Earnings</p>
                                        <h3 class="text-2xl font-bold text-gray-800" id="total-earnings"><span class="earnings-amount">0</span> <span class="earnings-currency"></span></h3>
                                        <p class="text-xs text-green-600 mt-2 font-medium">Click to view all</p>
                                    </div>
                                    <div onclick="toggleEarningsSection('affiliate')"
                                        class="card p-6 bg-gradient-to-br from-blue-50 to-indigo-50 border-blue-200 cursor-pointer hover:shadow-lg transition-all duration-200">
                                        <div class="flex items-center justify-between mb-2">
                                            <span class="text-blue-600 text-2xl">ü§ù</span>
                                            <span class="text-xs text-blue-600 font-semibold">AFFILIATE</span>
                                        </div>
                                        <p class="text-sm text-gray-600 mb-1">Affiliate Earnings</p>
                                        <h3 class="text-2xl font-bold text-gray-800" id="affiliate-earnings"><span class="earnings-amount">0</span> <span class="earnings-currency"></span></h3>
                                        <p class="text-xs text-blue-600 mt-2 font-medium">Click to view</p>
                                    </div>
                                </div>

                                <!-- Earnings Sections -->
                                <div class="space-y-8">
                                    <!-- Total Earnings Section -->
                                    <div id="total-earnings-section" class="card p-6 earnings-section">
                                        <div class="flex items-center justify-between mb-6">
                                            <div>
                                                <h3 class="text-xl font-bold flex items-center gap-2">
                                                    <span class="text-green-600">üí∞</span>
                                                    Total Earnings - All Sources
                                                </h3>
                                                <p class="text-sm text-gray-600 mt-1">Combined view of all your earnings</p>
                                            </div>
                                            <div class="flex items-center gap-3">
                                                <select id="total-period-selector" onchange="loadTotalEarningsData()"
                                                    class="p-2 border-2 rounded-lg text-sm font-medium">
                                                    <option value="1">Last Month</option>
                                                    <option value="3">Last 3 Months</option>
                                                    <option value="6" selected>Last 6 Months</option>
                                                    <option value="12">Last Year</option>
                                                </select>
                                            </div>
                                        </div>
                                        <!-- Total Earnings Chart -->
                                        <div class="mb-6 bg-gray-50 p-4 rounded-lg" style="height: 300px;">
                                            <canvas id="total-earnings-chart"></canvas>
                                        </div>
                                        <!-- Combined List -->
                                        <div id="total-earnings-list" class="space-y-3 max-h-96 overflow-y-auto">
                                            <!-- Will be populated by JS -->
                                        </div>
                                    </div>

                                    <!-- Affiliate Earnings Section (with 3 tabs: Advertisement, Subscription, Commission) -->
                                    <div id="affiliate-earnings-section" class="card p-6 earnings-section hidden">
                                        <div class="flex items-center justify-between mb-6">
                                            <div>
                                                <h3 class="text-xl font-bold flex items-center gap-2">
                                                    <span class="text-blue-600">ü§ù</span>
                                                    Affiliate Earnings
                                                </h3>
                                                <p class="text-sm text-gray-600 mt-1">Earnings from ads, referrals, and connections</p>
                                            </div>
                                            <div class="flex items-center gap-3">
                                                <select id="affiliate-period-selector" onchange="loadAffiliateData()"
                                                    class="p-2 border-2 rounded-lg text-sm font-medium">
                                                    <option value="1">Last Month</option>
                                                    <option value="3">Last 3 Months</option>
                                                    <option value="6" selected>Last 6 Months</option>
                                                    <option value="12">Last Year</option>
                                                </select>
                                            </div>
                                        </div>

                                        <!-- Affiliate Sub-Tabs -->
                                        <div class="flex gap-2 mb-6 border-b border-gray-200">
                                            <button onclick="switchAffiliateTab('referrals')" id="referrals-tab"
                                                class="affiliate-tab-btn px-4 py-2 font-medium text-blue-600 border-b-2 border-blue-600 transition-all flex items-center gap-2">
                                                <span>üë•</span> Total Referred
                                            </button>
                                            <button onclick="switchAffiliateTab('advertisement')" id="advertisement-tab"
                                                class="affiliate-tab-btn px-4 py-2 font-medium text-gray-500 hover:text-gray-700 transition-all flex items-center gap-2">
                                                <span>üì∫</span> Advertisement
                                            </button>
                                            <button onclick="switchAffiliateTab('subscription')" id="subscription-tab"
                                                class="affiliate-tab-btn px-4 py-2 font-medium text-gray-500 hover:text-gray-700 transition-all flex items-center gap-2">
                                                <span>‚≠ê</span> Subscription
                                            </button>
                                            <button onclick="switchAffiliateTab('commission')" id="commission-tab"
                                                class="affiliate-tab-btn px-4 py-2 font-medium text-gray-500 hover:text-gray-700 transition-all flex items-center gap-2">
                                                <span>üîó</span> Commission
                                            </button>
                                        </div>

                                        <!-- Total Referred Tab Content -->
                                        <div id="referrals-tab-content" class="affiliate-tab-content">
                                            <!-- Loading State -->
                                            <div id="referrals-loading" class="text-center py-12 hidden">
                                                <div class="inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-violet-600"></div>
                                                <p class="text-gray-600 mt-4">Loading referred users...</p>
                                            </div>
                                            <!-- Empty State -->
                                            <div id="referrals-empty" class="text-center py-12 hidden">
                                                <div class="text-6xl mb-4">üì≠</div>
                                                <h3 class="text-xl font-semibold text-gray-800 mb-2">No Referred Users Yet</h3>
                                                <p class="text-gray-600">Share your referral link to start growing your network.</p>
                                            </div>
                                            <div id="referrals-list" class="space-y-3 max-h-96 overflow-y-auto min-h-[200px]">
                                                <!-- Will be populated by JS -->
                                            </div>
                                        </div>

                                        <!-- Advertisement Tab Content -->
                                        <div id="advertisement-tab-content" class="affiliate-tab-content hidden">
                                            <div class="bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4">
                                                <p class="text-sm text-blue-800">
                                                    <strong>Advertisement Earnings:</strong> Revenue from ads displayed to users who signed up through your referral link.
                                                </p>
                                            </div>
                                            <!-- Affiliate Levels Info (Single Row, Clickable) -->
                                            <div id="advertisement-affiliate-levels" class="flex flex-wrap gap-3 mb-6">
                                                <!-- Will be populated by JS with clickable affiliate tier level cards -->
                                            </div>
                                            <div class="mb-6 bg-gray-50 p-4 rounded-lg" style="height: 250px;">
                                                <canvas id="advertisement-earnings-chart"></canvas>
                                            </div>
                                            <div id="advertisement-earnings-list" class="space-y-3 max-h-96 overflow-y-auto min-h-[200px]">
                                                <!-- Will be populated by JS -->
                                            </div>
                                        </div>

                                        <!-- Subscription Tab Content -->
                                        <div id="subscription-tab-content" class="affiliate-tab-content hidden">
                                            <div class="bg-purple-50 border border-purple-200 rounded-lg p-4 mb-4">
                                                <p class="text-sm text-purple-800">
                                                    <strong>Subscription Earnings:</strong> Commission from users you referred who subscribed to premium plans.
                                                </p>
                                            </div>
                                            <!-- Affiliate Levels Info (Single Row, Clickable) -->
                                            <div id="subscription-affiliate-levels" class="flex flex-wrap gap-3 mb-6">
                                                <!-- Will be populated by JS with clickable affiliate tier level cards -->
                                            </div>
                                            <div class="mb-6 bg-gray-50 p-4 rounded-lg" style="height: 250px;">
                                                <canvas id="subscription-earnings-chart"></canvas>
                                            </div>
                                            <div id="subscription-earnings-list" class="space-y-3 max-h-96 overflow-y-auto min-h-[200px]">
                                                <!-- Will be populated by JS -->
                                            </div>
                                        </div>

                                        <!-- Commission Tab Content -->
                                        <div id="commission-tab-content" class="affiliate-tab-content hidden">
                                            <div class="bg-green-50 border border-green-200 rounded-lg p-4 mb-4">
                                                <p class="text-sm text-green-800">
                                                    <strong>Commission Earnings:</strong> Your share from tutor-student connections you facilitated.
                                                </p>
                                            </div>
                                            <!-- Affiliate Levels Info (Single Row, Clickable) -->
                                            <div id="commission-affiliate-levels" class="flex flex-wrap gap-3 mb-6">
                                                <!-- Will be populated by JS with clickable affiliate tier level cards -->
                                            </div>
                                            <div class="mb-6 bg-gray-50 p-4 rounded-lg" style="height: 250px;">
                                                <canvas id="commission-earnings-chart"></canvas>
                                            </div>
                                            <div id="commission-earnings-list" class="space-y-3 max-h-96 overflow-y-auto min-h-[200px]">
                                                <!-- Will be populated by JS -->
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Investments Tab Content -->
                            <div id="investments-tab-content" class="earnings-tab-content hidden">
                                <!-- Investment Summary Card - Purchase History Only -->
                                <div class="grid grid-cols-1 gap-6 mb-8">
                                    <!-- Purchase History Card -->
                                    <div class="card p-6 bg-gradient-to-br from-green-50 to-emerald-50 border-green-200 cursor-pointer hover:shadow-lg transition-all" onclick="showPurchaseHistory()">
                                        <div class="flex items-center justify-between mb-2">
                                            <span class="text-green-600 text-2xl">üõí</span>
                                            <span class="text-xs text-green-600 font-semibold">PURCHASES</span>
                                        </div>
                                        <p class="text-sm text-gray-600 mb-1">Purchase History</p>
                                        <h3 class="text-2xl font-bold text-gray-800">
                                            <span class="text-base text-gray-500">Coming Soon</span>
                                        </h3>
                                        <p class="text-xs text-gray-500 mt-2">Track all your purchases here</p>
                                    </div>
                                </div>

                                <!-- Investments List -->
                                <div class="card p-6">
                                    <div class="flex items-center justify-between mb-6">
                                        <h3 class="text-xl font-bold flex items-center gap-2">
                                            <span class="text-blue-600" id="investments-list-icon">üí∞</span>
                                            <span id="investments-list-title">Purchase History</span>
                                        </h3>
                                    </div>

                                    <!-- Loading State -->
                                    <div id="investments-loading" class="text-center py-12 hidden">
                                        <div class="inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"></div>
                                        <p class="text-gray-600 mt-4">Loading purchases...</p>
                                    </div>

                                    <!-- Empty State -->
                                    <div id="investments-empty" class="text-center py-12 hidden">
                                        <div class="text-6xl mb-4">üì¶</div>
                                        <h3 class="text-xl font-semibold text-gray-800 mb-2">No purchases found</h3>
                                        <p class="text-gray-600">You haven't made any purchases yet.</p>
                                    </div>

                                    <!-- Investments List Container -->
                                    <div id="investments-list" class="space-y-4">
                                        <!-- Coming Soon Message -->
                                        <div class="text-center py-16">
                                            <div class="text-6xl mb-4">üöß</div>
                                            <h3 class="text-2xl font-bold text-gray-800 mb-2">Coming Soon</h3>
                                            <p class="text-gray-600 mb-4">Purchase history for materials and resources will be available soon.</p>
                                            <p class="text-sm text-gray-500">Stay tuned for updates!</p>
                                        </div>
                                    </div>
                                </div>
                            </div>

                        </div>

                        <!-- Settings Panel -->
                        <div id="settings-panel" class="panel-content hidden">
                            <div class="mb-8">
                                <h1 class="text-3xl font-bold mb-2">Settings</h1>
                                <p class="text-gray-600">Manage your account settings and preferences</p>
                            </div>

                            <!-- Account & Security Section -->
                            <div class="settings-section mb-8">
                                <h2 class="text-xl font-semibold mb-4 text-gray-700 flex items-center gap-2">
                                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"></path>
                                    </svg>
                                    Account & Security
                                </h2>

                                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                                    <!-- Verify Personal Info Card -->
                                    <div class="card p-6 cursor-pointer hover:shadow-lg transition-all duration-300 border-2 border-transparent hover:border-blue-500"
                                        onclick="openVerifyPersonalInfoModal()">
                                        <div class="flex flex-col items-center text-center">
                                            <div class="w-16 h-16 bg-gradient-to-br from-blue-500 to-purple-600 rounded-full flex items-center justify-center shadow-lg mb-4">
                                                <span class="text-3xl">üîê</span>
                                            </div>
                                            <h3 class="text-lg font-bold mb-2 text-gray-800">Verify Personal Info</h3>
                                            <p class="text-sm text-gray-600">Personal details and contact verification</p>
                                        </div>
                                    </div>

                                    <!-- Two-Factor Authentication Card -->
                                    <div class="card p-6 cursor-pointer hover:shadow-lg transition-all duration-300 border-2 border-transparent hover:border-indigo-500"
                                        onclick="openTwoFactorAuthModal()">
                                        <div class="flex flex-col items-center text-center">
                                            <div class="w-16 h-16 bg-gradient-to-br from-indigo-500 to-blue-600 rounded-full flex items-center justify-center shadow-lg mb-4">
                                                <span class="text-3xl">üõ°Ô∏è</span>
                                            </div>
                                            <h3 class="text-lg font-bold mb-2 text-gray-800">Two-Factor Auth</h3>
                                            <p class="text-sm text-gray-600">Extra security with 2FA</p>
                                            <span id="2fa-status-badge" class="mt-2 inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800">
                                                Not Enabled
                                            </span>
                                        </div>
                                    </div>

                                    <!-- Login Activity Card -->
                                    <div class="card p-6 cursor-pointer hover:shadow-lg transition-all duration-300 border-2 border-transparent hover:border-cyan-500"
                                        onclick="openLoginActivityModal()">
                                        <div class="flex flex-col items-center text-center">
                                            <div class="w-16 h-16 bg-gradient-to-br from-cyan-500 to-teal-600 rounded-full flex items-center justify-center shadow-lg mb-4">
                                                <span class="text-3xl">üì±</span>
                                            </div>
                                            <h3 class="text-lg font-bold mb-2 text-gray-800">Login Activity</h3>
                                            <p class="text-sm text-gray-600">Active sessions and history</p>
                                        </div>
                                    </div>

                                    <!-- Connected Accounts Card -->
                                    <div class="card p-6 cursor-pointer hover:shadow-lg transition-all duration-300 border-2 border-transparent hover:border-orange-500"
                                        onclick="openConnectedAccountsModal()">
                                        <div class="flex flex-col items-center text-center">
                                            <div class="w-16 h-16 bg-gradient-to-br from-orange-500 to-amber-600 rounded-full flex items-center justify-center shadow-lg mb-4">
                                                <span class="text-3xl">üîó</span>
                                            </div>
                                            <h3 class="text-lg font-bold mb-2 text-gray-800">Connected Accounts</h3>
                                            <p class="text-sm text-gray-600">Manage Google and other links</p>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Payments & Subscription Section -->
                            <div class="settings-section mb-8">
                                <h2 class="text-xl font-semibold mb-4 text-gray-700 flex items-center gap-2">
                                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"></path>
                                    </svg>
                                    Payments & Subscription
                                </h2>

                                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                                    <!-- Payment Method Card -->
                                    <div class="card p-6 cursor-pointer hover:shadow-lg transition-all duration-300 border-2 border-transparent hover:border-green-500"
                                        onclick="openPaymentMethodModal()">
                                        <div class="flex flex-col items-center text-center">
                                            <div class="w-16 h-16 bg-gradient-to-br from-green-500 to-emerald-600 rounded-full flex items-center justify-center shadow-lg mb-4">
                                                <span class="text-3xl">üí≥</span>
                                            </div>
                                            <h3 class="text-lg font-bold mb-2 text-gray-800">Payment Method</h3>
                                            <p class="text-sm text-gray-600">Manage your payment options</p>
                                        </div>
                                    </div>

                                    <!-- Subscription Card -->
                                    <div class="card p-6 cursor-pointer hover:shadow-lg transition-all duration-300 border-2 border-transparent hover:border-purple-500"
                                        onclick="openComingSoonModal('Subscription & Storage')">
                                        <div class="flex flex-col items-center text-center">
                                            <div class="w-16 h-16 bg-gradient-to-br from-purple-500 to-pink-600 rounded-full flex items-center justify-center shadow-lg mb-4">
                                                <span class="text-3xl">‚≠ê</span>
                                            </div>
                                            <h3 class="text-lg font-bold mb-2 text-gray-800">Subscription & Storage</h3>
                                            <p class="text-sm text-gray-600">Upgrade plan and unlock features</p>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Personalization Section -->
                            <div class="settings-section mb-8">
                                <h2 class="text-xl font-semibold mb-4 text-gray-700 flex items-center gap-2">
                                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 21a4 4 0 01-4-4V5a2 2 0 012-2h4a2 2 0 012 2v12a4 4 0 01-4 4zm0 0h12a2 2 0 002-2v-4a2 2 0 00-2-2h-2.343M11 7.343l1.657-1.657a2 2 0 012.828 0l2.829 2.829a2 2 0 010 2.828l-8.486 8.485M7 17h.01"></path>
                                    </svg>
                                    Personalization
                                </h2>

                                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                                    <!-- Appearance Card -->
                                    <div class="card p-6 cursor-pointer hover:shadow-lg transition-all duration-300 border-2 border-transparent hover:border-violet-500"
                                        onclick="openAppearanceModal()">
                                        <div class="flex flex-col items-center text-center">
                                            <div class="w-16 h-16 bg-gradient-to-br from-violet-500 to-purple-600 rounded-full flex items-center justify-center shadow-lg mb-4">
                                                <span class="text-3xl">üé®</span>
                                            </div>
                                            <h3 class="text-lg font-bold mb-2 text-gray-800">Appearance</h3>
                                            <p class="text-sm text-gray-600">Theme, font size, and display</p>
                                        </div>
                                    </div>

                                    <!-- Language Preferences Card -->
                                    <div class="card p-6 cursor-pointer hover:shadow-lg transition-all duration-300 border-2 border-transparent hover:border-sky-500"
                                        onclick="openComingSoonModal('Language Preferences')">
                                        <div class="flex flex-col items-center text-center">
                                            <div class="w-16 h-16 bg-gradient-to-br from-sky-500 to-blue-600 rounded-full flex items-center justify-center shadow-lg mb-4">
                                                <span class="text-3xl">üåê</span>
                                            </div>
                                            <h3 class="text-lg font-bold mb-2 text-gray-800">Language</h3>
                                            <p class="text-sm text-gray-600">UI language and translation</p>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Data & Privacy Section -->
                            <div class="settings-section mb-8">
                                <h2 class="text-xl font-semibold mb-4 text-gray-700 flex items-center gap-2">
                                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                                    </svg>
                                    Data & Privacy
                                </h2>

                                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                                    <!-- Export Data Card -->
                                    <div class="card p-6 cursor-pointer hover:shadow-lg transition-all duration-300 border-2 border-transparent hover:border-teal-500"
                                        onclick="openComingSoonModal('Export Data')">
                                        <div class="flex flex-col items-center text-center">
                                            <div class="w-16 h-16 bg-gradient-to-br from-teal-500 to-cyan-600 rounded-full flex items-center justify-center shadow-lg mb-4">
                                                <span class="text-3xl">üì¶</span>
                                            </div>
                                            <h3 class="text-lg font-bold mb-2 text-gray-800">Export Data</h3>
                                            <p class="text-sm text-gray-600">Download your personal data</p>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Feedback & Support Section -->
                            <div class="settings-section mb-8">
                                <h2 class="text-xl font-semibold mb-4 text-gray-700 flex items-center gap-2">
                                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"></path>
                                    </svg>
                                    Feedback & Support
                                </h2>

                                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                                    <!-- Review & Rate Astegni Card -->
                                    <div class="card p-6 cursor-pointer hover:shadow-lg transition-all duration-300 border-2 border-transparent hover:border-yellow-500"
                                        onclick="openReviewAstegniModal()">
                                        <div class="flex flex-col items-center text-center">
                                            <div class="w-16 h-16 bg-gradient-to-br from-yellow-500 to-orange-500 rounded-full flex items-center justify-center shadow-lg mb-4">
                                                <span class="text-3xl">‚≠ê</span>
                                            </div>
                                            <h3 class="text-lg font-bold mb-2 text-gray-800">Review Astegni</h3>
                                            <p class="text-sm text-gray-600">Share your feedback with us</p>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Danger Zone Section -->
                            <div class="settings-section">
                                <h2 class="text-xl font-semibold mb-4 text-red-600 flex items-center gap-2">
                                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path>
                                    </svg>
                                    Danger Zone
                                </h2>

                                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                                    <!-- Manage Roles Card -->
                                    <div class="card p-6 cursor-pointer hover:shadow-lg transition-all duration-300 border-2 border-transparent hover:border-rose-500"
                                        onclick="openManageRoleModal()">
                                        <div class="flex flex-col items-center text-center">
                                            <div class="w-16 h-16 bg-gradient-to-br from-rose-500 to-pink-600 rounded-full flex items-center justify-center shadow-lg mb-4">
                                                <span class="text-3xl">üóëÔ∏è</span>
                                            </div>
                                            <h3 class="text-lg font-bold mb-2 text-gray-800">Manage Roles</h3>
                                            <p class="text-sm text-gray-600">Deactivate or remove your role</p>
                                        </div>
                                    </div>

                                    <!-- Leave Astegni Card -->
                                    <div class="card p-6 cursor-pointer hover:shadow-lg transition-all duration-300 border-2 border-transparent hover:border-red-500"
                                        onclick="openLeaveAstegniModal()">
                                        <div class="flex flex-col items-center text-center">
                                            <div class="w-16 h-16 bg-gradient-to-br from-red-500 to-red-700 rounded-full flex items-center justify-center shadow-lg mb-4">
                                                <span class="text-3xl">üö™</span>
                                            </div>
                                            <h3 class="text-lg font-bold mb-2 text-gray-800">Leave Astegni</h3>
                                            <p class="text-sm text-gray-600">Delete account permanently</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Right Sidebar Widgets (Persistent across all panels) -->
                <div class="right-widgets">

                    <!-- Ad Widget -->
                                        <!-- Dynamic Logo Ad Widget -->
                    <div class="widget-card" style="padding: 1.5rem; margin-bottom: 1.5rem;">
                        <div class="widget-header" style="margin-bottom: 0.75rem; display: flex; justify-content: flex-end;">
                            <span style="font-size: 0.65rem; color: var(--text-secondary); background: var(--bg-secondary); padding: 0.2rem 0.5rem; border-radius: 4px;">Ad</span>
                        </div>
                        <!-- Dynamic ad container loaded by AdRotationManager -->
                        <div
                            data-placement="logo"
                            data-profile-type="user"
                            class="leaderboard-banner premium-promo"
                            style="min-height: 170px; border-radius: 12px; overflow: hidden; position: relative; background: var(--bg-secondary);">
                            <!-- Ads will be dynamically loaded here -->
                        </div>
                    </div>

                    <!-- Monthly Earnings Widget with Line Graph -->
                    <div class="widget-card" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border: none;">
                        <div class="flex items-center justify-between mb-3">
                            <h3 id="widget-title" class="text-lg font-semibold">üí∞ Monthly Earnings</h3>
                            <select id="earnings-period-select-user"
                                style="background: rgba(255,255,255,0.2); color: white; border: 1px solid rgba(255,255,255,0.3); border-radius: 6px; padding: 4px 8px; font-size: 12px; cursor: pointer;">
                                <option value="earnings" style="color: #333;">Earnings</option>
                                <option value="investments" style="color: #333;">Investments</option>
                            </select>
                        </div>

                        <div class="mb-4">
                            <div class="text-3xl font-bold mb-1"><span id="earnings-currency-symbol-user"></span> <span id="current-month-earnings-user">0</span></div>
                            <div class="flex items-center gap-2 text-sm">
                                <span id="earnings-change-user" class="text-green-300">+0%</span>
                                <span id="change-label-user" style="opacity: 0.8;">vs last month</span>
                            </div>
                        </div>

                        <!-- Line Graph Canvas -->
                        <div style="position: relative; height: 120px; margin: 0 -1.5rem;">
                            <canvas id="earnings-line-chart-user"></canvas>
                        </div>

                        <!-- Month Labels -->
                        <div id="earnings-months-labels-user" class="flex justify-between text-xs mt-2"
                            style="opacity: 0.8;">
                            <!-- Will be populated by JavaScript -->
                        </div>

                        <!-- View Details Button -->
                        <button onclick="switchPanel('earnings-investments'); return false;"
                            class="mt-4 w-full py-2 px-4 bg-white text-purple-600 rounded-lg font-semibold hover:bg-purple-50 transition-colors">
                            View Details ‚Üí
                        </button>
                    </div>

                    <!-- Trending Tutors Widget -->
                    <div class="widget-card">
                        <h3 class="text-lg font-semibold mb-4">üî• Trending Tutors</h3>
                        <div id="trending-tutors-container" class="space-y-3">
                            <!-- Trending tutors loaded dynamically -->
                            <div class="text-center py-8">
                                <i class="fas fa-spinner fa-spin text-2xl mb-2 text-blue-500"></i>
                                <p class="text-sm text-gray-500">Loading trending tutors...</p>
                            </div>
                        </div>
                    </div>

                    <!-- Recommended Topics Widget -->
                    <div class="widget-card">
                        <h3 class="text-lg font-semibold mb-4">üí° Recommended Topics</h3>
                        <div id="recommended-topics-widget" class="recommended-topics-widget">
                            <!-- Topics loaded dynamically from courses and schools database -->
                            <div class="text-center py-8">
                                <i class="fas fa-spinner fa-spin text-2xl mb-2 text-blue-500"></i>
                                <p class="text-sm text-gray-500">Loading topics...</p>
                            </div>
                        </div>
                    </div>            
                </div>
            </div>
        </div>
    </section>

        <!-- Bottom Widgets Section -->
    <section class="bottom-widgets" style="margin-top: 3rem; margin-bottom: 3rem;">
        <div class="container mx-auto px-4">
            <div class="bottom-widgets-grid"
                style="display: grid; grid-template-columns: repeat(auto-fit, minmax(320px, 1fr)); gap: 1.5rem;">

                <!-- News Widget -->
                <div class="sidebar-widget news-widget card" onclick="openComingSoonModal('news')"
                    style="cursor: pointer; padding: 1.5rem; background: var(--card-bg); border-radius: 16px; transition: transform 0.3s ease, box-shadow 0.3s ease;"
                    onmouseover="this.style.transform='translateY(-4px)'; this.style.boxShadow='0 8px 16px rgba(0,0,0,0.1)'"
                    onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='none'">
                    <div class="widget-header"
                        style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                        <h3 style="font-size: 1.25rem; font-weight: 600; margin: 0;">üì∞ Latest News</h3>
                        <a href="#" onclick="openComingSoonModal('news'); return false;"
                            style="color: var(--button-bg); text-decoration: none; font-size: 0.875rem;">View All</a>
                    </div>

                    <div class="news-carousel" style="position: relative; overflow: hidden;">
                        <div class="news-card-container" id="newsCardContainer">
                            <div class="news-card active" data-news-index="0"
                                style="opacity: 1; transition: opacity 0.5s ease;">
                                <div class="news-card-header"
                                    style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.75rem;">
                                    <span class="news-category-badge"
                                        style="background: linear-gradient(135deg, #667eea, #764ba2); color: white; padding: 0.25rem 0.75rem; border-radius: 12px; font-size: 0.75rem; font-weight: 600;">Education</span>
                                    <span class="news-time" style="color: var(--text-muted); font-size: 0.875rem;">2h
                                        ago</span>
                                </div>
                                <div class="news-card-image" style="margin-bottom: 1rem;">
                                    <img src="https://images.unsplash.com/photo-1427504494785-3a9ca7044f45?w=400"
                                        alt="Education News"
                                        style="width: 100%; height: 200px; object-fit: cover; border-radius: 8px;">
                                </div>
                                <div class="news-card-content">
                                    <h4
                                        style="font-size: 1.125rem; font-weight: 600; margin-bottom: 0.5rem; color: var(--heading);">
                                        New Education Reforms Transform Ethiopian Schools</h4>
                                    <p
                                        style="color: var(--text); opacity: 0.8; font-size: 0.875rem; line-height: 1.6; margin-bottom: 1rem;">
                                        Latest educational initiatives are revolutionizing how students learn across
                                        Ethiopia...</p>
                                    <div class="news-stats" style="display: flex; gap: 1rem; flex-wrap: wrap;">
                                        <span class="news-stat"
                                            style="display: flex; align-items: center; gap: 0.25rem; font-size: 0.875rem; color: var(--text-muted);">üî•
                                            Trending</span>
                                        <span class="news-stat"
                                            style="display: flex; align-items: center; gap: 0.25rem; font-size: 0.875rem; color: var(--text-muted);">üëÅÔ∏è
                                            1.2k views</span>
                                        <span class="news-stat"
                                            style="display: flex; align-items: center; gap: 0.25rem; font-size: 0.875rem; color: var(--text-muted);">üí¨
                                            45 comments</span>
                                    </div>
                                </div>
                            </div>
                            <div class="news-card" data-news-index="1"
                                style="display: none; opacity: 0; transition: opacity 0.5s ease;">
                                <div class="news-card-header"
                                    style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.75rem;">
                                    <span class="news-category-badge"
                                        style="background: linear-gradient(135deg, #f093fb, #f5576c); color: white; padding: 0.25rem 0.75rem; border-radius: 12px; font-size: 0.75rem; font-weight: 600;">Technology</span>
                                    <span class="news-time" style="color: var(--text-muted); font-size: 0.875rem;">5h
                                        ago</span>
                                </div>
                                <div class="news-card-image" style="margin-bottom: 1rem;">
                                    <img src="https://images.unsplash.com/photo-1488590528505-98d2b5aba04b?w=400"
                                        alt="Tech News"
                                        style="width: 100%; height: 200px; object-fit: cover; border-radius: 8px;">
                                </div>
                                <div class="news-card-content">
                                    <h4
                                        style="font-size: 1.125rem; font-weight: 600; margin-bottom: 0.5rem; color: var(--heading);">
                                        Digital Learning Platforms Surge in Popularity</h4>
                                    <p
                                        style="color: var(--text); opacity: 0.8; font-size: 0.875rem; line-height: 1.6; margin-bottom: 1rem;">
                                        Ethiopian students embrace online education tools for enhanced learning
                                        experiences...</p>
                                    <div class="news-stats" style="display: flex; gap: 1rem; flex-wrap: wrap;">
                                        <span class="news-stat"
                                            style="display: flex; align-items: center; gap: 0.25rem; font-size: 0.875rem; color: var(--text-muted);">üí°
                                            Innovation</span>
                                        <span class="news-stat"
                                            style="display: flex; align-items: center; gap: 0.25rem; font-size: 0.875rem; color: var(--text-muted);">üëÅÔ∏è
                                            890 views</span>
                                        <span class="news-stat"
                                            style="display: flex; align-items: center; gap: 0.25rem; font-size: 0.875rem; color: var(--text-muted);">üí¨
                                            32 comments</span>
                                    </div>
                                </div>
                            </div>
                            <div class="news-card" data-news-index="2"
                                style="display: none; opacity: 0; transition: opacity 0.5s ease;">
                                <div class="news-card-header"
                                    style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.75rem;">
                                    <span class="news-category-badge"
                                        style="background: linear-gradient(135deg, #4facfe, #00f2fe); color: white; padding: 0.25rem 0.75rem; border-radius: 12px; font-size: 0.75rem; font-weight: 600;">Career</span>
                                    <span class="news-time" style="color: var(--text-muted); font-size: 0.875rem;">1d
                                        ago</span>
                                </div>
                                <div class="news-card-image" style="margin-bottom: 1rem;">
                                    <img src="https://images.unsplash.com/photo-1522202176988-66273c2fd55f?w=400"
                                        alt="Career News"
                                        style="width: 100%; height: 200px; object-fit: cover; border-radius: 8px;">
                                </div>
                                <div class="news-card-content">
                                    <h4
                                        style="font-size: 1.125rem; font-weight: 600; margin-bottom: 0.5rem; color: var(--heading);">
                                        Top Skills Every Tutor Should Master in 2025</h4>
                                    <p
                                        style="color: var(--text); opacity: 0.8; font-size: 0.875rem; line-height: 1.6; margin-bottom: 1rem;">
                                        Professional development insights for educators to stay competitive and
                                        effective...</p>
                                    <div class="news-stats" style="display: flex; gap: 1rem; flex-wrap: wrap;">
                                        <span class="news-stat"
                                            style="display: flex; align-items: center; gap: 0.25rem; font-size: 0.875rem; color: var(--text-muted);">üìö
                                            Featured</span>
                                        <span class="news-stat"
                                            style="display: flex; align-items: center; gap: 0.25rem; font-size: 0.875rem; color: var(--text-muted);">üëÅÔ∏è
                                            2.1k views</span>
                                        <span class="news-stat"
                                            style="display: flex; align-items: center; gap: 0.25rem; font-size: 0.875rem; color: var(--text-muted);">üí¨
                                            67 comments</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Bookstore Widget -->
                <div class="sidebar-widget bookstore-widget card" onclick="openComingSoonModal('store')"
                    style="cursor: pointer; padding: 1.5rem; background: var(--card-bg); border-radius: 16px; transition: transform 0.3s ease, box-shadow 0.3s ease;"
                    onmouseover="this.style.transform='translateY(-4px)'; this.style.boxShadow='0 8px 16px rgba(0,0,0,0.1)'"
                    onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='none'">
                    <div class="widget-header"
                        style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                        <h3 style="font-size: 1.25rem; font-weight: 600; margin: 0; color: var(--heading);">üìö Bookstore
                        </h3>
                        <span
                            style="background: var(--button-bg); color: white; padding: 0.5rem 0.75rem; border-radius: 8px; font-size: 0.75rem; font-weight: 600;">Coming
                            Soon</span>
                    </div>

                    <!-- Bookstore Content -->
                    <div class="bookstore-content">
                        <div class="bookstore-main" style="text-align: center; margin-bottom: 1.5rem;">
                            <div class="bookstore-icon" style="font-size: 4rem; margin-bottom: 0.5rem;">üìñ</div>
                            <div class="bookstore-title-animated"
                                style="position: relative; height: 2.5rem; overflow: hidden;">
                                <div class="bookstore-title"
                                    style="font-size: 1.5rem; font-weight: bold; margin-bottom: 0.5rem; color: var(--heading); position: absolute; width: 100%; opacity: 1; transition: opacity 0.6s ease, transform 0.6s ease;">
                                    Educational Books</div>
                            </div>
                            <div class="bookstore-subtitle" style="font-size: 1rem; color: var(--text);">Buy, Sell &
                                Rent Textbooks</div>
                        </div>
                        <div class="bookstore-features"
                            style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 1rem;">
                            <div class="feature-item"
                                style="background: var(--highlight-bg); padding: 0.75rem; border-radius: 8px; text-align: center;">
                                <span style="display: block; font-size: 1.5rem; margin-bottom: 0.25rem;">üìó</span>
                                <span style="display: block; font-size: 0.875rem; color: var(--text);">New Books</span>
                            </div>
                            <div class="feature-item"
                                style="background: var(--highlight-bg); padding: 0.75rem; border-radius: 8px; text-align: center;">
                                <span style="display: block; font-size: 1.5rem; margin-bottom: 0.25rem;">üìò</span>
                                <span style="display: block; font-size: 0.875rem; color: var(--text);">Used Books</span>
                            </div>
                            <div class="feature-item"
                                style="background: var(--highlight-bg); padding: 0.75rem; border-radius: 8px; text-align: center;">
                                <span style="display: block; font-size: 1.5rem; margin-bottom: 0.25rem;">üí∞</span>
                                <span style="display: block; font-size: 0.875rem; color: var(--text);">Best
                                    Prices</span>
                            </div>
                            <div class="feature-item"
                                style="background: var(--highlight-bg); padding: 0.75rem; border-radius: 8px; text-align: center;">
                                <span style="display: block; font-size: 1.5rem; margin-bottom: 0.25rem;">üöö</span>
                                <span style="display: block; font-size: 0.875rem; color: var(--text);">Fast
                                    Delivery</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Gamestore Widget -->
                <div class="sidebar-widget gamestore-widget card" onclick="openComingSoonModal('gamestore')"
                    style="cursor: pointer; padding: 1.5rem; background: var(--card-bg); border-radius: 16px; transition: transform 0.3s ease, box-shadow 0.3s ease;"
                    onmouseover="this.style.transform='translateY(-4px)'; this.style.boxShadow='0 8px 16px rgba(0,0,0,0.1)'"
                    onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='none'">
                    <div class="widget-header"
                        style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                        <h3 style="font-size: 1.25rem; font-weight: 600; margin: 0; color: var(--heading);">üéÆ Gamestore
                        </h3>
                        <span
                            style="background: var(--button-bg); color: white; padding: 0.5rem 0.75rem; border-radius: 8px; font-size: 0.75rem; font-weight: 600;">Coming
                            Soon</span>
                    </div>
                    <div class="gamestore-content">
                        <div class="gamestore-main" style="text-align: center; margin-bottom: 1.5rem;">
                            <div class="gamestore-icon" style="font-size: 4rem; margin-bottom: 0.5rem;">üéÆ</div>
                            <div class="gamestore-title-animated"
                                style="position: relative; height: 2.5rem; overflow: hidden;">
                                <div class="gamestore-title"
                                    style="font-size: 1.5rem; font-weight: bold; margin-bottom: 0.5rem; color: var(--heading); position: absolute; width: 100%; opacity: 1; transition: opacity 0.6s ease, transform 0.6s ease;">
                                    Educational Games</div>
                            </div>
                            <div class="gamestore-subtitle" style="font-size: 1rem; color: var(--text);">Learn While
                                Playing</div>
                        </div>
                        <div class="gamestore-features"
                            style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 1rem;">
                            <div class="feature-item"
                                style="background: var(--highlight-bg); padding: 0.75rem; border-radius: 8px; text-align: center;">
                                <span style="display: block; font-size: 1.5rem; margin-bottom: 0.25rem;">üßÆ</span>
                                <span style="display: block; font-size: 0.875rem; color: var(--text);">Puzzle
                                    Games</span>
                            </div>
                            <div class="feature-item"
                                style="background: var(--highlight-bg); padding: 0.75rem; border-radius: 8px; text-align: center;">
                                <span style="display: block; font-size: 1.5rem; margin-bottom: 0.25rem;">üéØ</span>
                                <span style="display: block; font-size: 0.875rem; color: var(--text);">Strategy
                                    Games</span>
                            </div>
                            <div class="feature-item"
                                style="background: var(--highlight-bg); padding: 0.75rem; border-radius: 8px; text-align: center;">
                                <span style="display: block; font-size: 1.5rem; margin-bottom: 0.25rem;">üèÜ</span>
                                <span style="display: block; font-size: 0.875rem; color: var(--text);">Top Rated</span>
                            </div>
                            <div class="feature-item"
                                style="background: var(--highlight-bg); padding: 0.75rem; border-radius: 8px; text-align: center;">
                                <span style="display: block; font-size: 1.5rem; margin-bottom: 0.25rem;">üéÅ</span>
                                <span style="display: block; font-size: 0.875rem; color: var(--text);">Free to
                                    Play</span>
                            </div>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </section>

    <!-- Modals -->
    <!-- Edit Profile Modal -->
    <div id="editProfileModal" class="modal hidden">
        <div class="modal-overlay" onclick="closeEditProfileModal()"></div>
        <div class="modal-content enhanced-modal" style="max-width: 900px; max-height: 90vh; overflow-y: auto;">
            <div class="modal-header">
                <h2 class="modal-title">‚úèÔ∏è Edit Profile</h2>
                <button class="modal-close" onclick="closeEditProfileModal()">&times;</button>
            </div>
            <div class="modal-body" style="padding: 2rem;">
                <form id="editProfileForm">

                    <!-- Hero Titles Section -->
                    <div class="form-section" style="margin-bottom: 2rem;">
                        <h3 style="color: var(--text-primary); margin-bottom: 1rem; font-size: 1.2rem; display: flex; align-items: center; gap: 0.5rem;">
                            <span>üéØ</span> Hero Titles
                        </h3>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                            <div class="form-group">
                                <label>Hero Title</label>
                                <input type="text" id="editHeroTitle" class="form-input" placeholder="Your headline...">
                            </div>
                            <div class="form-group">
                                <label>Hero Subtitle</label>
                                <input type="text" id="editHeroSubtitle" class="form-input" placeholder="Your tagline...">
                            </div>
                        </div>
                    </div>

                    <!-- Basic Information Section -->
                    <div class="form-section" style="margin-bottom: 2rem;">
                        <h3 style="color: var(--text-primary); margin-bottom: 1rem; font-size: 1.2rem; display: flex; align-items: center; gap: 0.5rem;">
                            <span>üë§</span> Basic Information
                        </h3>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                            <div class="form-group">
                                <label>Username</label>
                                <input type="text" id="editUsername" class="form-input" placeholder="@username">
                            </div>
                            <div class="form-group">
                                <label>Location</label>
                                <input type="text" id="editLocation" class="form-input" placeholder="City, Country">

                                <!-- GPS Location Detection -->
                                <div style="margin-top: 0.75rem;">
                                    <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer; font-size: 0.875rem; color: var(--text-secondary); margin: 0;">
                                        <input type="checkbox" id="editAllowLocation" onchange="handleAllowLocationChange(this)" style="width: 16px; height: 16px; cursor: pointer;">
                                        <span>Enable GPS location detection</span>
                                    </label>
                                    <small style="color: var(--text-muted); font-size: 0.75rem; display: block; margin-top: 0.25rem;">Uses GPS/WiFi positioning to detect your physical location (not affected by VPN)</small>
                                </div>

                                <!-- Detect Location Button (shown when checkbox is checked) -->
                                <button type="button" id="detectLocationBtn" onclick="detectCurrentLocation()"
                                    style="display: none; margin-top: 0.5rem; font-size: 0.875rem; background: #10b981; color: white; padding: 0.375rem 0.75rem; border-radius: 0.5rem; border: none; cursor: pointer;">
                                    <i class="fas fa-location-arrow" style="margin-right: 0.25rem;"></i> Detect Location
                                </button>

                                <!-- Change Location Button (shown when location exists) -->
                                <button type="button" id="changeLocationBtn" onclick="handleChangeLocationUser()"
                                    style="display: none; margin-top: 0.5rem; font-size: 0.875rem; background: #3b82f6; color: white; padding: 0.375rem 0.75rem; border-radius: 0.5rem; border: none; cursor: pointer;">
                                    <i class="fas fa-edit" style="margin-right: 0.25rem;"></i> Change Location
                                </button>
                                <p id="locationStatus" style="display: none; font-size: 0.75rem; margin-top: 0.25rem;"></p>
                            </div>
                        </div>
                    </div>

                    <!-- Interests & Languages Section -->
                    <div class="form-section" style="margin-bottom: 2rem;">
                        <h3 style="color: var(--text-primary); margin-bottom: 1rem; font-size: 1.2rem; display: flex; align-items: center; gap: 0.5rem;">
                            <span>üìö</span> Languages & Interests
                        </h3>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                            <div class="form-group">
                                <label>Languages</label>
                                <input type="text" id="editLanguages" class="form-input" placeholder="English, Amharic, Oromifa (comma-separated)">
                            </div>
                            <div class="form-group">
                                <label>Interested In</label>
                                <input type="text" id="editInterestedIn" class="form-input" placeholder="Education, Learning, Technology (comma-separated)">
                            </div>
                        </div>
                    </div>

                    <!-- About Me Section -->
                    <div class="form-section" style="margin-bottom: 2rem;">
                        <h3 style="color: var(--text-primary); margin-bottom: 1rem; font-size: 1.2rem; display: flex; align-items: center; gap: 0.5rem;">
                            <span>üé®</span> About Me
                        </h3>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                            <div class="form-group">
                                <label>About Me</label>
                                <textarea id="editAbout" class="form-textarea" rows="4" placeholder="Tell us about yourself..."></textarea>
                            </div>
                            <div class="form-group">
                                <label>Favorite Quote</label>
                                <textarea id="editQuote" class="form-textarea" rows="4" placeholder="Your favorite quote..."></textarea>
                            </div>
                        </div>
                    </div>

                    <!-- Social Media Links Section -->
                    <div class="form-section" style="margin-bottom: 2rem;">
                        <h3 style="color: var(--text-primary); margin-bottom: 1rem; font-size: 1.2rem; display: flex; align-items: center; gap: 0.5rem;">
                            <span>üîó</span> Social Media Links
                        </h3>
                        <div class="form-group">
                            <label>Social Media Links (Optional)</label>
                            <div id="socialMediaContainer" style="margin-bottom: 0.5rem;"></div>
                            <button type="button" onclick="addSocialLink()" style="padding: 0.5rem 1rem; background: var(--button-bg); color: white; border: none; border-radius: 8px; cursor: pointer;">
                                ‚ûï Add Social Link
                            </button>
                        </div>
                    </div>

                </form>
            </div>
            <div class="modal-footer" style="display: flex; gap: 1rem; justify-content: flex-end; padding: 1.5rem;">
                <button onclick="closeEditProfileModal()" class="btn-secondary" style="padding: 0.75rem 2rem;">Cancel</button>
                <button onclick="saveUserProfile()" class="btn-primary" style="padding: 0.75rem 2rem;">üíæ Save Changes</button>
            </div>
        </div>
    </div>

    <!-- Modal will be loaded by CommonModalLoader -->

    <!-- Logout Modal will be loaded by CommonModalLoader -->

    <!-- Enhanced Footer -->
    <footer class="footer-section" id="footer" role="contentinfo">
        <div class="footer-wave" aria-hidden="true">
            <svg viewBox="0 0 1440 120" preserveAspectRatio="none">
                <defs>
                    <linearGradient id="wave-gradient" x1="0%" y1="0%" x2="100%" y2="0%">
                        <stop offset="0%" style="stop-color:var(--footer-accent);stop-opacity:0" />
                        <stop offset="25%" style="stop-color:var(--footer-accent);stop-opacity:1" />
                        <stop offset="75%" style="stop-color:var(--footer-hover);stop-opacity:1" />
                        <stop offset="100%" style="stop-color:var(--footer-hover);stop-opacity:0" />
                    </linearGradient>
                </defs>
                <!-- Main wave fill with explicit class -->
                <path class="wave-fill"
                    d="M0,64L48,69.3C96,75,192,85,288,80C384,75,480,53,576,48C672,43,768,53,864,58.7C960,64,1056,64,1152,58.7C1248,53,1344,43,1392,37.3L1440,32L1440,120L1392,120C1344,120,1248,120,1152,120C1056,120,960,120,864,120C768,120,672,120,576,120C480,120,384,120,288,120C192,120,96,120,48,120L0,120Z">
                </path>
                <!-- Animated line following the wave curve -->
                <path class="wave-line"
                    d="M0,64L48,69.3C96,75,192,85,288,80C384,75,480,53,576,48C672,43,768,53,864,58.7C960,64,1056,64,1152,58.7C1248,53,1344,43,1392,37.3L1440,32">
                </path>
            </svg>
        </div>

        <div class="container">
            <div class="footer-content">
                <div class="footer-section-item">
                    <h3 class="footer-title">Astegni Stats</h3>
                    <div class="footer-stats">
                        <div class="stat-item">
                            <span class="stat-number" id="footer-stat-users">-</span>
                            <span class="stat-label">Active Users</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-number" id="footer-stat-courses">-</span>
                            <span class="stat-label">Courses</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-number">Coming Soon</span>
                            <span class="stat-label">Success Rate</span>
                        </div>
                    </div>
                </div>

                <div class="footer-section-item">
                    <h3 class="footer-title">Quick Links</h3>
                    <ul class="footer-links">
                        <li><a href="#" class="footer-link" onclick="event.preventDefault();openAboutAstegniModal();">About Us</a></li>
                        <li><a href="#" class="footer-link" onclick="event.preventDefault();openComingSoonModal('Success Stories');">Success Stories</a></li>
                        <li><a href="#" class="footer-link" onclick="event.preventDefault();openComingSoonModal('Careers');">Careers</a></li>
                    </ul>
                </div>

                <div class="footer-section-item">
                    <h3 class="footer-title">Support</h3>
                    <ul class="footer-links">
                        <li><a href="#" class="footer-link">Contact Us</a></li>
                        <li><a href="#" class="footer-link">FAQs</a></li>
                        <li><a href="#" class="footer-link">Terms of Service</a></li>
                    </ul>
                </div>

                <div class="footer-section-item">
                    <h3 class="footer-title">Connect With Us</h3>
                    <div class="social-links">
                        <!-- TikTok -->
                        <a href="https://tiktok.com/@astegni" aria-label="TikTok" class="social-link" target="_blank" rel="noopener noreferrer">
                            <svg width="20" height="20" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M19.59 6.69a4.83 4.83 0 01-3.77-4.25V2h-3.45v13.67a2.89 2.89 0 01-5.2 1.74 2.89 2.89 0 012.31-4.64 2.93 2.93 0 01.88.13V9.4a6.84 6.84 0 00-1-.05A6.33 6.33 0 005 20.1a6.34 6.34 0 0010.86-4.43v-7a8.16 8.16 0 004.77 1.52v-3.4a4.85 4.85 0 01-1-.1z"/>
                            </svg>
                        </a>
                        <!-- Instagram -->
                        <a href="https://www.instagram.com/astegniethiopia" aria-label="Instagram" class="social-link" target="_blank" rel="noopener noreferrer">
                            <svg width="20" height="20" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zM12 0C8.741 0 8.333.014 7.053.072 2.695.272.273 2.69.073 7.052.014 8.333 0 8.741 0 12c0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98C8.333 23.986 8.741 24 12 24c3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98C15.668.014 15.259 0 12 0zm0 5.838a6.162 6.162 0 100 12.324 6.162 6.162 0 000-12.324zM12 16a4 4 0 110-8 4 4 0 010 8zm6.406-11.845a1.44 1.44 0 100 2.881 1.44 1.44 0 000-2.881z"/>
                            </svg>
                        </a>
                        <!-- Snapchat -->
                        <a href="https://snapchat.com/add/astegni" aria-label="Snapchat" class="social-link" target="_blank" rel="noopener noreferrer">
                            <svg width="20" height="20" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M12.017 0C5.396 0 .029 5.367.029 11.987c0 5.079 3.158 9.417 7.618 11.162-.105-.949-.199-2.403.041-3.439.219-.937 1.406-5.957 1.406-5.957s-.359-.72-.359-1.781c0-1.663.967-2.911 2.168-2.911 1.024 0 1.518.769 1.518 1.688 0 1.029-.653 2.567-.992 3.992-.285 1.193.6 2.165 1.775 2.165 2.128 0 3.768-2.245 3.768-5.487 0-2.861-2.063-4.869-5.008-4.869-3.41 0-5.409 2.562-5.409 5.199 0 1.033.394 2.143.889 2.741.099.12.112.225.085.345-.09.375-.293 1.199-.334 1.363-.053.225-.172.271-.401.165-1.495-.69-2.433-2.878-2.433-4.646 0-3.776 2.748-7.252 7.92-7.252 4.158 0 7.392 2.967 7.392 6.923 0 4.135-2.607 7.462-6.233 7.462-1.214 0-2.354-.629-2.758-1.379l-.749 2.848c-.269 1.045-1.004 2.352-1.498 3.146 1.123.345 2.306.535 3.55.535 6.607 0 11.985-5.365 11.985-11.987C23.97 5.39 18.592.026 11.985.026L12.017 0z"/>
                            </svg>
                        </a>
                        <!-- Facebook -->
                        <a href="https://facebook.com/astegni" aria-label="Facebook" class="social-link" target="_blank" rel="noopener noreferrer">
                            <svg width="20" height="20" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/>
                            </svg>
                        </a>
                        <!-- Telegram -->
                        <a href="https://t.me/astegni" aria-label="Telegram" class="social-link" target="_blank" rel="noopener noreferrer">
                            <svg width="20" height="20" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M11.944 0A12 12 0 000 12a12 12 0 0012 12 12 12 0 0012-12A12 12 0 0012 0a12 12 0 00-.056 0zm4.962 7.224c.1-.002.321.023.465.14a.506.506 0 01.171.325c.016.093.036.306.02.472-.18 1.898-.962 6.502-1.36 8.627-.168.9-.499 1.201-.82 1.23-.696.065-1.225-.46-1.9-.902-1.056-.693-1.653-1.124-2.678-1.8-1.185-.78-.417-1.21.258-1.91.177-.184 3.247-2.977 3.307-3.23.007-.032.014-.15-.056-.212s-.174-.041-.249-.024c-.106.024-1.793 1.14-5.061 3.345-.48.33-.913.49-1.302.48-.428-.008-1.252-.241-1.865-.44-.752-.245-1.349-.374-1.297-.789.027-.216.325-.437.893-.663 3.498-1.524 5.83-2.529 6.998-3.014 3.332-1.386 4.025-1.627 4.476-1.635z"/>
                            </svg>
                        </a>
                        <!-- WhatsApp -->
                        <a href="https://wa.me/251935244245" aria-label="WhatsApp" class="social-link" target="_blank" rel="noopener noreferrer">
                            <svg width="20" height="20" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413z"/>
                            </svg>
                        </a>
                        <!-- LinkedIn -->
                        <a href="https://linkedin.com/company/astegni" aria-label="LinkedIn" class="social-link" target="_blank" rel="noopener noreferrer">
                            <svg width="20" height="20" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/>
                            </svg>
                        </a>
                        <!-- X (Twitter) -->
                        <a href="https://x.com/astegniethiopia" aria-label="X" class="social-link" target="_blank" rel="noopener noreferrer">
                            <svg width="20" height="20" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/>
                            </svg>
                        </a>
                        <!-- YouTube -->
                        <a href="https://www.youtube.com/@Astegni" aria-label="YouTube" class="social-link" target="_blank" rel="noopener noreferrer">
                            <svg width="20" height="20" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M22.54 6.42a2.78 2.78 0 00-1.94-2C18.88 4 12 4 12 4s-6.88 0-8.6.46a2.78 2.78 0 00-1.94 2A29 29 0 001 12a29 29 0 00.46 5.58A2.78 2.78 0 003.4 19.6c1.72.46 8.6.46 8.6.46s6.88 0 8.6-.46a2.78 2.78 0 001.94-2A29 29 0 0023 12a29 29 0 00-.46-5.58zM9.75 15.02V8.98L15.5 12l-5.75 3.02z"/>
                            </svg>
                        </a>
                        <!-- GitHub -->
                        <a href="https://github.com/astegni" aria-label="GitHub" class="social-link" target="_blank" rel="noopener noreferrer">
                            <svg width="20" height="20" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M12 2C6.477 2 2 6.477 2 12c0 4.42 2.865 8.17 6.839 9.49.5.092.682-.217.682-.482 0-.237-.008-.866-.013-1.7-2.782.603-3.369-1.34-3.369-1.34-.454-1.156-1.11-1.463-1.11-1.463-.908-.62.069-.608.069-.608 1.003.07 1.531 1.03 1.531 1.03.892 1.529 2.341 1.087 2.91.831.092-.646.35-1.086.636-1.336-2.22-.253-4.555-1.11-4.555-4.943 0-1.091.39-1.984 1.029-2.683-.103-.253-.446-1.27.098-2.647 0 0 .84-.269 2.75 1.025A9.578 9.578 0 0112 6.836c.85.004 1.705.114 2.504.336 1.909-1.294 2.747-1.025 2.747-1.025.546 1.377.203 2.394.1 2.647.64.699 1.028 1.592 1.028 2.683 0 3.842-2.339 4.687-4.566 4.935.359.309.678.919.678 1.852 0 1.336-.012 2.415-.012 2.743 0 .267.18.578.688.48C19.138 20.167 22 16.418 22 12c0-5.523-4.477-10-10-10z"/>
                            </svg>
                        </a>
                    </div>

                    <div class="newsletter-signup">
                        <h4>Subscribe to Newsletter</h4>
                        <form class="newsletter-form" id="newsletterForm">
                            <input type="email" placeholder="Your email address" class="newsletter-input"
                                id="emailInput" aria-label="Email address" required>
                            <button type="submit" class="newsletter-btn" id="submitBtn">Subscribe</button>
                            <div class="newsletter-feedback" id="feedback"></div>
                        </form>
                    </div>
                </div>
            </div>

            <div class="footer-bottom-content">
                <div class="footer-badges">
                    <div class="company-brand">
                        <span>From the deep of</span>
                        <span class="trademark-symbol">‚Ñ¢</span>
                        <span class="company-text">Eshtaol</span>
                    </div>
                    <a href="tel:+251935244245" class="phone-link">
                        <span class="phone-icon">üìû</span>
                        <span>+251-935-24-42-45</span>
                        <span>+251-997-40-98-66</span>
                    </a>
                </div>
                <div class="footer-badges">
                    <p class="copyright">¬© </p>
                    <p>2025 Astegni. All rights reserved.</p>
                </div>
                <div class="footer-badges">
                    <span class="badge glow" tabindex="0">üîí SSL Secured</span>
                    <span class="badge" tabindex="0">‚úì Verified Platform</span>
                    <span class="badge" tabindex="0">üèÜ Future Awards Winner</span>
                </div>
            </div>
            <!-- TODO: counting cards should count from users where role = 'parent', 'student', 'tutor', etc... register-modal, reviews section professional-reviews-card should be enhanced. -->
        </div>
    </footer>

    <!-- JavaScript Files -->
    <!-- Root/Shared Scripts -->
    <script src="../js/root/app.js?v202602252204"></script>
    <script src="../js/root/auth.js?v202602252204"></script>
    <script src="../js/root/google-oauth.js?v202602252204"></script>
    <script src="../js/root/profile-system.js?v202602252204"></script>
    <script src="../js/root/nav.js?v202602252204"></script>
    <script src="../js/root/theme-toggle.js?v202602252204"></script>

    <!-- Common Modals -->
    <script src="../modals/common-modals/common-modal-loader.js"></script>
    <script src="../js/index/init-modals.js?v202602252204"></script>
    <script src="../js/common-modals/coming-soon-modal.js?v202602252204"></script>
    <script src="../js/common-modals/footer-manager.js?v202602252204"></script>
    <script src="../js/common-modals/ad-modal.js?v202602252204"></script>
    <script src="../js/common-modals/ad-rotation-manager.js?v202602252204"></script>
    <script src="../js/common-modals/logout-modal.js?v202602252204"></script>
    <!-- Chat Modal -->
    <script src="../js/common-modals/chat-modal.js?v202602252204"></script>
    <!-- Community Modal (load communityManager.js BEFORE community-modal-manager.js) -->
    <script src="../js/common-modals/communityManager.js?v202602252204"></script>
    <script src="../js/common-modals/community-modal-manager.js?v202602252204"></script>

    <!-- User Profile Specific Scripts -->
    <script src="../js/page-structure/user-profile.js?v202602252204"></script>

    <!-- Universal Upload Handler -->
    <script src="../js/root/storage-manager.js?v202602252204"></script>
    <script src="../js/advertiser-profile/universal-upload-handler.js?v202602252204"></script>

    <!-- Earnings & Investments Manager -->
    <script src="../js/tutor-profile/earnings-investments-manager.js?v202602252204"></script>

    <!-- Shared Sidebar Toggle -->
    <script src="../js/shared/sidebar-toggle.js?v202602252204"></script>

    <!-- Floating Action Button -->
    <div id="fab-container" class="fab-container">
        <button id="fab-button" class="fab-button" onclick="toggleFabMenu()">
            <span class="fab-icon">+</span>
        </button>
        <div id="fab-menu" class="fab-menu hidden">
            <a href="../branch/find-tutors.html" class="fab-item">
                <span class="fab-item-icon">üë®‚Äçüè´</span>
                <span class="fab-item-label">Find Tutors</span>
            </a>
            <a href="../branch/videos.html" class="fab-item">
                <span class="fab-item-icon">üé¨</span>
                <span class="fab-item-label">Browse Videos</span>
            </a>
            <a href="#" onclick="switchPanel('my-engagements'); toggleFabMenu(); return false;" class="fab-item">
                <span class="fab-item-icon">‚ù§Ô∏è</span>
                <span class="fab-item-label">Engagements</span>
            </a>
            <a href="#" onclick="switchPanel('settings'); toggleFabMenu(); return false;" class="fab-item">
                <span class="fab-item-icon">‚öôÔ∏è</span>
                <span class="fab-item-label">Settings</span>
            </a>
        </div>
    </div>

    <!-- Coming Soon Modal -->
    <div id="coming-soon-modal" class="modal hidden">
        <div class="modal-content enhanced coming-soon-content">
            <button class="modal-close-enhanced" onclick="closeModal('coming-soon-modal')">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12">
                    </path>
                </svg>
            </button>

            <div class="coming-soon-header">
                <div class="coming-soon-icon">
                    <svg class="w-16 h-16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z">
                        </path>
                    </svg>
                </div>
                <h3 class="modal-title">Coming Soon!</h3>
                <p class="modal-subtitle" id="coming-soon-message">We're working hard to bring you this feature. Stay
                    tuned!</p>
            </div>
        </div>
    </div>

    <!-- Toast Notification Container -->
    <div id="toast-container" class="toast-container"></div>

    <!-- Modal Container: All modals will be loaded here dynamically -->
    <div id="modal-container"></div>

    <!-- Settings Panel Modal Scripts -->
    <script src="../js/tutor-profile/settings-panel-personal-verification.js?v202602252204"></script>
    <script src="../js/tutor-profile/payment-method-modal.js?v202602252204"></script>
    <!-- Subscription Modal JavaScript (Dynamic - fetches plans based on role) -->
    <script src="../js/common-modals/subscription-modal.js?v202602252204"></script>
    <!-- Appearance Manager (Theme, Font Size, Display Density, etc.) -->
    <script src="../js/common-modals/appearance-manager.js?v202602252204"></script>
    <!-- Extended Settings Manager (2FA, Login Activity, Connected Accounts, etc.) -->
    <script src="../js/common-modals/settings-manager.js?v202602252204"></script>
    <!-- Two-Factor Authentication Manager -->
    <script src="../js/common-modals/tfa-manager.js?v202602252204"></script>
    <!-- Role Manager -->
    <script src="../js/common-modals/role-manager.js?v202602252204"></script>
    <script src="../js/common-modals/review-astegni-manager.js?v202602252204"></script>

    <!-- Load Settings Modals HTML -->
    <script>
        // Load verify-personal-info-modal
        fetch('../modals/common-modals/verify-personal-info-modal.html')
            .then(response => response.text())
            .then(html => {
                let container = document.getElementById('modal-container');
                if (!container) {
                    container = document.createElement('div');
                    container.id = 'modal-container';
                    document.body.appendChild(container);
                }
                container.insertAdjacentHTML('beforeend', html);
                console.log('[OK] Verify Personal Info Modal loaded');
            })
            .catch(error => console.error('Failed to load verify-personal-info-modal:', error));

        // Load payment-method-modal
        fetch('../modals/common-modals/payment-method-modal.html')
            .then(response => response.text())
            .then(html => {
                let container = document.getElementById('modal-container');
                if (!container) {
                    container = document.createElement('div');
                    container.id = 'modal-container';
                    document.body.appendChild(container);
                }
                container.insertAdjacentHTML('beforeend', html);
                console.log('[OK] Payment Method Modal loaded');
            })
            .catch(error => console.error('Failed to load payment-method-modal:', error));

        // Load leave-astegni-modal
        fetch('../modals/common-modals/leave-astegni-modal.html')
            .then(response => response.text())
            .then(html => {
                let container = document.getElementById('modal-container');
                if (!container) {
                    container = document.createElement('div');
                    container.id = 'modal-container';
                    document.body.appendChild(container);
                }
                container.insertAdjacentHTML('beforeend', html);
                console.log('[OK] Leave Astegni Modal loaded');
            })
            .catch(error => console.error('Failed to load leave-astegni-modal:', error));

        // Load review-astegni-modal HTML dynamically
        (function loadReviewAstegniModal() {
            fetch('../modals/common-modals/review-astegni-modal.html')
                .then(response => response.text())
                .then(html => {
                    let container = document.getElementById('modal-container');
                    if (!container) {
                        container = document.createElement('div');
                        container.id = 'modal-container';
                        document.body.appendChild(container);
                    }
                    container.insertAdjacentHTML('beforeend', html);
                    console.log('‚úÖ Review Astegni Modal loaded for user-profile');
                })
                .catch(error => console.error('Failed to load review-astegni-modal:', error));
        })();
    </script>

    <!-- Deletion Countdown Banner (shows when user has pending role deletion) -->
    <script src="../js/common-modals/deletion-countdown-banner.js?v202602252204"></script>

    <!-- Geolocation Utilities for GPS-based location detection -->
    <script src="../js/utils/geolocation-utils.js?v202602252204"></script>

    <!-- Currency Utilities for dynamic currency display -->
    <script src="../js/utils/currency-utils.js?v202602252204"></script>

    <!-- Leave Astegni Modal - LOADED LAST to ensure all dependencies are ready -->
    <script src="../js/common-modals/leave-astegni-modal.js?v202602252204"></script>

    <!-- Helper functions and fallback loading -->
    <script>
        // Helper function to get current location value
        window.getLocations = function() {
            const locationInput = document.getElementById('editLocation');
            return locationInput ? [locationInput.value.trim()].filter(v => v) : [];
        };

        // FIX: Ensure Leave Astegni modal functions are loaded
        // This handles cases where the script loads but doesn't execute properly
        (function ensureLeaveAstegniLoaded() {
            function checkAndLoad() {
                if (typeof openLeaveAstegniModal === 'undefined') {
                    console.warn('‚ö†Ô∏è Leave Astegni functions not loaded, attempting to reload...');

                    // Reload the script
                    const script = document.createElement('script');
                    script.src = '../js/common-modals/leave-astegni-modal.js?v202602252204' + Date.now();
                    script.onload = function() {
                        console.log('‚úÖ Leave Astegni modal functions loaded successfully');
                        console.log('   Function type:', typeof openLeaveAstegniModal);
                    };
                    script.onerror = function() {
                        console.error('‚ùå Failed to load leave-astegni-modal.js');
                    };
                    document.head.appendChild(script);
                } else {
                    console.log('‚úÖ Leave Astegni modal functions already loaded');
                }
            }

            // Try immediately
            checkAndLoad();

            // Also check after DOM is fully loaded (failsafe)
            if (document.readyState === 'loading') {
                document.addEventListener('DOMContentLoaded', checkAndLoad);
            }

            // Final check after window load (last resort)
            window.addEventListener('load', function() {
                if (typeof openLeaveAstegniModal === 'undefined') {
                    console.error('‚ùå CRITICAL: Leave Astegni functions still not loaded after page load!');
                    checkAndLoad();
                }
            });
        })();
    </script>

    <!-- Share Profile Manager -->
    <script src="../js/common-modals/share-profile-manager.js?v202602252204"></script>

    <!-- Referral Dashboard Manager -->
    <script src="../js/common-modals/referral-dashboard-manager.js?v202602252204"></script>

    <!-- Load Universal Upload Modal -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Load universal upload modal
            if (typeof CommonModalLoader !== 'undefined') {
                CommonModalLoader.load('universal-upload-modal.html')
                    .then(() => {
                        console.log('[user-profile.html] ‚úÖ Universal upload modal loaded');
                    })
                    .catch(error => {
                        console.error('[user-profile.html] ‚ùå Failed to load universal upload modal:', error);
                    });
            }
        });
    </script>

    <!-- Fix Active Role for User Profile -->
    <script>
        // CRITICAL FIX: Ensure active_role is set to "user" when on user-profile.html
        (function() {
            const currentActiveRole = localStorage.getItem('active_role');
            const currentUser = localStorage.getItem('currentUser');

            // Only set to "user" if we're on user-profile.html
            if (currentActiveRole !== 'user') {
                console.log('[user-profile.html] Fixing active_role from', currentActiveRole, 'to "user"');
                localStorage.setItem('active_role', 'user');
                localStorage.setItem('userRole', 'user');

                // Update currentUser object
                if (currentUser) {
                    try {
                        const userObj = JSON.parse(currentUser);
                        userObj.active_role = 'user';
                        localStorage.setItem('currentUser', JSON.stringify(userObj));
                        console.log('[user-profile.html] ‚úÖ Active role fixed to "user"');
                    } catch (error) {
                        console.error('[user-profile.html] Error updating currentUser:', error);
                    }
                }
            } else {
                console.log('[user-profile.html] ‚úÖ Active role already set to "user"');
            }
        })();
    </script>

    <!-- Debug Share Button -->
    <script>
        // Debug: Check if shareProfile is loaded
        console.log('[DEBUG] shareProfile function exists:', typeof shareProfile);
        console.log('[DEBUG] localStorage.currentUser:', !!localStorage.getItem('currentUser'));
        console.log('[DEBUG] localStorage.user:', !!localStorage.getItem('user'));
        console.log('[DEBUG] localStorage.token:', !!localStorage.getItem('token'));
        console.log('[DEBUG] localStorage.userRole:', localStorage.getItem('userRole'));
        console.log('[DEBUG] localStorage.active_role:', localStorage.getItem('active_role'));

        // Wrap shareProfile to add logging
        if (typeof shareProfile === 'function') {
            const originalShareProfile = window.shareProfile;
            window.shareProfile = async function() {
                console.log('[DEBUG] shareProfile() called!');
                console.log('[DEBUG] Arguments:', arguments);
                try {
                    const result = await originalShareProfile.apply(this, arguments);
                    console.log('[DEBUG] shareProfile() completed successfully');
                    return result;
                } catch (error) {
                    console.error('[DEBUG] shareProfile() error:', error);
                    alert('Debug: Error in shareProfile - ' + error.message);
                    throw error;
                }
            };
            console.log('[DEBUG] shareProfile() wrapper installed');
        } else {
            console.error('[DEBUG] shareProfile() NOT FOUND! Script may not have loaded.');
        }
    </script>

</body>
</html>

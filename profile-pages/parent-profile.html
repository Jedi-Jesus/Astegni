<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ASTEGNI - Parent Profile</title>
    <!-- TailwindCSS CDN -->
    <script src="../js/config.js?v=20251217"></script>
    <!-- Safe wrapper for openChatModal - waits for function to be available -->
    <script>
        // Temporary stub - will be replaced by chat-modal.js when it loads
        if (!window.openChatModal) {
            window.openChatModal = function(targetUser = null) {
                if (typeof ChatModalManager !== 'undefined') {
                    ChatModalManager.open(targetUser);
                } else {
                    console.log('Chat modal not loaded yet, waiting...');
                    // Wait for chat modal to load
                    const checkInterval = setInterval(function() {
                        if (typeof ChatModalManager !== 'undefined') {
                            clearInterval(checkInterval);
                            ChatModalManager.open(targetUser);
                        }
                    }, 100);
                    // Stop checking after 10 seconds
                    setTimeout(function() {
                        clearInterval(checkInterval);
                    }, 10000);
                }
            };
        }
    </script>
    <!-- Fix Loading Screen - Removes inappropriate loading screens -->
    <script src="../js/fix-loading-screen.js"></script>
    <!-- Active Role Guard - Prevents access to deactivated roles -->
    <script src="../js/root/active-role-guard.js"></script>
    <!-- Preconnect for faster font loading -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <!-- Google Fonts - For Appearance Modal Font Selection -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Roboto:wght@400;500;700&family=Open+Sans:wght@400;600;700&family=Comic+Neue:wght@400;700&family=Caveat:wght@400;500;600;700&family=Patrick+Hand&family=Dancing+Script:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Animate.css for animations -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css" />
    <!-- Custom Styles -->
    <link rel="stylesheet" href="../css/root.css?v=20260206-adblocker-fix">
    <link rel="stylesheet" href="../css/find-tutors/navbar.css">
    <link rel="stylesheet" href="../css/tutor-profile/right-widgets.css">
    <link rel="stylesheet" href="../css/admin-profile/admin.css">
    <link rel="stylesheet" href="../css/parent-profile/parent-profile.css">
    <link rel="stylesheet" href="../css/parent-profile/right-widgets.css?v=20260205b">
    <link rel="stylesheet" href="../css/parent-profile/parent-community.css">
    <link rel="stylesheet" href="../css/parent-profile/requests-panel.css">
    <link rel="stylesheet" href="../css/find-tutors/hero-section.css">
    <link rel="stylesheet" href="../css/find-tutors/tutor-card.css">
    <!-- Shared Modal Styles -->
    <link rel="stylesheet" href="../css/common-modals/access-restricted-modal.css">
    <link rel="stylesheet" href="../css/common-modals/add-role-modal.css">
    <link rel="stylesheet" href="../css/common-modals/coming-soon-modal.css">
    <link rel="stylesheet" href="../css/common-modals/ad-modal.css">
    <link rel="stylesheet" href="../css/common-modals/appearance-modal.css">
    <link rel="stylesheet" href="../css/common-modals/chat-modal.css">
    <!-- Standalone Chat Call Modal Styles -->
    <link rel="stylesheet" href="../css/common-modals/chat-call-modal.css">
    <link rel="stylesheet" href="../css/common-modals/view-request-modal.css">
    <link rel="stylesheet" href="../css/common-modals/view-schedule-modal.css">
    <link rel="stylesheet" href="../css/common-modals/confirm-delete-schedule-modal.css">
    <!-- Community Modal Styles -->
    <link rel="stylesheet" href="../css/common-modals/community-modal.css">
    <!-- Student Details Modal Styles (shared from tutor-profile) -->
    <link rel="stylesheet" href="../css/tutor-profile/tutor-profile.css">
    <!-- Advanced Notes Panel Styles -->
    <link rel="stylesheet" href="../css/common-modals/advanced-notes.css">
    <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <!-- Minimal inline styles - only for profile-specific fixes -->
    <style>
        /* Loading spinner animation */
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Compensate for fixed navbar */
        body {
            padding-top: 72px;
        }
        /* Fix overflow hidden that clips tooltip */
        .profile-header-section {
            overflow: visible !important;
        }
        /* Fix name truncation - allow full name to display */
        .profile-name {
            font-size: 2rem;
            font-weight: bold;
            color: var(--text-primary);
            margin-bottom: 0.5rem;
            white-space: normal !important;
            overflow: visible !important;
            text-overflow: clip !important;
            word-wrap: break-word;
        }
        .profile-main-info {
            overflow: visible !important;
        }
        .profile-details-section {
            overflow: visible !important;
        }
        /* Rating Tooltip - Force visibility on hover */
        .profile-header-section .rating-section,
        .rating-section {
            position: relative !important;
            overflow: visible !important;
            display: inline-block !important;
        }
        .profile-header-section .rating-wrapper,
        .rating-wrapper {
            position: relative !important;
            display: flex !important;
            align-items: center !important;
            gap: 0.75rem !important;
            cursor: pointer !important;
            overflow: visible !important;
        }
        .rating-tooltip-container {
            position: relative !important;
            display: inline-block !important;
        }
        .rating-tooltip {
            position: absolute !important;
            top: 110% !important;
            left: 50% !important;
            transform: translateX(-50%) !important;
            background: var(--card-bg) !important;
            border: 1px solid rgba(0, 0, 0, 0.1) !important;
            border-radius: 12px !important;
            padding: 1rem !important;
            min-width: 280px !important;
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.15) !important;
            opacity: 0 !important;
            visibility: hidden !important;
            transition: all 0.3s ease !important;
            z-index: 99999 !important;
            pointer-events: none !important;
        }
        .profile-header-section .rating-wrapper:hover .rating-tooltip,
        .rating-wrapper:hover .rating-tooltip,
        #rating-hover-trigger:hover #rating-tooltip {
            opacity: 1 !important;
            visibility: visible !important;
            top: calc(100% + 10px) !important;
            pointer-events: auto !important;
            display: block !important;
        }
        .rating-tooltip::before {
            content: '' !important;
            position: absolute !important;
            top: -8px !important;
            left: 50% !important;
            transform: translateX(-50%) !important;
            border-left: 8px solid transparent !important;
            border-right: 8px solid transparent !important;
            border-bottom: 8px solid var(--card-bg) !important;
        }
        /* Dark mode support */
        [data-theme="dark"] .rating-tooltip {
            background: #1f2937 !important;
            border-color: #374151 !important;
        }
        [data-theme="dark"] .rating-tooltip::before {
            border-bottom-color: #1f2937 !important;
        }
        /* Profile Header Tooltip: Rating Metrics with Progress Bars */
        .rating-tooltip .rating-metric {
            margin-bottom: 0.875rem;
        }
        .rating-tooltip .rating-metric:last-child {
            margin-bottom: 0;
        }
        .rating-tooltip .metric-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.375rem;
        }
        .rating-tooltip .metric-label {
            font-size: 0.8rem;
            color: var(--text-muted);
            font-weight: 500;
        }
        .rating-tooltip .metric-score {
            font-size: 0.875rem;
            font-weight: 700;
            color: var(--button-bg);
        }
        .rating-tooltip .metric-bar {
            height: 6px;
            background: var(--highlight-bg);
            border-radius: 3px;
            overflow: hidden;
        }
        .rating-tooltip .metric-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--button-bg), #7C3AED);
            border-radius: 3px;
            transition: width 0.3s ease;
        }
        /* Fix ALL parent containers that might clip tooltip */
        .panels-container,
        .panel-content,
        .profile-header,
        .profile-avatar-container,
        .profile-name-row,
        .cover-image-container,
        .reviews-container,
        .review-card,
        .review-rating-wrapper {
            overflow: visible !important;
        }
        /* ============================================
           ENHANCED PROFILE HEADER SECTION STYLES
           ============================================ */
        .profile-header-section {
            background: var(--card-bg);
            border-radius: 20px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
            margin-bottom: 2rem;
            position: relative;
            overflow: visible !important;
            transition: all 0.3s ease;
        }
        .profile-header-section:hover {
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.12);
        }
        /* Enhanced Cover Image */
        .cover-image-container {
            position: relative;
            height: 280px;
            border-radius: 20px 20px 0 0;
            overflow: hidden;
        }
        .cover-img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.5s ease;
        }
        .cover-image-container:hover .cover-img {
            transform: scale(1.05);
        }
        .cover-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(180deg,
                    rgba(0, 0, 0, 0.1) 0%,
                    rgba(0, 0, 0, 0.3) 100%);
            pointer-events: none;
        }
        .cover-upload-btn {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border: none;
            border-radius: 12px;
            padding: 0.75rem;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            z-index: 10;
        }
        .cover-upload-btn:hover {
            background: white;
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(0, 0, 0, 0.2);
        }
        .cover-upload-btn svg {
            width: 20px;
            height: 20px;
            color: #4f46e5;
        }
        /* Enhanced Profile Info Section */
        .profile-main-info {
            padding: 0 2rem 2rem 2rem;
            margin-top: -60px;
            position: relative;
            z-index: 5;
        }
        .profile-info-wrapper {
            display: flex;
            gap: 2rem;
            align-items: flex-start;
        }
        /* Enhanced Avatar */
        .profile-avatar-container {
            position: relative;
            flex-shrink: 0;
        }
        .profile-avatar {
            width: 140px;
            height: 140px;
            border-radius: 50%;
            border: 5px solid var(--card-bg);
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.15);
            object-fit: cover;
            transition: all 0.3s ease;
        }
        .profile-avatar-container:hover .profile-avatar {
            transform: scale(1.05);
            box-shadow: 0 12px 32px rgba(0, 0, 0, 0.2);
        }
        .online-indicator {
            position: absolute;
            bottom: 10px;
            right: 10px;
            width: 24px;
            height: 24px;
            background: #22c55e;
            border: 4px solid var(--card-bg);
            border-radius: 50%;
            box-shadow: 0 2px 8px rgba(34, 197, 94, 0.4);
            animation: pulse-indicator 2s ease-in-out infinite;
        }
        @keyframes pulse-indicator {
            0%,
            100% {
                box-shadow: 0 2px 8px rgba(34, 197, 94, 0.4);
            }
            50% {
                box-shadow: 0 2px 16px rgba(34, 197, 94, 0.8);
            }
        }
        .avatar-upload-btn {
            position: absolute;
            bottom: 5px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border: none;
            border-radius: 8px;
            padding: 0.5rem;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            opacity: 0;
        }
        .profile-avatar-container:hover .avatar-upload-btn {
            opacity: 1;
        }
        .avatar-upload-btn:hover {
            background: white;
            transform: translateX(-50%) translateY(-2px);
        }
        .avatar-upload-btn svg {
            width: 16px;
            height: 16px;
            color: #4f46e5;
        }
        /* Enhanced Profile Details */
        .profile-details-section {
            flex: 1;
            padding-top: 0.5rem;
        }
        .profile-name-row {
            margin-bottom: 1rem;
        }
        .profile-name {
            font-size: 2.25rem;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 0.75rem;
            line-height: 1.2;
            background: linear-gradient(135deg, var(--text-primary) 0%, var(--heading) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        .badges-row {
            display: flex;
            flex-wrap: wrap;
            gap: 0.75rem;
            margin-bottom: 1rem;
        }
        .profile-badge {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-size: 0.875rem;
            font-weight: 600;
            transition: all 0.3s ease;
            cursor: default;
        }
        .profile-badge.verified {
            background: linear-gradient(135deg, #22c55e 0%, #16a34a 100%);
            color: white;
            box-shadow: 0 4px 12px rgba(34, 197, 94, 0.3);
        }
        .profile-badge.verified:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(34, 197, 94, 0.4);
        }
        .profile-badge.children {
            background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
            color: white;
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3);
        }
        .profile-badge.children:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(59, 130, 246, 0.4);
        }
        .profile-badge.active {
            background: linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%);
            color: white;
            box-shadow: 0 4px 12px rgba(139, 92, 246, 0.3);
        }
        .profile-badge.active:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(139, 92, 246, 0.4);
        }
        /* Enhanced Rating Section */
        .rating-value {
            font-size: 2rem;
            font-weight: 700;
            color: #f59e0b;
            text-shadow: 0 2px 4px rgba(245, 158, 11, 0.2);
        }
        .rating-stars {
            color: #f59e0b;
            font-size: 1.5rem;
            letter-spacing: 2px;
            text-shadow: 0 2px 4px rgba(245, 158, 11, 0.2);
        }
        .rating-count {
            color: var(--text-secondary);
            font-size: 0.95rem;
            font-weight: 500;
        }
        .rating-label {
            color: var(--text-secondary);
            font-size: 0.875rem;
            margin-top: 0.25rem;
        }
        /* Enhanced Location/Info Items */
        .profile-location {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.75rem 1rem;
            background: rgba(var(--button-bg-rgb), 0.05);
            border-radius: 12px;
            margin-bottom: 0.75rem;
            transition: all 0.3s ease;
        }
        .profile-location:hover {
            background: rgba(var(--button-bg-rgb), 0.1);
            transform: translateX(5px);
        }
        .location-icon {
            font-size: 1.25rem;
        }
        .profile-location span:last-child {
            color: var(--text);
            font-size: 0.95rem;
        }
        /* Enhanced About Me / Info Grid Section */
        .profile-info-grid {
            background: rgba(var(--button-bg-rgb), 0.03);
            border-radius: 16px;
            padding: 1.5rem;
            margin-top: 1.5rem;
            border: 1px solid rgba(var(--border-rgb), 0.1);
        }
        .info-item {
            display: flex;
            align-items: baseline;
            gap: 0.5rem;
            margin-bottom: 1rem;
        }
        .info-item:last-child {
            margin-bottom: 0;
        }
        .info-label {
            font-weight: 600;
            color: var(--heading);
            font-size: 0.95rem;
            min-width: 120px;
        }
        .info-value {
            color: var(--text);
            font-size: 0.95rem;
        }
        .info-description {
            margin-top: 1rem;
            padding-top: 1rem;
            border-top: 1px solid rgba(var(--border-rgb), 0.1);
        }
        .info-description p {
            color: var(--text);
            line-height: 1.7;
            font-size: 0.95rem;
        }
        /* Enhanced Quote Section */
        .profile-quote {
            background: linear-gradient(135deg, rgba(79, 70, 229, 0.1) 0%, rgba(124, 58, 237, 0.05) 100%);
            border-left: 4px solid #4f46e5;
            border-radius: 12px;
            padding: 1.25rem 1.5rem;
            margin-top: 1.5rem;
            position: relative;
            font-style: italic;
            color: var(--text);
            font-size: 1rem;
            line-height: 1.6;
            box-shadow: 0 2px 8px rgba(79, 70, 229, 0.1);
        }
        .profile-quote::before {
            content: '"';
            position: absolute;
            top: -10px;
            left: 15px;
            font-size: 3rem;
            color: #4f46e5;
            opacity: 0.3;
            font-family: Georgia, serif;
        }
        .profile-quote span {
            position: relative;
            z-index: 1;
        }
        /* Enhanced Social Links Section */
        .profile-socials {
            margin-top: 1.5rem;
            padding: 1.5rem;
            background: rgba(var(--button-bg-rgb), 0.03);
            border-radius: 16px;
            border: 1px solid rgba(var(--border-rgb), 0.1);
        }
        .profile-socials h4 {
            font-weight: 600;
            font-size: 0.95rem;
            color: var(--heading);
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
        }
        .social-links {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
        }
        .social-links .social-link {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 44px;
            height: 44px;
            border-radius: 12px;
            background: var(--card-bg);
            border: 2px solid rgba(var(--border-rgb), 0.2);
            color: var(--text);
            transition: all 0.3s ease;
            text-decoration: none;
            position: relative;
            overflow: hidden;
        }
        .social-links .social-link::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, var(--button-bg), var(--button-hover));
            opacity: 0;
            transition: opacity 0.3s ease;
            z-index: 0;
        }
        .social-links .social-link:hover::before {
            opacity: 1;
        }
        .social-links .social-link svg {
            width: 20px;
            height: 20px;
            position: relative;
            z-index: 1;
            transition: all 0.3s ease;
        }
        .social-links .social-link:hover {
            transform: translateY(-4px);
            box-shadow: 0 6px 20px rgba(var(--button-bg-rgb), 0.3);
            border-color: var(--button-bg);
        }
        .social-links .social-link:hover svg {
            color: white;
        }
        /* Enhanced Profile Actions */
        .profile-actions {
            display: flex;
            gap: 1rem;
            margin-top: 2rem;
            flex-wrap: wrap;
        }
        .profile-actions .btn-primary,
        .profile-actions .btn-secondary {
            flex: 1;
            min-width: 160px;
            padding: 0.875rem 1.5rem;
            font-weight: 600;
            border-radius: 12px;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }
        .profile-actions .btn-primary {
            background: linear-gradient(135deg, #4f46e5 0%, #7c3aed 100%);
            color: white;
            border: none;
            box-shadow: 0 4px 12px rgba(79, 70, 229, 0.3);
        }
        .profile-actions .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(79, 70, 229, 0.4);
        }
        .profile-actions .btn-secondary {
            background: transparent;
            color: var(--text);
            border: 2px solid rgba(var(--border-rgb), 0.3);
        }
        .profile-actions .btn-secondary:hover {
            background: rgba(var(--button-bg-rgb), 0.05);
            border-color: var(--button-bg);
            transform: translateY(-2px);
        }
        /* Enhanced Connections Section */
        .profile-connections {
            margin-top: 1.5rem;
            padding: 1.5rem;
            background: rgba(var(--button-bg-rgb), 0.03);
            border-radius: 16px;
            border: 1px solid rgba(var(--border-rgb), 0.1);
        }
        .connections-header h4 {
            font-weight: 600;
            font-size: 0.95rem;
            color: var(--heading);
            display: flex;
            align-items: center;
        }
        .connections-stats {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 1rem;
            text-align: center;
        }
        .stat-box {
            padding: 1rem;
            background: var(--card-bg);
            border-radius: 12px;
            transition: all 0.3s ease;
            border: 1px solid rgba(var(--border-rgb), 0.1);
        }
        .stat-box:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
        }
        .stat-box div:first-child {
            font-size: 1.75rem;
            font-weight: 700;
            color: var(--heading);
            margin-bottom: 0.25rem;
        }
        .stat-box div:last-child {
            font-size: 0.8rem;
            color: var(--text-muted);
        }
        /* Responsive Design */
        @media (max-width: 768px) {
            .profile-info-wrapper {
                flex-direction: column;
                align-items: center;
                text-align: center;
            }
            .profile-avatar {
                width: 120px;
                height: 120px;
            }
            .profile-name {
                font-size: 1.75rem;
            }
            .badges-row {
                justify-content: center;
            }
            .profile-location {
                justify-content: center;
            }
            .info-item {
                flex-direction: column;
                text-align: center;
                gap: 0.25rem;
            }
            .info-label {
                min-width: auto;
            }
            .profile-actions {
                flex-direction: column;
            }
            .profile-actions .btn-primary,
            .profile-actions .btn-secondary {
                width: 100%;
            }
            .connections-stats {
                grid-template-columns: 1fr;
            }
            .social-links {
                justify-content: center;
            }
        }
        /* ============================================
           STUDY TIPS TICKER ANIMATION
           ============================================ */
        .activity-ticker-container {
            height: 95px;
            overflow: hidden;
            position: relative;
            background: rgba(var(--button-bg-rgb), 0.02);
            border-radius: var(--radius-md);
        }
        .activity-ticker {
            animation: tickerRoll 18s cubic-bezier(0.4, 0, 0.2, 1) infinite;
        }
        .activity-item {
            display: flex;
            align-items: start;
            gap: 0.5rem;
            padding: 0.75rem;
            height: 95px;
            box-sizing: border-box;
            transition: background var(--transition-base);
        }
        .activity-item:hover {
            background: rgba(var(--button-bg-rgb), 0.05);
        }
        @keyframes tickerRoll {
            0% {
                transform: translateY(0);
            }
            16.66% {
                transform: translateY(0);
            }
            20% {
                transform: translateY(-95px);
            }
            36.66% {
                transform: translateY(-95px);
            }
            40% {
                transform: translateY(-190px);
            }
            56.66% {
                transform: translateY(-190px);
            }
            60% {
                transform: translateY(-285px);
            }
            76.66% {
                transform: translateY(-285px);
            }
            80% {
                transform: translateY(-380px);
            }
            96.66% {
                transform: translateY(-380px);
            }
            100% {
                transform: translateY(-475px);
            }
        }
        /* Pause animation on hover */
        .activity-ticker-container:hover .activity-ticker {
            animation-play-state: paused;
        }
        /* ============================================
           FIX: Prevent profile-header-section from moving with sidebar
           ============================================ */
        /* The profile-header-section is nested inside the main content,
           so we need to prevent it from being affected by sidebar animation */
        .profile-header-section.sidebar-active {
            transform: none !important;
        }
        /* Also prevent any nested sections from moving */
        .panel-content section.sidebar-active {
            transform: none !important;
        }
        /* ============================================
           UPLOAD MODAL STYLES
           ============================================ */
        .upload-cover-modal,
        .upload-profile-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(10px);
            z-index: 10000;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 1rem;
        }
        .upload-cover-modal .modal-content,
        .upload-profile-modal .modal-content {
            background: var(--card-bg);
            border-radius: 20px;
            max-width: 600px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        }
        .upload-cover-modal .modal-inner,
        .upload-profile-modal .modal-inner {
            padding: 2rem;
        }
        .upload-area {
            border: 2px dashed var(--border);
            border-radius: 12px;
            padding: 3rem 2rem;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            background: var(--highlight-bg);
        }
        .upload-area:hover {
            border-color: var(--button-bg);
            background: rgba(var(--button-bg-rgb), 0.05);
        }
        .upload-icon {
            font-size: 3rem;
            display: block;
            margin-bottom: 1rem;
        }
        .upload-text {
            font-weight: 600;
            color: var(--heading);
            margin-bottom: 0.5rem;
        }
        .upload-hint {
            font-size: 0.875rem;
            color: var(--text-muted);
        }
        .upload-input {
            display: none;
        }
        .preview-container {
            margin-top: 1.5rem;
            border-radius: 12px;
            overflow: hidden;
            border: 1px solid var(--border);
        }
        .preview-image {
            width: 100%;
            max-height: 300px;
            object-fit: cover;
        }
        .preview-info {
            padding: 1rem;
            background: var(--highlight-bg);
        }
        .file-info {
            display: flex;
            justify-content: space-between;
            margin-bottom: 0.5rem;
            font-size: 0.875rem;
        }
        .file-info span:first-child {
            color: var(--text-muted);
        }
        .file-info span:last-child {
            font-weight: 600;
            color: var(--heading);
        }
        .upload-progress {
            margin-top: 1.5rem;
        }
        .progress-bar {
            width: 100%;
            height: 8px;
            background: var(--highlight-bg);
            border-radius: 4px;
            overflow: hidden;
        }
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--button-bg), #7c3aed);
            transition: width 0.3s ease;
        }
        .progress-text {
            text-align: center;
            margin-top: 0.5rem;
            font-size: 0.875rem;
            color: var(--text-muted);
        }
        .upload-actions {
            display: flex;
            gap: 1rem;
            margin-top: 1.5rem;
        }
        .btn-upload {
            flex: 1;
            padding: 0.875rem 1.5rem;
            border-radius: 12px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            border: none;
        }
        .btn-upload.primary {
            background: linear-gradient(135deg, #4f46e5 0%, #7c3aed 100%);
            color: white;
            box-shadow: 0 4px 12px rgba(79, 70, 229, 0.3);
        }
        .btn-upload.primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(79, 70, 229, 0.4);
        }
        .btn-upload.secondary {
            background: transparent;
            color: var(--text);
            border: 2px solid var(--border);
        }
        .btn-upload.secondary:hover {
            background: var(--highlight-bg);
            border-color: var(--button-bg);
        }
        /* ============================================
           UPLOAD MODAL STYLES
           ============================================ */
        .upload-cover-modal,
        .upload-profile-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(10px);
            z-index: 10000;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 1rem;
        }
        .upload-cover-modal .modal-content,
        .upload-profile-modal .modal-content {
            background: var(--card-bg);
            border-radius: 20px;
            max-width: 600px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        }
        .upload-cover-modal .modal-inner,
        .upload-profile-modal .modal-inner {
            padding: 2rem;
        }
        .upload-area {
            border: 2px dashed var(--border);
            border-radius: 12px;
            padding: 3rem 2rem;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            background: var(--highlight-bg);
        }
        .upload-area:hover {
            border-color: var(--button-bg);
            background: rgba(79, 70, 229, 0.05);
        }
        .upload-icon {
            font-size: 3rem;
            display: block;
            margin-bottom: 1rem;
        }
        .upload-text {
            font-weight: 600;
            color: var(--heading);
            margin-bottom: 0.5rem;
        }
        .upload-hint {
            font-size: 0.875rem;
            color: var(--text-muted);
        }
        .upload-input {
            display: none;
        }
        .preview-container {
            margin-top: 1.5rem;
            border-radius: 12px;
            overflow: hidden;
            border: 1px solid var(--border);
        }
        .preview-image {
            width: 100%;
            max-height: 300px;
            object-fit: cover;
        }
        .preview-info {
            padding: 1rem;
            background: var(--highlight-bg);
        }
        .file-info {
            display: flex;
            justify-content: space-between;
            margin-bottom: 0.5rem;
            font-size: 0.875rem;
        }
        .file-info span:first-child {
            color: var(--text-muted);
        }
        .file-info span:last-child {
            font-weight: 600;
            color: var(--heading);
        }
        .upload-progress {
            margin-top: 1.5rem;
        }
        .progress-bar {
            width: 100%;
            height: 8px;
            background: var(--highlight-bg);
            border-radius: 4px;
            overflow: hidden;
        }
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--button-bg), #7c3aed);
            transition: width 0.3s ease;
        }
        .progress-text {
            text-align: center;
            margin-top: 0.5rem;
            font-size: 0.875rem;
            color: var(--text-muted);
        }
        .upload-spinner {
            display: inline-block;
            width: 30px;
            height: 30px;
            border: 3px solid var(--highlight-bg);
            border-top-color: var(--button-bg);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 1rem auto;
        }
        @keyframes spin {
            to {
                transform: rotate(360deg);
            }
        }
        /* ============================================
           RATINGS & REVIEWS PANEL STYLES
           ============================================ */
        /* Metric Cards Grid */
        .metric-card {
            background: var(--card-bg);
            border-radius: 16px;
            padding: 1.5rem;
            box-shadow: 0 2px 12px rgba(0, 0, 0, 0.08);
            transition: all 0.3s ease;
            border: 1px solid rgba(0, 0, 0, 0.05);
        }
        .metric-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.12);
        }
        .metric-card-header {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            margin-bottom: 1rem;
        }
        .metric-icon {
            width: 48px;
            height: 48px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            flex-shrink: 0;
        }
        .metric-icon.tutor-icon {
            background: linear-gradient(135deg, #4F46E5, #7C3AED);
        }
        .metric-icon.student-icon {
            background: linear-gradient(135deg, #10B981, #059669);
        }
        .metric-icon.response-icon {
            background: linear-gradient(135deg, #F59E0B, #D97706);
        }
        .metric-icon.payment-icon {
            background: linear-gradient(135deg, #EF4444, #DC2626);
        }
        .metric-card-title {
            font-size: 0.95rem;
            font-weight: 600;
            color: var(--text-primary);
            line-height: 1.3;
        }
        .metric-card-body {
            text-align: center;
        }
        .metric-rating-display {
            margin-bottom: 0.75rem;
        }
        .metric-rating-number {
            display: block;
            font-size: 2.5rem;
            font-weight: 700;
            color: var(--button-bg);
            line-height: 1;
            margin-bottom: 0.5rem;
        }
        .metric-stars {
            color: #F59E0B;
            font-size: 1.125rem;
            letter-spacing: 2px;
        }
        .metric-description {
            font-size: 0.85rem;
            color: var(--text-muted);
            line-height: 1.4;
        }
        /* Star Filter Tabs */
        .star-filter-tabs {
            display: flex;
            gap: 0.75rem;
            flex-wrap: wrap;
            background: var(--highlight-bg);
            padding: 1rem;
            border-radius: 12px;
        }
        .star-filter-tab {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.75rem 1.25rem;
            background: var(--card-bg);
            border: 2px solid transparent;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
            color: var(--text-primary);
            flex: 1;
            min-width: 140px;
            justify-content: center;
        }
        .star-filter-tab:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
        .star-filter-tab.active {
            background: var(--button-bg);
            color: white;
            border-color: var(--button-bg);
        }
        .tab-icon {
            font-size: 1.125rem;
        }
        .tab-stars {
            color: #F59E0B;
            font-size: 1rem;
            letter-spacing: 1px;
        }
        .star-filter-tab.active .tab-stars {
            color: #FCD34D;
        }
        .tab-count {
            font-size: 0.85rem;
            opacity: 0.8;
        }
        /* Reviews Container */
        .reviews-container {
            display: grid;
            gap: 1.5rem;
        }
        .review-card {
            background: var(--card-bg);
            border-radius: 16px;
            padding: 1.5rem;
            box-shadow: 0 2px 12px rgba(0, 0, 0, 0.08);
            transition: all 0.3s ease;
            border: 1px solid rgba(0, 0, 0, 0.05);
        }
        .review-card:hover {
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.12);
        }
        .review-card.hidden {
            display: none;
        }
        .review-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }
        .reviewer-info {
            display: flex;
            align-items: center;
            gap: 1rem;
        }
        .reviewer-avatar {
            width: 48px;
            height: 48px;
            border-radius: 12px;
            object-fit: cover;
            flex-shrink: 0;
        }
        .reviewer-details {
            display: flex;
            flex-direction: column;
        }
        .reviewer-name {
            font-size: 1rem;
            font-weight: 600;
            color: var(--text-primary);
            margin: 0;
        }
        .reviewer-role {
            font-size: 0.85rem;
            color: var(--text-muted);
            margin: 0;
        }
        .review-date {
            font-size: 0.85rem;
            color: var(--text-muted);
        }
        .review-rating-wrapper {
            position: relative;
            display: inline-block;
            margin-bottom: 1rem;
        }
        .review-stars {
            color: #F59E0B;
            font-size: 1.25rem;
            letter-spacing: 3px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .review-stars:hover {
            transform: scale(1.05);
        }
        /* Review Rating Tooltip - Fixed positioning to stay on screen */
        .review-rating-tooltip {
            position: absolute;
            top: 110%;
            left: 0;
            background: var(--card-bg);
            border: 1px solid rgba(0, 0, 0, 0.1);
            border-radius: 12px;
            padding: 1rem;
            min-width: 280px;
            max-width: 320px;
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.15);
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
            z-index: 9999;
            pointer-events: none;
        }
        .review-rating-wrapper:hover .review-rating-tooltip {
            opacity: 1;
            visibility: visible;
            top: calc(100% + 10px);
        }
        .review-rating-tooltip::before {
            content: '';
            position: absolute;
            top: -8px;
            left: 20px;
            border-left: 8px solid transparent;
            border-right: 8px solid transparent;
            border-bottom: 8px solid var(--card-bg);
        }
        [data-theme="dark"] .review-rating-tooltip {
            background: #1f2937;
            border-color: #374151;
        }
        [data-theme="dark"] .review-rating-tooltip::before {
            border-bottom-color: #1f2937;
        }
        .tooltip-title {
            margin: 0 0 1rem 0;
            font-size: 0.9rem;
            font-weight: 600;
            color: var(--heading);
        }
        .tooltip-metric {
            margin-bottom: 0.875rem;
        }
        .tooltip-metric:last-child {
            margin-bottom: 0;
        }
        .tooltip-metric-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.375rem;
        }
        .tooltip-metric-label {
            font-size: 0.8rem;
            color: var(--text-muted);
            font-weight: 500;
        }
        .tooltip-metric-score {
            font-size: 0.875rem;
            font-weight: 700;
            color: var(--button-bg);
        }
        .tooltip-progress-bar {
            height: 6px;
            background: var(--highlight-bg);
            border-radius: 3px;
            overflow: hidden;
        }
        .tooltip-progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--button-bg), #7C3AED);
            border-radius: 3px;
            transition: width 0.3s ease;
        }
        .review-content {
            margin-bottom: 1rem;
        }
        .review-content p {
            margin: 0;
            font-size: 0.95rem;
            line-height: 1.6;
            color: var(--text-primary);
        }
        .review-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .review-helpful {
            display: flex;
            gap: 0.75rem;
        }
        .helpful-btn {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            background: var(--highlight-bg);
            border: none;
            border-radius: 8px;
            font-size: 0.85rem;
            font-weight: 500;
            color: var(--text-muted);
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .helpful-btn:hover {
            background: var(--button-bg);
            color: white;
        }
        .helpful-btn i {
            font-size: 0.9rem;
        }
        /* Empty State */
        .empty-state.hidden {
            display: none;
        }
        /* Responsive Design */
        @media (max-width: 768px) {
            .star-filter-tabs {
                flex-direction: column;
            }
            .star-filter-tab {
                width: 100%;
            }
            .review-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 0.75rem;
            }
            .review-rating-tooltip {
                min-width: 240px;
            }
        }
        /* ============================================
           COMMUNITY MODAL STYLES
           ============================================ */
        /* Modal Overlay */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 9998;
        }
        /* Community Modal Content */
        .community-modal-content {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: var(--card-bg);
            border-radius: 20px;
            max-width: 900px;
            width: 90%;
            max-height: 85vh;
            overflow: hidden;
            z-index: 9999;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            display: flex;
            flex-direction: column;
        }
        /* Community Modal Header */
        .community-modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1.5rem 2rem;
            border-bottom: 1px solid rgba(0, 0, 0, 0.1);
            background: linear-gradient(135deg, var(--button-bg), #7C3AED);
        }
        .community-modal-header .modal-title {
            color: white;
            font-size: 1.5rem;
            font-weight: 700;
            margin: 0;
        }
        .community-modal-header .modal-close {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: none;
            width: 36px;
            height: 36px;
            border-radius: 50%;
            font-size: 1.5rem;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .community-modal-header .modal-close:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: rotate(90deg);
        }
        /* Main Cards Section */
        .community-main-cards {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 1rem;
            padding: 1.5rem 2rem;
            background: var(--highlight-bg);
        }
        .community-main-card {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1.25rem;
            background: var(--card-bg);
            border-radius: 12px;
            border: 2px solid transparent;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
        }
        .community-main-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.12);
            border-color: var(--button-bg);
        }
        .community-main-card.active {
            background: linear-gradient(135deg, var(--button-bg), #7C3AED);
            border-color: var(--button-bg);
            box-shadow: 0 8px 24px rgba(79, 70, 229, 0.3);
        }
        .community-main-card.active .main-card-title,
        .community-main-card.active .main-card-count,
        .community-main-card.active .main-card-arrow {
            color: white;
        }
        .main-card-icon {
            font-size: 2rem;
            flex-shrink: 0;
        }
        .main-card-content {
            flex: 1;
        }
        .main-card-title {
            font-size: 1.125rem;
            font-weight: 600;
            color: var(--text-primary);
            margin: 0 0 0.25rem 0;
            transition: color 0.3s ease;
        }
        .main-card-count {
            font-size: 0.85rem;
            color: var(--text-muted);
            margin: 0;
            transition: color 0.3s ease;
        }
        .main-card-arrow {
            font-size: 1.5rem;
            color: var(--text-muted);
            transition: all 0.3s ease;
        }
        .community-main-card:hover .main-card-arrow {
            transform: translateX(4px);
        }
        /* Community Modal Body */
        .community-modal-body {
            flex: 1;
            overflow-y: auto;
            padding: 1.5rem 2rem;
        }
        /* Community Sections */
        .community-section {
            display: none;
        }
        .community-section.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        /* Community Tabs */
        .community-tabs {
            display: flex;
            gap: 0.75rem;
            flex-wrap: wrap;
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 2px solid var(--highlight-bg);
        }
        .community-tab {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.75rem 1.25rem;
            background: var(--highlight-bg);
            border: 2px solid transparent;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
            color: var(--text-primary);
            font-size: 0.95rem;
        }
        .community-tab:hover {
            background: var(--card-bg);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }
        .community-tab.active {
            background: var(--button-bg);
            color: white;
            border-color: var(--button-bg);
        }
        .community-tab-add {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.75rem 1.25rem;
            background: linear-gradient(135deg, #10B981, #059669);
            border: none;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
            color: white;
            font-size: 0.95rem;
            margin-left: auto;
        }
        .community-tab-add:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(16, 185, 129, 0.4);
        }
        .tab-badge {
            background: rgba(255, 255, 255, 0.2);
            padding: 0.25rem 0.5rem;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: 600;
        }
        .community-tab.active .tab-badge {
            background: rgba(255, 255, 255, 0.3);
        }
        /* Connections List */
        .connections-list {
            display: grid;
            gap: 1rem;
        }
        .connection-item {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1rem;
            background: var(--card-bg);
            border-radius: 12px;
            border: 1px solid rgba(0, 0, 0, 0.05);
            transition: all 0.3s ease;
        }
        .connection-item:hover {
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            transform: translateX(4px);
        }
        .connection-item.hidden {
            display: none;
        }
        .connection-avatar {
            width: 48px;
            height: 48px;
            border-radius: 12px;
            object-fit: cover;
            flex-shrink: 0;
        }
        .connection-details {
            flex: 1;
        }
        .connection-name {
            font-size: 1rem;
            font-weight: 600;
            color: var(--text-primary);
            margin: 0 0 0.25rem 0;
        }
        .connection-role {
            font-size: 0.85rem;
            color: var(--text-muted);
            margin: 0;
        }
        .connection-action-btn {
            background: var(--button-bg);
            color: white;
            border: none;
            padding: 0.625rem 1rem;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1rem;
        }
        .connection-action-btn:hover {
            background: #7C3AED;
            transform: scale(1.05);
        }
        /* Events List */
        .events-list {
            display: grid;
            gap: 1rem;
        }
        .event-item {
            display: flex;
            gap: 1rem;
            padding: 1.25rem;
            background: var(--card-bg);
            border-radius: 12px;
            border: 1px solid rgba(0, 0, 0, 0.05);
            transition: all 0.3s ease;
        }
        .event-item:hover {
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
        .event-item.hidden {
            display: none;
        }
        .event-date-badge {
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, var(--button-bg), #7C3AED);
            border-radius: 12px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
            color: white;
        }
        .event-date-badge.past {
            background: linear-gradient(135deg, #9CA3AF, #6B7280);
        }
        .event-month {
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
        }
        .event-day {
            font-size: 1.5rem;
            font-weight: 700;
            line-height: 1;
        }
        .event-details {
            flex: 1;
        }
        .event-title {
            font-size: 1.125rem;
            font-weight: 600;
            color: var(--text-primary);
            margin: 0 0 0.5rem 0;
        }
        .event-info {
            font-size: 0.85rem;
            color: var(--text-muted);
            margin: 0 0 0.75rem 0;
            line-height: 1.6;
        }
        .event-info i {
            width: 16px;
            margin-right: 0.25rem;
        }
        .event-badge {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: 600;
        }
        .event-badge.joined-badge {
            background: rgba(16, 185, 129, 0.1);
            color: #059669;
        }
        .event-badge.attended-badge {
            background: rgba(79, 70, 229, 0.1);
            color: var(--button-bg);
        }
        .event-action-btn {
            background: var(--highlight-bg);
            color: var(--text-primary);
            border: none;
            padding: 0.625rem 1.25rem;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
            font-size: 0.9rem;
            white-space: nowrap;
        }
        .event-action-btn:hover {
            background: var(--button-bg);
            color: white;
        }
        .event-action-btn.primary {
            background: var(--button-bg);
            color: white;
        }
        .event-action-btn.primary:hover {
            background: #7C3AED;
        }
        .event-action-btn.secondary {
            background: rgba(0, 0, 0, 0.05);
        }
        /* Clubs List */
        .clubs-list {
            display: grid;
            gap: 1rem;
        }
        .club-item {
            display: flex;
            gap: 1rem;
            padding: 1.25rem;
            background: var(--card-bg);
            border-radius: 12px;
            border: 1px solid rgba(0, 0, 0, 0.05);
            transition: all 0.3s ease;
        }
        .club-item:hover {
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
        .club-item.hidden {
            display: none;
        }
        .club-icon {
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, var(--button-bg), #7C3AED);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            flex-shrink: 0;
        }
        .club-details {
            flex: 1;
        }
        .club-title {
            font-size: 1.125rem;
            font-weight: 600;
            color: var(--text-primary);
            margin: 0 0 0.5rem 0;
        }
        .club-info {
            font-size: 0.85rem;
            color: var(--text-muted);
            margin: 0 0 0.5rem 0;
        }
        .club-info i {
            margin-right: 0.25rem;
        }
        .club-description {
            font-size: 0.9rem;
            color: var(--text-primary);
            margin: 0;
            line-height: 1.5;
        }
        .club-action-btn {
            background: var(--highlight-bg);
            color: var(--text-primary);
            border: none;
            padding: 0.75rem 1.25rem;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
            font-size: 0.9rem;
            white-space: nowrap;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        .club-action-btn:hover {
            background: var(--button-bg);
            color: white;
        }
        .club-action-btn.primary {
            background: var(--button-bg);
            color: white;
        }
        .club-action-btn.primary:hover {
            background: #7C3AED;
        }
        .club-action-btn.joined-btn {
            background: rgba(16, 185, 129, 0.1);
            color: #059669;
        }
        .club-action-btn.joined-btn:hover {
            background: rgba(16, 185, 129, 0.2);
        }
        /* Responsive Design for Community Modal */
        @media (max-width: 768px) {
            .community-main-cards {
                grid-template-columns: 1fr;
            }
            .community-tabs {
                flex-direction: column;
            }
            .community-tab-add {
                margin-left: 0;
            }
            .event-item,
            .club-item {
                flex-direction: column;
            }
            .event-action-btn,
            .club-action-btn {
                width: 100%;
            }
        }

        /* ============================================
           MOBILE RESPONSIVE STYLES
           Profile Header Centering & Mobile Menu
           ============================================ */

        /* Mobile menu button - show below 1024px */
        @media (max-width: 1024px) {
            .mobile-menu-btn {
                display: flex !important;
                align-items: center;
                justify-content: center;
                width: 44px;
                height: 44px;
                background: transparent;
                border: none;
                cursor: pointer;
                border-radius: 8px;
                transition: background 0.2s ease;
            }
            .mobile-menu-btn:hover {
                background: rgba(0, 0, 0, 0.05);
            }
            .mobile-hamburger {
                display: flex;
                flex-direction: column;
                gap: 5px;
                width: 24px;
            }
            .mobile-hamburger span {
                display: block;
                width: 100%;
                height: 2px;
                background: var(--text);
                border-radius: 2px;
                transition: all 0.3s ease;
            }
            /* Show logo-sub in navbar and mobile menu */
            .logo-sub,
            .mobile-menu-logo .logo-sub {
                display: inline !important;
            }
            /* Show logo-badge in navbar and mobile menu */
            .logo-badge,
            .mobile-menu-logo .logo-badge {
                display: inline-block !important;
            }
        }

        /* Hide mobile menu button on desktop */
        @media (min-width: 1025px) {
            .mobile-menu-btn {
                display: none !important;
            }
        }

        /* Profile header centering on mobile */
        @media (max-width: 768px) {
            .profile-info-wrapper {
                flex-direction: column !important;
                align-items: center !important;
                text-align: center !important;
            }
            .profile-avatar-container {
                margin-bottom: 1rem;
            }
            .profile-avatar {
                width: 120px !important;
                height: 120px !important;
            }
            .profile-details-section {
                display: flex;
                flex-direction: column;
                align-items: center;
                width: 100%;
            }
            .profile-name-row {
                justify-content: center;
                text-align: center;
            }
            .profile-name {
                font-size: 1.75rem !important;
                text-align: center;
            }
            .badges-row {
                justify-content: center !important;
            }
            .rating-section {
                justify-content: center !important;
            }
            .rating-wrapper {
                justify-content: center !important;
            }
            .profile-location {
                justify-content: center !important;
            }
            .info-item {
                flex-direction: column !important;
                text-align: center !important;
                gap: 0.25rem !important;
            }
            .info-label {
                min-width: auto !important;
            }
            .profile-actions {
                flex-direction: column !important;
            }
            .profile-actions .btn-primary,
            .profile-actions .btn-secondary {
                width: 100% !important;
            }
            .connections-stats {
                grid-template-columns: repeat(2, 1fr) !important;
            }
            .social-links {
                justify-content: center !important;
            }
            .profile-main-info {
                padding: 0 1rem 1.5rem 1rem !important;
            }
            .cover-image-container {
                height: 180px !important;
            }
        }

        /* Even smaller screens */
        @media (max-width: 480px) {
            .profile-avatar {
                width: 100px !important;
                height: 100px !important;
            }
            .profile-name {
                font-size: 1.5rem !important;
            }
            .cover-image-container {
                height: 150px !important;
            }
            .profile-main-info {
                margin-top: -40px !important;
            }
        }
    </style>
    <!-- Profile Specific Fixes -->
    <link rel="stylesheet" href="../css/tutor-profile/profile-specific-fix.css">
    <link rel="stylesheet" href="../css/parent-profile/profile-specific-fix.css">
    <!-- Comprehensive Responsive Styles - MUST be loaded LAST for responsive overrides -->
    <link rel="stylesheet" href="../css/tutor-profile/tutor-profile-responsive.css">
</head>
<body class="font-sans">
    <!-- Loading Overlay -->
    <div id="loading-overlay" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(255, 255, 255, 0.95); display: flex; align-items: center; justify-content: center; z-index: 9999;">
        <div style="text-align: center;">
            <div style="width: 50px; height: 50px; border: 4px solid #f3f3f3; border-top: 4px solid #3B82F6; border-radius: 50%; animation: spin 1s linear infinite; margin: 0 auto;"></div>
            <p style="margin-top: 1rem; color: #666; font-family: system-ui, -apple-system, sans-serif;">Loading profile...</p>
        </div>
    </div>

    <!-- Navigation -->
    <nav class="navbar" role="navigation" aria-label="Main navigation">
        <div class="nav-container" style="max-width: 100%; padding: 0 1rem;">
            <div class="nav-brand">
                <button class="sidebar-toggle" id="hamburger" aria-label="Toggle sidebar">
                    <span class="hamburger">
                        <span></span>
                        <span></span>
                        <span></span>
                    </span>
                </button>
                <a href="../index.html" class="logo-container">
                    <div class="logo-text">
                        <span class="logo-main">Astegni</span>
                        <span class="logo-sub">Parent</span>
                    </div>
                    <span class="logo-badge">Beta</span>
                </a>
            </div>
            <!-- Right Section: Nav Menu + Actions -->
            <div class="nav-actions" style="display: flex; align-items: center; gap: 0.5rem; margin-right: 0;">
                <!-- Navigation Links -->
                <div class="nav-items" style="display: flex; gap: 0.25rem;">
                    <a class="nav-link" href="#" onclick="handleNavLinkClick(event, 'news')">
                        <span class="nav-icon"></span> News
                    </a>
                    <a class="nav-link" href="../branch/find-tutors.html">
                        <span class="nav-icon"></span> Find Tutors
                    </a>
                    <a class="nav-link" href="../branch/videos.html">
                        <span class="nav-icon"></span> Videos
                    </a>
                    <a class="nav-link" href="#" onclick="handleNavLinkClick(event, 'store')">
                        <span class="nav-icon"></span> Bookstore
                    </a>
                    <a class="nav-link" href="#" onclick="handleNavLinkClick(event, 'find-jobs')">
                        <span class="nav-icon"></span> Find a Job
                    </a>
                </div>
                <!-- Profile container -->
                <div id="profile-container" class="profile-dropdown-container">
                    <button id="profile-dropdown-toggle" class="profile-dropdown-toggle"
                        onclick="toggleProfileDropdown()">
                        <img id="profile-pic" class="profile-pic" alt="Profile">
                        <span id="profile-name" class="profile-name"></span>
                        <svg class="dropdown-arrow" width="12" height="12" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd"
                                d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z"
                                clip-rule="evenodd"></path>
                        </svg>
                    </button>
                    <div id="profile-dropdown-menu" class="profile-dropdown-menu">
                        <!-- User info header - CLICKABLE to go to profile page -->
                        <a href="#" id="dropdown-profile-link" class="dropdown-header-link">
                            <div class="dropdown-header">
                                <img id="dropdown-profile-pic" class="profile-pic" alt="Profile">
                                <div class="dropdown-user-info">
                                    <span id="dropdown-user-name" class="dropdown-user-name"></span>
                                    <span id="dropdown-user-email" class="dropdown-user-email"></span>
                                    <span id="dropdown-user-role" class="dropdown-user-role"></span>
                                </div>
                                <svg class="dropdown-header-arrow" width="16" height="16" fill="currentColor" viewBox="0 0 20 20">
                                    <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                                </svg>
                            </div>
                        </a>
                        <div class="dropdown-divider"></div>

                        <!-- Deletion Countdown Banner (shown when role is scheduled for deletion) -->
                        <div id="deletion-countdown-banner" class="deletion-countdown-banner hidden">
                            <div class="countdown-content">
                                <div class="countdown-icon">
                                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                                    </svg>
                                </div>
                                <div class="countdown-text">
                                    <div class="countdown-title">Role Scheduled for Deletion</div>
                                    <div class="countdown-details">
                                        Your <span id="countdown-role-name" class="font-semibold"></span> role will be deleted in
                                        <span id="countdown-days" class="font-bold text-orange-600"></span> days
                                    </div>
                                </div>
                            </div>
                            <button onclick="openAddRoleModal()" class="countdown-restore-btn">
                                Restore Role
                            </button>
                        </div>

                        <div class="dropdown-divider" id="countdown-divider" style="display: none;"></div>

                        <!-- Role switcher (shown only if user has multiple roles) -->
                        <div id="role-switcher-section" class="role-switcher-section hidden">
                            <div class="dropdown-item-header">Switch Role</div>
                            <div id="role-options" class="role-options">
                                <!-- Role options will be dynamically added here -->
                            </div>
                            <div class="dropdown-divider"></div>
                        </div>
                        <div class="dropdown-divider"></div>
                        <button class="dropdown-item logout-item" onclick="showLogoutModal()">
                            <svg class="dropdown-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1">
                                </path>
                            </svg>
                            Logout
                        </button>
                    </div>
                </div>
                <!-- Notification Icon -->
                <button class="icon-btn" aria-label="Notifications">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9">
                        </path>
                    </svg>
                    <span class="notification-badge">3</span>
                </button>
                <!-- Theme Toggle -->
                <button id="theme-toggle-btn" class="icon-btn" aria-label="Toggle theme">
                    <svg id="theme-icon" class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z">
                        </path>
                    </svg>
                </button>
            </div>
            <!-- Mobile Menu Button (< 1024px) - Outside nav-actions so it's not hidden -->
            <button class="mobile-menu-btn" id="mobileMenuBtn" aria-label="Toggle mobile menu">
                <span class="mobile-hamburger">
                    <span></span>
                    <span></span>
                    <span></span>
                </span>
            </button>
        </div>
    </nav>

    <!-- Mobile Menu Overlay -->
    <div id="mobileMenuOverlay" class="mobile-menu-overlay hidden"></div>

    <!-- Mobile Slide-in Menu -->
    <div id="mobileMenu" class="mobile-menu hidden">
        <div class="mobile-menu-header">
            <div class="mobile-menu-logo">
                <span class="logo-main">Astegni</span>
                <span class="logo-sub">Parent</span>
                <span class="logo-badge">Beta</span>
            </div>
        </div>

        <div class="mobile-menu-content">
            <!-- Navigation Links -->
            <div class="mobile-nav-section">
                <a href="#" class="mobile-menu-link" onclick="handleNavLinkClick(event, 'news')">
                    <span class="nav-icon"></span> News
                </a>
                <a href="../branch/find-tutors.html" class="mobile-menu-link">
                    <span class="nav-icon"></span> Find Tutors
                </a>
                <a href="../branch/videos.html" class="mobile-menu-link">
                    <span class="nav-icon"></span> Videos
                </a>
                <a href="#" class="mobile-menu-link" onclick="handleNavLinkClick(event, 'store')">
                    <span class="nav-icon"></span> Bookstore
                </a>
                <a href="#" class="mobile-menu-link" onclick="handleNavLinkClick(event, 'find-jobs')">
                    <span class="nav-icon"></span> Find a Job
                </a>
            </div>

            <!-- Mobile Profile Section -->
            <div id="mobile-profile-section" class="mobile-profile-section">
                <div class="mobile-profile-dropdown">
                    <button id="mobile-profile-header" class="mobile-profile-header" onclick="toggleMobileProfileDropdown()">
                        <img id="mobile-profile-pic" class="mobile-profile-pic" src="" alt="Profile">
                        <div class="mobile-profile-info">
                            <span id="mobile-profile-name" class="mobile-profile-name"></span>
                            <span id="mobile-profile-role" class="mobile-profile-role">Parent</span>
                        </div>
                        <svg class="mobile-profile-arrow" width="16" height="16" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                        </svg>
                    </button>

                    <div class="mobile-profile-dropdown-content">
                        <!-- View Profile Link -->
                        <a href="parent-profile.html" class="mobile-dropdown-user-info" onclick="closeMobileMenu();">
                            <img id="mobile-dropdown-pic" class="mobile-dropdown-pic" src="" alt="Profile">
                            <div class="mobile-dropdown-info">
                                <span id="mobile-dropdown-name" class="mobile-dropdown-name"></span>
                                <span id="mobile-dropdown-email" class="mobile-dropdown-email"></span>
                            </div>
                        </a>

                        <!-- Role Switcher -->
                        <div id="mobile-role-switcher-section" class="mobile-role-switcher-section hidden">
                            <div class="mobile-role-switcher-header">Switch Role</div>
                            <div id="mobile-role-options" class="mobile-role-options">
                                <!-- Role options will be dynamically added here -->
                            </div>
                        </div>

                        <!-- Logout Button -->
                        <button id="mobile-logout-btn" class="mobile-dropdown-logout" onclick="showLogoutModal(); closeMobileMenu();">
                            <svg class="mobile-menu-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"></path>
                            </svg>
                            Logout
                        </button>
                    </div>
                </div>
                <div class="mobile-menu-divider"></div>
            </div>

            <!-- Theme Toggle -->
            <div class="mobile-theme-section">
                <button class="mobile-theme-toggle" onclick="toggleTheme()">
                    <svg class="theme-icon-sun" width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"></path>
                    </svg>
                    <span>Toggle Theme</span>
                </button>
            </div>

            <!-- Notifications -->
            <div class="mobile-notifications-section">
                <button class="mobile-notifications-btn">
                    <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"></path>
                    </svg>
                    <span>Notifications</span>
                    <span class="mobile-notification-badge">3</span>
                </button>
            </div>
        </div>
    </div>
    <!-- Rotating Ad Section - 4 Placeholder Ads -->
    <div class="promo-container premium-promo" style="margin-top: 2rem;">
        <div class="promo-animation">
            <div class="pulse-ring"></div>
            <div class="pulse-ring"></div>
        </div>
        <div class="promo-content">
            <span class="promo-label">Featured</span>
            <h3 class="promo-title">Premium Advertising Space</h3>
            <p class="promo-text">Reach thousands of students, tutors, and parents across Ethiopia</p>
            <button class="promo-cta" onclick="event.stopPropagation(); openComingSoonModal('Advertising')">Learn More</button>
        </div>
        <div class="promo-visual">
            <div class="promo-circles">
                <div class="circle circle-1"></div>
                <div class="circle circle-2"></div>
                <div class="circle circle-3"></div>
            </div>
        </div>
    </div>

        <!-- Ad Slide 2 -->
        <div class="promo-slide" onclick="openComingSoonModal('Advertising')">
            <div class="promo-animation">
                <div class="pulse-ring"></div>
                <div class="pulse-ring"></div>
            </div>
            <div class="promo-content">
                <span class="promo-label">Ad 2</span>
                <h3 class="promo-title">Track Your Child's Progress</h3>
                <p class="promo-text">Comprehensive learning analytics</p>
                <button class="promo-cta" onclick="openComingSoonModal('Advertising')">Get Started</button>
            </div>
            <div class="promo-visual">
                <div class="promo-circles">
                    <div class="circle circle-1"></div>
                    <div class="circle circle-2"></div>
                    <div class="circle circle-3"></div>
                </div>
            </div>
        </div>

        <!-- Ad Slide 3 -->
        <div class="promo-slide" onclick="openComingSoonModal('Advertising')">
            <div class="promo-animation">
                <div class="pulse-ring"></div>
                <div class="pulse-ring"></div>
            </div>
            <div class="promo-content">
                <span class="promo-label">Ad 3</span>
                <h3 class="promo-title">Verified Tutors Network</h3>
                <p class="promo-text">Safe & trusted educators</p>
                <button class="promo-cta" onclick="openComingSoonModal('Advertising')">Find Tutors</button>
            </div>
            <div class="promo-visual">
                <div class="promo-circles">
                    <div class="circle circle-1"></div>
                    <div class="circle circle-2"></div>
                    <div class="circle circle-3"></div>
                </div>
            </div>
        </div>

        <!-- Ad Slide 4 -->
        <div class="promo-slide" onclick="openComingSoonModal('Advertising')">
            <div class="promo-animation">
                <div class="pulse-ring"></div>
                <div class="pulse-ring"></div>
            </div>
            <div class="promo-content">
                <span class="promo-label">Ad 4</span>
                <h3 class="promo-title">Your Ad Space Here</h3>
                <p class="promo-text">Connect with parents</p>
                <button class="promo-cta" onclick="openComingSoonModal('Advertising')">Advertise</button>
            </div>
            <div class="promo-visual">
                <div class="promo-circles">
                    <div class="circle circle-1"></div>
                    <div class="circle circle-2"></div>
                    <div class="circle circle-3"></div>
                </div>
            </div>
        </div>
    </div>
    <!-- Sidebar -->
    <aside id="sidebar" class="sidebar-container">
        <div class="sidebar-content">
            <div class="sidebar-nav">
                <h3>Parent Dashboard</h3>
                <a href="#" onclick="switchPanel('dashboard'); return false;" class="sidebar-link active">
                    <span class="sidebar-icon"></span>
                    <span>Dashboard</span>
                </a>
                <a href="#" onclick="switchPanel('my-children'); return false;" class="sidebar-link">
                    <span class="sidebar-icon"></span>
                    <span>My Children</span>
                    <span class="badge-count">3</span>
                </a>
                <a href="#" onclick="switchPanel('co-parents'); return false;" class="sidebar-link">
                    <span class="sidebar-icon"></span>
                    <span>Co-Parents</span>
                    <span class="badge-count" id="coparents-count">0</span>
                </a>
                <hr class="my-4 border-gray-300">
                <a href="#" onclick="switchPanel('notes'); return false;" class="sidebar-link">
                    <span class="sidebar-icon"></span>
                    <span>Notes</span>
                </a>
                <a href="#" onclick="switchPanel('schedule'); return false;" class="sidebar-link">
                    <span class="sidebar-icon"></span>
                    <span>My Schedule</span>
                </a>
                <a href="#" onclick="switchPanel('sessions'); return false;" class="sidebar-link">
                    <span class="sidebar-icon"></span>
                    <span>My Sessions</span>
                </a>
                <a href="#" onclick="switchPanel('tutors'); return false;" class="sidebar-link">
                    <span class="sidebar-icon"></span>
                    <span>Tutors</span>
                </a>
                <a href="#" onclick="switchPanel('tutor-child'); return false;" class="sidebar-link">
                    <span class="sidebar-icon"></span>
                    <span>Tutor Child</span>
                </a>
                <hr class="my-4 border-gray-300">
                <a href="#" onclick="switchPanel('my-requests'); return false;" class="sidebar-link">
                    <span class="sidebar-icon"></span>
                    <span>My Requests</span>
                </a>
                <a href="#" onclick="switchPanel('community'); return false;" class="sidebar-link">
                    <span class="sidebar-icon"></span>
                    <span>Community</span>
                </a>
                <a href="#" onclick="switchPanel('events'); return false;" class="sidebar-link">
                    <span class="sidebar-icon"></span>
                    <span>Events</span>
                </a>
                <a href="#" onclick="switchPanel('blog'); return false;" class="sidebar-link">
                    <span class="sidebar-icon"></span>
                    <span>Blog</span>
                    <span class="badge-count">7</span>
                </a>
                <hr class="my-4 border-gray-300">
                <a href="#" onclick="switchPanel('earnings-investments'); return false;" class="sidebar-link">
                    <span class="sidebar-icon" style="font-family: 'Times New Roman', serif; font-weight: bold; font-size: 1.1rem;">e</span>
                    <span>Earnings & Investments</span>
                </a>
                <a href="#" onclick="switchPanel('ratings-and-reviews'); return false;" class="sidebar-link">
                    <span class="sidebar-icon">?</span>
                    <span>Ratings & Reviews</span>
                </a>
                <hr class="my-4 border-gray-300">
                <a href="#" onclick="switchPanel('settings'); return false;" class="sidebar-link">
                    <span class="sidebar-icon"></span>
                    <span>Settings</span>
                </a>
                <a href="#" onclick="showLogoutModal(); return false;" class="sidebar-link text-red-500 hover:bg-red-50">
                    <span class="sidebar-icon"></span>
                    <span>Logout</span>
                </a>
            </div>
        </div>
    </aside>
    <!-- Main Content -->
    <section class="py-8" style="padding-top: 1rem;">
        <div class="container mx-auto px-4">
            <!-- Main Content with Widgets -->
            <div class="flex gap-6">
                <!-- Left Content Area -->
                <div class="flex-1" style="min-width: 0;">
                    <!-- Panels Section -->
                    <div class="panels-container">
                        <!-- Dashboard Panel (Default) -->
                        <div id="dashboard-panel" class="panel-content active">
                            <!-- Hero Section -->
                            <section class="hero-section animate__animated animate__fadeIn">
                                <h2 class="hero-title">
                                    <span id="typedText">Supporting My Children's Educational Journey</span>
                                    <span id="cursor" class="cursor-blink">|</span>
                                </h2>
                                <p id="hero-subtitle" class="hero-subtitle">Empowering success through dedicated
                                    guidance and support</p>
                                <div class="hero-stats">
                                    <div class="stat-item animate__animated animate__fadeInUp"
                                        style="animation-delay: 0.2s">
                                        <span class="stat-number" data-target="3" data-suffix="">0</span>
                                        <span class="stat-label">Children</span>
                                    </div>
                                    <div class="stat-item animate__animated animate__fadeInUp"
                                        style="animation-delay: 0.3s">
                                        <span class="stat-number" data-target="5" data-suffix="">0</span>
                                        <span class="stat-label">Active Tutors</span>
                                    </div>
                                    <div class="stat-item animate__animated animate__fadeInUp"
                                        style="animation-delay: 0.4s">
                                        <span class="stat-number" data-target="12500" data-suffix=" ETB">0</span>
                                        <span class="stat-label">Monthly Investment</span>
                                    </div>
                                </div>
                            </section>
                            <!-- Profile Header Section (Only visible in Dashboard) -->
                            <section class="profile-header-section mb-8">
                                <div class="cover-image-container relative">
                                    <img id="cover-img"
                                        src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='1200' height='300'%3E%3Crect width='1200' height='300' fill='%23e5e7eb'/%3E%3Ctext x='50%25' y='50%25' text-anchor='middle' dy='.3em' fill='%239ca3af' font-family='sans-serif' font-size='20'%3E1200x300%3C/text%3E%3C/svg%3E"
                                        alt="Cover" class="cover-img">
                                    <div class="cover-overlay"></div>
                                    <!-- Cover Upload Button -->
                                    <button onclick="openCoverUploadModal()" class="cover-upload-btn">
                                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                d="M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z">
                                            </path>
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                d="M15 13a3 3 0 11-6 0 3 3 0 016 0z"></path>
                                        </svg>
                                    </button>
                                </div>
                                <div class="profile-main-info">
                                    <div class="profile-info-wrapper">
                                        <div class="profile-avatar-container">
                                            <img id="profile-avatar"
                                                src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='150' height='150'%3E%3Crect width='150' height='150' fill='%23e5e7eb'/%3E%3Ctext x='50%25' y='50%25' text-anchor='middle' dy='.3em' fill='%239ca3af' font-family='sans-serif' font-size='16'%3E150x150%3C/text%3E%3C/svg%3E"
                                                alt="Parent Profile" class="profile-avatar">
                                            <span class="online-indicator"></span>
                                            <!-- Profile Picture Upload Button -->
                                            <button onclick="openProfileUploadModal()" class="avatar-upload-btn">
                                                <svg class="w-4 h-4" fill="none" stroke="currentColor"
                                                    viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round"
                                                        stroke-width="2"
                                                        d="M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z">
                                                    </path>
                                                    <path stroke-linecap="round" stroke-linejoin="round"
                                                        stroke-width="2" d="M15 13a3 3 0 11-6 0 3 3 0 016 0z"></path>
                                                </svg>
                                            </button>
                                        </div>
                                        <div class="profile-details-section">
                                            <div class="profile-name-row" style="margin-bottom: 1.25rem;">
                                                <h1 class="profile-name" id="parentName">Parent Name</h1>
                                                <!-- Username field under name -->
                                                <div id="parentUsername"
                                                    style="font-size: 0.95rem; color: var(--text-muted); font-weight: 500; margin-bottom: 1rem;">
                                                    <!-- Username will be populated dynamically -->
                                                </div>
                                            <div class="badges-row" style="display: flex; flex-wrap: wrap; gap: 0.75rem; margin-bottom: 1rem; margin-top: 1rem;">
                                                <span class="profile-badge verified" id="verification-badge">?</span>
                                                <span class="profile-badge active">? Active Parent</span>
                                            </div>
                                            </div>
                                            <div class="rating-section" style="margin-bottom: 1rem;">
                                                <div class="rating-wrapper" style="display: flex; align-items: center; gap: 0.75rem;">
                                                    <div class="rating-tooltip-container">
                                                        <div class="rating-stars" id="rating-stars" style="color: #f59e0b; font-size: 1.5rem; letter-spacing: 2px;"></div>
                                                        <div class="rating-tooltip" id="rating-tooltip">
                                                            <h4
                                                                style="margin: 0 0 1rem 0; font-size: 0.9rem; font-weight: 600; color: var(--heading);">
                                                                Rating Breakdown</h4>
                                                            <div class="rating-metric">
                                                                <div class="metric-header">
                                                                    <span class="metric-label">Engagement with tutor</span>
                                                                    <span class="metric-score">4.9</span>
                                                                </div>
                                                                <div class="metric-bar">
                                                                    <div class="metric-fill" style="width: 98%"></div>
                                                                </div>
                                                            </div>
                                                            <div class="rating-metric">
                                                                <div class="metric-header">
                                                                    <span class="metric-label">Engagement with tutor</span>
                                                                    <span class="metric-score">4.8</span>
                                                                </div>
                                                                <div class="metric-bar">
                                                                    <div class="metric-fill" style="width: 96%"></div>
                                                                </div>
                                                            </div>
                                                            <div class="rating-metric">
                                                                <div class="metric-header">
                                                                    <span class="metric-label">Responsiveness</span>
                                                                    <span class="metric-score">4.9</span>
                                                                </div>
                                                                <div class="metric-bar">
                                                                    <div class="metric-fill" style="width: 98%"></div>
                                                                </div>
                                                            </div>
                                                            <div class="rating-metric">
                                                                <div class="metric-header">
                                                                    <span class="metric-label">Payment Consistency</span>
                                                                    <span class="metric-score">4.7</span>
                                                                </div>
                                                                <div class="metric-bar">
                                                                    <div class="metric-fill" style="width: 94%"></div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <span class="rating-value" id="parent-rating" style="font-size: 1.5rem; font-weight: 700; color: #f59e0b;">4.8</span>
                                                    <span class="rating-count" id="rating-count" style="color: var(--text-secondary); font-size: 0.95rem; font-weight: 500;">(15 reviews)</span>
                                                </div>
                                            </div>
                                            <!-- Location -->
                                            <div class="profile-location">
                                                <span class="location-icon"></span>
                                                <span id="parent-location">Addis Ababa, Ethiopia</span>
                                            </div>
                                            <!-- Contact Information (Email & Phone) -->
                                            <div class="profile-contact-info" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 0.75rem; margin-bottom: 0.75rem;">
                                                <div style="display: flex; align-items: center; gap: 0.75rem; padding: 0.75rem 1rem; background: rgba(var(--button-bg-rgb), 0.05); border-radius: 12px;">
                                                    <span style="font-size: 1.25rem;"></span>
                                                    <div style="flex: 1; overflow: hidden;">
                                                        <div style="font-size: 0.75rem; color: var(--text-muted); margin-bottom: 0.125rem;">Email</div>
                                                        <div id="parent-email" style="color: var(--text); font-size: 0.875rem; font-weight: 500; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;">parent@example.com</div>
                                                    </div>
                                                </div>
                                                <div style="display: flex; align-items: center; gap: 0.75rem; padding: 0.75rem 1rem; background: rgba(var(--button-bg-rgb), 0.05); border-radius: 12px;">
                                                    <span style="font-size: 1.25rem;"></span>
                                                    <div style="flex: 1;">
                                                        <div style="font-size: 0.75rem; color: var(--text-muted); margin-bottom: 0.125rem;">Phone</div>
                                                        <div id="parent-phone" style="color: var(--text); font-size: 0.875rem; font-weight: 500;">+251 912 345 678</div>
                                                    </div>
                                                </div>
                                            </div>
                                            <!-- Relationship & Occupation (Contact Info Style) -->
                                            <div class="profile-contact-info" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 0.75rem; margin-bottom: 0.75rem;">
                                                <div style="display: flex; align-items: center; gap: 0.75rem; padding: 0.75rem 1rem; background: rgba(var(--button-bg-rgb), 0.05); border-radius: 12px;">
                                                    <span style="font-size: 1.25rem;"></span>
                                                    <div style="flex: 1;">
                                                        <div style="font-size: 0.75rem; color: var(--text-muted); margin-bottom: 0.125rem;">Relationship</div>
                                                        <div id="parent-relationship" style="color: var(--text); font-size: 0.875rem; font-weight: 500;">Father</div>
                                                    </div>
                                                </div>
                                                <div style="display: flex; align-items: center; gap: 0.75rem; padding: 0.75rem 1rem; background: rgba(var(--button-bg-rgb), 0.05); border-radius: 12px;">
                                                    <span style="font-size: 1.25rem;"></span>
                                                    <div style="flex: 1;">
                                                        <div style="font-size: 0.75rem; color: var(--text-muted); margin-bottom: 0.125rem;">Occupation</div>
                                                        <div id="parent-occupation" style="color: var(--text); font-size: 0.875rem; font-weight: 500;">Software Engineer</div>
                                                    </div>
                                                </div>
                                            </div>
                                            <!-- Hobbies & Interests -->
                                            <div id="hobbies-display-container"
                                                style="display: flex; align-items: center; gap: 0.75rem; padding: 0.75rem 1rem; background: rgba(var(--button-bg-rgb), 0.05); border-radius: 12px; margin-bottom: 0.75rem;">
                                                <span style="font-size: 1.25rem;">??</span>
                                                <div style="flex: 1;">
                                                    <div
                                                        style="font-size: 0.75rem; color: var(--text-muted); margin-bottom: 0.125rem;">
                                                        Hobbies & Interests</div>
                                                    <div id="parent-hobbies"
                                                        style="color: var(--text-muted); font-size: 0.875rem; font-weight: 500; font-style: italic;">
                                                        No hobbies yet</div>
                                                </div>
                                            </div>

                                            <!-- Social Links -->
                                            <div class="profile-social-links" id="social-links-container"
                                                style="display: flex; gap: 0.75rem; margin-top: 1.5rem; margin-bottom: 0.75rem; padding: 0.5rem 0;">
                                                <!-- Social links will be populated dynamically by JS with beautiful styling -->
                                            </div>

                                            <div class="profile-quote">
                                                <span id="parent-quote">"Education is the key to unlocking my children's
                                                    potential."</span>
                                            </div>
                                            <!-- Connections Section -->
                                            <div class="profile-connections" style="margin-top: 1.5rem;">
                                                <div class="connections-header"
                                                    style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                                                    <h4 style="font-weight: 600; font-size: 0.95rem; color: var(--heading);">
                                                        <span style="margin-right: 0.5rem;"></span>Activity Stats
                                                    </h4>
                                                </div>
                                                <div class="connections-stats"
                                                    style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 1rem; text-align: center;">
                                                    <!-- Connections Card -->
                                                    <div class="stat-box" onclick="openCommunityModalTab('connections')"
                                                        style="padding: 0.75rem; background: rgba(var(--button-bg-rgb), 0.05); border-radius: var(--radius-md); cursor: pointer; transition: all 0.3s ease;">
                                                        <div style="font-size: 1.5rem; font-weight: 700; color: var(--heading);"
                                                            id="connections-count">0</div>
                                                        <div style="font-size: 0.75rem; color: var(--text-muted); margin-top: 0.25rem;">
                                                            Connections</div>
                                                    </div>
                                                    <!-- Pending Requests Card -->
                                                    <div class="stat-box" onclick="openCommunityModalTab('pending')"
                                                        style="padding: 0.75rem; background: rgba(var(--button-bg-rgb), 0.05); border-radius: var(--radius-md); cursor: pointer; transition: all 0.3s ease;">
                                                        <div style="font-size: 1.5rem; font-weight: 700; color: var(--heading);"
                                                            id="pending-requests-count">0</div>
                                                        <div style="font-size: 0.75rem; color: var(--text-muted); margin-top: 0.25rem;">
                                                            Pending Requests</div>
                                                    </div>
                                                    <!-- Received Requests Card -->
                                                    <div class="stat-box" onclick="openCommunityModalTab('received')"
                                                        style="padding: 0.75rem; background: rgba(var(--button-bg-rgb), 0.05); border-radius: var(--radius-md); cursor: pointer; transition: all 0.3s ease;">
                                                        <div style="font-size: 1.5rem; font-weight: 700; color: var(--heading);"
                                                            id="received-requests-count">0</div>
                                                        <div style="font-size: 0.75rem; color: var(--text-muted); margin-top: 0.25rem;">
                                                            Received Requests</div>
                                                    </div>
                                                </div>
                                            </div>
                                            <!-- Profile Actions -->
                                            <div class="profile-actions">
                                                <button class="btn-primary" onclick="openEditProfileModal()">
                                                    <svg class="w-5 h-5" fill="none" stroke="currentColor"
                                                        viewBox="0 0 24 24">
                                                        <path stroke-linecap="round" stroke-linejoin="round"
                                                            stroke-width="2"
                                                            d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z">
                                                        </path>
                                                    </svg>
                                                    Edit Profile
                                                </button>
                                                <button class="btn-secondary" onclick="openChatModal()">
                                                    <svg class="w-5 h-5" fill="none" stroke="currentColor"
                                                        viewBox="0 0 24 24">
                                                        <path stroke-linecap="round" stroke-linejoin="round"
                                                            stroke-width="2"
                                                            d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z">
                                                        </path>
                                                    </svg>
                                                    Message
                                                </button>
                                                <button class="btn-secondary"
                                                    onclick="shareProfile(event)">
                                                    <svg class="w-5 h-5" fill="none" stroke="currentColor"
                                                        viewBox="0 0 24 24">
                                                        <path stroke-linecap="round" stroke-linejoin="round"
                                                            stroke-width="2"
                                                            d="M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.368 2.684 3 3 0 00-5.368-2.684z">
                                                        </path>
                                                    </svg>
                                                    Share Profile
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </section>
                            <!-- About Section -->
                            <section style="background: var(--card-bg); border-radius: 16px; padding: 2rem; margin-bottom: 2rem; box-shadow: 0 2px 8px rgba(0,0,0,0.08);">
                                <h3 style="font-size: 1.5rem; font-weight: 700; margin-bottom: 1rem; color: var(--heading);">About Me</h3>
                                <p id="parent-bio" style="color: var(--text); line-height: 1.7;">Dedicated to supporting my children's educational journey. Actively involved in their learning and development, working closely with tutors to ensure they reach their full potential.</p>
                            </section>
                            <!-- Achievements Section
                            <div class="card p-6 mb-8">
                                <h3 class="text-xl font-semibold mb-4">Parent Achievements & Milestones</h3>
                                <div class="grid grid-cols-3 md:grid-cols-6 gap-4">
                                    <div class="text-center">
                                        <div class="text-3xl mb-2"></div>
                                        <div class="text-sm">Super Parent</div>
                                        <div class="text-xs text-gray-500">3 Children</div>
                                    </div>
                                    <div class="text-center">
                                        <div class="text-3xl mb-2"></div>
                                        <div class="text-sm">Active Supporter</div>
                                        <div class="text-xs text-gray-500">365+ Days</div>
                                    </div>
                                    <div class="text-center">
                                        <div class="text-3xl mb-2"></div>
                                        <div class="text-sm">Engagement Star</div>
                                        <div class="text-xs text-gray-500">100+ Sessions</div>
                                    </div>
                                    <div class="text-center">
                                        <div class="text-3xl mb-2"></div>
                                        <div class="text-sm">Education Champion</div>
                                        <div class="text-xs text-gray-500">Top 10%</div>
                                    </div>
                                    <div class="text-center">
                                        <div class="text-3xl mb-2"></div>
                                        <div class="text-sm">Goal Achiever</div>
                                        <div class="text-xs text-gray-500">Family Goals</div>
                                    </div>
                                    <div class="text-center">
                                        <div class="text-3xl mb-2"></div>
                                        <div class="text-sm">Premium Member</div>
                                        <div class="text-xs text-gray-500">Level 5</div>
                                    </div>
                                </div>
                            </div>
                        -->
                            <!-- Family Statistics -->
                            <div class="dashboard-grid mb-8"
                                style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 1.5rem;">
                                <div class="card p-4">
                                    <div class="flex items-center gap-3 mb-2">
                                        <span class="text-3xl"></span>
                                        <h3 class="text-lg font-semibold">Children Enrolled</h3>
                                    </div>
                                    <p class="text-2xl font-bold" id="stat-children">3</p>
                                    <span class="text-sm text-gray-500">Active learners</span>
                                </div>
                                <div class="card p-4">
                                    <div class="flex items-center gap-3 mb-2">
                                        <span class="text-3xl"></span>
                                        <h3 class="text-lg font-semibold">Active Tutors</h3>
                                    </div>
                                    <p class="text-2xl font-bold text-blue-600" id="stat-tutors">5</p>
                                    <span class="text-sm text-gray-500">Across all children</span>
                                </div>
                                <div class="card p-4">
                                    <div class="flex items-center gap-3 mb-2">
                                        <span class="text-3xl"></span>
                                        <h3 class="text-lg font-semibold">Family Progress</h3>
                                    </div>
                                    <p class="text-2xl font-bold text-green-600" id="stat-family-progress">85%</p>
                                    <span class="text-sm text-gray-500">Average completion</span>
                                </div>
                                <div class="card p-4">
                                    <div class="flex items-center gap-3 mb-2">
                                        <span class="text-3xl"></span>
                                        <h3 class="text-lg font-semibold">Monthly Investment</h3>
                                    </div>
                                    <p class="text-2xl font-bold" id="stat-investment">12,500</p>
                                    <span class="text-sm text-gray-500">ETB per month</span>
                                </div>
                                <div class="card p-4">
                                    <div class="flex items-center gap-3 mb-2">
                                        <span class="text-3xl"></span>
                                        <h3 class="text-lg font-semibold">Sessions This Month</h3>
                                    </div>
                                    <p class="text-2xl font-bold text-purple-600" id="stat-sessions">48</p>
                                    <span class="text-sm text-gray-500">Across all children</span>
                                </div>
                                <div class="card p-4">
                                    <div class="flex items-center gap-3 mb-2">
                                        <span class="text-3xl"></span>
                                        <h3 class="text-lg font-semibold">Tutor Satisfaction</h3>
                                    </div>
                                    <p class="text-2xl font-bold text-yellow-600" id="stat-satisfaction">4.8</p>
                                    <span class="text-sm text-gray-500">Out of 5.0</span>
                                </div>
                                <div class="card p-4">
                                    <div class="flex items-center gap-3 mb-2">
                                        <span class="text-3xl"></span>
                                        <h3 class="text-lg font-semibold">Total Study Hours</h3>
                                    </div>
                                    <p class="text-2xl font-bold text-green-600"><span id="stat-study-hours">156</span>
                                    </p>
                                    <span class="text-sm text-gray-500">This month</span>
                                </div>
                                <div class="card p-4">
                                    <div class="flex items-center gap-3 mb-2">
                                        <span class="text-3xl">??</span>
                                        <h3 class="text-lg font-semibold">Attendance Rate</h3>
                                    </div>
                                    <p class="text-2xl font-bold text-orange-600"><span id="stat-attendance">94</span>%
                                    </p>
                                    <span class="text-sm text-gray-500">Family average</span>
                                </div>
                            </div>
                            <!-- Reviews Section - Dynamically loaded from parent_reviews table -->
                            <div class="card p-6 mb-8">
                                <div class="flex justify-between items-center mb-4">
                                    <h3 class="text-xl font-semibold">Recent Feedback from Tutors</h3>
                                    <a href="#" onclick="switchPanel('ratings-and-reviews'); return false;" class="text-sm text-purple-600 hover:text-purple-700 font-medium">View All</a>
                                </div>
                                <div id="dashboard-reviews-container" class="space-y-4">
                                    <!-- Reviews will be loaded dynamically from parent_reviews table -->
                                    <div class="loading-placeholder text-center py-8">
                                        <div class="animate-pulse">
                                            <div class="h-4 bg-gray-200 rounded w-3/4 mx-auto mb-2"></div>
                                            <div class="h-4 bg-gray-200 rounded w-1/2 mx-auto"></div>
                                        </div>
                                        <p class="text-gray-500 mt-4 text-sm">Loading reviews...</p>
                                    </div>
                                </div>
                                <!-- Empty state (shown when no reviews) -->
                                <div id="dashboard-reviews-empty" class="hidden text-center py-8">
                                    <div class="text-4xl mb-2">?</div>
                                    <h4 class="font-semibold text-gray-700 mb-1">No reviews yet</h4>
                                    <p class="text-sm text-gray-500">Reviews from tutors will appear here</p>
                                </div>
                            </div>
                            <!-- Additional Dashboard Content Here -->
                            <div class="grid grid-cols-1 gap-6">
                                <!-- Coming soon panels will be implemented by panel managers -->
                            </div>
                        </div>
                        <!-- End Dashboard Panel -->
                        <!-- ============================================ -->
                        <!-- PARENT PROFILE PANELS                        -->
                        <!-- ============================================ -->
                        <!-- My Children Panel -->
                        <div id="my-children-panel" class="panel-content hidden">
                            <div class="mb-8">
                                <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 0.5rem;">
                                    <h1 class="text-3xl font-bold">My Children</h1>
                                    <span id="children-count-badge" class="hidden" style="background: var(--primary-color); color: white; padding: 0.25rem 0.75rem; border-radius: 999px; font-size: 0.875rem; font-weight: 600;">0 children</span>
                                </div>
                                <p class="text-gray-600">View and manage your children's progress and academic performance</p>
                            </div>
                            <!-- Search and Add Child Bar -->
                            <div class="card p-6 mb-6">
                                <div style="display: flex; align-items: center; gap: 1rem;">
                                    <div style="position: relative; flex: 1;">
                                        <i class="fas fa-search" style="position: absolute; left: 1rem; top: 50%; transform: translateY(-50%); color: var(--text-secondary);"></i>
                                        <input type="search" id="children-search" class="w-full p-3 pl-12 border-2 rounded-lg"
                                            placeholder="Search children by name, grade, or school..."
                                            autocomplete="new-password" autocorrect="off" autocapitalize="off" spellcheck="false"
                                            data-form-type="other" data-lpignore="true"
                                            oninput="ChildrenManager.searchChildren(this.value)">
                                    </div>
                                    <button onclick="ChildrenManager.loadChildren()" class="btn-secondary" style="padding: 0.75rem 1.25rem; white-space: nowrap;">
                                        <i class="fas fa-sync-alt"></i> Refresh
                                    </button>
                                    <button onclick="openAddChildModal()" class="btn-primary" style="padding: 0.75rem 1.25rem; white-space: nowrap;">
                                        <i class="fas fa-plus"></i> Add Child
                                    </button>
                                </div>
                            </div>
                            <!-- Loading State -->
                            <div id="children-loading-state" class="hidden">
                                <div class="col-span-full card p-6 text-center text-gray-500">
                                    <i class="fas fa-spinner fa-spin text-3xl mb-3"></i>
                                    <p>Loading children...</p>
                                </div>
                            </div>
                            <!-- Empty State -->
                            <div id="children-empty-state" class="hidden">
                                <div class="card p-8 text-center" style="border: 2px dashed var(--border-color);">
                                    <div style="font-size: 4rem; margin-bottom: 1.5rem;"></div>
                                    <h3 style="font-size: 1.5rem; font-weight: 700; color: var(--heading); margin-bottom: 0.75rem;">No Children Yet</h3>
                                    <p style="color: var(--text-secondary); max-width: 400px; margin: 0 auto 1.5rem; line-height: 1.6;">Your linked children will appear here. Add a child or ask your child to invite you as their parent.</p>
                                    <button class="btn-primary" onclick="openAddChildModal()" style="padding: 0.75rem 1.5rem;">
                                        <i class="fas fa-plus"></i> Add Child
                                    </button>
                                </div>
                            </div>
                            <!-- Pending Invitations Section -->
                            <div id="pending-child-invitations-section" class="hidden mb-6">
                                <h2 class="text-xl font-bold mb-4 flex items-center gap-2">
                                    <i class="fas fa-clock text-yellow-500"></i>
                                    Pending Invitations
                                </h2>
                                <div id="pending-child-invitations-container" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                                    <!-- Pending invitation cards will be loaded here -->
                                </div>
                            </div>

                            <!-- Children Cards Container (dynamically loaded) -->
                            <div id="children-cards-container" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                                <!-- Child cards will be dynamically loaded here by ChildrenManager -->
                            </div>
                        </div>
                        <!-- Co-Parents Panel -->
                        <div id="co-parents-panel" class="panel-content hidden">
                            <!-- Header with title and badge -->
                            <div class="mb-8">
                                <div style="display: flex; align-items: center; gap: 1rem; flex-wrap: wrap;">
                                    <h1 class="text-3xl font-bold">Co-Parents</h1>
                                    <span id="coparents-count-badge" class="hidden" style="background: var(--primary-color); color: white; padding: 0.25rem 0.75rem; border-radius: 20px; font-size: 0.875rem; font-weight: 600;">0 co-parents</span>
                                </div>
                            </div>
                            <!-- Search and Add Co-Parent Bar -->
                            <div class="card p-6 mb-6" style="display: flex; flex-wrap: wrap; gap: 1rem; align-items: center; justify-content: space-between;">
                                <div style="flex: 1; min-width: 200px; max-width: 400px;">
                                    <div style="position: relative;">
                                        <i class="fas fa-search" style="position: absolute; left: 1rem; top: 50%; transform: translateY(-50%); color: var(--text-secondary);"></i>
                                        <input type="search"
                                               id="coparents-search"
                                               placeholder="Search co-parents..."
                                               oninput="CoparentsManager.searchCoparents(this.value)"
                                               style="width: 100%; padding: 0.75rem 1rem 0.75rem 2.5rem; border: 1px solid var(--border-color); border-radius: 8px; background: var(--card-bg); color: var(--text-primary);">
                                    </div>
                                </div>
                                <div style="display: flex; gap: 0.5rem;">
                                    <button class="btn-secondary" onclick="CoparentsManager.loadCoparents()" style="padding: 0.75rem 1rem; border-radius: 8px;">
                                        <i class="fas fa-sync-alt"></i> Refresh
                                    </button>
                                    <button class="btn-primary" onclick="openInviteCoparentModal()" style="padding: 0.75rem 1.5rem; border-radius: 8px;">
                                        <i class="fas fa-plus"></i> Add Co-Parent
                                    </button>
                                </div>
                            </div>
                            <!-- Loading State -->
                            <div id="coparents-loading-state" class="children-loading-state hidden">
                                <div class="loading-spinner-container">
                                    <i class="fas fa-spinner fa-spin text-4xl text-primary-color"></i>
                                </div>
                                <p class="loading-text">Loading co-parents...</p>
                            </div>
                            <!-- Co-parents Grid -->
                            <div id="coparents-grid" class="coparents-grid grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6" style="overflow: visible;">
                                <!-- Co-parent cards will be dynamically loaded here -->
                                <!-- Empty State -->
                                <div class="children-empty-state" id="coparents-empty-state" style="grid-column: 1 / -1;">
                                    <div class="empty-state-icon"></div>
                                    <h3 class="empty-state-title">No Co-Parents Yet</h3>
                                    <p class="empty-state-text">Add a co-parent (mother/father/guardian) to share parental responsibilities and manage your children together.</p>
                                    <button class="btn-primary" onclick="openInviteCoparentModal()">
                                        <i class="fas fa-plus"></i> Add Co-Parent
                                    </button>
                                </div>
                            </div>
                        </div>
                        <!-- tutor-child Panel (formerly Tutor My Child) -->
                        <div id="tutor-child-panel" class="panel-content hidden">
                            <div class="mb-8">
                                <h1 class="text-3xl font-bold mb-2">Tutor My Child</h1>
                                <p class="text-gray-600">Become a tutor to access teaching tools for your children</p>
                            </div>
                            <div class="card p-8 text-center max-w-2xl mx-auto">
                                <div class="text-6xl mb-6"></div>
                                <p class="text-gray-600 text-lg mb-6" id="tutor-child-message">
                                    Create a tutor account to get all the tools you need to teach your child.
                                </p>
                                <div id="tutor-child-action">
                                    <button onclick="openAddRoleModal()" class="btn btn-primary text-lg px-8 py-3" id="create-tutor-btn">
                                        <i class="fas fa-chalkboard-teacher mr-2"></i>
                                        Create Tutor Account
                                    </button>
                                </div>
                            </div>
                            <script>
                                (function() {
                                    // Check if user has tutor role
                                    function checkHasTutorRole() {
                                        const user = JSON.parse(localStorage.getItem('user') || '{}');
                                        // Check multiple possible formats:
                                        // 1. role_ids object: { tutor: 85, student: 28 }
                                        // 2. roles as array: ['tutor', 'student', 'parent']
                                        // 3. roles as object: { tutor: true, student: true }

                                        if (user.role_ids && user.role_ids.tutor) {
                                            return true;
                                        }
                                        if (Array.isArray(user.roles) && user.roles.includes('tutor')) {
                                            return true;
                                        }
                                        if (user.roles && typeof user.roles === 'object' && user.roles.tutor) {
                                            return true;
                                        }
                                        return false;
                                    }

                                    function updateTutorChildPanel() {
                                        const hasTutorRole = checkHasTutorRole();

                                        const messageEl = document.getElementById('tutor-child-message');
                                        const actionEl = document.getElementById('tutor-child-action');

                                        if (hasTutorRole && messageEl && actionEl) {
                                            messageEl.textContent = 'You already have a tutor account. Switch to your tutor profile to access all teaching tools.';
                                            actionEl.innerHTML = `
                                                <button onclick="switchToRole('tutor')" class="btn btn-primary text-lg px-8 py-3">
                                                    <i class="fas fa-exchange-alt mr-2"></i>
                                                    Go to Tutor Profile
                                                </button>
                                            `;
                                        } else if (messageEl && actionEl) {
                                            // Reset to default state if no tutor role
                                            messageEl.textContent = 'Create a tutor account to get all the tools you need to teach your child.';
                                            actionEl.innerHTML = `
                                                <button onclick="openAddRoleModal()" class="btn btn-primary text-lg px-8 py-3" id="create-tutor-btn">
                                                    <i class="fas fa-chalkboard-teacher mr-2"></i>
                                                    Create Tutor Account
                                                </button>
                                            `;
                                        }
                                    }

                                    // Run on DOM ready and when panel becomes visible
                                    if (document.readyState === 'loading') {
                                        document.addEventListener('DOMContentLoaded', updateTutorChildPanel);
                                    } else {
                                        updateTutorChildPanel();
                                    }

                                    // Also update when switching to this panel
                                    window.addEventListener('panelSwitch', function(e) {
                                        if (e.detail && e.detail.panelName === 'tutor-child') {
                                            updateTutorChildPanel();
                                        }
                                    });
                                })();
                            </script>
                        </div>
                        <!-- Tutors Panel -->
                        <div id="tutors-panel" class="panel-content hidden">
                            <div class="section-header" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem;">
                                <div>
                                    <h2 class="section-title">Your Children's Tutors</h2>
                                    <p class="text-gray-600">View and manage tutors teaching your children</p>
                                </div>
                                <a href="../branch/find-tutors.html" class="btn-primary">
                                    <span> Find More Tutors</span>
                                </a>
                            </div>
                            <!-- Tutors Grid - Dynamically loaded from enrolled_students table -->
                            <div class="tutors-grid" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(350px, 1fr)); gap: 2rem;">
                                <!-- Loading state - will be replaced by TutorsPanelManager -->
                                <div class="loading-state" style="grid-column: 1 / -1; text-align: center; padding: 3rem;">
                                    <div class="text-center py-8 text-gray-500">
                                        <i class="fas fa-spinner fa-spin text-4xl mb-4" style="color: var(--button-bg);"></i>
                                        <p class="text-lg">Loading tutors...</p>
                                    </div>
                                </div>
                                <!-- End loading state - Tutors will be dynamically inserted here by tutors-panel-manager.js -->
                            </div>
                        </div>
                        <!-- Schedule Panel -->
                        <div class="panel-content hidden" id="schedule-panel">
                            <div class="mb-8">
                                <h1 class="text-3xl font-bold mb-2">My Schedule</h1>
                                <p class="text-gray-600">Manage your family's schedules and activities</p>
                            </div>

                            <!-- Schedules Content -->
                            <div id="schedules-content">
                                <!-- Create Schedule Button and Search Bar in One Row -->
                                <div class="card p-6 mb-6">
                                    <div style="display: flex; gap: 16px; align-items: center; margin-bottom: 12px;">
                                        <button class="cta-button" onclick="openScheduleModal()"
                                            style="white-space: nowrap;">
                                            <i class="fas fa-plus"></i> Create Schedule
                                        </button>
                                        <div class="relative" style="flex: 1;">
                                            <i
                                                class="fas fa-search absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-400"></i>
                                            <input type="text" id="schedule-search"
                                                class="w-full p-3 pl-12 border-2 rounded-lg"
                                                placeholder="Search schedules by title, priority level, or child name..."
                                                oninput="searchSchedules(this.value)">
                                        </div>
                                    </div>
                                </div>

                                <!-- Role-based Filters -->
                                <div class="mb-6 flex gap-4 flex-wrap">
                                    <button class="px-4 py-2 rounded-full bg-blue-500 text-white"
                                        onclick="filterSchedulesByRole('all', event)">
                                        <i class="fas fa-users mr-2"></i>All Sessions
                                    </button>
                                    <button class="px-4 py-2 rounded-full bg-gray-200"
                                        onclick="filterSchedulesByRole('tutor', event)">
                                        <i class="fas fa-chalkboard-teacher mr-2"></i>As Tutor
                                    </button>
                                    <button class="px-4 py-2 rounded-full bg-gray-200"
                                        onclick="filterSchedulesByRole('student', event)">
                                        <i class="fas fa-user-graduate mr-2"></i>As Student
                                    </button>
                                    <button class="px-4 py-2 rounded-full bg-gray-200"
                                        onclick="filterSchedulesByRole('parent', event)">
                                        <i class="fas fa-user-friends mr-2"></i>As Parent
                                    </button>
                                </div>

                                <!-- Schedules Table -->
                                <div class="card p-6 mb-6">
                                    <div class="flex justify-between items-center mb-4">
                                        <h3 class="text-2xl font-bold">My Family Schedules</h3>
                                        <!-- Schedule Priority Filters -->
                                        <div class="flex gap-2 flex-wrap">
                                            <button class="px-4 py-2 rounded-full bg-blue-500 text-white text-sm"
                                                onclick="filterSchedules('all')">
                                                All
                                            </button>
                                            <button class="px-4 py-2 rounded-full bg-gray-200 text-sm"
                                                onclick="filterSchedules('urgent')" title="Critical tasks requiring immediate attention">
                                                Urgent
                                            </button>
                                            <button class="px-4 py-2 rounded-full bg-gray-200 text-sm"
                                                onclick="filterSchedules('high')" title="Important tasks with high priority">
                                                High
                                            </button>
                                            <button class="px-4 py-2 rounded-full bg-gray-200 text-sm"
                                                onclick="filterSchedules('medium')" title="Regular scheduled tasks">
                                                Medium
                                            </button>
                                            <button class="px-4 py-2 rounded-full bg-gray-200 text-sm"
                                                onclick="filterSchedules('low')" title="Optional or flexible tasks">
                                                Low
                                            </button>
                                        </div>
                                    </div>
                                    <div id="schedule-calendar">
                                        <div class="text-center py-8 text-gray-500">
                                            <i class="fas fa-spinner fa-spin text-3xl mb-3"></i>
                                            <p>Loading schedules...</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- My Sessions Panel -->
                        <div id="sessions-panel" class="panel-content hidden">
                            <div class="mb-8">
                                <h1 class="text-3xl font-bold mb-2">My Sessions</h1>
                                <p class="text-gray-600">View and monitor your children's tutoring sessions</p>
                            </div>

                            <!-- Session Stats Cards -->
                            <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-6">
                                <div class="card p-6 text-center">
                                    <div class="text-3xl mb-2">??</div>
                                    <div class="text-2xl font-bold" id="parent-session-stat-total">0</div>
                                    <div class="text-sm text-gray-600">Total Sessions</div>
                                </div>
                                <div class="card p-6 text-center">
                                    <div class="text-3xl mb-2">?</div>
                                    <div class="text-2xl font-bold" id="parent-session-stat-completed">0</div>
                                    <div class="text-sm text-gray-600">Completed</div>
                                </div>
                                <div class="card p-6 text-center">
                                    <div class="text-3xl mb-2">?</div>
                                    <div class="text-2xl font-bold" id="parent-session-stat-hours">0</div>
                                    <div class="text-sm text-gray-600">Total Hours</div>
                                </div>
                                <div class="card p-6 text-center">
                                    <div class="text-3xl mb-2">??</div>
                                    <div class="text-2xl font-bold" id="parent-session-stat-upcoming">0</div>
                                    <div class="text-sm text-gray-600">Upcoming</div>
                                </div>
                            </div>

                            <!-- Search Bar -->
                            <div class="card p-6 mb-6">
                                <div class="relative mb-3">
                                    <i class="fas fa-search absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-400"></i>
                                    <input type="text" id="sessions-search" class="w-full p-3 pl-12 border-2 rounded-lg"
                                        placeholder="Search sessions by child name, tutor, subject, or topic..."
                                        oninput="searchParentSessions(this.value)">
                                </div>
                            </div>

                            <!-- Role-based Filters -->
                            <div class="mb-6 flex gap-4 flex-wrap">
                                <button class="px-4 py-2 rounded-full bg-blue-500 text-white"
                                    onclick="filterParentSessionsByRole('all', event)">
                                    <i class="fas fa-users mr-2"></i>All Sessions
                                </button>
                                <button class="px-4 py-2 rounded-full bg-gray-200"
                                    onclick="filterParentSessionsByRole('tutor', event)">
                                    <i class="fas fa-chalkboard-teacher mr-2"></i>As Tutor
                                </button>
                                <button class="px-4 py-2 rounded-full bg-gray-200"
                                    onclick="filterParentSessionsByRole('student', event)">
                                    <i class="fas fa-user-graduate mr-2"></i>As Student
                                </button>
                                <button class="px-4 py-2 rounded-full bg-gray-200"
                                    onclick="filterParentSessionsByRole('parent', event)">
                                    <i class="fas fa-user-friends mr-2"></i>As Parent
                                </button>
                            </div>

                            <!-- Sessions Table -->
                            <div class="card p-6 mb-6">
                                <h3 class="text-2xl font-bold mb-4">My Children's Sessions</h3>
                                <div id="sessions-table-container">
                                    <div class="text-center py-8 text-gray-500">
                                        <i class="fas fa-spinner fa-spin text-3xl mb-3"></i>
                                        <p>Loading sessions...</p>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Community Panel (Restructured to match Earnings-Investments pattern) -->
                        <div class="panel-content hidden" id="community-panel">
                            <div class="mb-8">
                                <h1 class="text-3xl font-bold mb-2">Community</h1>
                                <p class="text-gray-600">Connect with tutors, your children, and other parents</p>
                            </div>
                            <!-- Main Section Cards (Clickable Cards instead of Tabs) -->
                            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8">
                                <div onclick="switchCommunityMainTab('connections')" id="connections-main-tab"
                                    class="card p-6 bg-gradient-to-br from-blue-50 to-indigo-50 border-blue-200 cursor-pointer hover:shadow-lg transition-all duration-200 community-main-card active-community-card"
                                    style="display: flex; flex-direction: column; min-height: 140px; overflow: visible;">
                                    <div class="flex items-center justify-between mb-3">
                                        <span class="text-blue-600" style="font-size: 2.5rem; line-height: 1;"></span>
                                    </div>
                                    <h3 class="text-xl font-bold text-gray-800 mb-2" style="line-height: 1.3;">Connections</h3>
                                    <p class="text-sm text-gray-600 mb-2" style="line-height: 1.4; flex-grow: 1;">Manage your network</p>
                                    <p class="text-xs text-blue-600 font-medium" style="margin-top: auto;">Click to open</p>
                                </div>
                                <div onclick="switchCommunityMainTab('requests-sent')" id="requests-sent-main-tab"
                                    class="card p-6 bg-gradient-to-br from-blue-50 to-indigo-50 border-blue-200 cursor-pointer hover:shadow-lg transition-all duration-200 community-main-card"
                                    style="display: flex; flex-direction: column; min-height: 140px; overflow: visible;">
                                    <div class="flex items-center justify-between mb-3">
                                        <span class="text-blue-600" style="font-size: 2.5rem; line-height: 1;"></span>
                                        <span class="text-xs text-blue-600 font-semibold">SENT</span>
                                    </div>
                                    <h3 class="text-xl font-bold text-gray-800 mb-2" style="line-height: 1.3;">Requests Sent</h3>
                                    <p class="text-sm text-gray-600 mb-2" style="line-height: 1.4; flex-grow: 1;">
                                        <span class="text-2xl font-bold" id="sent-requests-count-main">0</span> pending
                                    </p>
                                    <p class="text-xs text-blue-600 font-medium" style="margin-top: auto;">Click to open</p>
                                </div>
                                <div onclick="switchCommunityMainTab('requests-received')" id="requests-received-main-tab"
                                    class="card p-6 bg-gradient-to-br from-green-50 to-emerald-50 border-green-200 cursor-pointer hover:shadow-lg transition-all duration-200 community-main-card"
                                    style="display: flex; flex-direction: column; min-height: 140px; overflow: visible;">
                                    <div class="flex items-center justify-between mb-3">
                                        <span class="text-green-600" style="font-size: 2.5rem; line-height: 1;"></span>
                                        <span class="text-xs text-green-600 font-semibold">RECEIVED</span>
                                    </div>
                                    <h3 class="text-xl font-bold text-gray-800 mb-2" style="line-height: 1.3;">Requests Received</h3>
                                    <p class="text-sm text-gray-600 mb-2" style="line-height: 1.4; flex-grow: 1;">
                                        <span class="text-2xl font-bold" id="received-requests-count-main">0</span> pending
                                    </p>
                                    <p class="text-xs text-green-600 font-medium" style="margin-top: auto;">Click to open</p>
                                </div>
                            </div>
                            <!-- Connections Tab Content -->
                            <div id="connections-main-tab-content" class="community-main-tab-content">
                                <!-- Sub-Section Tabs (Regular Tabs) -->
                                <div class="flex gap-4 mb-6 border-b border-gray-200">
                                    <button onclick="toggleConnectionsSubSection('all')" id="all-connections-tab"
                                        class="connections-sub-tab px-6 py-3 font-semibold text-blue-600 border-b-2 border-blue-600 transition-all">
                                        All Connections
                                    </button>
                                    <button onclick="toggleConnectionsSubSection('tutors')" id="tutors-connections-tab"
                                        class="connections-sub-tab px-6 py-3 font-semibold text-gray-500 hover:text-gray-700 transition-all">
                                        Tutors
                                    </button>
                                    <button onclick="toggleConnectionsSubSection('children')" id="children-connections-tab"
                                        class="connections-sub-tab px-6 py-3 font-semibold text-gray-500 hover:text-gray-700 transition-all">
                                        Children
                                    </button>
                                    <button onclick="toggleConnectionsSubSection('parents')" id="parents-connections-tab"
                                        class="connections-sub-tab px-6 py-3 font-semibold text-gray-500 hover:text-gray-700 transition-all">
                                        Parents
                                    </button>
                                </div>
                                <!-- Connections Sub-Sections -->
                                <div class="space-y-8">
                                    <!-- All Connections Section -->
                                    <div id="all-connections-subsection" class="card p-6 connections-subsection">
                                        <div class="flex items-center justify-between mb-6">
                                            <div>
                                                <h3 class="text-xl font-bold flex items-center gap-2">
                                                    <span class="text-blue-600"></span>
                                                    All Connections
                                                </h3>
                                                <p class="text-sm text-gray-600 mt-1">View all your connections in one place</p>
                                            </div>
                                            <div class="flex items-center gap-3">
                                                <input type="text" id="all-connections-search" placeholder="Search connections..."
                                                    class="p-2 border-2 rounded-lg text-sm" oninput="searchAllConnections(this.value)">
                                            </div>
                                        </div>
                                        <!-- Connections Grid -->
                                        <div id="all-connections-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 max-h-96 overflow-y-auto">
                                            <!-- Will be populated by JS -->
                                        </div>
                                    </div>
                                    <!-- Tutors Section -->
                                    <div id="tutors-connections-subsection" class="card p-6 connections-subsection hidden">
                                        <div class="flex items-center justify-between mb-6">
                                            <div>
                                                <h3 class="text-xl font-bold flex items-center gap-2">
                                                    <span class="text-green-600"></span>
                                                    Tutor Connections
                                                </h3>
                                                <p class="text-sm text-gray-600 mt-1">Tutors teaching your children</p>
                                            </div>
                                            <div class="flex items-center gap-3">
                                                <input type="text" id="tutor-connections-search" placeholder="Search tutors..."
                                                    class="p-2 border-2 rounded-lg text-sm" oninput="searchTutorConnections(this.value)">
                                            </div>
                                        </div>
                                        <div id="tutor-connections-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 max-h-96 overflow-y-auto">
                                            <!-- Will be populated by JS -->
                                        </div>
                                    </div>
                                    <!-- Children Section -->
                                    <div id="children-connections-subsection" class="card p-6 connections-subsection hidden">
                                        <div class="flex items-center justify-between mb-6">
                                            <div>
                                                <h3 class="text-xl font-bold flex items-center gap-2">
                                                    <span class="text-purple-600"></span>
                                                    Children Connections
                                                </h3>
                                                <p class="text-sm text-gray-600 mt-1">Your children and their connections</p>
                                            </div>
                                            <div class="flex items-center gap-3">
                                                <input type="text" id="children-connections-search" placeholder="Search children..."
                                                    class="p-2 border-2 rounded-lg text-sm" oninput="searchChildrenConnections(this.value)">
                                            </div>
                                        </div>
                                        <div id="children-connections-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 max-h-96 overflow-y-auto">
                                            <!-- Will be populated by JS -->
                                        </div>
                                    </div>
                                    <!-- Parents Section -->
                                    <div id="parents-connections-subsection" class="card p-6 connections-subsection hidden">
                                        <div class="flex items-center justify-between mb-6">
                                            <div>
                                                <h3 class="text-xl font-bold flex items-center gap-2">
                                                    <span class="text-orange-600"></span>
                                                    Parent Connections
                                                </h3>
                                                <p class="text-sm text-gray-600 mt-1">Other parents you're connected with</p>
                                            </div>
                                            <div class="flex items-center gap-3">
                                                <input type="text" id="parent-connections-search" placeholder="Search parents..."
                                                    class="p-2 border-2 rounded-lg text-sm" oninput="searchParentConnections(this.value)">
                                            </div>
                                        </div>
                                        <div id="parent-connections-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 max-h-96 overflow-y-auto">
                                            <!-- Will be populated by JS -->
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Requests Tab Content (NEW) -->
                            <div id="requests-main-tab-content" class="community-main-tab-content hidden">
                                <!-- Requests Sub-Sections -->
                                <div class="space-y-8">
                                    <!-- Requests Sent Section -->
                                    <div id="sent-requests-subsection" class="card p-6 requests-subsection">
                                        <div class="mb-6">
                                            <div class="mb-4">
                                                <h3 class="text-xl font-bold flex items-center gap-2">
                                                    <span class="text-blue-600">??</span>
                                                    Requests Sent
                                                </h3>
                                                <p class="text-sm text-gray-600 mt-1">Connection requests you've sent to others</p>
                                            </div>
                                            <!-- Status Filter Tabs -->
                                            <div class="flex items-center gap-2 border-b-2 border-gray-200">
                                                <button onclick="filterSentRequests('all')" data-status="all"
                                                    class="sent-requests-status-tab px-4 py-2 font-medium text-sm border-b-2 border-blue-600 text-blue-600 transition-all">
                                                    All Requests
                                                </button>
                                                <button onclick="filterSentRequests('pending')" data-status="pending"
                                                    class="sent-requests-status-tab px-4 py-2 font-medium text-sm border-b-2 border-transparent text-gray-600 hover:text-gray-800 transition-all">
                                                    Pending
                                                </button>
                                                <button onclick="filterSentRequests('accepted')" data-status="accepted"
                                                    class="sent-requests-status-tab px-4 py-2 font-medium text-sm border-b-2 border-transparent text-gray-600 hover:text-gray-800 transition-all">
                                                    Accepted
                                                </button>
                                                <button onclick="filterSentRequests('rejected')" data-status="rejected"
                                                    class="sent-requests-status-tab px-4 py-2 font-medium text-sm border-b-2 border-transparent text-gray-600 hover:text-gray-800 transition-all">
                                                    Rejected
                                                </button>
                                            </div>
                                        </div>
                                        <div id="sent-requests-list" class="space-y-3 max-h-96 overflow-y-auto">
                                            <!-- Will be populated by JS -->
                                        </div>
                                    </div>
                                    <!-- Requests Received Section -->
                                    <div id="received-requests-subsection" class="card p-6 requests-subsection hidden">
                                        <div class="mb-6">
                                            <div class="mb-4">
                                                <h3 class="text-xl font-bold flex items-center gap-2">
                                                    <span class="text-green-600"></span>
                                                    Requests Received
                                                </h3>
                                                <p class="text-sm text-gray-600 mt-1">Connection requests from others waiting for your response</p>
                                            </div>
                                            <!-- Status Filter Tabs -->
                                            <div class="flex items-center gap-2 border-b-2 border-gray-200">
                                                <button onclick="filterReceivedRequests('all')" data-status="all"
                                                    class="received-requests-status-tab px-4 py-2 font-medium text-sm border-b-2 border-green-600 text-green-600 transition-all">
                                                    All Requests
                                                </button>
                                                <button onclick="filterReceivedRequests('pending')" data-status="pending"
                                                    class="received-requests-status-tab px-4 py-2 font-medium text-sm border-b-2 border-transparent text-gray-600 hover:text-gray-800 transition-all">
                                                    Pending
                                                </button>
                                                <button onclick="filterReceivedRequests('accepted')" data-status="accepted"
                                                    class="received-requests-status-tab px-4 py-2 font-medium text-sm border-b-2 border-transparent text-gray-600 hover:text-gray-800 transition-all">
                                                    Accepted
                                                </button>
                                                <button onclick="filterReceivedRequests('rejected')" data-status="rejected"
                                                    class="received-requests-status-tab px-4 py-2 font-medium text-sm border-b-2 border-transparent text-gray-600 hover:text-gray-800 transition-all">
                                                    Rejected
                                                </button>
                                            </div>
                                        </div>
                                        <div id="received-requests-list" class="space-y-3 max-h-96 overflow-y-auto">
                                            <!-- Will be populated by JS -->
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Events Panel -->
                        <div class="panel-content hidden" id="events-panel">
                            <div class="mb-8">
                                <h1 class="text-3xl font-bold mb-2">Events</h1>
                                <p class="text-gray-600">Discover and join events created by advertisers</p>
                            </div>

                            <!-- Events Tabs -->
                            <div class="flex gap-4 mb-6 border-b border-gray-200">
                                <button onclick="switchEventsTab('past')" id="past-events-tab"
                                    class="events-tab px-6 py-3 font-semibold text-blue-600 border-b-2 border-blue-600 transition-all">
                                    Past Events
                                </button>
                                <button onclick="switchEventsTab('upcoming')" id="upcoming-events-panel-tab"
                                    class="events-tab px-6 py-3 font-semibold text-gray-500 hover:text-gray-700 transition-all">
                                    Upcoming Events
                                </button>
                                <button onclick="switchEventsTab('joined')" id="joined-events-panel-tab"
                                    class="events-tab px-6 py-3 font-semibold text-gray-500 hover:text-gray-700 transition-all">
                                    Joined Events
                                </button>
                            </div>

                            <!-- Past Events Tab -->
                            <div id="past-events-tab-content" class="events-tab-content">
                                <div class="card p-6">
                                    <div class="flex items-center justify-between mb-6">
                                        <div>
                                            <h3 class="text-xl font-bold flex items-center gap-2">
                                                <span class="text-gray-600"></span>
                                                Past Events
                                            </h3>
                                            <p class="text-sm text-gray-600 mt-1">Events you haven't joined that already happened</p>
                                        </div>
                                        <div class="flex items-center gap-3">
                                            <input type="text" id="past-events-search" placeholder="Search past events..."
                                                class="p-2 border-2 rounded-lg text-sm"
                                                oninput="searchPastEvents(this.value)">
                                        </div>
                                    </div>
                                    <div id="past-events-grid"
                                        class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                                        <!-- Will be populated by JS -->
                                    </div>
                                </div>
                            </div>

                            <!-- Upcoming Events Tab -->
                            <div id="upcoming-events-panel-tab-content" class="events-tab-content hidden">
                                <div class="card p-6">
                                    <div class="flex items-center justify-between mb-6">
                                        <div>
                                            <h3 class="text-xl font-bold flex items-center gap-2">
                                                <span class="text-green-600"></span>
                                                Upcoming Events
                                            </h3>
                                            <p class="text-sm text-gray-600 mt-1">Events you haven't joined yet that are scheduled for the future</p>
                                        </div>
                                        <div class="flex items-center gap-3">
                                            <input type="text" id="upcoming-events-panel-search" placeholder="Search upcoming events..."
                                                class="p-2 border-2 rounded-lg text-sm"
                                                oninput="searchUpcomingPanelEvents(this.value)">
                                        </div>
                                    </div>
                                    <div id="upcoming-events-panel-grid"
                                        class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                                        <!-- Will be populated by JS -->
                                    </div>
                                </div>
                            </div>

                            <!-- Joined Events Tab -->
                            <div id="joined-events-panel-tab-content" class="events-tab-content hidden">
                                <div class="card p-6">
                                    <div class="flex items-center justify-between mb-6">
                                        <div>
                                            <h3 class="text-xl font-bold flex items-center gap-2">
                                                <span class="text-blue-600">?</span>
                                                Joined Events
                                            </h3>
                                            <p class="text-sm text-gray-600 mt-1">All events you have joined (past and upcoming)</p>
                                        </div>
                                        <div class="flex items-center gap-3">
                                            <input type="text" id="joined-events-panel-search" placeholder="Search joined events..."
                                                class="p-2 border-2 rounded-lg text-sm"
                                                oninput="searchJoinedPanelEvents(this.value)">
                                        </div>
                                    </div>
                                    <div id="joined-events-panel-grid"
                                        class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                                        <!-- Will be populated by JS -->
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!-- Blog Panel -->
                        <div class="panel-content hidden" id="blog-panel">
                            <div class="section-header">
                                <h2 class="section-title">Blog & Articles</h2>
                                <button class="btn-primary" onclick="openCreateBlogModal()">
                                    <span> Create Blog Post</span>
                                </button>
                            </div>
                            <div class="blog-filters">
                                <button class="filter-chip active" onclick="filterBlogs('all')">All Posts</button>
                                <button class="filter-chip" onclick="filterBlogs('published')">Published</button>
                                <button class="filter-chip" onclick="filterBlogs('draft')">Drafts</button>
                                <button class="filter-chip" onclick="filterBlogs('industry')">Industry News</button>
                                <button class="filter-chip" onclick="filterBlogs('tutorials')">Tutorials</button>
                                <button class="filter-chip" onclick="filterBlogs('student')">Student
                                    Stories</button>
                            </div>
                            <div class="blog-grid">
                                <!-- Blog posts will be loaded dynamically -->
                            </div>
                        </div>

                        <!-- Notes Panel -->
                        <div id="notes-panel" class="panel-content hidden">
                            <!-- Notes Panel Header -->
                            <div class="dashboard-header">
                                <div class="dashboard-title-section">
                                    <h1 class="dashboard-title">
                                        <i class="fas fa-sticky-note"></i>
                                        My Notes
                                    </h1>
                                    <p class="dashboard-subtitle">Organize your thoughts and knowledge</p>
                                </div>
                                <div class="dashboard-actions">
                                    <button class="btn btn-primary" onclick="NotesManager.createNewNote()">
                                        <i class="fas fa-plus"></i> New Note
                                    </button>
                                </div>
                            </div>

                            <!-- Stats Bar -->
                            <div class="stats-bar">
                                <div class="stat-item">
                                    <div class="stat-icon">
                                        <i class="fas fa-file-alt"></i>
                                    </div>
                                    <div class="stat-info">
                                        <span class="stat-number" id="totalNotes">0</span>
                                        <span class="stat-label">Total Notes</span>
                                    </div>
                                </div>
                                <div class="stat-item">
                                    <div class="stat-icon words">
                                        <i class="fas fa-font"></i>
                                    </div>
                                    <div class="stat-info">
                                        <span class="stat-number" id="totalWords">0</span>
                                        <span class="stat-label">Total Words</span>
                                    </div>
                                </div>
                                <div class="stat-item">
                                    <div class="stat-icon courses">
                                        <i class="fas fa-book"></i>
                                    </div>
                                    <div class="stat-info">
                                        <span class="stat-number" id="totalCourses">0</span>
                                        <span class="stat-label">Courses</span>
                                    </div>
                                </div>
                                <div class="stat-item">
                                    <div class="stat-icon recent">
                                        <i class="fas fa-clock"></i>
                                    </div>
                                    <div class="stat-info">
                                        <span class="stat-number" id="recentNotes">0</span>
                                        <span class="stat-label">This Week</span>
                                    </div>
                                </div>
                            </div>

                            <!-- Controls Bar: Search, Filter, Sort -->
                            <div class="controls-bar">
                                <div class="search-box">
                                    <i class="fas fa-search search-icon"></i>
                                    <input type="text" class="search-input" id="searchInput" placeholder="Search notes..." oninput="NotesManager.searchNotes(this.value)">
                                </div>
                                <div class="filter-buttons">
                                    <button class="filter-btn active" data-filter="all" onclick="NotesManager.filterNotes('all', this)">
                                        <i class="fas fa-th"></i> All Notes
                                    </button>
                                    <button class="filter-btn" data-filter="recent" onclick="NotesManager.filterNotes('recent', this)">
                                        <i class="fas fa-clock"></i> Recent
                                    </button>
                                    <button class="filter-btn" data-filter="favorites" onclick="NotesManager.filterNotes('favorites', this)">
                                        <i class="fas fa-star"></i> Favorites
                                    </button>
                                    <button class="filter-btn" data-filter="media" onclick="NotesManager.filterNotes('media', this)">
                                        <i class="fas fa-microphone"></i> Media Notes
                                    </button>
                                </div>
                                <select class="sort-select" id="sortSelect" onchange="NotesManager.sortNotes()">
                                    <option value="date-desc">Newest First</option>
                                    <option value="date-asc">Oldest First</option>
                                    <option value="title">Title A-Z</option>
                                    <option value="course">By Course</option>
                                </select>
                            </div>

                            <!-- Notes Grid -->
                            <div class="notes-grid" id="notesGrid">
                                <!-- New Note Card (always shown first) -->
                                <div class="note-card new-note" onclick="NotesManager.createNewNote()">
                                    <div class="new-note-content">
                                        <div class="new-note-icon">
                                            <i class="fas fa-plus"></i>
                                        </div>
                                        <h3>Create New Note</h3>
                                        <p>Start writing your next note</p>
                                    </div>
                                </div>
                                <!-- Note cards will be rendered here by NotesManager.renderDashboard() -->
                            </div>

                        </div>

                        <!-- Earnings & Investments Panel -->
                        <div id="earnings-investments-panel" class="panel-content hidden">
                            <div class="mb-8">
                                <h1 class="text-3xl font-bold mb-2">Earnings & Investments</h1>
                                <p class="text-gray-600">Track your income streams and investment portfolio</p>
                            </div>
                            <!-- Tabs -->
                            <div class="flex gap-4 mb-6 border-b border-gray-200">
                                <button onclick="switchEarningsTab('earnings')" id="earnings-tab"
                                    class="earnings-tab-btn px-6 py-3 font-semibold text-blue-600 border-b-2 border-blue-600 transition-all">
                                    Earnings
                                </button>
                                <button onclick="switchEarningsTab('investments')" id="investments-tab"
                                    class="earnings-tab-btn px-6 py-3 font-semibold text-gray-500 hover:text-gray-700 transition-all">
                                    Investments
                                </button>
                            </div>
                            <!-- Earnings Tab Content -->
                            <div id="earnings-tab-content" class="earnings-tab-content">
                                <!-- Summary Cards (3 Cards: Total, Affiliate, Tutoring) -->
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
                                    <div onclick="toggleEarningsSection('total')"
                                        class="card p-6 bg-gradient-to-br from-green-50 to-emerald-50 border-green-200 cursor-pointer hover:shadow-lg transition-all duration-200 active-earnings-card">
                                        <div class="flex items-center justify-between mb-2">
                                            <span class="text-green-600 text-2xl"></span>
                                            <span class="text-xs text-green-600 font-semibold">ALL SOURCES</span>
                                        </div>
                                        <p class="text-sm text-gray-600 mb-1">Total Earnings</p>
                                        <h3 class="text-2xl font-bold text-gray-800" id="total-earnings">0 ETB</h3>
                                        <p class="text-xs text-green-600 mt-2 font-medium">Click to view all</p>
                                    </div>
                                    <div onclick="toggleEarningsSection('affiliate')"
                                        class="card p-6 bg-gradient-to-br from-blue-50 to-indigo-50 border-blue-200 cursor-pointer hover:shadow-lg transition-all duration-200">
                                        <div class="flex items-center justify-between mb-2">
                                            <span class="text-blue-600 text-2xl"></span>
                                            <span class="text-xs text-blue-600 font-semibold">AFFILIATE</span>
                                        </div>
                                        <p class="text-sm text-gray-600 mb-1">Affiliate Earnings</p>
                                        <h3 class="text-2xl font-bold text-gray-800" id="affiliate-earnings">0 ETB</h3>
                                        <p class="text-xs text-blue-600 mt-2 font-medium">Click to view</p>
                                    </div>
                                </div>
                                <!-- Earnings Sections -->
                                <div class="space-y-8">
                                    <!-- Total Earnings Section -->
                                    <div id="total-earnings-section" class="card p-6 earnings-section">
                                        <div class="flex items-center justify-between mb-6">
                                            <div>
                                                <h3 class="text-xl font-bold flex items-center gap-2">
                                                    <span class="text-green-600"></span>
                                                    Total Earnings - All Sources
                                                </h3>
                                                <p class="text-sm text-gray-600 mt-1">Combined view of all your earnings</p>
                                            </div>
                                            <div class="flex items-center gap-3">
                                                <select id="total-period-selector" onchange="loadTotalEarningsData()"
                                                    class="p-2 border-2 rounded-lg text-sm font-medium">
                                                    <option value="1">Last Month</option>
                                                    <option value="3">Last 3 Months</option>
                                                    <option value="6" selected>Last 6 Months</option>
                                                    <option value="12">Last Year</option>
                                                </select>
                                            </div>
                                        </div>
                                        <!-- Total Earnings Chart -->
                                        <div class="mb-6 bg-gray-50 p-4 rounded-lg" style="height: 300px;">
                                            <canvas id="total-earnings-chart"></canvas>
                                        </div>
                                        <!-- Combined List -->
                                        <div id="total-earnings-list" class="space-y-3 max-h-96 overflow-y-auto">
                                            <!-- Will be populated by JS -->
                                        </div>
                                    </div>
                                    <!-- Affiliate Earnings Section (with 3 tabs: Advertisement, Subscription, Commission) -->
                                    <div id="affiliate-earnings-section" class="card p-6 earnings-section hidden">
                                        <div class="flex items-center justify-between mb-6">
                                            <div>
                                                <h3 class="text-xl font-bold flex items-center gap-2">
                                                    <span class="text-blue-600">??</span>
                                                    Affiliate Earnings
                                                </h3>
                                                <p class="text-sm text-gray-600 mt-1">Earnings from ads, referrals, and connections</p>
                                            </div>
                                            <div class="flex items-center gap-3">
                                                <select id="affiliate-period-selector" onchange="loadAffiliateData()"
                                                    class="p-2 border-2 rounded-lg text-sm font-medium">
                                                    <option value="1">Last Month</option>
                                                    <option value="3">Last 3 Months</option>
                                                    <option value="6" selected>Last 6 Months</option>
                                                    <option value="12">Last Year</option>
                                                </select>
                                            </div>
                                        </div>

                                        <!-- Affiliate Sub-Tabs -->
                                        <div class="flex gap-2 mb-6 border-b border-gray-200">
                                            <button onclick="switchAffiliateTab('advertisement')" id="advertisement-tab"
                                                class="affiliate-tab-btn px-4 py-2 font-medium text-blue-600 border-b-2 border-blue-600 transition-all flex items-center gap-2">
                                                <span></span> Advertisement
                                            </button>
                                            <button onclick="switchAffiliateTab('subscription')" id="subscription-tab"
                                                class="affiliate-tab-btn px-4 py-2 font-medium text-gray-500 hover:text-gray-700 transition-all flex items-center gap-2">
                                                <span>?</span> Subscription
                                            </button>
                                            <button onclick="switchAffiliateTab('commission')" id="commission-tab"
                                                class="affiliate-tab-btn px-4 py-2 font-medium text-gray-500 hover:text-gray-700 transition-all flex items-center gap-2">
                                                <span></span> Commission
                                            </button>
                                        </div>

                                        <!-- Advertisement Tab Content -->
                                        <div id="advertisement-tab-content" class="affiliate-tab-content">
                                            <div class="bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4">
                                                <p class="text-sm text-blue-800">
                                                    <strong>Advertisement Earnings:</strong> Revenue from ads displayed to users who signed up through your referral link.
                                                </p>
                                            </div>
                                            <!-- Affiliate Levels Info (Single Row, Clickable) -->
                                            <div id="advertisement-affiliate-levels" class="flex flex-wrap gap-3 mb-6">
                                                <!-- Will be populated by JS with clickable affiliate tier level cards -->
                                            </div>
                                            <div class="mb-6 bg-gray-50 p-4 rounded-lg" style="height: 250px;">
                                                <canvas id="advertisement-earnings-chart"></canvas>
                                            </div>
                                            <div id="advertisement-earnings-list" class="space-y-3 max-h-96 overflow-y-auto min-h-[200px]">
                                                <!-- Will be populated by JS -->
                                            </div>
                                        </div>

                                        <!-- Subscription Tab Content -->
                                        <div id="subscription-tab-content" class="affiliate-tab-content hidden">
                                            <div class="bg-purple-50 border border-purple-200 rounded-lg p-4 mb-4">
                                                <p class="text-sm text-purple-800">
                                                    <strong>Subscription Earnings:</strong> Commission from users you referred who subscribed to premium plans.
                                                </p>
                                            </div>
                                            <!-- Affiliate Levels Info (Single Row, Clickable) -->
                                            <div id="subscription-affiliate-levels" class="flex flex-wrap gap-3 mb-6">
                                                <!-- Will be populated by JS with clickable affiliate tier level cards -->
                                            </div>
                                            <div class="mb-6 bg-gray-50 p-4 rounded-lg" style="height: 250px;">
                                                <canvas id="subscription-earnings-chart"></canvas>
                                            </div>
                                            <div id="subscription-earnings-list" class="space-y-3 max-h-96 overflow-y-auto min-h-[200px]">
                                                <!-- Will be populated by JS -->
                                            </div>
                                        </div>

                                        <!-- Commission Tab Content -->
                                        <div id="commission-tab-content" class="affiliate-tab-content hidden">
                                            <div class="bg-green-50 border border-green-200 rounded-lg p-4 mb-4">
                                                <p class="text-sm text-green-800">
                                                    <strong>Commission Earnings:</strong> Your share from tutor-student connections you facilitated.
                                                </p>
                                            </div>
                                            <!-- Affiliate Levels Info (Single Row, Clickable) -->
                                            <div id="commission-affiliate-levels" class="flex flex-wrap gap-3 mb-6">
                                                <!-- Will be populated by JS with clickable affiliate tier level cards -->
                                            </div>
                                            <div class="mb-6 bg-gray-50 p-4 rounded-lg" style="height: 250px;">
                                                <canvas id="commission-earnings-chart"></canvas>
                                            </div>
                                            <div id="commission-earnings-list" class="space-y-3 max-h-96 overflow-y-auto min-h-[200px]">
                                                <!-- Will be populated by JS -->
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <!-- Investments Tab Content -->
                            <div id="investments-tab-content" class="earnings-tab-content hidden">
                                <!-- Investment Summary Cards -->
                                <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                                    <!-- Subscription History Card -->
                                    <div class="card p-6 bg-gradient-to-br from-blue-50 to-indigo-50 border-blue-200 cursor-pointer hover:shadow-lg transition-all" onclick="showSubscriptionHistory()">
                                        <div class="flex items-center justify-between mb-2">
                                            <span class="text-blue-600 text-2xl"></span>
                                            <span class="text-xs text-blue-600 font-semibold">SUBSCRIPTIONS</span>
                                        </div>
                                        <p class="text-sm text-gray-600 mb-1">Subscription History</p>
                                        <h3 class="text-2xl font-bold text-gray-800" id="total-subscriptions">0</h3>
                                        <p class="text-xs text-gray-500 mt-2">View all subscriptions</p>
                                    </div>

                                    <!-- Tutoring Session Packages Card -->
                                    <div class="card p-6 bg-gradient-to-br from-purple-50 to-pink-50 border-purple-200 cursor-pointer hover:shadow-lg transition-all" onclick="showTutoringPackages()">
                                        <div class="flex items-center justify-between mb-2">
                                            <span class="text-purple-600 text-2xl"></span>
                                            <span class="text-xs text-purple-600 font-semibold">TUTORING</span>
                                        </div>
                                        <p class="text-sm text-gray-600 mb-1">Tutoring Packages</p>
                                        <h3 class="text-2xl font-bold text-gray-800" id="total-tutoring-packages">0</h3>
                                        <p class="text-xs text-gray-500 mt-2">View packages & sessions</p>
                                    </div>

                                    <!-- Purchase History Card -->
                                    <div class="card p-6 bg-gradient-to-br from-green-50 to-emerald-50 border-green-200 cursor-pointer hover:shadow-lg transition-all" onclick="showPurchaseHistory()">
                                        <div class="flex items-center justify-between mb-2">
                                            <span class="text-green-600 text-2xl"></span>
                                            <span class="text-xs text-green-600 font-semibold">PURCHASES</span>
                                        </div>
                                        <p class="text-sm text-gray-600 mb-1">Purchase History</p>
                                        <h3 class="text-2xl font-bold text-gray-800">
                                            <span class="text-base text-gray-500">Coming Soon</span>
                                        </h3>
                                        <p class="text-xs text-gray-500 mt-2">Materials & resources</p>
                                    </div>
                                </div>
                                <!-- Investments List -->
                                <div class="card p-6">
                                    <div class="flex items-center justify-between mb-6">
                                        <h3 class="text-xl font-bold flex items-center gap-2">
                                            <span class="text-blue-600" id="investments-list-icon"></span>
                                            <span id="investments-list-title">All Investments</span>
                                        </h3>
                                        <button
                                            class="px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors text-sm"
                                            onclick="resetInvestmentFilter()">
                                            Show All
                                        </button>
                                    </div>

                                    <!-- Loading State -->
                                    <div id="investments-loading" class="text-center py-12 hidden">
                                        <div class="inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"></div>
                                        <p class="text-gray-600 mt-4">Loading investments...</p>
                                    </div>

                                    <!-- Empty State -->
                                    <div id="investments-empty" class="text-center py-12 hidden">
                                        <div class="text-6xl mb-4"></div>
                                        <h3 class="text-xl font-semibold text-gray-800 mb-2">No investments found</h3>
                                        <p class="text-gray-600">You haven't made any investments yet.</p>
                                    </div>

                                    <!-- Investments List Container -->
                                    <div id="investments-list" class="space-y-4">
                                        <!-- Dynamically populated by JavaScript -->
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!-- Settings Panel -->
                        <div id="settings-panel" class="panel-content hidden">
                            <div class="mb-8">
                                <h1 class="text-3xl font-bold mb-2">Settings</h1>
                                <p class="text-gray-600">Manage your account settings and preferences</p>
                            </div>

                            <!-- Account & Security Section -->
                            <div class="settings-section mb-8">
                                <h2 class="text-xl font-semibold mb-4 text-gray-700 flex items-center gap-2">
                                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"></path>
                                    </svg>
                                    Account & Security
                                </h2>

                                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                                    <!-- Verify Personal Info Card -->
                                    <div class="card p-6 cursor-pointer hover:shadow-lg transition-all duration-300 border-2 border-transparent hover:border-blue-500"
                                        onclick="openVerifyPersonalInfoModal()">
                                        <div class="flex flex-col items-center text-center">
                                            <div class="w-16 h-16 bg-gradient-to-br from-blue-500 to-purple-600 rounded-full flex items-center justify-center shadow-lg mb-4">
                                                <span class="text-3xl">??</span>
                                            </div>
                                            <h3 class="text-lg font-bold mb-2 text-gray-800">Verify Personal Info</h3>
                                            <p class="text-sm text-gray-600">Personal details and contact verification</p>
                                        </div>
                                    </div>

                                    <!-- Two-Factor Authentication Card -->
                                    <div class="card p-6 cursor-pointer hover:shadow-lg transition-all duration-300 border-2 border-transparent hover:border-indigo-500"
                                        onclick="openTwoFactorAuthModal()">
                                        <div class="flex flex-col items-center text-center">
                                            <div class="w-16 h-16 bg-gradient-to-br from-indigo-500 to-blue-600 rounded-full flex items-center justify-center shadow-lg mb-4">
                                                <span class="text-3xl">???</span>
                                            </div>
                                            <h3 class="text-lg font-bold mb-2 text-gray-800">Two-Factor Auth</h3>
                                            <p class="text-sm text-gray-600">Extra security with 2FA</p>
                                            <span id="2fa-status-badge" class="mt-2 inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800">
                                                Not Enabled
                                            </span>
                                        </div>
                                    </div>

                                    <!-- Login Activity Card -->
                                    <div class="card p-6 cursor-pointer hover:shadow-lg transition-all duration-300 border-2 border-transparent hover:border-cyan-500"
                                        onclick="openLoginActivityModal()">
                                        <div class="flex flex-col items-center text-center">
                                            <div class="w-16 h-16 bg-gradient-to-br from-cyan-500 to-teal-600 rounded-full flex items-center justify-center shadow-lg mb-4">
                                                <span class="text-3xl">??</span>
                                            </div>
                                            <h3 class="text-lg font-bold mb-2 text-gray-800">Login Activity</h3>
                                            <p class="text-sm text-gray-600">Active sessions and history</p>
                                        </div>
                                    </div>

                                    <!-- Connected Accounts Card -->
                                    <div class="card p-6 cursor-pointer hover:shadow-lg transition-all duration-300 border-2 border-transparent hover:border-orange-500"
                                        onclick="openConnectedAccountsModal()">
                                        <div class="flex flex-col items-center text-center">
                                            <div class="w-16 h-16 bg-gradient-to-br from-orange-500 to-amber-600 rounded-full flex items-center justify-center shadow-lg mb-4">
                                                <span class="text-3xl">??</span>
                                            </div>
                                            <h3 class="text-lg font-bold mb-2 text-gray-800">Connected Accounts</h3>
                                            <p class="text-sm text-gray-600">Manage Google and other links</p>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Payments & Subscription Section -->
                            <div class="settings-section mb-8">
                                <h2 class="text-xl font-semibold mb-4 text-gray-700 flex items-center gap-2">
                                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"></path>
                                    </svg>
                                    Payments & Subscription
                                </h2>

                                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                                    <!-- Payment Method Card -->
                                    <div class="card p-6 cursor-pointer hover:shadow-lg transition-all duration-300 border-2 border-transparent hover:border-green-500"
                                        onclick="openPaymentMethodModal()">
                                        <div class="flex flex-col items-center text-center">
                                            <div class="w-16 h-16 bg-gradient-to-br from-green-500 to-emerald-600 rounded-full flex items-center justify-center shadow-lg mb-4">
                                                <span class="text-3xl">??</span>
                                            </div>
                                            <h3 class="text-lg font-bold mb-2 text-gray-800">Payment Method</h3>
                                            <p class="text-sm text-gray-600">Manage your payment options</p>
                                        </div>
                                    </div>

                                    <!-- Subscription Card -->
                                    <div class="card p-6 cursor-pointer hover:shadow-lg transition-all duration-300 border-2 border-transparent hover:border-purple-500"
                                        onclick="openComingSoonModal('Subscription & Storage')">
                                        <div class="flex flex-col items-center text-center">
                                            <div class="w-16 h-16 bg-gradient-to-br from-purple-500 to-pink-600 rounded-full flex items-center justify-center shadow-lg mb-4">
                                                <span class="text-3xl">?</span>
                                            </div>
                                            <h3 class="text-lg font-bold mb-2 text-gray-800">Subscription & Storage</h3>
                                            <p class="text-sm text-gray-600">Upgrade plan and unlock features</p>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Personalization Section -->
                            <div class="settings-section mb-8">
                                <h2 class="text-xl font-semibold mb-4 text-gray-700 flex items-center gap-2">
                                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 21a4 4 0 01-4-4V5a2 2 0 012-2h4a2 2 0 012 2v12a4 4 0 01-4 4zm0 0h12a2 2 0 002-2v-4a2 2 0 00-2-2h-2.343M11 7.343l1.657-1.657a2 2 0 012.828 0l2.829 2.829a2 2 0 010 2.828l-8.486 8.485M7 17h.01"></path>
                                    </svg>
                                    Personalization
                                </h2>

                                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                                    <!-- Appearance Card -->
                                    <div class="card p-6 cursor-pointer hover:shadow-lg transition-all duration-300 border-2 border-transparent hover:border-violet-500"
                                        onclick="openAppearanceModal()">
                                        <div class="flex flex-col items-center text-center">
                                            <div class="w-16 h-16 bg-gradient-to-br from-violet-500 to-purple-600 rounded-full flex items-center justify-center shadow-lg mb-4">
                                                <span class="text-3xl">??</span>
                                            </div>
                                            <h3 class="text-lg font-bold mb-2 text-gray-800">Appearance</h3>
                                            <p class="text-sm text-gray-600">Theme, font size, and display</p>
                                        </div>
                                    </div>

                                    <!-- Language Preferences Card -->
                                    <div class="card p-6 cursor-pointer hover:shadow-lg transition-all duration-300 border-2 border-transparent hover:border-sky-500"
                                        onclick="openComingSoonModal('Language Preferences')">
                                        <div class="flex flex-col items-center text-center">
                                            <div class="w-16 h-16 bg-gradient-to-br from-sky-500 to-blue-600 rounded-full flex items-center justify-center shadow-lg mb-4">
                                                <span class="text-3xl">??</span>
                                            </div>
                                            <h3 class="text-lg font-bold mb-2 text-gray-800">Language</h3>
                                            <p class="text-sm text-gray-600">UI language and translation</p>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Data & Privacy Section -->
                            <div class="settings-section mb-8">
                                <h2 class="text-xl font-semibold mb-4 text-gray-700 flex items-center gap-2">
                                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                                    </svg>
                                    Data & Privacy
                                </h2>

                                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                                    <!-- Export Data Card -->
                                    <div class="card p-6 cursor-pointer hover:shadow-lg transition-all duration-300 border-2 border-transparent hover:border-teal-500"
                                        onclick="openComingSoonModal('Export Data')">
                                        <div class="flex flex-col items-center text-center">
                                            <div class="w-16 h-16 bg-gradient-to-br from-teal-500 to-cyan-600 rounded-full flex items-center justify-center shadow-lg mb-4">
                                                <span class="text-3xl">??</span>
                                            </div>
                                            <h3 class="text-lg font-bold mb-2 text-gray-800">Export Data</h3>
                                            <p class="text-sm text-gray-600">Download your personal data</p>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Feedback & Support Section -->
                            <div class="settings-section mb-8">
                                <h2 class="text-xl font-semibold mb-4 text-gray-700 flex items-center gap-2">
                                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"></path>
                                    </svg>
                                    Feedback & Support
                                </h2>

                                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                                    <!-- Review & Rate Astegni Card -->
                                    <div class="card p-6 cursor-pointer hover:shadow-lg transition-all duration-300 border-2 border-transparent hover:border-yellow-500"
                                        onclick="openReviewAstegniModal()">
                                        <div class="flex flex-col items-center text-center">
                                            <div class="w-16 h-16 bg-gradient-to-br from-yellow-500 to-orange-500 rounded-full flex items-center justify-center shadow-lg mb-4">
                                                <span class="text-3xl">?</span>
                                            </div>
                                            <h3 class="text-lg font-bold mb-2 text-gray-800">Review Astegni</h3>
                                            <p class="text-sm text-gray-600">Share your feedback with us</p>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Danger Zone Section -->
                            <div class="settings-section">
                                <h2 class="text-xl font-semibold mb-4 text-red-600 flex items-center gap-2">
                                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path>
                                    </svg>
                                    Danger Zone
                                </h2>

                                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                                    <!-- Manage Roles Card -->
                                    <div class="card p-6 cursor-pointer hover:shadow-lg transition-all duration-300 border-2 border-transparent hover:border-rose-500"
                                        onclick="openManageRoleModal()">
                                        <div class="flex flex-col items-center text-center">
                                            <div class="w-16 h-16 bg-gradient-to-br from-rose-500 to-pink-600 rounded-full flex items-center justify-center shadow-lg mb-4">
                                                <span class="text-3xl">???</span>
                                            </div>
                                            <h3 class="text-lg font-bold mb-2 text-gray-800">Manage Roles</h3>
                                            <p class="text-sm text-gray-600">Deactivate or remove your role</p>
                                        </div>
                                    </div>

                                    <!-- Leave Astegni Card -->
                                    <div class="card p-6 cursor-pointer hover:shadow-lg transition-all duration-300 border-2 border-transparent hover:border-red-500"
                                        onclick="openLeaveAstegniModal()">
                                        <div class="flex flex-col items-center text-center">
                                            <div class="w-16 h-16 bg-gradient-to-br from-red-500 to-red-700 rounded-full flex items-center justify-center shadow-lg mb-4">
                                                <span class="text-3xl">??</span>
                                            </div>
                                            <h3 class="text-lg font-bold mb-2 text-gray-800">Leave Astegni</h3>
                                            <p class="text-sm text-gray-600">Delete account permanently</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!-- My Requests Panel -->
                        <div class="panel-content hidden" id="my-requests-panel">
                            <div class="mb-8">
                                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                                    <div>
                                        <h1 class="text-3xl font-bold mb-2">My Requests</h1>
                                        <p class="text-gray-600">Manage your course, school, session requests, and parenting invitations</p>
                                    </div>
                                    <div style="display: flex; gap: 0.75rem;">
                                        <button id="request-course-btn" onclick="openCourseRequestModal()" class="px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition flex items-center gap-2" style="display: none;">
                                            <i class="fas fa-plus"></i> Request Course
                                        </button>
                                        <button id="request-school-btn" onclick="openSchoolRequestModal()" class="px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition flex items-center gap-2" style="display: none;">
                                            <i class="fas fa-plus"></i> Request School
                                        </button>
                                    </div>
                                </div>
                            </div>
                            <!-- Request Type Filter Cards -->
                            <div class="request-type-cards grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6">
                                <div class="request-type-card card p-4 cursor-pointer border-2 transition active"
                                    onclick="filterParentRequestType('courses')" data-type="courses">
                                    <div class="flex items-center gap-3">
                                        <div class="text-3xl">??</div>
                                        <div>
                                            <h3 class="font-bold text-lg">Requested Courses</h3>
                                            <p class="text-sm text-gray-600">View course requests</p>
                                            <span id="parent-courses-count" class="text-xs bg-blue-500 text-white px-2 py-0.5 rounded-full hidden">0</span>
                                        </div>
                                    </div>
                                </div>
                                <div class="request-type-card card p-4 cursor-pointer border-2 transition"
                                    onclick="filterParentRequestType('schools')" data-type="schools">
                                    <div class="flex items-center gap-3">
                                        <div class="text-3xl">??</div>
                                        <div>
                                            <h3 class="font-bold text-lg">Requested Schools</h3>
                                            <p class="text-sm text-gray-600">View school requests</p>
                                            <span id="parent-schools-count" class="text-xs bg-green-500 text-white px-2 py-0.5 rounded-full hidden">0</span>
                                        </div>
                                    </div>
                                </div>
                                <div class="request-type-card card p-4 cursor-pointer border-2 transition"
                                    onclick="filterParentRequestType('sessions')" data-type="sessions">
                                    <div class="flex items-center gap-3">
                                        <div class="text-3xl">?????</div>
                                        <div>
                                            <h3 class="font-bold text-lg">Requested Sessions</h3>
                                            <p class="text-sm text-gray-600">View tutor session requests</p>
                                            <span id="parent-sessions-count" class="text-xs bg-orange-500 text-white px-2 py-0.5 rounded-full hidden">0</span>
                                        </div>
                                    </div>
                                </div>
                                <div class="request-type-card card p-4 cursor-pointer border-2 transition"
                                    onclick="filterParentRequestType('parenting')" data-type="parenting">
                                    <div class="flex items-center gap-3">
                                        <div class="text-3xl">??</div>
                                        <div>
                                            <h3 class="font-bold text-lg">Parenting Invitations</h3>
                                            <p class="text-sm text-gray-600">Students inviting you as parent</p>
                                            <span id="parent-parenting-invitation-count" class="text-xs bg-purple-500 text-white px-2 py-0.5 rounded-full hidden">0</span>
                                        </div>
                                    </div>
                                </div>
                                <div class="request-type-card card p-4 cursor-pointer border-2 transition"
                                    onclick="filterParentRequestType('child-invitations')" data-type="child-invitations">
                                    <div class="flex items-center gap-3">
                                        <div class="text-3xl">??</div>
                                        <div>
                                            <h3 class="font-bold text-lg">Child Invitations</h3>
                                            <p class="text-sm text-gray-600">Parents inviting you as child</p>
                                            <span id="parent-child-invitation-count" class="text-xs bg-green-500 text-white px-2 py-0.5 rounded-full hidden">0</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <!-- Request Direction Tabs (Received vs Sent) - Only shown for Session Requests -->
                            <div id="parent-session-direction-tabs" class="request-direction-tabs mb-4 hidden"
                                style="display: none; gap: 1rem; border-bottom: 2px solid var(--border-color); padding-bottom: 0.5rem;">
                                <button class="direction-tab active"
                                    onclick="filterParentRequestDirection('sent')" data-direction="sent">
                                    <i class="fas fa-paper-plane"></i> Sent
                                </button>
                                <button class="direction-tab"
                                    onclick="filterParentRequestDirection('received')" data-direction="received">
                                    <i class="fas fa-inbox"></i> Received
                                </button>
                            </div>

                            <!-- Request Status Sub-Tabs -->
                            <div class="status-tabs mb-6"
                                style="display: flex; gap: 1rem; border-bottom: 2px solid var(--border-color); padding-bottom: 0.5rem;">
                                <button class="status-tab active"
                                    onclick="filterParentRequestStatus('all')" data-status="all">
                                    All
                                </button>
                                <button class="status-tab"
                                    onclick="filterParentRequestStatus('pending')"
                                    data-status="pending">
                                    Pending
                                </button>
                                <button class="status-tab"
                                    onclick="filterParentRequestStatus('accepted')"
                                    data-status="accepted">
                                    Accepted
                                </button>
                                <button class="status-tab"
                                    onclick="filterParentRequestStatus('rejected')"
                                    data-status="rejected">
                                    Rejected
                                </button>
                            </div>

                            <!-- Parenting Direction Tabs (Received/Sent) - Only shown for parenting type -->
                            <div id="parent-parenting-direction-tabs" class="mb-6 hidden" style="display: none;">
                                <div style="display: flex; gap: 0; border-bottom: 2px solid var(--border-color);">
                                    <button id="parent-parenting-received-tab" class="parenting-direction-tab active"
                                        onclick="switchParentParentingDirection('received')"
                                        style="padding: 0.75rem 1.5rem; font-weight: 600; color: var(--button-bg); border-bottom: 2px solid var(--button-bg); margin-bottom: -2px; background: transparent; cursor: pointer; transition: all 0.3s ease; display: flex; align-items: center; gap: 0.5rem;">
                                        <i class="fas fa-inbox"></i> Invitations Received
                                        <span id="parent-parenting-received-count" class="text-xs font-medium px-2 py-0.5 rounded-full hidden" style="background: rgba(139, 92, 246, 0.1); color: #8b5cf6;">0</span>
                                    </button>
                                    <button id="parent-parenting-sent-tab" class="parenting-direction-tab"
                                        onclick="switchParentParentingDirection('sent')"
                                        style="padding: 0.75rem 1.5rem; font-weight: 600; color: var(--text-muted); border-bottom: 2px solid transparent; margin-bottom: -2px; background: transparent; cursor: pointer; transition: all 0.3s ease; display: flex; align-items: center; gap: 0.5rem;">
                                        <i class="fas fa-paper-plane"></i> Invitations Sent
                                        <span id="parent-parenting-sent-count" class="text-xs font-medium px-2 py-0.5 rounded-full hidden" style="background: rgba(245, 158, 11, 0.1); color: #f59e0b;">0</span>
                                    </button>
                                </div>
                            </div>

                            <!-- Requests List Container -->
                            <div id="parent-requests-list">
                                <!-- Requests will be loaded dynamically -->
                                <div class="text-center py-8 text-gray-500">
                                    <i class="fas fa-spinner fa-spin text-3xl mb-3"></i>
                                    <p>Loading your requests...</p>
                                </div>
                            </div>
                        </div>
                        <!-- Ratings & Reviews Panel -->
                        <div id="ratings-and-reviews-panel" class="panel-content hidden">
                            <!-- Section Header -->
                            <div class="section-header mb-6">
                                <h2 class="text-2xl font-bold">? Ratings & Reviews</h2>
                                <p class="text-gray-600 mt-2">Track your engagement and see what tutors and students are saying</p>
                            </div>
                            <!-- Rating Metrics Cards Grid -->
                            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                                <!-- Tutor Engagement Metric Card -->
                                <div class="metric-card">
                                    <div class="metric-card-header">
                                        <div class="metric-icon tutor-icon"></div>
                                        <h3 class="metric-card-title">Tutor Engagement</h3>
                                    </div>
                                    <div class="metric-card-body">
                                        <div class="metric-rating-display">
                                            <span class="metric-rating-number">4.9</span>
                                            <div class="metric-stars"></div>
                                        </div>
                                    </div>
                                </div>
                                <!-- Student Engagement Metric Card -->
                                <div class="metric-card">
                                    <div class="metric-card-header">
                                        <div class="metric-icon student-icon"></div>
                                        <h3 class="metric-card-title">Student Engagement</h3>
                                    </div>
                                    <div class="metric-card-body">
                                        <div class="metric-rating-display">
                                            <span class="metric-rating-number">4.8</span>
                                            <div class="metric-stars"></div>
                                        </div>
                                    </div>
                                </div>
                                <!-- Responsiveness Metric Card -->
                                <div class="metric-card">
                                    <div class="metric-card-header">
                                        <div class="metric-icon response-icon"></div>
                                        <h3 class="metric-card-title">Responsiveness</h3>
                                    </div>
                                    <div class="metric-card-body">
                                        <div class="metric-rating-display">
                                            <span class="metric-rating-number">4.9</span>
                                            <div class="metric-stars"></div>
                                        </div>
                                    </div>
                                </div>
                                <!-- Payment History Metric Card -->
                                <div class="metric-card">
                                    <div class="metric-card-header">
                                        <div class="metric-icon payment-icon"></div>
                                        <h3 class="metric-card-title">Payment History</h3>
                                    </div>
                                    <div class="metric-card-body">
                                        <div class="metric-rating-display">
                                            <span class="metric-rating-number">4.7</span>
                                            <div class="metric-stars"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <!-- Star Filter Tabs - Counts are updated dynamically by ParentReviewsManager -->
                            <div class="star-filter-tabs mb-6">
                                <button class="star-filter-tab active" data-filter="all">
                                    <span class="tab-icon"></span>
                                    All Reviews
                                    <span class="tab-count">(0)</span>
                                </button>
                                <button class="star-filter-tab" data-filter="5">
                                    <span class="tab-stars"></span>
                                    5 Stars
                                    <span class="tab-count">(0)</span>
                                </button>
                                <button class="star-filter-tab" data-filter="4">
                                    <span class="tab-stars"></span>
                                    4 Stars
                                    <span class="tab-count">(0)</span>
                                </button>
                                <button class="star-filter-tab" data-filter="3">
                                    <span class="tab-stars"></span>
                                    3 Stars
                                    <span class="tab-count">(0)</span>
                                </button>
                                <button class="star-filter-tab" data-filter="2">
                                    <span class="tab-stars"></span>
                                    2 Stars
                                    <span class="tab-count">(0)</span>
                                </button>
                                <button class="star-filter-tab" data-filter="1">
                                    <span class="tab-stars"></span>
                                    1 Star
                                    <span class="tab-count">(0)</span>
                                </button>
                            </div>
                            <!-- Reviews Container - Dynamically loaded from parent_reviews table -->
                            <div class="reviews-container" id="ratings-reviews-container">
                                <!-- Reviews will be loaded dynamically -->
                                <div class="loading-placeholder text-center py-12">
                                    <div class="animate-pulse space-y-4">
                                        <div class="h-24 bg-gray-200 rounded-lg"></div>
                                        <div class="h-24 bg-gray-200 rounded-lg"></div>
                                        <div class="h-24 bg-gray-200 rounded-lg"></div>
                                    </div>
                                    <p class="text-gray-500 mt-4">Loading reviews...</p>
                                </div>
                            </div>
                            <!-- Empty State (shown when no reviews) -->
                            <div class="empty-state hidden" id="ratings-reviews-empty">
                                <div class="text-center py-12">
                                    <i class="fas fa-star text-6xl text-gray-300 mb-4"></i>
                                    <h3 class="text-xl font-semibold text-gray-700 mb-2">No reviews yet</h3>
                                    <p class="text-gray-500">Reviews from tutors will appear here</p>
                                </div>
                            </div>
                        </div>
                        <!-- Other panels will be dynamically populated -->
                    </div>
                </div>

                <!-- Right Sidebar Widgets (Persistent across all panels) -->
                <div class="right-widgets">
                    
                    <!-- Ad Widget -->
                    <div class="sidebar-widget ad-widget card" style="padding: 1.5rem;">
                        <div class="widget-header" style="margin-bottom: 0.75rem; display: flex; justify-content: flex-end;">
                            <span style="font-size: 0.65rem; color: var(--text-secondary); background: var(--bg-secondary); padding: 0.2rem 0.5rem; border-radius: 4px;">Ad</span>
                        </div>
                        <div class="promo-content" id="promo-container" style="min-height: 170px; display: flex; flex-direction: column; align-items: center; justify-content: center; background: linear-gradient(135deg, var(--bg-secondary) 0%, var(--card-bg) 100%); border-radius: 12px; padding: 1.5rem 1rem 2rem; cursor: pointer; overflow: hidden; position: relative;">
                            <!-- Rotating Ad Messages -->
                            <div id="ad-message-container" style="text-align: center; position: relative; width: 100%; height: 90px; overflow: hidden;">
                                <div class="ad-message active" style="position: absolute; width: 100%; transition: all 0.6s ease; opacity: 1; transform: scale(1);">
                                    <div style="font-size: 1.8rem; margin-bottom: 0.5rem;">??</div>
                                    <p style="font-size: 1rem; font-weight: 600; color: var(--heading);">Your Ad Goes Here</p>
                                </div>
                                <div class="ad-message" style="position: absolute; width: 100%; transition: all 0.6s ease; opacity: 0; transform: scale(0.8);">
                                    <div style="font-size: 1.8rem; margin-bottom: 0.5rem;">??</div>
                                    <p style="font-size: 1rem; font-weight: 600; color: var(--heading);">Target Millions of Audience</p>
                                </div>
                                <div class="ad-message" style="position: absolute; width: 100%; transition: all 0.6s ease; opacity: 0; transform: scale(0.8);">
                                    <div style="font-size: 1.8rem; margin-bottom: 0.5rem;">??</div>
                                    <p style="font-size: 1rem; font-weight: 600; color: var(--heading);">Grow Your Business</p>
                                </div>
                                <div class="ad-message" style="position: absolute; width: 100%; transition: all 0.6s ease; opacity: 0; transform: scale(0.8);">
                                    <div style="font-size: 1.8rem; margin-bottom: 0.5rem;">??</div>
                                    <p style="font-size: 1rem; font-weight: 600; color: var(--heading);">Reach Your Audience</p>
                                </div>
                                <div class="ad-message" style="position: absolute; width: 100%; transition: all 0.6s ease; opacity: 0; transform: scale(0.8);">
                                    <div style="font-size: 1.8rem; margin-bottom: 0.5rem;">??</div>
                                    <p style="font-size: 1rem; font-weight: 600; color: var(--heading);">Advertise With Us</p>
                                </div>
                            </div>
                            <!-- Ticker at bottom -->
                            <div id="ad-ticker" style="position: absolute; bottom: 0; left: 0; right: 0; height: 22px; background: rgba(0,0,0,0.05); overflow: hidden;">
                                <div id="ad-ticker-content" style="position: absolute; white-space: nowrap; font-size: 0.7rem; color: var(--text-secondary); line-height: 22px;">
                                    <span style="padding: 0 2rem;">Reach millions of engaged learners</span>
                                    <span style="padding: 0 2rem;">Premium ad placements available</span>
                                    <span style="padding: 0 2rem;">Contact us to advertise</span>
                                    <span style="padding: 0 2rem;">Boost your brand visibility</span>
                                    <span style="padding: 0 2rem;">Reach millions of engaged learners</span>
                                    <span style="padding: 0 2rem;">Premium ad placements available</span>
                                </div>
                            </div>
                        </div>
                        <style>
                            @keyframes tickerScroll {
                                0% { transform: translateX(0); }
                                100% { transform: translateX(-50%); }
                            }
                            #ad-ticker-content {
                                animation: tickerScroll 20s linear infinite;
                            }
                            .ad-message {
                                visibility: hidden;
                            }
                            .ad-message.active {
                                opacity: 1 !important;
                                transform: scale(1) !important;
                                visibility: visible !important;
                            }
                            .ad-message.fade-out {
                                opacity: 0 !important;
                                transform: scale(0.8) !important;
                                visibility: visible !important;
                            }
                        </style>
                        <script>
                            (function() {
                                const messages = document.querySelectorAll('#ad-message-container .ad-message');
                                let currentIndex = 0;

                                function rotateMessages() {
                                    const prevIndex = currentIndex;
                                    currentIndex = (currentIndex + 1) % messages.length;

                                    // Fade out current
                                    messages[prevIndex].classList.remove('active');
                                    messages[prevIndex].classList.add('fade-out');

                                    // Fade in next
                                    messages[currentIndex].classList.add('active');

                                    // Hide previous after animation
                                    setTimeout(() => {
                                        messages[prevIndex].classList.remove('fade-out');
                                    }, 600);
                                }

                                setInterval(rotateMessages, 10000);
                            })();
                        </script>
                    </div>
                    
                    <!-- Monthly Earnings Widget with Line Graph -->
                    <div class="widget-card"
                        style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border: none; box-shadow: 0 10px 30px rgba(102, 126, 234, 0.3);">
                        <div class="flex items-center justify-between mb-3">
                            <h3 id="widget-title" class="text-lg font-semibold"> Monthly Earnings</h3>
                            <select id="earnings-period-select"
                                style="background: rgba(255,255,255,0.2); color: white; border: 1px solid rgba(255,255,255,0.3); border-radius: 6px; padding: 4px 8px; font-size: 12px; cursor: pointer;">
                                <option value="earnings" style="color: #333;">Earnings</option>
                                <option value="investments" style="color: #333;">Investments</option>
                            </select>
                        </div>

                        <div class="mb-4">
                            <div class="text-3xl font-bold mb-1"><span id="earnings-currency-symbol"></span> <span id="current-month-earnings">0</span></div>
                            <div class="flex items-center gap-2 text-sm">
                                <span id="earnings-change" class="text-green-300">+0%</span>
                                <span id="change-label" style="opacity: 0.8;">vs last month</span>
                            </div>
                        </div>

                        <!-- Line Graph Canvas -->
                        <div style="position: relative; height: 120px; margin: 0 -1rem;">
                            <canvas id="earnings-line-chart"></canvas>
                        </div>

                        <!-- Month Labels -->
                        <div id="earnings-months-labels" class="flex justify-between text-xs mt-2"
                            style="opacity: 0.8;">
                            <!-- Will be populated by JavaScript -->
                        </div>

                        <!-- View Details Button -->
                        <button onclick="switchPanel('earnings-investments'); return false;"
                            class="mt-4 w-full py-2 px-4 bg-white text-purple-600 rounded-lg font-semibold hover:bg-purple-50 transition-colors shadow-md">
                            View Details 
                        </button>
                    </div>
                    
                    <!-- Children's Progress Widget -->
                    <div id="children-progress-widget" class="sidebar-widget card" style="padding: 1.5rem;">
                        <div class="flex items-center justify-between mb-4">
                            <h3 class="text-lg font-semibold" style="color: var(--heading); display: flex; align-items: center; gap: 0.5rem;">
                                <i class="fas fa-chart-line" style="color: var(--primary-color);"></i>
                                Children's Progress
                            </h3>
                            <span class="text-xs px-2 py-1 rounded-full" style="background: var(--primary-color); color: white; font-weight: 600;">
                                Beta
                            </span>
                        </div>

                        <!-- Widget Content Container -->
                        <div id="progress-widget-content">
                            <!-- Loading State -->
                            <div id="progress-loading-state" class="hidden" style="text-align: center; padding: 2rem 1rem;">
                                <i class="fas fa-spinner fa-spin" style="font-size: 2rem; color: var(--primary-color); margin-bottom: 1rem;"></i>
                                <p style="color: var(--text-secondary); font-size: 0.9rem;">Loading progress data...</p>
                            </div>

                            <!-- Coming Soon State (Default) -->
                            <div id="progress-coming-soon-state" style="text-align: center; padding: 2.5rem 1rem; background: linear-gradient(135deg, var(--bg-secondary) 0%, var(--card-bg) 100%); border-radius: 12px; border: 2px dashed var(--border);">
                                <div style="font-size: 3rem; margin-bottom: 1rem;"></div>
                                <h4 style="font-size: 1.1rem; font-weight: 600; color: var(--heading); margin-bottom: 0.5rem;">
                                    Coming Soon
                                </h4>
                                <p style="color: var(--text-secondary); font-size: 0.85rem; line-height: 1.6; max-width: 280px; margin: 0 auto;">
                                    Track your children's academic progress, attendance, and performance metrics all in one place.
                                </p>
                                <div style="margin-top: 1.5rem; padding: 1rem; background: var(--card-bg); border-radius: 8px; border: 1px solid var(--border);">
                                    <p style="font-size: 0.75rem; color: var(--text-secondary); margin-bottom: 0.5rem;">
                                        <strong style="color: var(--heading);">Coming Features:</strong>
                                    </p>
                                    <ul style="text-align: left; font-size: 0.75rem; color: var(--text-secondary); list-style: none; padding: 0; margin: 0;">
                                        <li style="margin-bottom: 0.35rem;">
                                            <i class="fas fa-check-circle" style="color: var(--success); margin-right: 0.5rem;"></i>
                                            Grade tracking per subject
                                        </li>
                                        <li style="margin-bottom: 0.35rem;">
                                            <i class="fas fa-check-circle" style="color: var(--success); margin-right: 0.5rem;"></i>
                                            Attendance monitoring
                                        </li>
                                        <li style="margin-bottom: 0.35rem;">
                                            <i class="fas fa-check-circle" style="color: var(--success); margin-right: 0.5rem;"></i>
                                            Assignment completion
                                        </li>
                                        <li style="margin-bottom: 0.35rem;">
                                            <i class="fas fa-check-circle" style="color: var(--success); margin-right: 0.5rem;"></i>
                                            Progress comparisons
                                        </li>
                                    </ul>
                                </div>
                            </div>

                            <!-- Data State (Hidden until feature is implemented) -->
                            <div id="progress-data-state" class="hidden space-y-3">
                                <!-- Will be populated with actual progress data when feature is ready -->
                            </div>

                            <!-- Error State -->
                            <div id="progress-error-state" class="hidden" style="text-align: center; padding: 2rem 1rem;">
                                <i class="fas fa-exclamation-triangle" style="font-size: 2.5rem; color: var(--danger); margin-bottom: 1rem;"></i>
                                <p style="color: var(--text-secondary); font-size: 0.9rem; margin-bottom: 1rem;">
                                    Unable to load progress data
                                </p>
                                <button onclick="loadChildrenProgress()" style="padding: 0.5rem 1rem; background: var(--primary-color); color: white; border: none; border-radius: 8px; font-size: 0.85rem; cursor: pointer; transition: all 0.3s ease;">
                                    <i class="fas fa-redo-alt" style="margin-right: 0.5rem;"></i>
                                    Retry
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- This Week's Schedule Widget -->
                    <div id="this-week-schedule-widget" class="sidebar-widget card" style="padding: 1.5rem;">
                        <div class="flex items-center justify-between mb-4">
                            <h3 class="text-lg font-semibold" style="color: var(--heading); display: flex; align-items: center; gap: 0.5rem;">
                                <i class="fas fa-calendar-week" style="color: var(--primary-color);"></i>
                                This Week's Schedule
                            </h3>
                            <span id="week-item-count" class="text-xs px-2 py-1 rounded-full" style="background: var(--primary-color); color: white; font-weight: 600;">
                                0
                            </span>
                        </div>

                        <!-- Widget Content Container -->
                        <div id="week-schedule-content">
                            <!-- Loading State -->
                            <div id="week-schedule-loading" class="hidden" style="text-align: center; padding: 2rem 1rem;">
                                <i class="fas fa-spinner fa-spin" style="font-size: 2rem; color: var(--primary-color); margin-bottom: 1rem;"></i>
                                <p style="color: var(--text-secondary); font-size: 0.9rem;">Loading this week's schedule...</p>
                            </div>

                            <!-- Empty State -->
                            <div id="week-schedule-empty" class="hidden" style="text-align: center; padding: 2rem 1rem; background: var(--bg-secondary); border-radius: 12px;">
                                <i class="fas fa-calendar-check" style="font-size: 2.5rem; color: var(--text-secondary); margin-bottom: 1rem;"></i>
                                <p style="color: var(--text-secondary); font-size: 0.9rem; margin-bottom: 0.5rem;">No schedule this week</p>
                                <p style="color: var(--text-secondary); font-size: 0.75rem;">Schedule sessions or classes to see them here</p>
                            </div>

                            <!-- Data Container -->
                            <div id="week-schedule-data" class="hidden space-y-3">
                                <!-- Schedule items will be populated here -->
                            </div>

                            <!-- Error State -->
                            <div id="week-schedule-error" class="hidden" style="text-align: center; padding: 2rem 1rem;">
                                <i class="fas fa-exclamation-triangle" style="font-size: 2.5rem; color: var(--danger); margin-bottom: 1rem;"></i>
                                <p style="color: var(--text-secondary); font-size: 0.9rem; margin-bottom: 1rem;">
                                    Unable to load schedule
                                </p>
                                <button onclick="loadThisWeekSchedule()" style="padding: 0.5rem 1rem; background: var(--primary-color); color: white; border: none; border-radius: 8px; font-size: 0.85rem; cursor: pointer; transition: all 0.3s ease;">
                                    <i class="fas fa-redo-alt" style="margin-right: 0.5rem;"></i>
                                    Retry
                                </button>
                            </div>
                        </div>

                        <!-- View All Button -->
                        <button id="view-all-schedule-btn" class="hidden w-full mt-3 px-4 py-2 text-sm rounded-lg transition-colors"
                                style="background: var(--primary-color); color: white; border: none; cursor: pointer;"
                                onclick="switchToSchedulePanel()">
                            View All Schedule
                        </button>
                    </div>
                    <!-- Trending Tutors Widget -->
                    <div id="trending-tutors-widget" class="sidebar-widget card" style="padding: 1.5rem;">
                        <div class="flex items-center justify-between mb-4">
                            <h3 class="text-lg font-semibold" style="color: var(--heading); display: flex; align-items: center; gap: 0.5rem;">
                                <i class="fas fa-fire" style="color: #FF6B6B;"></i>
                                Trending Tutors
                            </h3>
                            <span id="trending-tutors-count" class="text-xs px-2 py-1 rounded-full" style="background: #FF6B6B; color: white; font-weight: 600;">
                                0
                            </span>
                        </div>

                        <!-- Widget Content Container -->
                        <div id="trending-tutors-content">
                            <!-- Loading State -->
                            <div id="trending-tutors-loading" class="hidden" style="text-align: center; padding: 2rem 1rem;">
                                <i class="fas fa-spinner fa-spin" style="font-size: 2rem; color: var(--primary-color); margin-bottom: 1rem;"></i>
                                <p style="color: var(--text-secondary); font-size: 0.9rem;">Loading top tutors...</p>
                            </div>

                            <!-- Empty State -->
                            <div id="trending-tutors-empty" class="hidden" style="text-align: center; padding: 2rem 1rem; background: var(--bg-secondary); border-radius: 12px;">
                                <i class="fas fa-user-graduate" style="font-size: 2.5rem; color: var(--text-secondary); margin-bottom: 1rem;"></i>
                                <p style="color: var(--text-secondary); font-size: 0.9rem;">No tutors available</p>
                            </div>

                            <!-- Data Container with Carousel -->
                            <div id="trending-tutors-data" class="hidden" style="position: relative; min-height: 180px;">
                                <!-- Tutors will be displayed here with fade animation -->
                            </div>

                            <!-- Error State -->
                            <div id="trending-tutors-error" class="hidden" style="text-align: center; padding: 2rem 1rem;">
                                <i class="fas fa-exclamation-triangle" style="font-size: 2.5rem; color: var(--danger); margin-bottom: 1rem;"></i>
                                <p style="color: var(--text-secondary); font-size: 0.9rem; margin-bottom: 1rem;">
                                    Unable to load tutors
                                </p>
                                <button onclick="loadTrendingTutors()" style="padding: 0.5rem 1rem; background: var(--primary-color); color: white; border: none; border-radius: 8px; font-size: 0.85rem; cursor: pointer; transition: all 0.3s ease;">
                                    <i class="fas fa-redo-alt" style="margin-right: 0.5rem;"></i>
                                    Retry
                                </button>
                            </div>
                        </div>

                        <!-- Explore More Button -->
                        <button id="explore-more-tutors-btn" class="hidden w-full mt-3 px-4 py-2 text-sm rounded-lg transition-colors"
                                style="background: var(--primary-color); color: white; border: none; cursor: pointer;"
                                onclick="window.location.href='../branch/find-tutors.html'">
                            Explore More Tutors
                        </button>
                    </div>
                </div>
                <!-- End of right-widgets -->
            </div>
            <!-- End of flex gap-6 container -->
        </div>
        <!-- End of container mx-auto px-4 -->
    </section>
    <!-- Bottom Widgets Section -->
    <section class="bottom-widgets" style="margin-top: 3rem; margin-bottom: 3rem;">
        <div class="container mx-auto px-4">
            <div class="bottom-widgets-grid"
                style="display: grid; grid-template-columns: repeat(auto-fit, minmax(320px, 1fr)); gap: 1.5rem;">

                <!-- News Widget -->
                <div class="sidebar-widget news-widget card" style="cursor: pointer; padding: 1.5rem;">
                    <div class="widget-header"
                        style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                        <h3 style="font-size: 1.25rem; font-weight: 600; margin: 0;"> Latest News</h3>
                        <a href="#" onclick="openComingSoonModal('news'); return false;"
                            style="color: var(--button-bg); text-decoration: none; font-size: 0.875rem;">View All</a>
                    </div>
                    <div class="news-carousel" style="position: relative; overflow: hidden;">
                        <div class="news-card-container" id="newsCardContainer">
                            <div class="news-card active" data-news-index="0"
                                style="opacity: 1; transition: opacity 0.5s ease;">
                                <div class="news-card-header"
                                    style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.75rem;">
                                    <span class="news-category-badge"
                                        style="background: linear-gradient(135deg, #667eea, #764ba2); color: white; padding: 0.25rem 0.75rem; border-radius: 12px; font-size: 0.75rem; font-weight: 600;">Education</span>
                                    <span class="news-time" style="color: var(--text-muted); font-size: 0.875rem;">2h
                                        ago</span>
                                </div>
                                <div class="news-card-image" style="margin-bottom: 1rem;">
                                    <img src="https://images.unsplash.com/photo-1427504494785-3a9ca7044f45?w=400"
                                        alt="Education News"
                                        style="width: 100%; height: 200px; object-fit: cover; border-radius: 8px;">
                                </div>
                                <div class="news-card-content">
                                    <h4
                                        style="font-size: 1.125rem; font-weight: 600; margin-bottom: 0.5rem; color: var(--heading);">
                                        New Education Reforms Transform Ethiopian Schools</h4>
                                    <p
                                        style="color: var(--text); opacity: 0.8; font-size: 0.875rem; line-height: 1.6; margin-bottom: 1rem;">
                                        Latest educational initiatives are revolutionizing how students learn across
                                        Ethiopia...</p>
                                    <div class="news-stats" style="display: flex; gap: 1rem; flex-wrap: wrap;">
                                        <span class="news-stat"
                                            style="display: flex; align-items: center; gap: 0.25rem; font-size: 0.875rem; color: var(--text-muted);">
                                            Trending</span>
                                        <span class="news-stat"
                                            style="display: flex; align-items: center; gap: 0.25rem; font-size: 0.875rem; color: var(--text-muted);">?
                                            1.2k views</span>
                                        <span class="news-stat"
                                            style="display: flex; align-items: center; gap: 0.25rem; font-size: 0.875rem; color: var(--text-muted);">
                                            45 comments</span>
                                    </div>
                                </div>
                            </div>
                            <div class="news-card" data-news-index="1"
                                style="display: none; opacity: 0; transition: opacity 0.5s ease;">
                                <div class="news-card-header"
                                    style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.75rem;">
                                    <span class="news-category-badge"
                                        style="background: linear-gradient(135deg, #f093fb, #f5576c); color: white; padding: 0.25rem 0.75rem; border-radius: 12px; font-size: 0.75rem; font-weight: 600;">Technology</span>
                                    <span class="news-time" style="color: var(--text-muted); font-size: 0.875rem;">5h
                                        ago</span>
                                </div>
                                <div class="news-card-image" style="margin-bottom: 1rem;">
                                    <img src="https://images.unsplash.com/photo-1488590528505-98d2b5aba04b?w=400"
                                        alt="Tech News"
                                        style="width: 100%; height: 200px; object-fit: cover; border-radius: 8px;">
                                </div>
                                <div class="news-card-content">
                                    <h4
                                        style="font-size: 1.125rem; font-weight: 600; margin-bottom: 0.5rem; color: var(--heading);">
                                        Digital Learning Platforms Surge in Popularity</h4>
                                    <p
                                        style="color: var(--text); opacity: 0.8; font-size: 0.875rem; line-height: 1.6; margin-bottom: 1rem;">
                                        Ethiopian students embrace online education tools for enhanced learning
                                        experiences...</p>
                                    <div class="news-stats" style="display: flex; gap: 1rem; flex-wrap: wrap;">
                                        <span class="news-stat"
                                            style="display: flex; align-items: center; gap: 0.25rem; font-size: 0.875rem; color: var(--text-muted);">
                                            Innovation</span>
                                        <span class="news-stat"
                                            style="display: flex; align-items: center; gap: 0.25rem; font-size: 0.875rem; color: var(--text-muted);">?
                                            890 views</span>
                                        <span class="news-stat"
                                            style="display: flex; align-items: center; gap: 0.25rem; font-size: 0.875rem; color: var(--text-muted);">
                                            32 comments</span>
                                    </div>
                                </div>
                            </div>
                            <div class="news-card" data-news-index="2"
                                style="display: none; opacity: 0; transition: opacity 0.5s ease;">
                                <div class="news-card-header"
                                    style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.75rem;">
                                    <span class="news-category-badge"
                                        style="background: linear-gradient(135deg, #4facfe, #00f2fe); color: white; padding: 0.25rem 0.75rem; border-radius: 12px; font-size: 0.75rem; font-weight: 600;">Career</span>
                                    <span class="news-time" style="color: var(--text-muted); font-size: 0.875rem;">1d
                                        ago</span>
                                </div>
                                <div class="news-card-image" style="margin-bottom: 1rem;">
                                    <img src="https://images.unsplash.com/photo-1522202176988-66273c2fd55f?w=400"
                                        alt="Career News"
                                        style="width: 100%; height: 200px; object-fit: cover; border-radius: 8px;">
                                </div>
                                <div class="news-card-content">
                                    <h4
                                        style="font-size: 1.125rem; font-weight: 600; margin-bottom: 0.5rem; color: var(--heading);">
                                        Top Skills Every Tutor Should Master in 2025</h4>
                                    <p
                                        style="color: var(--text); opacity: 0.8; font-size: 0.875rem; line-height: 1.6; margin-bottom: 1rem;">
                                        Professional development insights for educators to stay competitive and
                                        effective...</p>
                                    <div class="news-stats" style="display: flex; gap: 1rem; flex-wrap: wrap;">
                                        <span class="news-stat"
                                            style="display: flex; align-items: center; gap: 0.25rem; font-size: 0.875rem; color: var(--text-muted);">
                                            Featured</span>
                                        <span class="news-stat"
                                            style="display: flex; align-items: center; gap: 0.25rem; font-size: 0.875rem; color: var(--text-muted);">?
                                            2.1k views</span>
                                        <span class="news-stat"
                                            style="display: flex; align-items: center; gap: 0.25rem; font-size: 0.875rem; color: var(--text-muted);">
                                            67 comments</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- Bookstore Widget -->
                <div class="sidebar-widget bookstore-widget card" onclick="openComingSoonModal('store')"
                    style="cursor: pointer; padding: 1.5rem; background: var(--card-bg); border-radius: 16px; transition: transform 0.3s ease, box-shadow 0.3s ease;"
                    onmouseover="this.style.transform='translateY(-4px)'; this.style.boxShadow='0 8px 16px rgba(0,0,0,0.1)'"
                    onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='none'">
                    <div class="widget-header"
                        style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                        <h3 style="font-size: 1.25rem; font-weight: 600; margin: 0; color: var(--heading);"> Bookstore
                        </h3>
                        <span
                            style="background: var(--button-bg); color: white; padding: 0.5rem 0.75rem; border-radius: 8px; font-size: 0.75rem; font-weight: 600;">Coming
                            Soon</span>
                    </div>
                    <!-- Bookstore Content -->
                    <div class="bookstore-content">
                        <div class="bookstore-main" style="text-align: center; margin-bottom: 1.5rem;">
                            <div class="bookstore-icon" style="font-size: 4rem; margin-bottom: 0.5rem;"></div>
                            <div class="bookstore-title-animated"
                                style="position: relative; height: 2.5rem; overflow: hidden;">
                                <div class="bookstore-title"
                                    style="font-size: 1.5rem; font-weight: bold; margin-bottom: 0.5rem; color: var(--heading); position: absolute; width: 100%; opacity: 1; transition: opacity 0.6s ease, transform 0.6s ease;">
                                    Educational Books</div>
                            </div>
                            <div class="bookstore-subtitle" style="font-size: 1rem; color: var(--text);">Buy, Sell &
                                Rent Textbooks</div>
                        </div>
                        <div class="bookstore-features"
                            style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 1rem;">
                            <div class="feature-item"
                                style="background: var(--highlight-bg); padding: 0.75rem; border-radius: 8px; text-align: center;">
                                <span style="display: block; font-size: 1.5rem; margin-bottom: 0.25rem;"></span>
                                <span style="display: block; font-size: 0.875rem; color: var(--text);">New Books</span>
                            </div>
                            <div class="feature-item"
                                style="background: var(--highlight-bg); padding: 0.75rem; border-radius: 8px; text-align: center;">
                                <span style="display: block; font-size: 1.5rem; margin-bottom: 0.25rem;"></span>
                                <span style="display: block; font-size: 0.875rem; color: var(--text);">Used Books</span>
                            </div>
                            <div class="feature-item"
                                style="background: var(--highlight-bg); padding: 0.75rem; border-radius: 8px; text-align: center;">
                                <span style="display: block; font-size: 1.5rem; margin-bottom: 0.25rem;"></span>
                                <span style="display: block; font-size: 0.875rem; color: var(--text);">Best
                                    Prices</span>
                            </div>
                            <div class="feature-item"
                                style="background: var(--highlight-bg); padding: 0.75rem; border-radius: 8px; text-align: center;">
                                <span style="display: block; font-size: 1.5rem; margin-bottom: 0.25rem;"></span>
                                <span style="display: block; font-size: 0.875rem; color: var(--text);">Fast
                                    Delivery</span>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- Gamestore Widget -->
                <div class="sidebar-widget gamestore-widget card" onclick="openComingSoonModal('gamestore')"
                    style="cursor: pointer; padding: 1.5rem; background: var(--card-bg); border-radius: 16px; transition: transform 0.3s ease, box-shadow 0.3s ease;"
                    onmouseover="this.style.transform='translateY(-4px)'; this.style.boxShadow='0 8px 16px rgba(0,0,0,0.1)'"
                    onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='none'">
                    <div class="widget-header"
                        style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                        <h3 style="font-size: 1.25rem; font-weight: 600; margin: 0; color: var(--heading);"> Gamestore
                        </h3>
                        <span
                            style="background: var(--button-bg); color: white; padding: 0.5rem 0.75rem; border-radius: 8px; font-size: 0.75rem; font-weight: 600;">Coming
                            Soon</span>
                    </div>
                    <div class="gamestore-content">
                        <div class="gamestore-main" style="text-align: center; margin-bottom: 1.5rem;">
                            <div class="gamestore-icon" style="font-size: 4rem; margin-bottom: 0.5rem;"></div>
                            <div class="gamestore-title-animated"
                                style="position: relative; height: 2.5rem; overflow: hidden;">
                                <div class="gamestore-title"
                                    style="font-size: 1.5rem; font-weight: bold; margin-bottom: 0.5rem; color: var(--heading); position: absolute; width: 100%; opacity: 1; transition: opacity 0.6s ease, transform 0.6s ease;">
                                    Educational Games</div>
                            </div>
                            <div class="gamestore-subtitle" style="font-size: 1rem; color: var(--text);">Learn While
                                Playing</div>
                        </div>
                        <div class="gamestore-features"
                            style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 1rem;">
                            <div class="feature-item"
                                style="background: var(--highlight-bg); padding: 0.75rem; border-radius: 8px; text-align: center;">
                                <span style="display: block; font-size: 1.5rem; margin-bottom: 0.25rem;"></span>
                                <span style="display: block; font-size: 0.875rem; color: var(--text);">Puzzle
                                    Games</span>
                            </div>
                            <div class="feature-item"
                                style="background: var(--highlight-bg); padding: 0.75rem; border-radius: 8px; text-align: center;">
                                <span style="display: block; font-size: 1.5rem; margin-bottom: 0.25rem;"></span>
                                <span style="display: block; font-size: 0.875rem; color: var(--text);">Strategy
                                    Games</span>
                            </div>
                            <div class="feature-item"
                                style="background: var(--highlight-bg); padding: 0.75rem; border-radius: 8px; text-align: center;">
                                <span style="display: block; font-size: 1.5rem; margin-bottom: 0.25rem;"></span>
                                <span style="display: block; font-size: 0.875rem; color: var(--text);">Top Rated</span>
                            </div>
                            <div class="feature-item"
                                style="background: var(--highlight-bg); padding: 0.75rem; border-radius: 8px; text-align: center;">
                                <span style="display: block; font-size: 1.5rem; margin-bottom: 0.25rem;"></span>
                                <span style="display: block; font-size: 0.875rem; color: var(--text);">Free to
                                    Play</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <!-- Edit Profile Modal -->
    <div id="editProfileModal" class="modal hidden" style="display: none;">
        <div class="modal-overlay" onclick="closeEditProfileModal()"></div>
        <div class="modal-content enhanced-modal" style="max-width: 900px; max-height: 90vh; overflow-y: auto;">
            <div class="modal-header">
                <h2 class="modal-title"> Edit Profile</h2>
                <button class="modal-close" onclick="closeEditProfileModal()">&times;</button>
            </div>
            <div class="modal-body" style="padding: 2rem;">
                <form id="editProfileForm">

                    <!-- Basic Information Section -->
                    <div class="form-section" style="margin-bottom: 2rem;">
                        <h3 style="color: var(--text-primary); margin-bottom: 1rem; font-size: 1.2rem; display: flex; align-items: center; gap: 0.5rem;">
                            <span></span> Basic Information
                        </h3>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                            <div class="form-group">
                                <label>Full Name</label>
                                <input type="text" id="editName" class="form-input" placeholder="Enter your full name">
                            </div>
                            <div class="form-group">
                                <label>Username</label>
                                <input type="text" id="editUsername" class="form-input" placeholder="@username">
                            </div>
                        </div>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                            <div class="form-group">
                                <label>Relationship to Children</label>
                                <select id="editRelationship" class="form-input">
                                    <option value="Father">Father</option>
                                    <option value="Mother">Mother</option>
                                    <option value="Brother">Brother</option>
                                    <option value="Sister">Sister</option>
                                    <option value="Grandfather">Grandfather</option>
                                    <option value="Grandmother">Grandmother</option>
                                    <option value="Uncle">Uncle</option>
                                    <option value="Aunt">Aunt</option>
                                    <option value="Cousin">Cousin</option>
                                    <option value="Guardian">Guardian</option>
                                </select>
                                <small style="color: var(--text-muted); font-size: 0.75rem; display: block; margin-top: 0.25rem;">Your relationship to the enrolled children</small>
                            </div>
                            <div class="form-group">
                                <label>Location</label>
                                <input type="text" id="editLocation" class="form-input" placeholder="City, Country (e.g., Addis Ababa, Ethiopia)">

                                <!-- GPS Location Detection -->
                                <div style="margin-top: 0.75rem;">
                                    <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer; font-size: 0.875rem; color: var(--text-secondary); margin: 0;">
                                        <input type="checkbox" id="editAllowLocation" onchange="handleAllowLocationChange(this)" style="width: 16px; height: 16px; cursor: pointer;">
                                        <span>Enable GPS location detection</span>
                                    </label>
                                    <small style="color: var(--text-muted); font-size: 0.75rem; display: block; margin-top: 0.25rem;">Uses GPS/WiFi positioning to detect your physical location (not affected by VPN)</small>
                                </div>

                                <!-- Change Location Button (shown when location exists) -->
                                <button type="button" id="changeLocationBtn" onclick="handleChangeLocationParent()"
                                    style="display: none; margin-top: 0.5rem; font-size: 0.875rem; background: #3b82f6; color: white; padding: 0.375rem 0.75rem; border-radius: 0.5rem; border: none; cursor: pointer;">
                                    <i class="fas fa-edit" style="margin-right: 0.25rem;"></i> Change Location
                                </button>

                                <!-- Detect Location Button (shown when checkbox is checked) -->
                                <button type="button" id="detectLocationBtn" onclick="detectCurrentLocation()"
                                    style="display: none; margin-top: 0.5rem; font-size: 0.875rem; background: #10b981; color: white; padding: 0.375rem 0.75rem; border-radius: 0.5rem; border: none; cursor: pointer;">
                                    <i class="fas fa-location-arrow" style="margin-right: 0.25rem;"></i> Detect Location
                                </button>
                                <p id="locationStatus" style="display: none; font-size: 0.75rem; margin-top: 0.25rem;"></p>
                            </div>
                        </div>
                    </div>

                    <!-- Contact Information Section -->
                    <div class="form-section" style="margin-bottom: 2rem;">
                        <h3 style="color: var(--text-primary); margin-bottom: 1rem; font-size: 1.2rem; display: flex; align-items: center; gap: 0.5rem;">
                            <span></span> Contact Information
                        </h3>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                            <div class="form-group">
                                <label>Email</label>
                                <input type="email" id="editEmail" class="form-input" placeholder="your.email@example.com" disabled>
                                <small style="color: var(--text-muted); font-size: 0.75rem; display: block; margin-top: 0.25rem;">Email cannot be changed here</small>
                            </div>
                            <div class="form-group">
                                <label>Phone Number</label>
                                <input type="tel" id="editPhone" class="form-input" placeholder="+251 912 345 678" disabled>
                                <small style="color: var(--text-muted); font-size: 0.75rem; display: block; margin-top: 0.25rem;">Phone cannot be changed here</small>
                            </div>
                        </div>
                    </div>

                    <!-- Languages & Hobbies Section -->
                    <div class="form-section" style="margin-bottom: 2rem;">
                        <h3 style="color: var(--text-primary); margin-bottom: 1rem; font-size: 1.2rem; display: flex; align-items: center; gap: 0.5rem;">
                            <span></span> Languages & Hobbies
                        </h3>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                            <div class="form-group">
                                <label>Languages (Multiple)</label>
                                <div id="languages-container" style="display: flex; flex-direction: column; gap: 0.5rem; margin-bottom: 0.5rem;"></div>
                                <button type="button" onclick="addLanguage()" style="padding: 0.5rem 1rem; background: var(--button-bg); color: white; border: none; border-radius: 8px; cursor: pointer; width: 100%;">
                                     Add Language
                                </button>
                            </div>
                            <div class="form-group">
                                <label>Hobbies & Interests (Multiple)</label>
                                <div id="hobbies-container" style="display: flex; flex-direction: column; gap: 0.5rem; margin-bottom: 0.5rem;"></div>
                                <button type="button" onclick="addHobby()" style="padding: 0.5rem 1rem; background: var(--button-bg); color: white; border: none; border-radius: 8px; cursor: pointer; width: 100%;">
                                     Add Hobby
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- About Me Section -->
                    <div class="form-section" style="margin-bottom: 2rem;">
                        <h3 style="color: var(--text-primary); margin-bottom: 1rem; font-size: 1.2rem; display: flex; align-items: center; gap: 0.5rem;">
                            <span></span> About Me
                        </h3>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                            <div class="form-group">
                                <label>About Me</label>
                                <textarea id="editBio" class="form-textarea" rows="4" placeholder="Tell us about yourself..."></textarea>
                            </div>
                            <div class="form-group">
                                <label>Favorite Quote</label>
                                <textarea id="editQuote" class="form-textarea" rows="4" placeholder="Your motivational quote"></textarea>
                            </div>
                        </div>
                    </div>

                    <!-- Social Media Links Section -->
                    <div class="form-section" style="margin-bottom: 2rem;">
                        <h3 style="color: var(--text-primary); margin-bottom: 1rem; font-size: 1.2rem; display: flex; align-items: center; gap: 0.5rem;">
                            <span></span> Social Media Links
                        </h3>
                        <div class="form-group">
                            <label>Social Media Links (Optional)</label>
                            <div id="socialMediaContainer" style="margin-bottom: 0.5rem;"></div>
                            <button type="button" onclick="addSocialLink()" style="padding: 0.5rem 1rem; background: var(--button-bg); color: white; border: none; border-radius: 8px; cursor: pointer;">
                                 Add Social Link
                            </button>
                        </div>
                    </div>

                </form>
            </div>
            <div class="modal-footer" style="display: flex; gap: 1rem; justify-content: flex-end; padding: 1.5rem;">
                <button class="btn-secondary" onclick="closeEditProfileModal()" style="padding: 0.75rem 2rem;">Cancel</button>
                <button class="btn-primary" onclick="saveParentProfile()" style="padding: 0.75rem 2rem;"> Save Changes</button>
            </div>
        </div>
    </div>
    <!-- Invite Parent Modal (shared modal for inviting co-parents) -->
    <div id="invite-parent-modal-container"></div>
    <!-- Add Child Modal Container -->
    <div id="add-child-modal-container"></div>
    <!-- Chat Modal Container -->
    <div id="chat-modal-container"></div>
    <!-- Notes Modal Container -->
    <div id="notes-modal-container"></div>
    <!-- Cover Upload Modal -->
    <div class="upload-cover-modal" id="coverUploadModal" style="display: none;">
        <div class="modal-content">
            <div class="modal-inner">
                <div class="modal-header">
                    <h2 class="modal-title">Upload Cover Photo</h2>
                    <button class="modal-close" onclick="closeCoverUploadModal()">&times;</button>
                </div>
                <div class="upload-area" id="coverUploadArea" onclick="document.getElementById('coverInput').click()">
                    <span class="upload-icon"></span>
                    <p class="upload-text">Click to upload or drag and drop</p>
                    <p class="upload-hint">Recommended: 1920x400px (JPG, PNG, GIF)</p>
                    <input type="file" id="coverInput" class="upload-input" accept="image/*"
                        onchange="handleImageSelect(event, 'cover')">
                </div>
                <div class="preview-container" id="coverPreview" style="display: none;">
                    <img src="" alt="Cover preview" class="preview-image" id="coverPreviewImage">
                    <div class="preview-info">
                        <div class="file-info">
                            <span>File Name:</span>
                            <span id="coverFileName">-</span>
                        </div>
                        <div class="file-info">
                            <span>File Size:</span>
                            <span id="coverFileSize">-</span>
                        </div>
                        <div class="file-info">
                            <span>Dimensions:</span>
                            <span id="coverDimensions">-</span>
                        </div>
                    </div>
                </div>
                <div class="upload-progress" id="coverProgress" style="display: none;">
                    <div class="progress-bar">
                        <div class="progress-fill" id="coverProgressFill"></div>
                    </div>
                    <p class="progress-text" id="coverProgressText">Uploading... 0%</p>
                </div>
                <div class="upload-spinner" id="coverSpinner" style="display: none;"></div>
                <div class="upload-actions">
                    <button class="btn-upload secondary" onclick="resetUpload('cover')">Change Image</button>
                    <button class="btn-upload primary" onclick="uploadImage('cover')">Upload Cover</button>
                </div>
            </div>
        </div>
    </div>
    <!-- Profile Upload Modal -->
    <div class="upload-profile-modal" id="profileUploadModal" style="display: none;">
        <div class="modal-content">
            <div class="modal-inner">
                <div class="modal-header">
                    <h2 class="modal-title">Upload Profile Picture</h2>
                    <button class="modal-close" onclick="closeProfileUploadModal()">&times;</button>
                </div>
                <div class="upload-area" id="profileUploadArea"
                    onclick="document.getElementById('profileInput').click()">
                    <span class="upload-icon"></span>
                    <p class="upload-text">Click to upload or drag and drop</p>
                    <p class="upload-hint">Recommended: 500x500px (JPG, PNG, GIF)</p>
                    <input type="file" id="profileInput" class="upload-input" accept="image/*"
                        onchange="handleImageSelect(event, 'profile')">
                </div>
                <div class="preview-container" id="profilePreview" style="display: none;">
                    <img src="" alt="Profile preview" class="preview-image" id="profilePreviewImage">
                    <div class="preview-info">
                        <div class="file-info">
                            <span>File Name:</span>
                            <span id="profileFileName">-</span>
                        </div>
                        <div class="file-info">
                            <span>File Size:</span>
                            <span id="profileFileSize">-</span>
                        </div>
                        <div class="file-info">
                            <span>Dimensions:</span>
                            <span id="profileDimensions">-</span>
                        </div>
                    </div>
                </div>
                <div class="upload-progress" id="profileProgress" style="display: none;">
                    <div class="progress-bar">
                        <div class="progress-fill" id="profileProgressFill"></div>
                    </div>
                    <p class="progress-text" id="profileProgressText">Uploading... 0%</p>
                </div>
                <div class="upload-spinner" id="profileSpinner" style="display: none;"></div>
                <div class="upload-actions">
                    <button class="btn-upload secondary" onclick="resetUpload('profile')">Change Image</button>
                    <button class="btn-upload primary" onclick="uploadImage('profile')">Upload Profile</button>
                </div>
            </div>
        </div>
    </div>
    <!-- Coming Soon Modal -->
    <div id="coming-soon-modal" class="modal hidden">
        <div class="modal-content enhanced coming-soon-content">
            <button class="modal-close-enhanced" onclick="closeModal('coming-soon-modal')">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12">
                    </path>
                </svg>
            </button>
            <div class="coming-soon-header">
                <div class="coming-soon-icon">
                    <svg class="w-16 h-16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z">
                        </path>
                    </svg>
                </div>
                <h3 class="modal-title">Coming Soon!</h3>
                <p class="modal-subtitle" id="coming-soon-message">We're working hard to bring you this feature. Stay
                    tuned!</p>
            </div>
        </div>
    </div>
    <!-- Toast Notification Container -->
    <div id="toast-container" class="toast-container"></div>
    <!-- Ad Analytics Modal -->
    <div class="modal hidden" id="adAnalyticsModal">
        <div class="modal-overlay" onclick="closeAdAnalyticsModal()"></div>
        <div class="modal-content ad-analytics-modal">
            <div class="modal-header">
                <h2>Advertisement Analytics & Information</h2>
                <button class="modal-close" onclick="closeAdAnalyticsModal()"></button>
            </div>
            <div class="modal-body">
                <div class="ad-stats-grid">
                    <div class="ad-stat-card">
                        <div class="ad-stat-icon"></div>
                        <div class="ad-stat-info">
                            <h3>2.5M+</h3>
                            <p>Monthly Impressions</p>
                        </div>
                        <span>Mock</span>
                    </div>
                    <div class="ad-stat-card">
                        <div class="ad-stat-icon">??</div>
                        <div class="ad-stat-info">
                            <h3>4.2%</h3>
                            <p>Average CTR</p>
                        </div>
                        <span>Mock</span>
                    </div>
                    <div class="ad-stat-card">
                        <div class="ad-stat-icon">??</div>
                        <div class="ad-stat-info">
                            <h3>$0.45</h3>
                            <p>Average CPC</p>
                        </div>
                        <span>Mock</span>
                    </div>
                    <div class="ad-stat-card">
                        <div class="ad-stat-icon">??</div>
                        <div class="ad-stat-info">
                            <h3>325%</h3>
                            <p>Average ROI</p>
                        </div>
                        <span>Mock</span>
                    </div>
                </div>
                <div class="advertisers-section">
                    <h3>Our Premium Advertisers</h3>
                    <div class="advertisers-grid">
                        <div class="advertiser-card">
                            <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='80' height='80' viewBox='0 0 80 80' fill='%23e5e7eb'%3E%3Crect width='80' height='80' rx='8'/%3E%3Ctext x='50%25' y='50%25' text-anchor='middle' dy='.3em' fill='%236b7280' font-family='sans-serif' font-size='14'%3EAdobe%3C/text%3E%3C/svg%3E"
                                alt="Adobe">
                            <span>Your company name</span>
                        </div>
                        <div class="advertiser-card">
                            <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='80' height='80' viewBox='0 0 80 80' fill='%23e5e7eb'%3E%3Crect width='80' height='80' rx='8'/%3E%3Ctext x='50%25' y='50%25' text-anchor='middle' dy='.3em' fill='%236b7280' font-family='sans-serif' font-size='14'%3ECanon%3C/text%3E%3C/svg%3E"
                                alt="Canon">
                            <span>Your company name</span>
                        </div>
                        <div class="advertiser-card">
                            <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='80' height='80' viewBox='0 0 80 80' fill='%23e5e7eb'%3E%3Crect width='80' height='80' rx='8'/%3E%3Ctext x='50%25' y='50%25' text-anchor='middle' dy='.3em' fill='%236b7280' font-family='sans-serif' font-size='14'%3ENetflix%3C/text%3E%3C/svg%3E"
                                alt="Netflix">
                            <span>Your company name</span>
                        </div>
                        <div class="advertiser-card">
                            <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='80' height='80' viewBox='0 0 80 80' fill='%23e5e7eb'%3E%3Crect width='80' height='80' rx='8'/%3E%3Ctext x='50%25' y='50%25' text-anchor='middle' dy='.3em' fill='%236b7280' font-family='sans-serif' font-size='14'%3ESony%3C/text%3E%3C/svg%3E"
                                alt="Sony">
                            <span>Your company name</span>
                        </div>
                    </div>
                </div>
                <div class="testimonials-section">
                    <h3>Client Testimonials</h3>
                    <div class="testimonials-carousel">
                        <div class="testimonial-card">
                            <div class="testimonial-content">
                                <p>"Advertising on Astegni has been game-changing for our educational services business.
                                    We've
                                    seen a 400% increase in qualified leads from parents."</p>
                            </div>
                            <div class="testimonial-author">
                                <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='40' height='40' viewBox='0 0 40 40' fill='%23e5e7eb'%3E%3Ccircle cx='20' cy='20' r='20'/%3E%3Cpath d='M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2' transform='translate(8,8)' fill='none' stroke='%236b7280' stroke-width='1.5'/%3E%3Ccircle cx='20' cy='15' r='4' fill='none' stroke='%236b7280' stroke-width='1.5'/%3E%3C/svg%3E"
                                    alt="Author">
                                <div>
                                    <h4>Sarah Yohannes</h4>
                                    <span>Marketing Director, EduPro Ethiopia</span>
                                    <span>Mock</span>
                                </div>
                            </div>
                        </div>
                        <div class="testimonial-card">
                            <div class="testimonial-content">
                                <p>"The targeted audience on this platform is exactly what we needed. Our course
                                    enrollments have doubled since we started advertising here."</p>
                            </div>
                            <div class="testimonial-author">
                                <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='40' height='40' viewBox='0 0 40 40' fill='%23e5e7eb'%3E%3Ccircle cx='20' cy='20' r='20'/%3E%3Cpath d='M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2' transform='translate(8,8)' fill='none' stroke='%236b7280' stroke-width='1.5'/%3E%3Ccircle cx='20' cy='15' r='4' fill='none' stroke='%236b7280' stroke-width='1.5'/%3E%3C/svg%3E"
                                    alt="Author">
                                <div>
                                    <h4>Christian Abebe</h4>
                                    <span>CEO, Digital Learning Academy</span>
                                    <span>Mock</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="ad-packages">
                    <h3>Advertising Packages</h3>
                    <div class="packages-grid">
                        <div class="package-card">
                            <h4>Up to Three days</h4>
                            <div class="package-price">2000 ETB/day</div>
                            <ul>
                                <li>Unlimited impressions</li>
                                <li>Custom targeting</li>
                                <li>Priority placement</li>
                                <li>Full analytics suite</li>
                            </ul>
                        </div>
                        <div class="package-card featured">
                            <div class="featured-badge">Most Popular</div>
                            <h4>Up to seven days</h4>
                            <div class="package-price">1800 ETB/day</div>
                            <ul>
                                <li>Unlimited impressions</li>
                                <li>Custom targeting</li>
                                <li>Priority placement</li>
                                <li>Full analytics suite</li>
                            </ul>
                        </div>
                        <div class="package-card">
                            <h4>Up to Half a month</h4>
                            <div class="package-price">1500 ETB/day</div>
                            <ul>
                                <li>Unlimited impressions</li>
                                <li>Custom targeting</li>
                                <li>Priority placement</li>
                                <li>Full analytics suite</li>
                            </ul>
                        </div>
                        <div class="package-card">
                            <h4>Up to a Month</h4>
                            <div class="package-price">1200 ETB/day</div>
                            <ul>
                                <li>Unlimited impressions</li>
                                <li>Custom targeting</li>
                                <li>Priority placement</li>
                                <li>Full analytics suite</li>
                            </ul>
                        </div>
                        <div class="package-card">
                            <h4>Up to Three Months</h4>
                            <div class="package-price">1000 ETB/day</div>
                            <ul>
                                <li>Unlimited impressions</li>
                                <li>Custom targeting</li>
                                <li>Priority placement</li>
                                <li>Full analytics suite</li>
                            </ul>
                        </div>
                        <div class="package-card">
                            <h4>Up to Six Months</h4>
                            <div class="package-price">800 ETB/day</div>
                            <ul>
                                <li>Unlimited impressions</li>
                                <li>Custom targeting</li>
                                <li>Priority placement</li>
                                <li>Full analytics suite</li>
                            </ul>
                        </div>
                        <div class="package-card">
                            <h4>Up to Nine Months</h4>
                            <div class="package-price">600 ETB/day</div>
                            <ul>
                                <li>Unlimited impressions</li>
                                <li>Custom targeting</li>
                                <li>Priority placement</li>
                                <li>Full analytics suite</li>
                            </ul>
                        </div>
                        <div class="package-card">
                            <h4>Up to a Year</h4>
                            <div class="package-price">400 ETB/day</div>
                            <ul>
                                <li>Unlimited impressions</li>
                                <li>Custom targeting</li>
                                <li>Priority placement</li>
                                <li>Full analytics suite</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn-secondary" onclick="closeAdAnalyticsModal()">Close</button>
                <button class="btn-primary" onclick="startAdvertising()">Start Advertising</button>
            </div>
        </div>
    </div>
    <!-- Community Modal -->
    <div id="communityModal" class="modal hidden" style="display: none; z-index: 10001;">
        <div class="modal-overlay"></div>
        <div class="modal-content community-modal-content">
            <div class="modal-wrapper">
                <!-- Sidebar -->
                <div class="community-sidebar">
                    <h3>Community</h3>
                    <div class="community-menu">
                        <div class="menu-item active" data-section="connections" onclick="switchCommunityMainSection('connections')">
                            <span class="menu-icon">??</span>
                            <span>Connections</span>
                            <span class="count-badge" id="connections-count">0</span>
                        </div>
                        <div class="menu-item" data-section="requests" onclick="switchCommunityMainSection('requests')">
                            <span class="menu-icon">??</span>
                            <span>Requests</span>
                            <span class="count-badge" id="requests-count">0</span>
                        </div>
                        <div class="menu-divider"></div>
                        <div class="menu-item" data-section="events" onclick="switchCommunityMainSection('events')">
                            <span class="menu-icon">??</span>
                            <span>Events</span>
                            <span class="count-badge" id="events-count">0</span>
                        </div>
                        <div class="menu-item" data-section="clubs" onclick="switchCommunityMainSection('clubs')">
                            <span class="menu-icon">??</span>
                            <span>Clubs</span>
                            <span class="count-badge" id="clubs-count">0</span>
                        </div>
                    </div>
                </div>
                <!-- Main Content Area -->
                <div class="community-main">
                    <!-- Modal Header -->
                    <div class="modal-header">
                        <h2 id="communityModalTitle">Connections</h2>
                        <button class="modal-close" onclick="closeCommunityModal()">&times;</button>
                    </div>
                    <!-- CONNECTIONS SECTION -->
                    <div id="connections-section" class="community-section active">
                        <!-- Section Header with Search -->
                        <div class="section-header">
                            <div class="search-box">
                                <i class="fas fa-search search-icon"></i>
                                <input type="text" class="search-input" placeholder="Search connections..." id="connections-search" oninput="searchConnections(this.value)">
                            </div>
                        </div>
                        <!-- Section Filters (Tabs) -->
                        <div class="section-filters">
                            <button class="filter-btn active" data-filter="all" onclick="filterConnectionsBy('all')">
                                All <span class="filter-count" data-role="all">0</span>
                            </button>
                            <button class="filter-btn" data-filter="children" onclick="filterConnectionsBy('children')">
                                 Children <span class="filter-count" data-role="children">0</span>
                            </button>
                            <button class="filter-btn" data-filter="tutors" onclick="filterConnectionsBy('tutors')">
                                 Tutors <span class="filter-count" data-role="tutors">0</span>
                            </button>
                            <button class="filter-btn" data-filter="parents" onclick="filterConnectionsBy('parents')">
                                 Parents <span class="filter-count" data-role="parents">0</span>
                            </button>
                            <button class="filter-btn add-filter-btn" onclick="openAddConnectionModal()">
                                <i class="fas fa-plus"></i> Add
                            </button>
                        </div>
                        <!-- Connections Grid -->
                        <div class="connections-grid" id="connectionsGrid" style="padding: 2rem;">
                            <div class="loading-container">
                                <div class="loading-spinner"></div>
                                <p class="loading-text">Loading connections...</p>
                            </div>
                        </div>
                    </div>
                    <!-- REQUESTS SECTION -->
                    <div id="requests-section" class="community-section hidden">
                        <!-- Request Type Tabs -->
                        <div class="request-tabs" style="display: flex; gap: 0.5rem; padding: 1rem; border-bottom: 1px solid rgba(var(--border-rgb), 0.1);">
                            <button class="request-tab-btn active" onclick="switchRequestTab('received')" data-tab="received"
                                style="flex: 1; padding: 0.75rem 1rem; background: var(--button-bg); color: white; border: none; border-radius: 8px; font-weight: 500; cursor: pointer; transition: all 0.2s;">
                                <span> Requests Received</span>
                                <span class="request-tab-count" id="received-requests-count" style="display: inline-block; margin-left: 0.5rem; background: rgba(255,255,255,0.2); padding: 0.1rem 0.5rem; border-radius: 12px; font-size: 0.85rem;">0</span>
                            </button>
                            <button class="request-tab-btn" onclick="switchRequestTab('sent')" data-tab="sent"
                                style="flex: 1; padding: 0.75rem 1rem; background: transparent; color: var(--text); border: 1px solid rgba(var(--border-rgb), 0.3); border-radius: 8px; font-weight: 500; cursor: pointer; transition: all 0.2s;">
                                <span> Requests Sent</span>
                                <span class="request-tab-count" id="sent-requests-count" style="display: inline-block; margin-left: 0.5rem; background: rgba(var(--border-rgb), 0.1); padding: 0.1rem 0.5rem; border-radius: 12px; font-size: 0.85rem;">0</span>
                            </button>
                        </div>
                        <!-- Requests Received Content -->
                        <div class="request-content" id="received-requests-content">
                            <div class="section-header">
                                <div class="search-box">
                                    <i class="fas fa-search search-icon"></i>
                                    <input type="text" class="search-input" placeholder="Search received requests..." id="received-requests-search" oninput="searchReceivedRequests(this.value)">
                                </div>
                            </div>
                            <div class="section-filters">
                                <button class="filter-btn active" data-filter="all" onclick="filterReceivedRequestsBy('all')">
                                    All Requests <span class="filter-count" data-role="all">0</span>
                                </button>
                                <button class="filter-btn" data-filter="children" onclick="filterReceivedRequestsBy('children')">
                                     Children <span class="filter-count" data-role="children">0</span>
                                </button>
                                <button class="filter-btn" data-filter="tutors" onclick="filterReceivedRequestsBy('tutors')">
                                     Tutors <span class="filter-count" data-role="tutors">0</span>
                                </button>
                                <button class="filter-btn" data-filter="parents" onclick="filterReceivedRequestsBy('parents')">
                                     Parents <span class="filter-count" data-role="parents">0</span>
                                </button>
                            </div>
                            <div class="connections-grid" id="receivedRequestsGrid" style="padding: 2rem;">
                                <div class="loading-container">
                                    <div class="loading-spinner"></div>
                                    <p class="loading-text">Loading received requests...</p>
                                </div>
                            </div>
                        </div>
                        <!-- Requests Sent Content -->
                        <div class="request-content hidden" id="sent-requests-content">
                            <div class="section-header">
                                <div class="search-box">
                                    <i class="fas fa-search search-icon"></i>
                                    <input type="text" class="search-input" placeholder="Search sent requests..." id="sent-requests-search" oninput="searchSentRequests(this.value)">
                                </div>
                            </div>
                            <div class="section-filters">
                                <button class="filter-btn active" data-filter="all" onclick="filterSentRequestsBy('all')">
                                    All Requests <span class="filter-count" data-role="all">0</span>
                                </button>
                                <button class="filter-btn" data-filter="children" onclick="filterSentRequestsBy('children')">
                                     Children <span class="filter-count" data-role="children">0</span>
                                </button>
                                <button class="filter-btn" data-filter="tutors" onclick="filterSentRequestsBy('tutors')">
                                     Tutors <span class="filter-count" data-role="tutors">0</span>
                                </button>
                                <button class="filter-btn" data-filter="parents" onclick="filterSentRequestsBy('parents')">
                                     Parents <span class="filter-count" data-role="parents">0</span>
                                </button>
                            </div>
                            <div class="connections-grid" id="sentRequestsGrid" style="padding: 2rem;">
                                <div class="loading-container">
                                    <div class="loading-spinner"></div>
                                    <p class="loading-text">Loading sent requests...</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- EVENTS SECTION -->
                    <div id="events-section" class="community-section hidden">
                        <!-- Section Header with Search -->
                        <div class="section-header">
                            <div class="search-box">
                                <i class="fas fa-search search-icon"></i>
                                <input type="text" class="search-input" placeholder="Search events..." id="events-search" oninput="searchEvents(this.value)">
                            </div>
                        </div>
                        <!-- Section Filters (Tabs) -->
                        <div class="section-filters">
                            <button class="filter-btn" data-filter="past" onclick="filterEventsBy('past')">
                                 Past <span class="filter-count">0</span>
                            </button>
                            <button class="filter-btn active" data-filter="upcoming" onclick="filterEventsBy('upcoming')">
                                 Upcoming <span class="filter-count">0</span>
                            </button>
                            <button class="filter-btn" data-filter="joined" onclick="filterEventsBy('joined')">
                                ? Joined <span class="filter-count">0</span>
                            </button>
                        </div>
                        <!-- Events Grid -->
                        <div class="events-grid" id="eventsGrid" style="padding: 2rem;">
                            <div class="loading-container">
                                <div class="loading-spinner"></div>
                                <p class="loading-text">Loading events...</p>
                            </div>
                        </div>
                    </div>
                    <!-- CLUBS SECTION -->
                    <div id="clubs-section" class="community-section hidden">
                        <!-- Section Header with Search -->
                        <div class="section-header">
                            <div class="search-box">
                                <i class="fas fa-search search-icon"></i>
                                <input type="text" class="search-input" placeholder="Search clubs..." id="clubs-search" oninput="searchClubs(this.value)">
                            </div>
                        </div>
                        <!-- Section Filters (Tabs) -->
                        <div class="section-filters">
                            <button class="filter-btn active" data-filter="discover" onclick="filterClubsBy('discover')">
                                 Discover <span class="filter-count">0</span>
                            </button>
                            <button class="filter-btn" data-filter="joined" onclick="filterClubsBy('joined')">
                                ? Joined <span class="filter-count">0</span>
                            </button>
                        </div>
                        <!-- Clubs Grid -->
                        <div class="clubs-grid" id="clubsGrid" style="padding: 2rem;">
                            <div class="loading-container">
                                <div class="loading-spinner"></div>
                                <p class="loading-text">Loading clubs...</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Logout Modal -->
    <div id="logout-modal" class="modal hidden">
        <div class="modal-content enhanced" style="max-width: 420px;">
            <button class="modal-close-enhanced" onclick="closeModal('logout-modal')">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                </svg>
            </button>
            <div class="modal-header" style="text-align: center; padding: 32px 32px 16px;">
                <div style="width: 72px; height: 72px; background: rgba(239, 68, 68, 0.1); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 24px;">
                    <svg width="36" height="36" fill="none" stroke="#EF4444" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1">
                        </path>
                    </svg>
                </div>
                <h3 class="modal-title" style="margin-bottom: 8px;">Log Out?</h3>
                <p class="modal-subtitle" style="margin: 0;">Are you sure you want to log out of your account?</p>
            </div>
            <div style="padding: 24px 32px 32px;">
                <!-- Session info -->
                <div id="logout-session-info" style="background: var(--bg-secondary); border-radius: 12px; padding: 16px; margin-bottom: 24px; display: none;">
                    <div style="display: flex; align-items: center; gap: 12px;">
                        <div id="logout-user-avatar" style="width: 48px; height: 48px; border-radius: 50%; background: linear-gradient(135deg, var(--accent-color), var(--accent-hover)); display: flex; align-items: center; justify-content: center; color: white; font-weight: 600; font-size: 16px; flex-shrink: 0;">
                        </div>
                        <div style="flex: 1; min-width: 0;">
                            <p id="logout-user-name" style="margin: 0; font-weight: 600; color: var(--text-primary); font-size: 15px;"></p>
                            <p id="logout-user-email" style="margin: 4px 0 0; font-size: 13px; color: var(--text-muted);"></p>
                            <div id="logout-user-roles" style="display: flex; flex-wrap: wrap; gap: 6px; margin-top: 8px;">
                            </div>
                        </div>
                    </div>
                </div>
                <!-- Warning message -->
                <div style="background: rgba(245, 158, 11, 0.08); border: 1px solid rgba(245, 158, 11, 0.2); border-radius: 10px; padding: 14px; margin-bottom: 24px;">
                    <div style="display: flex; align-items: start; gap: 10px;">
                        <svg style="width: 20px; height: 20px; color: #F59E0B; flex-shrink: 0; margin-top: 1px;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path>
                        </svg>
                        <p style="margin: 0; font-size: 13px; color: var(--text-secondary); line-height: 1.5;">
                            You will need to sign in again to access your account and continue your learning journey.
                        </p>
                    </div>
                </div>
                <!-- Action buttons -->
                <div style="display: flex; gap: 12px;">
                    <button onclick="closeModal('logout-modal')" class="submit-btn" style="flex: 1; background: var(--bg-secondary); color: var(--text-primary); border: 1px solid var(--border-color);">
                        Stay Logged In
                    </button>
                    <button onclick="confirmLogout()" class="submit-btn" style="flex: 1; background: #EF4444; border-color: #EF4444;">
                        <svg style="width: 18px; height: 18px; margin-right: 6px;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7"></path>
                        </svg>
                        Log Out
                    </button>
                </div>
                <!-- Remember me option -->
                <div style="margin-top: 20px; text-align: center;">
                    <label style="display: inline-flex; align-items: center; gap: 8px; cursor: pointer; font-size: 13px; color: var(--text-muted);">
                        <input type="checkbox" id="logout-all-devices" style="width: 16px; height: 16px; accent-color: var(--accent-color);">
                        <span>Log out from all devices</span>
                    </label>
                </div>
            </div>
        </div>
    </div>
    <!-- Enhanced Footer -->
    <footer class="footer-section" id="footer" role="contentinfo">
        <div class="footer-wave" aria-hidden="true">
            <svg viewBox="0 0 1440 120" preserveAspectRatio="none">
                <defs>
                    <linearGradient id="wave-gradient" x1="0%" y1="0%" x2="100%" y2="0%">
                        <stop offset="0%" style="stop-color:var(--footer-accent);stop-opacity:0" />
                        <stop offset="25%" style="stop-color:var(--footer-accent);stop-opacity:1" />
                        <stop offset="75%" style="stop-color:var(--footer-hover);stop-opacity:1" />
                        <stop offset="100%" style="stop-color:var(--footer-hover);stop-opacity:0" />
                    </linearGradient>
                </defs>
                <!-- Main wave fill with explicit class -->
                <path class="wave-fill"
                    d="M0,64L48,69.3C96,75,192,85,288,80C384,75,480,53,576,48C672,43,768,53,864,58.7C960,64,1056,64,1152,58.7C1248,53,1344,43,1392,37.3L1440,32L1440,120L1392,120C1344,120,1248,120,1152,120C1056,120,960,120,864,120C768,120,672,120,576,120C480,120,384,120,288,120C192,120,96,120,48,120L0,120Z">
                </path>
                <!-- Animated line following the wave curve -->
                <path class="wave-line"
                    d="M0,64L48,69.3C96,75,192,85,288,80C384,75,480,53,576,48C672,43,768,53,864,58.7C960,64,1056,64,1152,58.7C1248,53,1344,43,1392,37.3L1440,32">
                </path>
            </svg>
        </div>
        <div class="container">
            <div class="footer-content">
                <div class="footer-section-item">
                    <h3 class="footer-title">About Astegni</h3>
                    <p class="footer-description">Ethiopia's premier educational platform connecting students with
                        expert tutors and quality learning resources.</p>
                    <div class="footer-stats">
                        <div class="stat-item">
                            <span class="stat-number">10k+</span>
                            <span class="stat-label">Active Users</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-number">500+</span>
                            <span class="stat-label">Courses</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-number">95%</span>
                            <span class="stat-label">Success Rate</span>
                        </div>
                    </div>
                </div>
                <div class="footer-section-item">
                    <h3 class="footer-title">Quick Links</h3>
                    <ul class="footer-links">
                        <li><a href="#" class="footer-link">About Us</a></li>
                        <li><a href="#" class="footer-link">How It Works</a></li>
                        <li><a href="#" class="footer-link">Pricing</a></li>
                        <li><a href="#" class="footer-link">Success Stories</a></li>
                        <li><a href="#" class="footer-link">Blog</a></li>
                        <li><a href="#" class="footer-link">Careers</a></li>
                    </ul>
                </div>
                <div class="footer-section-item">
                    <h3 class="footer-title">Support</h3>
                    <ul class="footer-links">
                        <li><a href="#" class="footer-link">Help Center</a></li>
                        <li><a href="#" class="footer-link">Contact Us</a></li>
                        <li><a href="#" class="footer-link">FAQs</a></li>
                        <li><a href="#" class="footer-link">Terms of Service</a></li>
                        <li><a href="#" class="footer-link">Privacy Policy</a></li>
                        <li><a href="#" class="footer-link">Safety</a></li>
                    </ul>
                </div>
                <div class="footer-section-item">
                    <h3 class="footer-title">Connect With Us</h3>
                    <div class="social-links">
                        <a href="#" aria-label="Facebook" class="social-link" target="_blank" rel="noopener noreferrer">
                            <svg class="w-6 h-6" width="20" height="20" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M18 2h-3a5 5 0 00-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 011-1h3V2z"></path>
                            </svg>
                        </a>
                        <a href="#" aria-label="Twitter" class="social-link" target="_blank" rel="noopener noreferrer">
                            <svg class="w-6 h-6" width="20" height="20" fill="currentColor" viewBox="0 0 24 24">
                                <path
                                    d="M23 3a10.9 10.9 0 01-3.14 1.53 4.48 4.48 0 00-7.86 3v1A10.66 10.66 0 013 4s-4 9 5 13a11.64 11.64 0 01-7 2c9 5 20 0 20-11.5a4.5 4.5 0 00-.08-.83A7.72 7.72 0 0023 3z">
                                </path>
                            </svg>
                        </a>
                        <a href="#" aria-label="LinkedIn" class="social-link" target="_blank" rel="noopener noreferrer">
                            <svg class="w-6 h-6" width="20" height="20" fill="currentColor" viewBox="0 0 24 24">
                                <path
                                    d="M16 8a6 6 0 016 6v7h-4v-7a2 2 0 00-2-2 2 2 0 00-2 2v7h-4v-7a6 6 0 016-6zM2 9h4v12H2z">
                                </path>
                                <circle cx="4" cy="4" r="2"></circle>
                            </svg>
                        </a>
                        <a href="#" aria-label="Instagram" class="social-link" target="_blank"
                            rel="noopener noreferrer">
                            <svg class="w-6 h-6" width="20" height="20" fill="currentColor" viewBox="0 0 24 24">
                                <rect x="2" y="2" width="20" height="20" rx="5" ry="5"></rect>
                                <path d="M16 11.37A4 4 0 1112.63 8 4 4 0 0116 11.37z"></path>
                                <line x1="17.5" y1="6.5" x2="17.51" y2="6.5"></line>
                            </svg>
                        </a>
                        <a href="https://www.youtube.com/@Astegni" aria-label="YouTube" class="social-link"
                            target="_blank" rel="noopener noreferrer">
                            <svg class="w-6 h-6" width="20" height="20" fill="currentColor" viewBox="0 0 24 24">
                                <path
                                    d="M22.54 6.42a2.78 2.78 0 00-1.94-2C18.88 4 12 4 12 4s-6.88 0-8.6.46a2.78 2.78 0 00-1.94 2A29 29 0 001 12a29 29 0 00.46 5.58A2.78 2.78 0 003.4 19.6c1.72.46 8.6.46 8.6.46s6.88 0 8.6-.46a2.78 2.78 0 001.94-2A29 29 0 0023 12a29 29 0 00-.46-5.58zM9.75 15.02V8.98L15.5 12l-5.75 3.02z">
                                </path>
                            </svg>
                        </a>
                    </div>
                    <div class="newsletter-signup">
                        <h4>Subscribe to Newsletter</h4>
                        <form class="newsletter-form" id="newsletterForm">
                            <input type="email" placeholder="Your email address" class="newsletter-input"
                                id="emailInput" aria-label="Email address" required>
                            <button type="submit" class="newsletter-btn" id="submitBtn">Subscribe</button>
                            <div class="newsletter-feedback" id="feedback"></div>
                        </form>
                    </div>
                </div>
            </div>
            <div class="footer-bottom-content">
                <div class="footer-badges">
                    <div class="company-brand">
                        <span>From the deep of</span>
                        <span class="trademark-symbol"></span>
                        <span class="company-text">Eshtaol</span>
                    </div>
                    <a href="tel:+251935244245" class="phone-link">
                        <span class="phone-icon"></span>
                        <span>+251-935-24-42-45</span>
                        <span>+251-997-40-98-66</span>
                    </a>
                </div>
                <div class="footer-badges">
                    <p class="copyright"> </p>
                    <p>2025 Astegni. All rights reserved.</p>
                </div>
                <div class="footer-badges">
                    <span class="badge glow" tabindex="0"> SSL Secured</span>
                    <span class="badge" tabindex="0">? Verified Platform</span>
                    <span class="badge" tabindex="0"> Future Awards Winner</span>
                </div>
            </div>
            <!-- TODO: counting cards should count from users where role = 'parent', 'student', 'tutor', etc... register-modal, reviews section professional-reviews-card should be enhanced. -->
        </div>
    </footer>
    <!-- Core Page Structure Scripts -->
    <!-- Note: Only loading existing manager files -->
    <script src="../js/page-structure/notificationManager.js"></script>
    <script src="../js/page-structure/initializationManager.js"></script>

    <!-- Share Profile Manager (Must load early for onclick handlers) -->
    <script src="../js/common-modals/share-profile-manager.js?v=20260204k"></script>

    <script src="../js/common-modals/communityManager.js"></script>
    <!-- Default Avatar Handler - prevents 404 errors for missing profile pictures -->
    <script src="../js/root/default-avatar.js"></script>
    <!-- Authentication Manager - MUST load before profile-specific code -->
    <script src="../js/root/auth.js?v=20260124"></script>
    <script src="../js/root/google-oauth.js"></script>
    <!-- Navigation - mobile menu handler -->
    <script src="../js/root/nav.js"></script>
    <!-- Theme Toggle - for theme persistence across pages -->
    <script src="../js/root/theme-toggle.js"></script>
    <!-- Access Restricted Modal - MUST load before ProfileCompletionGuard -->
    <script src="../js/common-modals/access-restricted-modal.js?v=20251229"></script>
    <!-- Profile Completion Guard - checks profile and KYC before protected features -->
    <script src="../js/root/profile-completion-guard.js?v=20251224"></script>
    <!-- Profile System -->
    <script src="../js/root/profile-system.js?v=20260124"></script>
    <!-- Common Modals -->
    <script src="../modals/common-modals/common-modal-loader.js"></script>
    <script src="../js/index/init-modals.js"></script>
    <script src="../js/common-modals/coming-soon-modal.js?v=20260205"></script>
    <script src="../js/common-modals/ad-modal.js"></script>
    <script src="../js/common-modals/ad-rotation-manager.js"></script>
    <!-- Two-Factor Authentication Manager -->
    <script src="../js/common-modals/tfa-manager.js?v=20251227"></script>
    <script src="../js/common-modals/role-manager.js?v=20260126"></script>
    <script src="../js/common-modals/logout-modal.js"></script>
    <!-- Subscription Modal JavaScript (Dynamic - fetches plans based on role) -->
    <script src="../js/common-modals/subscription-modal.js"></script>
    <script src="../js/common-modals/chat-modal.js"></script>
    <!-- Standalone Chat Call Modal JavaScript -->
    <script src="../js/common-modals/chat-call-modal.js"></script>
    <script src="../js/common-modals/truevoice-manager.js"></script>
    <script src="../js/common-modals/view-request-modal.js"></script>
    <script src="../js/common-modals/child-invitation-manager.js"></script>
    <!-- Stats Counter for Hero Section -->
    <script src="../js/find-tutors/stats-counter.js"></script>
    <!-- ============================================ -->
    <!-- PARENT PROFILE MODULES (Modularized)        -->
    <!-- Load in strict order for proper initialization -->
    <!-- ============================================ -->
    <!-- Parent Profile Modular System -->
    <!-- 1. API Service (Must load first) -->
    <script src="../js/parent-profile/api-service.js?v=20260205"></script>
    <!-- 2. Edit Handler -->
    <script src="../js/parent-profile/edit-handler.js"></script>
    <!-- 3. Upload Modal Handler -->
    <script src="../js/parent-profile/upload-modal-handler.js"></script>
    <!-- 3.3. Protected API Wrapper (2FA protection for settings, requests, my-children, co-parents panels) -->
    <!-- Note: Session requests on view-tutor.html are also 2FA protected (in session-request-handler.js) -->
    <script src="../js/common-modals/protected-api-wrapper.js"></script>

    <!-- 3.5. Panel Manager (for sidebar panel switching) -->
    <script src="../js/parent-profile/panel-manager.js"></script>
    <!-- 3.6. Tutors Panel Manager (loads tutors from enrolled_students) -->
    <script src="../js/parent-profile/tutors-panel-manager.js"></script>
    <!-- 3.7. Right Widgets Manager (manages right sidebar widgets) -->
    <script src="../js/parent-profile/right-widgets-manager.js?v=20260205b"></script>
    <!-- 4. Global Functions (for HTML onclick handlers) -->
    <script src="../js/parent-profile/global-functions.js"></script>

    <!-- 4.5 Sessions Panel Manager (manages dedicated sessions panel) -->
    <script src="../js/parent-profile/sessions-panel-manager.js?v=20260128"></script>

    <!-- 5. Main Parent Profile Script -->
    <script src="../js/parent-profile/parent-profile.js?v=20260205b"></script>
    <!-- 6. Session Requests Manager -->
    <script src="../js/parent-profile/session-requests-manager.js?v=20251230a"></script>
    <!-- 6.5. Schedule Manager (for schedules and sessions panels) -->
    <script src="../js/parent-profile/schedule-manager.js?v=20260129"></script>
    <!-- 7. Co-Parents Manager -->
    <script src="../js/parent-profile/coparents-manager.js"></script>
    <!-- 9. Co-Parent Portal Manager (provides parentPortalManager for invite modal) -->
    <script src="../js/parent-profile/coparent-portal-manager.js"></script>
    <!-- Load Invite Parent Modal from common-modals (used for inviting co-parents) -->
    <script>
        // Load invite parent modal dynamically
        fetch('../modals/common-modals/invite-parent-modal.html')
            .then(response => response.text())
            .then(html => {
                let container = document.getElementById('modal-container');
                if (!container) {
                    container = document.createElement('div');
                    container.id = 'modal-container';
                    document.body.appendChild(container);
                }
                container.insertAdjacentHTML('beforeend', html);

                // Execute scripts from the loaded HTML (innerHTML doesn't execute scripts)
                const scripts = container.querySelectorAll('script');
                scripts.forEach(script => {
                    const newScript = document.createElement('script');
                    if (script.src) {
                        newScript.src = script.src;
                    } else {
                        newScript.textContent = script.textContent;
                    }
                    document.body.appendChild(newScript);
                });
                console.log('? Invite Parent Modal loaded and scripts executed');
            })
            .catch(error => console.error('Failed to load invite-parent-modal:', error));

        // Create safe wrappers for all modal functions that load the modal if needed
        window.openAddChildModal = function() {
            // If the actual function exists, call it
            if (typeof window._openAddChildModalImpl === 'function') {
                window._openAddChildModalImpl();
            } else {
                // Modal not loaded yet, load it first then open
                console.log(' Add Child Modal not loaded yet, loading now...');
                loadAddChildModalOnce().then(() => {
                    if (typeof window._openAddChildModalImpl === 'function') {
                        window._openAddChildModalImpl();
                    }
                });
            }
        };

        window.closeAddChildModal = function() {
            if (typeof window._closeAddChildModalImpl === 'function') {
                window._closeAddChildModalImpl();
            } else {
                // Fallback: just hide the modal
                const modal = document.getElementById('addChildModal');
                if (modal) {
                    modal.classList.add('hidden');
                    modal.style.display = 'none';
                    document.body.style.overflow = '';
                }
            }
        };

        // Create safe wrapper for ChildInvitationManager
        window.ChildInvitationManager = new Proxy({}, {
            get: function(target, prop) {
                // If the real manager is loaded, use it
                if (window._ChildInvitationManagerImpl) {
                    const value = window._ChildInvitationManagerImpl[prop];
                    // If it's a function, bind it to the implementation object to preserve 'this' context
                    if (typeof value === 'function') {
                        return value.bind(window._ChildInvitationManagerImpl);
                    }
                    return value;
                }
                // Otherwise return a function that loads the modal first
                return function(...args) {
                    console.log(` ChildInvitationManager.${prop} called before modal loaded, loading now...`);
                    return loadAddChildModalOnce().then(() => {
                        if (window._ChildInvitationManagerImpl && typeof window._ChildInvitationManagerImpl[prop] === 'function') {
                            return window._ChildInvitationManagerImpl[prop].apply(window._ChildInvitationManagerImpl, args);
                        }
                    });
                };
            }
        });

        // Track if modal is being loaded to prevent duplicate loads
        let addChildModalLoading = false;
        let addChildModalLoaded = false;

        function loadAddChildModalOnce() {
            if (addChildModalLoaded) {
                return Promise.resolve();
            }
            if (addChildModalLoading) {
                // Wait for existing load to complete
                return new Promise(resolve => {
                    const checkInterval = setInterval(() => {
                        if (addChildModalLoaded) {
                            clearInterval(checkInterval);
                            resolve();
                        }
                    }, 100);
                });
            }

            addChildModalLoading = true;
            return fetch('../modals/parent-profile/add-child-modal.html')
                .then(response => response.text())
                .then(html => {
                    const container = document.getElementById('add-child-modal-container');
                    container.innerHTML = html;

                    // Execute scripts from the loaded HTML (innerHTML doesn't execute scripts)
                    const scripts = container.querySelectorAll('script');
                    scripts.forEach(script => {
                        const newScript = document.createElement('script');
                        if (script.src) {
                            newScript.src = script.src;
                        } else {
                            newScript.textContent = script.textContent;
                        }
                        document.body.appendChild(newScript);
                    });

                    // Wait a tick for scripts to execute
                    return new Promise(resolve => {
                        setTimeout(() => {
                            console.log('? Add Child Modal loaded and scripts executed');
                            console.log('ChildInvitationManager available?', typeof ChildInvitationManager !== 'undefined');
                            console.log('closeAddChildModal available?', typeof closeAddChildModal !== 'undefined');
                            console.log('_ChildInvitationManagerImpl available?', typeof window._ChildInvitationManagerImpl !== 'undefined');
                            if (window._ChildInvitationManagerImpl) {
                                console.log('_ChildInvitationManagerImpl.searchUsers:', typeof window._ChildInvitationManagerImpl.searchUsers);
                                console.log('_ChildInvitationManagerImpl.showAddNewChildForm:', typeof window._ChildInvitationManagerImpl.showAddNewChildForm);
                            }
                            console.log('ChildInvitationManager.searchUsers:', typeof window.ChildInvitationManager.searchUsers);
                            console.log('ChildInvitationManager.showAddNewChildForm:', typeof window.ChildInvitationManager.showAddNewChildForm);
                            addChildModalLoaded = true;
                            addChildModalLoading = false;
                            resolve();
                        }, 50);
                    });
                })
                .catch(error => {
                    console.error('Failed to load add-child-modal:', error);
                    addChildModalLoading = false;
                    throw error;
                });
        }

        // Pre-load the modal on page load
        loadAddChildModalOnce();
    </script>
    <!-- View Request Modal Container (loaded dynamically) -->
    <div id="view-request-modal-container"></div>

    <!-- Load Chat Modal -->
    <script>
        // Load chat modal HTML dynamically
        fetch('../modals/common-modals/chat-modal.html')
            .then(response => response.text())
            .then(html => {
                document.body.insertAdjacentHTML('beforeend', html);
                console.log('? Chat Modal loaded for parent-profile');

                if (typeof ChatModalManager !== 'undefined') {
                    ChatModalManager.init();
                    console.log('? ChatModalManager initialized');
                }
            })
            .catch(error => console.error('Failed to load chat-modal:', error));

        // Load standalone chat call modal HTML dynamically
        fetch('../modals/common-modals/chat-call-modal.html')
            .then(response => response.text())
            .then(html => {
                document.body.insertAdjacentHTML('beforeend', html);
                console.log('? Standalone Chat Call Modal loaded for parent-profile');
            })
            .catch(error => console.error('Failed to load chat-call-modal:', error));

        // Load view-request-modal HTML dynamically
        fetch('../modals/common-modals/view-request-modal.html')
            .then(response => response.text())
            .then(html => {
                document.getElementById('view-request-modal-container').innerHTML = html;
                console.log('? View Request Modal loaded for parent-profile');
            })
            .catch(error => console.error('Failed to load view-request-modal:', error));

        // Load schedule modal
        fetch('../modals/common-modals/schedule-modal.html')
            .then(response => response.text())
            .then(html => {
                document.body.insertAdjacentHTML('beforeend', html);
                console.log('? Schedule Modal loaded for parent-profile');
            })
            .catch(error => console.error('Failed to load schedule-modal:', error));

        // Load view schedule modal
        fetch('../modals/common-modals/view-schedule-modal.html')
            .then(response => response.text())
            .then(html => {
                document.body.insertAdjacentHTML('beforeend', html);
                console.log('? View Schedule Modal loaded for parent-profile');
            })
            .catch(error => console.error('Failed to load view-schedule-modal:', error));

        // Load confirm delete schedule modal
        fetch('../modals/common-modals/confirm-delete-schedule-modal.html')
            .then(response => response.text())
            .then(html => {
                document.body.insertAdjacentHTML('beforeend', html);
                console.log('? Confirm Delete Schedule Modal loaded for parent-profile');
            })
            .catch(error => console.error('Failed to load confirm-delete-schedule-modal:', error));
    </script>
    <!-- Earnings & Investments Manager -->
    <script src="../js/tutor-profile/earnings-investments-manager.js?v=20260205"></script>
    <!-- Common Modals -->
    <script src="../js/shared/sidebar-toggle.js"></script>
    <!-- Floating Action Button (FAB) for Quick Actions -->
    <div class="fab-container" style="position: fixed; bottom: 2rem; right: 2rem; z-index: 1000;">
        <!-- Main FAB Button -->
        <button class="fab-main" id="fabMain" onclick="toggleFabMenu()"
            style="width: 60px; height: 60px; border-radius: 50%; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border: none; color: white; font-size: 1.5rem; cursor: pointer; box-shadow: 0 8px 24px rgba(102, 126, 234, 0.4); transition: all 0.3s ease; display: flex; align-items: center; justify-content: center;">
            <span id="fabIcon">?</span>
        </button>
        <!-- FAB Menu Items -->
        <div class="fab-menu" id="fabMenu"
            style="position: absolute; bottom: 70px; right: 0; display: none; flex-direction: column; gap: 1rem;">
            <!-- My Children -->
            <div class="fab-item" onclick="navigateToContent('my-children')"
                style="display: flex; align-items: center; gap: 1rem; cursor: pointer; animation: fadeInUp 0.3s ease;">
                <span
                    style="background: white; color: #667eea; padding: 0.5rem; border-radius: 8px; font-size: 0.875rem; font-weight: 600; box-shadow: 0 4px 12px rgba(0,0,0,0.1); white-space: nowrap;">My
                    Children</span>
                <div
                    style="width: 48px; height: 48px; border-radius: 50%; background: linear-gradient(135deg, #667eea, #764ba2); display: flex; align-items: center; justify-content: center; color: white; font-size: 1.25rem; box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);">
                    
                </div>
            </div>
            <!-- Schedule -->
            <div class="fab-item" onclick="navigateToContent('schedule')"
                style="display: flex; align-items: center; gap: 1rem; cursor: pointer; animation: fadeInUp 0.3s ease 0.1s; animation-fill-mode: both; opacity: 0;">
                <span
                    style="background: white; color: #667eea; padding: 0.5rem; border-radius: 8px; font-size: 0.875rem; font-weight: 600; box-shadow: 0 4px 12px rgba(0,0,0,0.1); white-space: nowrap;">Schedule</span>
                <div
                    style="width: 48px; height: 48px; border-radius: 50%; background: linear-gradient(135deg, #22c55e, #16a34a); display: flex; align-items: center; justify-content: center; color: white; font-size: 1.25rem; box-shadow: 0 4px 12px rgba(34, 197, 94, 0.3);">
                    
                </div>
            </div>
            <!-- tutor-child -->
            <div class="fab-item" onclick="navigateToContent('tutor-child')"
                style="display: flex; align-items: center; gap: 1rem; cursor: pointer; animation: fadeInUp 0.3s ease 0.2s; animation-fill-mode: both; opacity: 0;">
                <span
                    style="background: white; color: #667eea; padding: 0.5rem; border-radius: 8px; font-size: 0.875rem; font-weight: 600; box-shadow: 0 4px 12px rgba(0,0,0,0.1); white-space: nowrap;">tutor-child</span>
                <div
                    style="width: 48px; height: 48px; border-radius: 50%; background: linear-gradient(135deg, #f59e0b, #d97706); display: flex; align-items: center; justify-content: center; color: white; font-size: 1.25rem; box-shadow: 0 4px 12px rgba(245, 158, 11, 0.3);">
                    
                </div>
            </div>
            <!-- Make Payment -->
            <div class="fab-item" onclick="navigateToContent('payment-center')"
                style="display: flex; align-items: center; gap: 1rem; cursor: pointer; animation: fadeInUp 0.3s ease 0.4s; animation-fill-mode: both; opacity: 0;">
                <span
                    style="background: white; color: #667eea; padding: 0.5rem; border-radius: 8px; font-size: 0.875rem; font-weight: 600; box-shadow: 0 4px 12px rgba(0,0,0,0.1); white-space: nowrap;">Make
                    Payment</span>
                <div
                    style="width: 48px; height: 48px; border-radius: 50%; background: linear-gradient(135deg, #ec4899, #d946ef); display: flex; align-items: center; justify-content: center; color: white; font-size: 1.25rem; box-shadow: 0 4px 12px rgba(236, 72, 153, 0.3);">
                    
                </div>
            </div>
        </div>
    </div>
    <style>
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        .fab-main:hover {
            transform: scale(1.1);
            box-shadow: 0 12px 32px rgba(102, 126, 234, 0.5);
        }
        .fab-main:active {
            transform: scale(0.95);
        }
        .fab-item:hover {
            transform: translateX(-5px);
        }
        .fab-item div:hover {
            transform: scale(1.1);
        }
    </style>
    <!-- ============================================ -->
    <!-- PROFILE MODAL FUNCTIONS                     -->
    <!-- ============================================ -->
    <script>
        // Edit Profile Modal Functions
        function openEditProfileModal() {
            const user = JSON.parse(localStorage.getItem('user') || '{}');
            const profile = user.profile || {};
            populateEditModal(profile);
        }

        function populateEditModal(profile) {
            // Populate basic fields (with null checks)
            const setValueIfExists = (id, value) => {
                const element = document.getElementById(id);
                if (element) element.value = value || '';
            };

            setValueIfExists('editName', profile.name || `${profile.first_name || ''} ${profile.father_name || ''} ${profile.grandfather_name || ''}`.trim());
            setValueIfExists('editUsername', profile.username);
            setValueIfExists('editRelationship', profile.relationship_type || 'Father');
            setValueIfExists('editEmail', profile.email);
            setValueIfExists('editPhone', profile.phone);
            setValueIfExists('editLocation', profile.location);
            setValueIfExists('editBio', profile.bio);
            setValueIfExists('editQuote', (profile.quote || '').replace(/["""]/g, ''));

            // Populate languages (if using old single-input approach)
            const languages = profile.languages || [];
            const editLanguagesField = document.getElementById('editLanguages');
            if (editLanguagesField) {
                editLanguagesField.value = Array.isArray(languages) ? languages.join(', ') : '';
            }

            // Populate social links (if using old individual input approach)
            const socialLinks = profile.social_links || {};
            setValueIfExists('editFacebook', socialLinks.facebook);
            setValueIfExists('editTwitter', socialLinks.twitter);
            setValueIfExists('editLinkedIn', socialLinks.linkedin);
            setValueIfExists('editInstagram', socialLinks.instagram);

            // Load display_location checkbox (show/hide location on public profile)
            const displayLocationCheckbox = document.getElementById('editDisplayLocation');
            if (displayLocationCheckbox) {
                displayLocationCheckbox.checked = profile.display_location === true;
                console.log('[Parent Edit] display_location loaded:', profile.display_location);
            }

            // Disable GPS checkbox if location exists (require "Change Location" button click to enable)
            const allowLocationCheckbox = document.getElementById('editAllowLocation');
            const changeLocationBtn = document.getElementById('changeLocationBtn');
            if (allowLocationCheckbox && profile.location) {
                allowLocationCheckbox.checked = false;
                allowLocationCheckbox.disabled = true; // Make unselectable
                // Show "Change Location" button
                if (changeLocationBtn) {
                    changeLocationBtn.classList.remove('hidden');
                }
                console.log('[Parent Edit] GPS checkbox disabled (location exists, click Change Location to modify)');
            } else if (allowLocationCheckbox) {
                allowLocationCheckbox.disabled = false;
                if (changeLocationBtn) {
                    changeLocationBtn.classList.add('hidden');
                }
            }

            // Open the modal
            const modal = document.getElementById('editProfileModal');
            if (modal) {
                modal.style.display = 'flex';
            }
        }
        function closeEditProfileModal() {
            const modal = document.getElementById('editProfileModal');
            modal.style.display = 'none';
        }
        function handleChangeLocationParent() {
            const allowLocationCheckbox = document.getElementById('editAllowLocation');
            const changeLocationBtn = document.getElementById('changeLocationBtn');

            if (allowLocationCheckbox) {
                allowLocationCheckbox.disabled = false; // Enable the checkbox
                allowLocationCheckbox.checked = false; // Uncheck it
                console.log('[Parent Edit] GPS checkbox enabled for location change');
            }

            if (changeLocationBtn) {
                changeLocationBtn.classList.add('hidden'); // Hide the button
            }
        }
        async function saveParentProfile() {
            // Get form values
            const username = document.getElementById('editUsername').value.trim();
            const relationship = document.getElementById('editRelationship').value;
            const location = document.getElementById('editLocation').value.trim();
            const bio = document.getElementById('editBio').value.trim();
            const quote = document.getElementById('editQuote').value.trim();

            // Get languages and convert to array
            const languagesInput = document.getElementById('editLanguages').value.trim();
            const languages = languagesInput ? languagesInput.split(',').map(lang => lang.trim()).filter(lang => lang) : [];

            // Get social links and build object
            const facebook = document.getElementById('editFacebook').value.trim();
            const twitter = document.getElementById('editTwitter').value.trim();
            const linkedin = document.getElementById('editLinkedIn').value.trim();
            const instagram = document.getElementById('editInstagram').value.trim();

            const social_links = {};
            if (facebook) social_links.facebook = facebook;
            if (twitter) social_links.twitter = twitter;
            if (linkedin) social_links.linkedin = linkedin;
            if (instagram) social_links.instagram = instagram;

            // Get display_location checkbox value
            const displayLocationCheckbox = document.getElementById('editDisplayLocation');
            const displayLocation = displayLocationCheckbox?.checked || false;
            console.log('[Parent Save] display_location value:', displayLocation);

            // Prepare profile data for API (only include fields supported by the backend)
            const profileData = {
                username: username || null,
                relationship_type: relationship,
                location: location || null,
                display_location: displayLocation,
                bio: bio || null,
                quote: quote || null,
                languages: languages,
                social_links: Object.keys(social_links).length > 0 ? social_links : null
            };
            // Show loading state
            const saveBtn = document.querySelector('#editProfileModal .btn-primary');
            const originalText = saveBtn.textContent;
            saveBtn.textContent = 'Saving...';
            saveBtn.disabled = true;
            try {
                // Save to database via API
                const result = await ParentProfileAPI.updateParentProfile(profileData);
                console.log('[ParentProfile] Profile saved:', result);
                // Update local display
                if (document.getElementById('parentUsername')) {
                    if (username) {
                        document.getElementById('parentUsername').textContent = `@${username}`;
                        document.getElementById('parentUsername').style.display = 'block';
                    } else {
                        document.getElementById('parentUsername').style.display = 'none';
                    }
                }
                if (document.getElementById('parent-relationship')) {
                    document.getElementById('parent-relationship').textContent = relationship;
                }
                if (document.getElementById('parent-location')) {
                    document.getElementById('parent-location').textContent = location || 'Location not set';
                }
                if (document.getElementById('parent-bio')) {
                    document.getElementById('parent-bio').textContent = bio || 'Dedicated to supporting my children\'s educational journey.';
                }
                if (document.getElementById('parent-quote')) {
                    document.getElementById('parent-quote').textContent = quote ? `"${quote}"` : '"Education is the key to unlocking my children\'s potential."';
                }
                // Update stored profile data
                if (window.parentProfileData) {
                    window.parentProfileData.username = username;
                    window.parentProfileData.relationship_type = relationship;
                    window.parentProfileData.location = location;
                    window.parentProfileData.bio = bio;
                    window.parentProfileData.quote = quote;
                    window.parentProfileData.languages = languages;
                    window.parentProfileData.social_links = social_links;
                }
                // Close modal
                closeEditProfileModal();
                // Show success message
                if (typeof showNotification === 'function') {
                    showNotification('Profile updated successfully!', 'success');
                } else {
                    alert('Profile updated successfully!');
                }
            } catch (error) {
                console.error('[ParentProfile] Error saving profile:', error);
                if (typeof showNotification === 'function') {
                    showNotification('Failed to save profile. Please try again.', 'error');
                } else {
                    alert('Failed to save profile. Please try again.');
                }
            } finally {
                // Restore button state
                saveBtn.textContent = originalText;
                saveBtn.disabled = false;
            }
        }
        // Close modal when clicking outside
        window.addEventListener('click', function (event) {
            const modal = document.getElementById('editProfileModal');
            if (event.target === modal) {
                closeEditProfileModal();
            }
        });
        // Note: Profile loading is now handled by loadUserProfile() in parent-profile.js
        // which calls ParentProfileAPI.getParentProfile() from api-service.js
    </script>
    <!-- ============================================ -->
    <!-- FAB MENU FUNCTIONS                          -->
    <!-- ============================================ -->
    <script>
        // FAB (Floating Action Button) Menu Toggle
        let fabOpen = false;
        function toggleFabMenu() {
            fabOpen = !fabOpen;
            const fabMenu = document.querySelector('.fab-menu');
            const fabIcon = document.getElementById('fabIcon');
            const fabMain = document.getElementById('fabMain');
            if (fabOpen) {
                fabMenu.style.display = 'flex';
                fabIcon.textContent = '?';
                fabMain.style.transform = 'rotate(180deg)';
            } else {
                fabMenu.style.display = 'none';
                fabIcon.textContent = '?';
                fabMain.style.transform = 'rotate(0deg)';
            }
        }
        // Close FAB menu when clicking outside
        document.addEventListener('click', function (event) {
            const fabContainer = document.querySelector('.fab-container');
            if (fabOpen && !fabContainer.contains(event.target)) {
                toggleFabMenu();
            }
        });
    </script>
    <!-- ============================================ -->
    <!-- WIDGET ANIMATIONS                           -->
    <!-- ============================================ -->
    <script>
        // News Carousel Auto-Rotation
        const newsCards = document.querySelectorAll('.news-card');
        let currentNewsIndex = 0;
        const newsInterval = 5000; // 5 seconds

        function rotateNews() {
            // Hide current card
            newsCards[currentNewsIndex].style.display = 'none';
            newsCards[currentNewsIndex].style.opacity = '0';
            newsCards[currentNewsIndex].classList.remove('active');
            // Move to next card
            currentNewsIndex = (currentNewsIndex + 1) % newsCards.length;
            // Show next card
            newsCards[currentNewsIndex].style.display = 'block';
            setTimeout(() => {
                newsCards[currentNewsIndex].style.opacity = '1';
                newsCards[currentNewsIndex].classList.add('active');
            }, 50);
        }
        // Start auto-rotation
        if (newsCards.length > 1) {
            setInterval(rotateNews, newsInterval);
        }
        // Manual navigation (optional)
        function showNewsCard(index) {
            if (index >= 0 && index < newsCards.length) {
                newsCards[currentNewsIndex].style.display = 'none';
                newsCards[currentNewsIndex].style.opacity = '0';
                newsCards[currentNewsIndex].classList.remove('active');
                currentNewsIndex = index;
                newsCards[currentNewsIndex].style.display = 'block';
                setTimeout(() => {
                    newsCards[currentNewsIndex].style.opacity = '1';
                    newsCards[currentNewsIndex].classList.add('active');
                }, 50);
            }
        }
    </script>
    <script>
        // Market Value Animation
        function animateMarketNumber(element, targetValue) {
            const duration = 1000; // 1 second
            const steps = 60;
            const increment = targetValue / steps;
            let current = 0;
            let step = 0;
            const timer = setInterval(() => {
                current += increment;
                step++;
                if (step >= steps) {
                    current = targetValue;
                    clearInterval(timer);
                }
                element.textContent = current.toFixed(2);
            }, duration / steps);
        }
        // Animate market values on load
        window.addEventListener('load', () => {
            // Bank sector value
            const bankValue = document.querySelector('.exchange-item:nth-child(1) .rate');
            if (bankValue) animateMarketNumber(bankValue, 1245.67);
            // Telecom sector value
            const telecomValue = document.querySelector('.exchange-item:nth-child(2) .rate');
            if (telecomValue) animateMarketNumber(telecomValue, 892.45);
        });
        // Pulse animation for change indicators
        const changeIndicators = document.querySelectorAll('.change.up');
        changeIndicators.forEach(indicator => {
            setInterval(() => {
                indicator.style.transform = 'scale(1.1)';
                setTimeout(() => {
                    indicator.style.transform = 'scale(1)';
                }, 300);
            }, 2000);
        });
    </script>
    <!-- ============================================ -->
    <!-- MODAL HELPER FUNCTIONS                      -->
    <!-- ============================================ -->
    <script>
        // Modal Helper Functions (if not already defined elsewhere)
        function openModal(modalId) {
            const modal = document.getElementById(modalId);
            if (modal) {
                modal.classList.remove('hidden');
                modal.classList.add('active');
                modal.style.display = 'flex';
                document.body.style.overflow = 'hidden';
            }
        }
        function closeModal(modalId) {
            const modal = document.getElementById(modalId);
            if (modal) {
                modal.classList.add('hidden');
                modal.classList.remove('active');
                modal.style.display = 'none';
                document.body.style.overflow = '';
            }
        }
        // Close modals on ESC key
        document.addEventListener('keydown', function (event) {
            if (event.key === 'Escape') {
                // Close coming soon modal
                const comingSoonModal = document.getElementById('coming-soon-modal');
                if (comingSoonModal && !comingSoonModal.classList.contains('hidden')) {
                    closeModal('coming-soon-modal');
                }
                // Close ad analytics modal
                const adModal = document.getElementById('adAnalyticsModal');
                if (adModal && !adModal.classList.contains('hidden')) {
                    closeAdAnalyticsModal();
                }
            }
        });
        // ============================================
        // RATINGS & REVIEWS: STAR FILTERING SYSTEM
        // ============================================
        // Initialize star filtering when DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            initializeStarFiltering();
        });
        function initializeStarFiltering() {
            const starFilterTabs = document.querySelectorAll('.star-filter-tab');
            if (starFilterTabs.length === 0) return; // Exit if not on ratings page
            // Add click event to each star filter tab
            starFilterTabs.forEach(tab => {
                tab.addEventListener('click', function() {
                    const filterValue = this.getAttribute('data-filter');
                    // Update active state
                    starFilterTabs.forEach(t => t.classList.remove('active'));
                    this.classList.add('active');
                    // Filter reviews
                    filterReviewsByStars(filterValue);
                });
            });
        }
        function filterReviewsByStars(filterValue) {
            const reviewCards = document.querySelectorAll('.review-card');
            reviewCards.forEach(card => {
                const cardStars = card.getAttribute('data-stars');
                if (filterValue === 'all') {
                    // Show all reviews
                    card.classList.remove('hidden');
                } else {
                    // Show only matching star ratings
                    if (cardStars === filterValue) {
                        card.classList.remove('hidden');
                    } else {
                        card.classList.add('hidden');
                    }
                }
            });
            // Update empty state visibility
            updateEmptyState(filterValue);
        }
        function updateEmptyState(filterValue) {
            const reviewsContainer = document.querySelector('.reviews-container');
            const emptyState = document.querySelector('.empty-state');
            if (!reviewsContainer || !emptyState) return;
            const visibleReviews = reviewsContainer.querySelectorAll('.review-card:not(.hidden)');
            if (visibleReviews.length === 0) {
                emptyState.classList.remove('hidden');
                // Update empty state message based on filter
                const emptyMessage = emptyState.querySelector('p');
                if (emptyMessage) {
                    if (filterValue === 'all') {
                        emptyMessage.textContent = 'No reviews yet';
                    } else {
                        emptyMessage.textContent = `No ${filterValue}-star reviews found`;
                    }
                }
            } else {
                emptyState.classList.add('hidden');
            }
        }
        // ============================================
        // REVIEW RATING TOOLTIPS: ENHANCED INTERACTIONS
        // ============================================
        // Add smooth tooltip animations on hover
        document.addEventListener('DOMContentLoaded', function() {
            const reviewRatingWrappers = document.querySelectorAll('.review-rating-wrapper');
            reviewRatingWrappers.forEach(wrapper => {
                const tooltip = wrapper.querySelector('.review-rating-tooltip');
                if (!tooltip) return;
                // Add hover effects
                wrapper.addEventListener('mouseenter', function() {
                    tooltip.style.pointerEvents = 'auto';
                });
                wrapper.addEventListener('mouseleave', function() {
                    tooltip.style.pointerEvents = 'none';
                });
            });
        });
        // ============================================
        // HELPFUL BUTTON INTERACTIONS
        // ============================================
        document.addEventListener('DOMContentLoaded', function() {
            const helpfulButtons = document.querySelectorAll('.helpful-btn');
            helpfulButtons.forEach(button => {
                button.addEventListener('click', function(e) {
                    e.preventDefault();
                    // Toggle helpful state
                    if (this.classList.contains('marked-helpful')) {
                        this.classList.remove('marked-helpful');
                        this.style.background = '';
                        this.style.color = '';
                        // Decrement count
                        const currentCount = parseInt(this.textContent.match(/\d+/)[0]);
                        this.innerHTML = `<i class="fas fa-thumbs-up"></i> Helpful (${currentCount - 1})`;
                    } else {
                        this.classList.add('marked-helpful');
                        this.style.background = 'var(--button-bg)';
                        this.style.color = 'white';
                        // Increment count
                        const currentCount = parseInt(this.textContent.match(/\d+/)[0]);
                        this.innerHTML = `<i class="fas fa-thumbs-up"></i> Helpful (${currentCount + 1})`;
                        // Add animation
                        this.style.transform = 'scale(1.1)';
                        setTimeout(() => {
                            this.style.transform = '';
                        }, 200);
                    }
                });
            });
        });
        // ============================================
        // METRIC CARDS: HOVER EFFECTS
        // ============================================
        document.addEventListener('DOMContentLoaded', function() {
            const metricCards = document.querySelectorAll('.metric-card');
            metricCards.forEach(card => {
                card.addEventListener('mouseenter', function() {
                    const ratingNumber = this.querySelector('.metric-rating-number');
                    if (ratingNumber) {
                        ratingNumber.style.transform = 'scale(1.1)';
                        ratingNumber.style.transition = 'transform 0.3s ease';
                    }
                });
                card.addEventListener('mouseleave', function() {
                    const ratingNumber = this.querySelector('.metric-rating-number');
                    if (ratingNumber) {
                        ratingNumber.style.transform = '';
                    }
                });
            });
        });
        console.log('? Ratings & Reviews Panel: Fully initialized with star filtering and interactive tooltips');
        // ============================================
        // COMMUNITY MODAL: INITIALIZATION & FUNCTIONS
        // ============================================
        // Initialize CommunityManager instance
        let communityManager;
        document.addEventListener('DOMContentLoaded', function() {
            communityManager = new CommunityManager();
            // Make communityManager available globally for onclick handlers in rendered cards
            window.communityManager = communityManager;
            console.log('? CommunityManager initialized for parent profile');
        });
        // ============================================
        // COMMUNITY MODAL: OPEN/CLOSE FUNCTIONS
        // ============================================
        function openCommunityModal() {
            const modal = document.getElementById('communityModal');
            if (modal) {
                modal.classList.remove('hidden');
                modal.style.display = 'flex';
                document.body.style.overflow = 'hidden';
                // Load connections by default
                if (communityManager) {
                    communityManager.loadSectionGrid('connections', 'all');
                }
            }
        }
        function closeCommunityModal() {
            const modal = document.getElementById('communityModal');
            if (modal) {
                modal.classList.add('hidden');
                modal.style.display = 'none';
                document.body.style.overflow = '';
            }
        }
        // Close modal on ESC key
        document.addEventListener('keydown', function(event) {
            if (event.key === 'Escape') {
                const communityModal = document.getElementById('communityModal');
                if (communityModal && !communityModal.classList.contains('hidden')) {
                    closeCommunityModal();
                }
            }
        });
        // ============================================
        // COMMUNITY MODAL: MAIN SECTION SWITCHING
        // ============================================
        function switchCommunityMainSection(sectionName) {
            console.log('Switching to section:', sectionName);
            // Update sidebar menu active state
            const menuItems = document.querySelectorAll('.community-menu .menu-item');
            menuItems.forEach(item => {
                if (item.getAttribute('data-section') === sectionName) {
                    item.classList.add('active');
                } else {
                    item.classList.remove('active');
                }
            });
            // Update modal title
            const titleElement = document.getElementById('communityModalTitle');
            if (titleElement) {
                const titles = {
                    'connections': 'Connections',
                    'requests': 'Connection Requests',
                    'events': 'Events',
                    'clubs': 'Clubs'
                };
                titleElement.textContent = titles[sectionName] || 'Community';
            }
            // Update sections visibility
            const sections = document.querySelectorAll('.community-section');
            sections.forEach(section => {
                if (section.id === sectionName + '-section') {
                    section.classList.remove('hidden');
                    section.classList.add('active');
                } else {
                    section.classList.add('hidden');
                    section.classList.remove('active');
                }
            });
            // Load data for the section
            if (communityManager) {
                if (sectionName === 'connections') {
                    communityManager.loadSectionGrid('connections', 'all');
                } else if (sectionName === 'requests') {
                    // Load received requests by default
                    communityManager.loadRequestTab('received', 'all');
                } else if (sectionName === 'events') {
                    communityManager.loadSectionGrid('events');
                } else if (sectionName === 'clubs') {
                    communityManager.loadSectionGrid('clubs');
                }
            }
        }
        // ============================================
        // CONNECTIONS: TAB FILTERING
        // ============================================
        function filterConnectionsBy(category) {
            console.log('Filtering connections by:', category);
            // Update filter buttons active state
            const filterBtns = document.querySelectorAll('#connections-section .filter-btn');
            filterBtns.forEach(btn => {
                if (btn.getAttribute('data-filter') === category) {
                    btn.classList.add('active');
                } else {
                    btn.classList.remove('active');
                }
            });
            // Map 'children' to 'student' for API compatibility (parent's children are students)
            const apiCategory = category === 'children' ? 'student' : category;
            // Load connections with category filter
            if (communityManager) {
                communityManager.loadSectionGrid('connections', apiCategory);
            }
        }
        function searchConnections(query) {
            console.log('Searching connections:', query);
            if (communityManager) {
                communityManager.searchConnections(query, 'connections');
            }
        }
        // ============================================
        // EVENTS: TAB FILTERING
        // ============================================
        function filterEventsBy(filterType) {
            console.log('Filtering events by:', filterType);
            // Update filter buttons active state
            const filterBtns = document.querySelectorAll('#events-section .filter-btn');
            filterBtns.forEach(btn => {
                if (btn.getAttribute('data-filter') === filterType) {
                    btn.classList.add('active');
                } else {
                    btn.classList.remove('active');
                }
            });
            // TODO: Implement event filtering by type (past/upcoming/joined)
            // For now just reload all events
            if (communityManager) {
                communityManager.loadSectionGrid('events');
            }
        }
        function searchEvents(query) {
            console.log('Searching events:', query);
            // TODO: Implement event search
        }
        // ============================================
        // CLUBS: TAB FILTERING
        // ============================================
        function filterClubsBy(filterType) {
            console.log('Filtering clubs by:', filterType);
            // Update filter buttons active state
            const filterBtns = document.querySelectorAll('#clubs-section .filter-btn');
            filterBtns.forEach(btn => {
                if (btn.getAttribute('data-filter') === filterType) {
                    btn.classList.add('active');
                } else {
                    btn.classList.remove('active');
                }
            });
            // TODO: Implement club filtering by type (discover/joined)
            // For now just reload all clubs
            if (communityManager) {
                communityManager.loadSectionGrid('clubs');
            }
        }
        function searchClubs(query) {
            console.log('Searching clubs:', query);
            // TODO: Implement club search
        }
        // ============================================
        // PLACEHOLDER FUNCTIONS
        // ============================================
        function openAddConnectionModal() {
            alert('Add Connection feature coming soon!');
            // TODO: Implement add connection modal
        }
        function viewEvent(eventId) {
            console.log('View event:', eventId);
            alert('Event details coming soon!');
        }
        function joinEvent(eventId) {
            console.log('Join event:', eventId);
            alert('Join event feature coming soon!');
        }
        function viewClub(clubId) {
            console.log('View club:', clubId);
            alert('Club details coming soon!');
        }
        function joinClub(clubId) {
            console.log('Join club:', clubId);
            alert('Join club feature coming soon!');
        }
        // ============================================
        // REQUESTS TAB: TAB SWITCHING & FILTERING
        // ============================================
        function switchRequestTab(tab) {
            console.log('Switching to request tab:', tab);
            // Update tab button styles
            const tabBtns = document.querySelectorAll('.request-tab-btn');
            tabBtns.forEach(btn => {
                if (btn.getAttribute('data-tab') === tab) {
                    btn.style.background = 'var(--button-bg)';
                    btn.style.color = 'white';
                    btn.style.border = 'none';
                    btn.classList.add('active');
                } else {
                    btn.style.background = 'transparent';
                    btn.style.color = 'var(--text)';
                    btn.style.border = '1px solid rgba(var(--border-rgb), 0.3)';
                    btn.classList.remove('active');
                }
            });
            // Show/hide content
            const receivedContent = document.getElementById('received-requests-content');
            const sentContent = document.getElementById('sent-requests-content');
            if (tab === 'received') {
                receivedContent.classList.remove('hidden');
                sentContent.classList.add('hidden');
                // Load received requests
                if (communityManager) {
                    communityManager.loadRequestTab('received', 'all');
                }
            } else {
                receivedContent.classList.add('hidden');
                sentContent.classList.remove('hidden');
                // Load sent requests
                if (communityManager) {
                    communityManager.loadRequestTab('sent', 'all');
                }
            }
        }
        function filterReceivedRequestsBy(category) {
            console.log('Filtering received requests by:', category);
            // Update filter buttons
            const filterBtns = document.querySelectorAll('#received-requests-content .filter-btn');
            filterBtns.forEach(btn => {
                if (btn.getAttribute('data-filter') === category) {
                    btn.classList.add('active');
                } else {
                    btn.classList.remove('active');
                }
            });
            // Map 'children' to 'student' for API compatibility
            const apiCategory = category === 'children' ? 'student' : category;
            // Load filtered requests
            if (communityManager) {
                communityManager.loadRequestTab('received', apiCategory);
            }
        }
        function filterSentRequestsBy(category) {
            console.log('Filtering sent requests by:', category);
            // Update filter buttons
            const filterBtns = document.querySelectorAll('#sent-requests-content .filter-btn');
            filterBtns.forEach(btn => {
                if (btn.getAttribute('data-filter') === category) {
                    btn.classList.add('active');
                } else {
                    btn.classList.remove('active');
                }
            });
            // Map 'children' to 'student' for API compatibility
            const apiCategory = category === 'children' ? 'student' : category;
            // Load filtered requests
            if (communityManager) {
                communityManager.loadRequestTab('sent', apiCategory);
            }
        }
        function searchReceivedRequests(query) {
            console.log('Searching received requests:', query);
            if (communityManager) {
                communityManager.searchRequestTab('received', query);
            }
        }
        function searchSentRequests(query) {
            console.log('Searching sent requests:', query);
            if (communityManager) {
                communityManager.searchRequestTab('sent', query);
            }
        }
        console.log('? Community Modal: Fully initialized with sidebar navigation, database integration, and dynamic loading');
    </script>
    <!-- Parent Community Manager -->
    <script src="../js/parent-profile/parent-community-manager.js"></script>
    <!-- Events Panel Manager (NEW: Handles standalone Events panel) -->
    <script src="../js/parent-profile/events-panel-manager.js?v=20260130"></script>
    <script>
        // ============================================
        //   BOOKSTORE WIDGET - FADE IN/OUT ANIMATION
        // ============================================
        (function () {
            const bookstoreTitles = [
                { icon: '??', text: 'Fiction & Novels', emoji: '??' },
                { icon: '??', text: 'Science Textbooks', emoji: '??' },
                { icon: '', text: 'Mathematics Books', emoji: '' },
                { icon: '', text: 'Trending Books', emoji: '' },
                { icon: '', text: 'Special Discounts', emoji: '' },
                { icon: '', text: 'Bundle Deals', emoji: '' },
                { icon: '', text: 'Coming Soon!', emoji: '' }
            ];
            let currentBookIndex = 0;
            const bookstoreTitleContainer = document.querySelector('.bookstore-title-animated');
            const bookstoreIcon = document.querySelector('.bookstore-icon');
            if (bookstoreTitleContainer && bookstoreIcon) {
                const titleElement = bookstoreTitleContainer.querySelector('.bookstore-title');
                function animateBookstoreTitle() {
                    // Fade out
                    titleElement.style.opacity = '0';
                    titleElement.style.transform = 'translateY(-10px)';
                    setTimeout(() => {
                        // Update content
                        currentBookIndex = (currentBookIndex + 1) % bookstoreTitles.length;
                        const currentTitle = bookstoreTitles[currentBookIndex];
                        titleElement.textContent = currentTitle.text;
                        bookstoreIcon.textContent = currentTitle.icon;
                        // Fade in
                        titleElement.style.transform = 'translateY(10px)';
                        setTimeout(() => {
                            titleElement.style.opacity = '1';
                            titleElement.style.transform = 'translateY(0)';
                        }, 50);
                    }, 600);
                }
                // Start animation every 3 seconds
                setInterval(animateBookstoreTitle, 3000);
            }
        })();
        // ============================================
        //   GAMESTORE WIDGET - FADE IN/OUT ANIMATION
        // ============================================
        (function () {
            const gamestoreTitles = [
                { icon: '', text: 'Educational Games', emoji: '' },
                { icon: '', text: 'Puzzle Games', emoji: '' },
                { icon: '', text: 'Strategy Games', emoji: '' },
                { icon: '', text: 'Top Rated Games', emoji: '' },
                { icon: '', text: 'Trending Games', emoji: '' },
                { icon: '', text: 'Special Discounts', emoji: '' },
                { icon: '', text: 'Bundle Deals', emoji: '' },
                { icon: '', text: 'Coming Soon!', emoji: '' }
            ];
            let currentGameIndex = 0;
            const gamestoreTitleContainer = document.querySelector('.gamestore-title-animated');
            const gamestoreIcon = document.querySelector('.gamestore-icon');
            if (gamestoreTitleContainer && gamestoreIcon) {
                const titleElement = gamestoreTitleContainer.querySelector('.gamestore-title');
                function animateGamestoreTitle() {
                    // Fade out
                    titleElement.style.opacity = '0';
                    titleElement.style.transform = 'translateY(-10px)';
                    setTimeout(() => {
                        // Update content
                        currentGameIndex = (currentGameIndex + 1) % gamestoreTitles.length;
                        const currentTitle = gamestoreTitles[currentGameIndex];
                        titleElement.textContent = currentTitle.text;
                        gamestoreIcon.textContent = currentTitle.icon;
                        // Fade in
                        titleElement.style.transform = 'translateY(10px)';
                        setTimeout(() => {
                            titleElement.style.opacity = '1';
                            titleElement.style.transform = 'translateY(0)';
                        }, 50);
                    }, 600);
                }
                // Start animation every 3 seconds
                setInterval(animateGamestoreTitle, 3000);
            }
        })();
    </script>

    <!-- Settings Panel Modal Scripts -->
    <script src="../js/tutor-profile/settings-panel-personal-verification.js"></script>
    <script src="../js/tutor-profile/payment-method-modal.js"></script>
    <script src="../js/common-modals/leave-astegni-modal.js?v=20260127"></script>
    <!-- Appearance Manager (Theme, Font Size, Display Density, etc.) -->
    <script src="../js/common-modals/appearance-manager.js?v=20260127"></script>
    <script src="../js/common-modals/settings-manager.js"></script>
    <script src="../js/common-modals/review-astegni-manager.js"></script>

    <!-- Load Settings Modals HTML -->
    <script>
        // Load verify-personal-info-modal HTML dynamically
        fetch('../modals/common-modals/verify-personal-info-modal.html')
            .then(response => response.text())
            .then(html => {
                let container = document.getElementById('modal-container');
                if (!container) {
                    container = document.createElement('div');
                    container.id = 'modal-container';
                    document.body.appendChild(container);
                }
                container.insertAdjacentHTML('beforeend', html);
                console.log('[OK] Verify Personal Info Modal loaded');
            })
            .catch(error => console.error('Failed to load verify-personal-info-modal:', error));

        // Load payment-method-modal
        fetch('../modals/common-modals/payment-method-modal.html')
            .then(response => response.text())
            .then(html => {
                let container = document.getElementById('modal-container');
                if (!container) {
                    container = document.createElement('div');
                    container.id = 'modal-container';
                    document.body.appendChild(container);
                }
                container.insertAdjacentHTML('beforeend', html);
                console.log('[OK] Payment Method Modal loaded');
            })
            .catch(error => console.error('Failed to load payment-method-modal:', error));

        // Load leave-astegni-modal
        fetch('../modals/common-modals/leave-astegni-modal.html')
            .then(response => response.text())
            .then(html => {
                let container = document.getElementById('modal-container');
                if (!container) {
                    container = document.createElement('div');
                    container.id = 'modal-container';
                    document.body.appendChild(container);
                }
                container.insertAdjacentHTML('beforeend', html);
                console.log('[OK] Leave Astegni Modal loaded');
            })
            .catch(error => console.error('Failed to load leave-astegni-modal:', error));

        // Load review-astegni-modal HTML dynamically
        (function loadReviewAstegniModal() {
            fetch('../modals/common-modals/review-astegni-modal.html')
                .then(response => response.text())
                .then(html => {
                    let container = document.getElementById('modal-container');
                    if (!container) {
                        container = document.createElement('div');
                        container.id = 'modal-container';
                        document.body.appendChild(container);
                    }
                    container.insertAdjacentHTML('beforeend', html);
                    console.log('? Review Astegni Modal loaded for parent-profile');
                })
                .catch(error => console.error('Failed to load review-astegni-modal:', error));
        })();
    </script>

    <!-- jsPDF for PDF Export in Notes -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

    <!-- Advanced Notes Manager -->
    <script src="../js/common-modals/advanced-notes.js"></script>

    <!-- Load Notes Modal HTML -->
    <script>
        // Initialize Notes Manager after loading
        if (typeof NotesManager !== 'undefined') {
            NotesManager.init();
            console.log('[OK] NotesManager initialized');
        }
    </script>

    <!-- Deletion Countdown Banner (shows when user has pending role deletion) -->
    <script src="../js/common-modals/deletion-countdown-banner.js"></script>

    <!-- Ad Rotation Manager -->
    <script src="../js/common-modals/ad-rotation-manager.js"></script>

    <!-- Geolocation Utilities for GPS-based location detection -->
    <script src="../js/utils/geolocation-utils.js"></script>

    <!-- Currency Utilities for dynamic currency display -->
    <script src="../js/utils/currency-utils.js"></script>

    <!-- Course and School Request Managers -->
    <script src="../js/tutor-profile/course-request-manager.js"></script>
    <script src="../js/common-modals/school-request-manager.js"></script>

    <!-- Helper functions for location -->
    <script>
        // Helper function to get current location value
        window.getLocations = function() {
            const locationInput = document.getElementById('editLocation');
            return locationInput ? [locationInput.value.trim()].filter(v => v) : [];
        };
    </script>

    <!-- Share Profile Manager - MOVED EARLIER (after initializationManager.js) to ensure onclick handlers work -->

    <!-- Referral Dashboard Manager -->
    <script src="../js/common-modals/referral-dashboard-manager.js"></script>

    <!-- Debug Share Button -->
    <script>
        // Debug: Check if shareProfile is loaded
        console.log('[DEBUG] shareProfile function exists:', typeof shareProfile);
        console.log('[DEBUG] localStorage.currentUser:', !!localStorage.getItem('currentUser'));
        console.log('[DEBUG] localStorage.user:', !!localStorage.getItem('user'));
        console.log('[DEBUG] localStorage.token:', !!localStorage.getItem('token'));
        console.log('[DEBUG] localStorage.userRole:', localStorage.getItem('userRole'));
        console.log('[DEBUG] localStorage.active_role:', localStorage.getItem('active_role'));

        // Wrap shareProfile to add logging
        if (typeof shareProfile === 'function') {
            const originalShareProfile = window.shareProfile;
            window.shareProfile = async function() {
                console.log('[DEBUG] shareProfile() called!');
                console.log('[DEBUG] Arguments:', arguments);
                try {
                    const result = await originalShareProfile.apply(this, arguments);
                    console.log('[DEBUG] shareProfile() completed successfully');
                    return result;
                } catch (error) {
                    console.error('[DEBUG] shareProfile() error:', error);
                    alert('Debug: Error in shareProfile - ' + error.message);
                    throw error;
                }
            };
            console.log('[DEBUG] shareProfile() wrapper installed');
        } else {
            console.error('[DEBUG] shareProfile() NOT FOUND! Script may not have loaded.');
        }
    </script>

</body>
</html>

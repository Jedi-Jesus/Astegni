<!DOCTYPE html>
<html lang="en" data-theme="light">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ASTEGNI - Student Profile</title>
    <!-- LOADING SCREEN FIX - MUST LOAD FIRST -->
    <script src="../js/fix-loading-screen.js"></script>
    <!-- TailwindCSS CDN -->
    <script src="../js/config.js?v=20251217"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Animate.css for animations -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css" />
    <!-- Custom Styles -->
    <link rel="stylesheet" href="../css/root.css">
    <!-- Mobile Menu Styles -->
    <link rel="stylesheet" href="../css/find-tutors/navbar.css">
    <!-- Shared Responsive Styles -->
    <link rel="stylesheet" href="../css/shared/profile-responsive.css">
    <link rel="stylesheet" href="../css/student-profile/student-layout.css">
    <link rel="stylesheet" href="../css/tutor-profile/tutor-profile.css">
    <link rel="stylesheet" href="../css/find-tutors/hero-section.css">
    <!-- Tutor Card Styles for My Tutors panel -->
    <link rel="stylesheet" href="../css/find-tutors/tutor-card.css">
    <!-- Shared Modal Styles -->
    <link rel="stylesheet" href="../css/common-modals/access-restricted-modal.css">
    <link rel="stylesheet" href="../css/common-modals/add-role-modal.css">
    <link rel="stylesheet" href="../css/common-modals/coming-soon-modal.css">
    <link rel="stylesheet" href="../css/common-modals/ad-modal.css">
    <!-- Community Modal CSS -->
    <link rel="stylesheet" href="../css/common-modals/community-modal.css">
    <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">

    <!-- Profile Dropdown Fix - MUST load last to override conflicting styles -->
    <link rel="stylesheet" href="../css/student-profile/profile-specific-fix.css">

    <!-- Tutors Panel Styles -->
    <link rel="stylesheet" href="../css/student-profile/tutors-panel.css">

    <!-- Courses Panel Styles -->
    <link rel="stylesheet" href="../css/student-profile/courses-panel.css">

    <!-- Parent Portal Styles -->
    <link rel="stylesheet" href="../css/student-profile/parent-portal.css">

    <!-- Digital Whiteboard Styles -->
    <link rel="stylesheet" href="../css/tutor-profile/whiteboard-modal.css">

    <!-- Coursework Modal Styles -->
    <link rel="stylesheet" href="../css/tutor-profile/coursework-modal.css">

    <!-- Chat Modal Styles -->
    <link rel="stylesheet" href="../css/common-modals/chat-modal.css">
    <link rel="stylesheet" href="../css/common-modals/view-request-modal.css">

    <!-- Digital Lab Modal Styles -->
    <link rel="stylesheet" href="../css/common-modals/digital-lab-modal.css">

    <!-- Advanced Notes Panel Styles -->
    <link rel="stylesheet" href="../css/common-modals/advanced-notes.css">

    <!-- Minimal inline styles - only for profile-specific fixes -->
    <style>
        /* Compensate for fixed navbar */
        body {
            padding-top: 72px;
        }

        /* Fix overflow hidden that clips tooltip */
        .profile-header-section {
            overflow: visible !important;
        }

        /* Fix name truncation - allow full name to display */
        .profile-name {
            font-size: 2rem;
            font-weight: bold;
            color: var(--text-primary);
            margin-bottom: 0.5rem;
            white-space: normal !important;
            overflow: visible !important;
            text-overflow: clip !important;
            word-wrap: break-word;
        }

        .profile-main-info {
            overflow: visible !important;
        }

        .profile-details-section {
            overflow: visible !important;
        }

        /* Rating Tooltip - Force visibility on hover */
        .profile-header-section .rating-section,
        .rating-section {
            position: relative !important;
            overflow: visible !important;
            display: inline-block !important;
        }

        .profile-header-section .rating-wrapper,
        .rating-wrapper {
            position: relative !important;
            display: flex !important;
            align-items: center !important;
            gap: 0.75rem !important;
            cursor: pointer !important;
            overflow: visible !important;
        }

        .rating-tooltip-container {
            position: relative !important;
            display: inline-block !important;
        }

        .rating-tooltip {
            position: absolute !important;
            top: 110% !important;
            left: 50% !important;
            transform: translateX(-50%) !important;
            background: var(--card-bg) !important;
            border: 1px solid rgba(0, 0, 0, 0.1) !important;
            border-radius: 12px !important;
            padding: 1rem !important;
            min-width: 280px !important;
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.15) !important;
            opacity: 0 !important;
            visibility: hidden !important;
            transition: all 0.3s ease !important;
            z-index: 99999 !important;
            pointer-events: none !important;
        }

        .profile-header-section .rating-wrapper:hover .rating-tooltip,
        .rating-wrapper:hover .rating-tooltip,
        #rating-hover-trigger:hover #rating-tooltip {
            opacity: 1 !important;
            visibility: visible !important;
            top: calc(100% + 10px) !important;
            pointer-events: auto !important;
            display: block !important;
        }

        .rating-tooltip::before {
            content: '' !important;
            position: absolute !important;
            top: -8px !important;
            left: 50% !important;
            transform: translateX(-50%) !important;
            border-left: 8px solid transparent !important;
            border-right: 8px solid transparent !important;
            border-bottom: 8px solid var(--card-bg) !important;
        }

        /* Dark mode support */
        [data-theme="dark"] .rating-tooltip {
            background: #1f2937 !important;
            border-color: #374151 !important;
        }

        [data-theme="dark"] .rating-tooltip::before {
            border-bottom-color: #1f2937 !important;
        }

        /* Fix ALL parent containers that might clip tooltip */
        .panels-container,
        .panel-content,
        .profile-header,
        .profile-avatar-container,
        .profile-name-row,
        .cover-image-container {
            overflow: visible !important;
        }

        /* ============================================
           ENHANCED PROFILE HEADER SECTION STYLES
           ============================================ */

        .profile-header-section {
            background: var(--card-bg);
            border-radius: 20px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
            margin-bottom: 2rem;
            position: relative;
            overflow: visible !important;
            transition: all 0.3s ease;
        }

        .profile-header-section:hover {
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.12);
        }

        /* Enhanced Cover Image */
        .cover-image-container {
            position: relative;
            height: 280px;
            border-radius: 20px 20px 0 0;
            overflow: hidden;
        }

        .cover-img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.5s ease;
        }

        .cover-image-container:hover .cover-img {
            transform: scale(1.05);
        }

        .cover-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(180deg,
                    rgba(0, 0, 0, 0.1) 0%,
                    rgba(0, 0, 0, 0.3) 100%);
            pointer-events: none;
        }

        .cover-upload-btn {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border: none;
            border-radius: 12px;
            padding: 0.75rem;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            z-index: 10;
        }

        .cover-upload-btn:hover {
            background: white;
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(0, 0, 0, 0.2);
        }

        .cover-upload-btn svg {
            width: 20px;
            height: 20px;
            color: #4f46e5;
        }

        /* Enhanced Profile Info Section */
        .profile-main-info {
            padding: 0 2rem 2rem 2rem;
            margin-top: -60px;
            position: relative;
            z-index: 5;
        }

        .profile-info-wrapper {
            display: flex;
            gap: 2rem;
            align-items: flex-start;
        }

        /* Enhanced Avatar */
        .profile-avatar-container {
            position: relative;
            flex-shrink: 0;
        }

        .profile-avatar {
            width: 140px;
            height: 140px;
            border-radius: 50%;
            border: 5px solid var(--card-bg);
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.15);
            object-fit: cover;
            transition: all 0.3s ease;
        }

        .profile-avatar-container:hover .profile-avatar {
            transform: scale(1.05);
            box-shadow: 0 12px 32px rgba(0, 0, 0, 0.2);
        }

        .online-indicator {
            position: absolute;
            bottom: 10px;
            right: 10px;
            width: 24px;
            height: 24px;
            background: #22c55e;
            border: 4px solid var(--card-bg);
            border-radius: 50%;
            box-shadow: 0 2px 8px rgba(34, 197, 94, 0.4);
            animation: pulse-indicator 2s ease-in-out infinite;
        }

        @keyframes pulse-indicator {

            0%,
            100% {
                box-shadow: 0 2px 8px rgba(34, 197, 94, 0.4);
            }

            50% {
                box-shadow: 0 2px 16px rgba(34, 197, 94, 0.8);
            }
        }

        .avatar-upload-btn {
            position: absolute;
            bottom: 5px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border: none;
            border-radius: 8px;
            padding: 0.5rem;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            opacity: 0;
        }

        .profile-avatar-container:hover .avatar-upload-btn {
            opacity: 1;
        }

        .avatar-upload-btn:hover {
            background: white;
            transform: translateX(-50%) translateY(-2px);
        }

        .avatar-upload-btn svg {
            width: 16px;
            height: 16px;
            color: #4f46e5;
        }

        /* Enhanced Profile Details */
        .profile-details-section {
            flex: 1;
            padding-top: 0.5rem;
        }

        .profile-name-row {
            margin-bottom: 1rem;
        }

        .profile-name {
            font-size: 2.25rem;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 0.75rem;
            line-height: 1.2;
            background: linear-gradient(135deg, var(--text-primary) 0%, var(--heading) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .badges-row {
            display: flex;
            flex-wrap: wrap;
            gap: 0.75rem;
            margin-bottom: 1rem;
        }

        .profile-badge {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-size: 0.875rem;
            font-weight: 600;
            transition: all 0.3s ease;
            cursor: default;
        }

        .profile-badge.verified {
            background: linear-gradient(135deg, #22c55e 0%, #16a34a 100%);
            color: white;
            box-shadow: 0 4px 12px rgba(34, 197, 94, 0.3);
        }

        .profile-badge.verified:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(34, 197, 94, 0.4);
        }

        .profile-badge.gpa {
            background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
            color: white;
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3);
        }

        .profile-badge.gpa:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(59, 130, 246, 0.4);
        }

        .profile-badge.honor {
            background: linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%);
            color: white;
            box-shadow: 0 4px 12px rgba(139, 92, 246, 0.3);
        }

        .profile-badge.honor:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(139, 92, 246, 0.4);
        }

        /* Enhanced Rating Section */
        .rating-value {
            font-size: 2rem;
            font-weight: 700;
            color: #f59e0b;
            text-shadow: 0 2px 4px rgba(245, 158, 11, 0.2);
        }

        .rating-stars {
            color: #f59e0b;
            font-size: 1.5rem;
            letter-spacing: 2px;
            text-shadow: 0 2px 4px rgba(245, 158, 11, 0.2);
        }

        .rating-count {
            color: var(--text-secondary);
            font-size: 0.95rem;
            font-weight: 500;
        }

        .rating-label {
            color: var(--text-secondary);
            font-size: 0.875rem;
            margin-top: 0.25rem;
        }

        /* Enhanced Location/Info Items */
        .profile-location {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.75rem 1rem;
            background: rgba(var(--button-bg-rgb), 0.05);
            border-radius: 12px;
            margin-bottom: 0.75rem;
            transition: all 0.3s ease;
        }

        .profile-location:hover {
            background: rgba(var(--button-bg-rgb), 0.1);
            transform: translateX(5px);
        }

        .location-icon {
            font-size: 1.25rem;
        }

        .profile-location span:last-child {
            color: var(--text);
            font-size: 0.95rem;
        }

        /* Enhanced About Me / Info Grid Section */
        .profile-info-grid {
            background: rgba(var(--button-bg-rgb), 0.03);
            border-radius: 16px;
            padding: 1.5rem;
            margin-top: 1.5rem;
            border: 1px solid rgba(var(--border-rgb), 0.1);
        }

        .info-item {
            display: flex;
            align-items: baseline;
            gap: 0.5rem;
            margin-bottom: 1rem;
        }

        .info-item:last-child {
            margin-bottom: 0;
        }

        .info-label {
            font-weight: 600;
            color: var(--heading);
            font-size: 0.95rem;
            min-width: 100px;
        }

        .info-value {
            color: var(--text);
            font-size: 0.95rem;
        }

        .info-description {
            margin-top: 1rem;
            padding-top: 1rem;
            border-top: 1px solid rgba(var(--border-rgb), 0.1);
        }

        .info-description p {
            color: var(--text);
            line-height: 1.7;
            font-size: 0.95rem;
        }

        /* Enhanced Quote Section */
        .profile-quote {
            background: linear-gradient(135deg, rgba(79, 70, 229, 0.1) 0%, rgba(124, 58, 237, 0.05) 100%);
            border-left: 4px solid #4f46e5;
            border-radius: 12px;
            padding: 1.25rem 1.5rem;
            margin-top: 1.5rem;
            position: relative;
            font-style: italic;
            color: var(--text);
            font-size: 1rem;
            line-height: 1.6;
            box-shadow: 0 2px 8px rgba(79, 70, 229, 0.1);
        }

        .profile-quote::before {
            content: '"';
            position: absolute;
            top: -10px;
            left: 15px;
            font-size: 3rem;
            color: #4f46e5;
            opacity: 0.3;
            font-family: Georgia, serif;
        }

        .profile-quote span {
            position: relative;
            z-index: 1;
        }

        /* Enhanced Social Links Section */
        .profile-socials {
            margin-top: 1.5rem;
            padding: 1.5rem;
            background: rgba(var(--button-bg-rgb), 0.03);
            border-radius: 16px;
            border: 1px solid rgba(var(--border-rgb), 0.1);
        }

        .profile-socials h4 {
            font-weight: 600;
            font-size: 0.95rem;
            color: var(--heading);
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
        }

        .social-links {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
        }

        .social-links .social-link {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 44px;
            height: 44px;
            border-radius: 12px;
            background: var(--card-bg);
            border: 2px solid rgba(var(--border-rgb), 0.2);
            color: var(--text);
            transition: all 0.3s ease;
            text-decoration: none;
            position: relative;
            overflow: hidden;
        }

        .social-links .social-link::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, var(--button-bg), var(--button-hover));
            opacity: 0;
            transition: opacity 0.3s ease;
            z-index: 0;
        }

        .social-links .social-link:hover::before {
            opacity: 1;
        }

        .social-links .social-link svg {
            width: 20px;
            height: 20px;
            position: relative;
            z-index: 1;
            transition: all 0.3s ease;
        }

        .social-links .social-link:hover {
            transform: translateY(-4px);
            box-shadow: 0 6px 20px rgba(var(--button-bg-rgb), 0.3);
            border-color: var(--button-bg);
        }

        .social-links .social-link:hover svg {
            color: white;
        }

        /* Enhanced Profile Actions */
        .profile-actions {
            display: flex;
            gap: 1rem;
            margin-top: 2rem;
            flex-wrap: wrap;
        }

        .profile-actions .btn-primary,
        .profile-actions .btn-secondary {
            flex: 1;
            min-width: 160px;
            padding: 0.875rem 1.5rem;
            font-weight: 600;
            border-radius: 12px;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }

        .profile-actions .btn-primary {
            background: linear-gradient(135deg, #4f46e5 0%, #7c3aed 100%);
            color: white;
            border: none;
            box-shadow: 0 4px 12px rgba(79, 70, 229, 0.3);
        }

        .profile-actions .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(79, 70, 229, 0.4);
        }

        .profile-actions .btn-secondary {
            background: transparent;
            color: var(--text);
            border: 2px solid rgba(var(--border-rgb), 0.3);
        }

        .profile-actions .btn-secondary:hover {
            background: rgba(var(--button-bg-rgb), 0.05);
            border-color: var(--button-bg);
            transform: translateY(-2px);
        }

        /* Enhanced Connections Section */
        .profile-connections {
            margin-top: 1.5rem;
            padding: 1.5rem;
            background: rgba(var(--button-bg-rgb), 0.03);
            border-radius: 16px;
            border: 1px solid rgba(var(--border-rgb), 0.1);
        }

        .connections-header h4 {
            font-weight: 600;
            font-size: 0.95rem;
            color: var(--heading);
            display: flex;
            align-items: center;
        }

        .connections-stats {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 1rem;
            text-align: center;
        }

        .stat-box {
            padding: 1rem;
            background: var(--card-bg);
            border-radius: 12px;
            transition: all 0.3s ease;
            border: 1px solid rgba(var(--border-rgb), 0.1);
        }

        .stat-box:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
        }

        .stat-box div:first-child {
            font-size: 1.75rem;
            font-weight: 700;
            color: var(--heading);
            margin-bottom: 0.25rem;
        }

        .stat-box div:last-child {
            font-size: 0.8rem;
            color: var(--text-muted);
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .profile-info-wrapper {
                flex-direction: column;
                align-items: center;
                text-align: center;
            }

            .profile-avatar {
                width: 120px;
                height: 120px;
            }

            .profile-name {
                font-size: 1.75rem;
            }

            .badges-row {
                justify-content: center;
            }

            .profile-location {
                justify-content: center;
            }

            .info-item {
                flex-direction: column;
                text-align: center;
                gap: 0.25rem;
            }

            .info-label {
                min-width: auto;
            }

            .profile-actions {
                flex-direction: column;
            }

            .profile-actions .btn-primary,
            .profile-actions .btn-secondary {
                width: 100%;
            }

            .connections-stats {
                grid-template-columns: 1fr;
            }

            .social-links {
                justify-content: center;
            }
        }

        /* ============================================
           STUDY TIPS TICKER ANIMATION
           ============================================ */
        .activity-ticker-container {
            height: 95px;
            overflow: hidden;
            position: relative;
            background: rgba(var(--button-bg-rgb), 0.02);
            border-radius: var(--radius-md);
        }

        .activity-ticker {
            animation: tickerRoll 18s cubic-bezier(0.4, 0, 0.2, 1) infinite;
        }

        .activity-item {
            display: flex;
            align-items: start;
            gap: 0.5rem;
            padding: 0.75rem;
            height: 95px;
            box-sizing: border-box;
            transition: background var(--transition-base);
        }

        .activity-item:hover {
            background: rgba(var(--button-bg-rgb), 0.05);
        }

        @keyframes tickerRoll {
            0% {
                transform: translateY(0);
            }

            16.66% {
                transform: translateY(0);
            }

            20% {
                transform: translateY(-95px);
            }

            36.66% {
                transform: translateY(-95px);
            }

            40% {
                transform: translateY(-190px);
            }

            56.66% {
                transform: translateY(-190px);
            }

            60% {
                transform: translateY(-285px);
            }

            76.66% {
                transform: translateY(-285px);
            }

            80% {
                transform: translateY(-380px);
            }

            96.66% {
                transform: translateY(-380px);
            }

            100% {
                transform: translateY(-475px);
            }
        }

        /* Pause animation on hover */
        .activity-ticker-container:hover .activity-ticker {
            animation-play-state: paused;
        }

        /* ============================================
           FIX: Prevent profile-header-section from moving with sidebar
           ============================================ */
        /* The profile-header-section is nested inside the main content,
           so we need to prevent it from being affected by sidebar animation */
        .profile-header-section.sidebar-active {
            transform: none !important;
        }

        /* Also prevent any nested sections from moving */
        .panel-content section.sidebar-active {
            transform: none !important;
        }

        /* ============================================
           UPLOAD MODAL STYLES
           ============================================ */
        .upload-cover-modal,
        .upload-profile-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(10px);
            z-index: 10000;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 1rem;
        }

        .upload-cover-modal .modal-content,
        .upload-profile-modal .modal-content {
            background: var(--card-bg);
            border-radius: 20px;
            max-width: 600px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        }

        .upload-cover-modal .modal-inner,
        .upload-profile-modal .modal-inner {
            padding: 2rem;
        }

        .upload-area {
            border: 2px dashed var(--border);
            border-radius: 12px;
            padding: 3rem 2rem;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            background: var(--highlight-bg);
        }

        .upload-area:hover {
            border-color: var(--button-bg);
            background: rgba(var(--button-bg-rgb), 0.05);
        }

        .upload-icon {
            font-size: 3rem;
            display: block;
            margin-bottom: 1rem;
        }

        .upload-text {
            font-weight: 600;
            color: var(--heading);
            margin-bottom: 0.5rem;
        }

        .upload-hint {
            font-size: 0.875rem;
            color: var(--text-muted);
        }

        .upload-input {
            display: none;
        }

        .preview-container {
            margin-top: 1.5rem;
            border-radius: 12px;
            overflow: hidden;
            border: 1px solid var(--border);
        }

        .preview-image {
            width: 100%;
            max-height: 300px;
            object-fit: cover;
        }

        .preview-info {
            padding: 1rem;
            background: var(--highlight-bg);
        }

        .file-info {
            display: flex;
            justify-content: space-between;
            margin-bottom: 0.5rem;
            font-size: 0.875rem;
        }

        .file-info span:first-child {
            color: var(--text-muted);
        }

        .file-info span:last-child {
            font-weight: 600;
            color: var(--heading);
        }

        .upload-progress {
            margin-top: 1.5rem;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: var(--highlight-bg);
            border-radius: 4px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--button-bg), #7c3aed);
            transition: width 0.3s ease;
        }

        .progress-text {
            text-align: center;
            margin-top: 0.5rem;
            font-size: 0.875rem;
            color: var(--text-muted);
        }

        .upload-actions {
            display: flex;
            gap: 1rem;
            margin-top: 1.5rem;
        }

        .btn-upload {
            flex: 1;
            padding: 0.875rem 1.5rem;
            border-radius: 12px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            border: none;
        }

        .btn-upload.primary {
            background: linear-gradient(135deg, #4f46e5 0%, #7c3aed 100%);
            color: white;
            box-shadow: 0 4px 12px rgba(79, 70, 229, 0.3);
        }

        .btn-upload.primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(79, 70, 229, 0.4);
        }

        .btn-upload.secondary {
            background: transparent;
            color: var(--text);
            border: 2px solid var(--border);
        }

        .btn-upload.secondary:hover {
            background: var(--highlight-bg);
            border-color: var(--button-bg);
        }

        /* ============================================ */
        /* SIDEBAR & OVERLAY STYLES (Toggle on All Devices) */
        /* ============================================ */

        /* Sidebar Overlay */
        .sidebar-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(4px);
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease, visibility 0.3s ease;
            z-index: 998;
        }

        .sidebar-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        /* Sidebar Container - Hidden by default, toggleable on all devices */
        .sidebar-container {
            position: fixed;
            left: 0;
            top: 72px;
            width: 280px;
            height: calc(100vh - 72px);
            transform: translateX(-100%);
            transition: transform 0.3s ease;
            z-index: 999;
            background: var(--card-bg);
            overflow-y: auto;
            box-shadow: 2px 0 10px rgba(0, 0, 0, 0.1);
        }

        .sidebar-container.active {
            transform: translateX(0);
        }

        /* Hamburger animation when active */
        #hamburger.active .hamburger span:nth-child(1) {
            transform: rotate(45deg) translate(5px, 5px);
        }

        #hamburger.active .hamburger span:nth-child(2) {
            opacity: 0;
        }

        #hamburger.active .hamburger span:nth-child(3) {
            transform: rotate(-45deg) translate(7px, -6px);
        }

        /* ============================================
           TOGGLE SWITCH STYLES (Featured Document)
           ============================================ */
        .toggle-switch {
            position: relative;
            display: inline-block;
            width: 50px;
            height: 26px;
        }

        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .toggle-slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: 0.4s;
            border-radius: 26px;
        }

        .toggle-slider:before {
            position: absolute;
            content: "";
            height: 20px;
            width: 20px;
            left: 3px;
            bottom: 3px;
            background-color: white;
            transition: 0.4s;
            border-radius: 50%;
        }

        .toggle-switch input:checked + .toggle-slider {
            background-color: var(--primary, #3b82f6);
        }

        .toggle-switch input:checked + .toggle-slider:before {
            transform: translateX(24px);
        }

        .toggle-switch input:focus + .toggle-slider {
            box-shadow: 0 0 1px var(--primary, #3b82f6);
        }

        /* Dark mode support for toggle */
        [data-theme="dark"] .toggle-slider {
            background-color: #4b5563;
        }

        [data-theme="dark"] .toggle-switch input:checked + .toggle-slider {
            background-color: var(--primary, #3b82f6);
        }
    </style>
</head>

<body class="font-sans">

    <!-- Early Parent Portal Functions (needed before scripts load) -->
    <script>
        // Initialize window.parentPortalManager - will be replaced by full version when script loads
        window.parentPortalManager = {
            _isStub: true,
            searchTimeout: null,
            searchUsers: function(query) {
                // Debounced search - stub version just logs
                if (this.searchTimeout) clearTimeout(this.searchTimeout);
                if (query.length < 2) return;
                console.log('[STUB] Searching for:', query, '- Full ParentPortalManager not loaded yet!');
            },
            showStep: function(step) {
                document.querySelectorAll('.invite-step').forEach(s => s.classList.add('hidden'));
                const target = document.getElementById('invite-step-' + step);
                if (target) target.classList.remove('hidden');
            },
            renderSearchPlaceholder: function() {
                const container = document.getElementById('parent-search-results');
                if (container) {
                    container.innerHTML = '<div class="text-center py-8 text-gray-400"><p>Start typing to search for your parent</p></div>';
                }
            },
            backToSearch: function() { this.showStep(1); },
            showAddNewParentForm: function() { this.showStep(3); },
            selectUser: function(user) { this.showStep(2); },
            submitExistingUserInvitation: function(e) { if(e) e.preventDefault(); },
            submitNewUserInvitation: function(e) { if(e) e.preventDefault(); }
        };

        // Functions that will be called by onclick handlers
        function openInviteParentModal() {
            console.log('openInviteParentModal called');
            const modal = document.getElementById('inviteParentModal');
            if (modal) {
                modal.style.display = 'flex';
                modal.classList.remove('hidden');
                modal.classList.add('active');
                document.body.style.overflow = 'hidden';
                window.parentPortalManager.showStep(1);
                const searchInput = document.getElementById('parent-search-input');
                if (searchInput) searchInput.value = '';
                window.parentPortalManager.renderSearchPlaceholder();
            }
        }

        function closeInviteParentModal() {
            const modal = document.getElementById('inviteParentModal');
            if (modal) {
                modal.style.display = 'none';
                modal.classList.add('hidden');
                modal.classList.remove('active');
                document.body.style.overflow = '';
            }
        }

        function switchParentPortalTab(tabName) {
            const linkedTab = document.getElementById('linked-parents-tab');
            const pendingTab = document.getElementById('pending-parents-tab');
            const linkedContent = document.getElementById('linked-parents-content');
            const pendingContent = document.getElementById('pending-parents-content');
            if (!linkedTab || !pendingTab || !linkedContent || !pendingContent) return;

            linkedTab.style.color = 'var(--text-muted)';
            linkedTab.style.borderBottomColor = 'transparent';
            pendingTab.style.color = 'var(--text-muted)';
            pendingTab.style.borderBottomColor = 'transparent';
            linkedContent.style.display = 'none';
            pendingContent.style.display = 'none';

            if (tabName === 'linked') {
                linkedTab.style.color = 'var(--button-bg)';
                linkedTab.style.borderBottomColor = 'var(--button-bg)';
                linkedContent.style.display = 'block';
            } else if (tabName === 'pending') {
                pendingTab.style.color = 'var(--button-bg)';
                pendingTab.style.borderBottomColor = 'var(--button-bg)';
                pendingContent.style.display = 'block';
            }
        }

        // Alias for HTML oninput handlers
        var parentPortalManager = window.parentPortalManager;
    </script>

    <!-- Navigation -->
    <nav class="navbar" role="navigation" aria-label="Main navigation">
        <div class="nav-container" style="max-width: 100%; padding: 0 1rem;">
            <div class="nav-brand">
                <button class="sidebar-toggle" id="hamburger" aria-label="Toggle sidebar">
                    <span class="hamburger">
                        <span></span>
                        <span></span>
                        <span></span>
                    </span>
                </button>
                <a href="../profile-pages/student-profile.html" class="logo-container">
                    <div class="logo-text">
                        <span class="logo-main">Astegni</span>
                        <span class="logo-sub">Student</span>
                    </div>
                    <span class="logo-badge">Beta</span>
                </a>
            </div>

            <!-- Right Section: Nav Menu + Actions -->
            <div class="nav-actions" style="display: flex; align-items: center; gap: 0.5rem; margin-right: 0;">
                <!-- Navigation Links -->
                <div class="nav-items" style="display: flex; gap: 0.25rem;">
                    <a class="nav-link" href="../index.html">
                        <span class="nav-icon">üè†</span> Home
                    </a>
                    <a class="nav-link" href="#" onclick="handleNavLinkClick(event, 'news')">
                        <span class="nav-icon">üì∞</span> News
                    </a>
                    <a class="nav-link" href="../branch/find-tutors.html">
                        <span class="nav-icon">üë®‚Äçüè´</span> Find Tutors
                    </a>
                    <a class="nav-link" href="../branch/reels.html">
                        <span class="nav-icon">üé¨</span> Reels
                    </a>
                    <a class="nav-link" href="#" onclick="handleNavLinkClick(event, 'store')">
                        <span class="nav-icon">üìö</span> Bookstore
                    </a>
                    <a class="nav-link" href="#" onclick="handleNavLinkClick(event, 'find-jobs')">
                        <span class="nav-icon">üíº</span> Find a Job
                    </a>
                </div>
                <!-- Profile container -->
                <div id="profile-container" class="profile-dropdown-container">
                    <button id="profile-dropdown-toggle" class="profile-dropdown-toggle"
                        onclick="toggleProfileDropdown()">
                        <img id="profile-pic" class="profile-pic" alt="Profile">
                        <span id="profile-name" class="profile-name"></span>
                        <svg class="dropdown-arrow" width="12" height="12" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd"
                                d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z"
                                clip-rule="evenodd"></path>
                        </svg>
                    </button>

                    <div id="profile-dropdown-menu" class="profile-dropdown-menu">
                        <!-- User info header - CLICKABLE to go to profile page -->
                        <a href="#" id="dropdown-profile-link" class="dropdown-header-link">
                            <div class="dropdown-header">
                                <img id="dropdown-profile-pic" class="profile-pic" alt="Profile">
                                <div class="dropdown-user-info">
                                    <span id="dropdown-user-name" class="dropdown-user-name"></span>
                                    <span id="dropdown-user-email" class="dropdown-user-email"></span>
                                    <span id="dropdown-user-role" class="dropdown-user-role"></span>
                                </div>
                                <svg class="dropdown-header-arrow" width="16" height="16" fill="currentColor" viewBox="0 0 20 20">
                                    <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                                </svg>
                            </div>
                        </a>

                        <div class="dropdown-divider"></div>

                        <!-- Role switcher (shown only if user has multiple roles) -->
                        <div id="role-switcher-section" class="role-switcher-section hidden">
                            <div class="dropdown-item-header">Switch Role</div>
                            <div id="role-options" class="role-options">
                                <!-- Role options will be dynamically added here -->
                            </div>
                            <div class="dropdown-divider"></div>
                        </div>

                        <div class="dropdown-divider"></div>

                        <button class="dropdown-item logout-item" onclick="showLogoutModal()">
                            <svg class="dropdown-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1">
                                </path>
                            </svg>
                            Logout
                        </button>
                    </div>
                </div>


                <!-- Notification Icon -->
                <button class="icon-btn" aria-label="Notifications">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9">
                        </path>
                    </svg>
                    <span class="notification-badge">3</span>
                </button>

                <!-- Theme Toggle (Desktop) -->
                <button id="theme-toggle-btn" class="icon-btn desktop-only-lg" aria-label="Toggle theme">
                    <svg id="theme-icon" class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z">
                        </path>
                    </svg>
                </button>
            </div>

            <!-- Mobile Menu Button (< 1024px) -->
            <button class="mobile-menu-btn" id="mobileMenuBtn" aria-label="Toggle mobile menu">
                <span class="mobile-hamburger">
                    <span></span>
                    <span></span>
                    <span></span>
                </span>
            </button>
        </div>
    </nav>

    <!-- Mobile Menu (< 1024px) -->
    <div id="mobileMenu" class="mobile-menu hidden">
        <div class="mobile-menu-content">
            <!-- Mobile Menu Header -->
            <div class="mobile-menu-header">
                <a href="student-profile.html" class="mobile-logo-container">
                    <div class="logo-text">
                        <span class="logo-main">Astegni</span>
                        <span class="logo-sub">Student Profile</span>
                    </div>
                    <span class="logo-badge">Beta</span>
                </a>
            </div>

            <div class="mobile-menu-divider"></div>

            <!-- Navigation Links -->
            <a class="mobile-menu-link" href="../index.html">
                <span class="nav-icon">üè†</span> Home
            </a>
            <a class="mobile-menu-link" href="../branch/find-tutors.html">
                <span class="nav-icon">üë®‚Äçüè´</span> Find Tutors
            </a>
            <a class="mobile-menu-link" href="#" onclick="handleNavLinkClick(event, 'news'); closeMobileMenu();">
                <span class="nav-icon">üì∞</span> News
            </a>
            <a class="mobile-menu-link" href="../branch/reels.html">
                <span class="nav-icon">üé¨</span> Reels
            </a>
            <a class="mobile-menu-link" href="#" onclick="handleNavLinkClick(event, 'store'); closeMobileMenu();">
                <span class="nav-icon">üìö</span> Bookstore
            </a>

            <div class="mobile-menu-divider"></div>

            <!-- Mobile Profile Section -->
            <div id="mobile-profile-section" class="mobile-profile-section">
                <div class="mobile-profile-dropdown">
                    <button id="mobile-profile-header" class="mobile-profile-header" onclick="toggleMobileProfileDropdown()">
                        <img id="mobile-profile-pic" class="mobile-profile-pic" src="" alt="Profile">
                        <div class="mobile-profile-info">
                            <span id="mobile-profile-name" class="mobile-profile-name"></span>
                            <span id="mobile-profile-role" class="mobile-profile-role">Student</span>
                        </div>
                        <svg class="mobile-profile-arrow" width="16" height="16" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                        </svg>
                    </button>

                    <div class="mobile-profile-dropdown-content">
                        <a href="student-profile.html" class="mobile-dropdown-user-info" onclick="closeMobileMenu();">
                            <img id="mobile-dropdown-pic" class="mobile-dropdown-pic" src="" alt="Profile">
                            <div class="mobile-dropdown-info">
                                <span id="mobile-dropdown-name" class="mobile-dropdown-name"></span>
                                <span id="mobile-dropdown-email" class="mobile-dropdown-email"></span>
                            </div>
                        </a>

                        <div id="mobile-role-switcher-section" class="mobile-role-switcher-section hidden">
                            <div class="mobile-role-switcher-header">Switch Role</div>
                            <div id="mobile-role-options" class="mobile-role-options"></div>
                        </div>

                        <button id="mobile-logout-btn" class="mobile-dropdown-logout" onclick="showLogoutModal(); closeMobileMenu();">
                            <svg class="mobile-menu-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"></path>
                            </svg>
                            Logout
                        </button>
                    </div>
                </div>
                <div class="mobile-menu-divider"></div>
            </div>

            <!-- Theme Toggle -->
            <button id="mobile-theme-toggle-btn" class="mobile-menu-item" onclick="toggleTheme(); closeMobileMenu();">
                <svg id="mobile-theme-icon" class="w-5 h-5 inline mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                        d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z">
                    </path>
                </svg>
                Toggle Theme
            </button>

            <!-- Notification Button -->
            <button id="mobile-notification-btn" class="mobile-menu-item" onclick="closeMobileMenu();">
                <svg class="w-5 h-5 inline mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                        d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9">
                    </path>
                </svg>
                Notifications
                <span class="notification-badge-mobile">3</span>
            </button>
        </div>
    </div>

    <!-- Mobile Menu Overlay -->
    <div id="mobileMenuOverlay" class="mobile-menu-overlay hidden"></div>

    <!-- Sidebar -->
    <aside id="sidebar" class="sidebar-container">
        <div class="sidebar-content">
            <div class="sidebar-nav">
                <h3>Student Dashboard</h3>

                <a href="#" onclick="switchPanel('dashboard'); return false;" class="sidebar-link active">
                    <span class="sidebar-icon">üè†</span>
                    <span>Dashboard</span>
                </a>
                <a href="#" onclick="switchPanel('analysis'); return false;" class="sidebar-link">
                    <span class="sidebar-icon">üìä</span>
                    <span>Analysis</span>
                </a>
                <a href="#" onclick="switchPanel('credentials'); return false;" class="sidebar-link">
                    <span class="sidebar-icon">üìÑ</span>
                    <span>Credentials</span>
                </a>
                <hr class="my-4 border-gray-300">
                <a href="#" onclick="switchPanel('notes'); return false;" class="sidebar-link">
                    <span class="sidebar-icon">üìã</span>
                    <span>Notes</span>
                </a>
                <a href="#" onclick="switchPanel('my-requests'); return false;" class="sidebar-link">
                    <span class="sidebar-icon">üìÆ</span>
                    <span>Requests</span>
                </a>
                <a href="#" onclick="switchPanel('schedule'); return false;" class="sidebar-link">
                    <span class="sidebar-icon">üìÖ</span>
                    <span>My Schedule</span>
                </a>
                <a href="#" onclick="switchPanel('my-tutors'); return false;" class="sidebar-link">
                    <span class="sidebar-icon">üë®‚Äçüè´</span>
                    <span>My Tutors</span>
                    <span class="badge-count">3</span>
                </a>
                <a href="#" onclick="switchPanel('my-courses'); return false;" class="sidebar-link">
                    <span class="sidebar-icon">üìö</span>
                    <span>My Courses</span>
                    <span class="badge-count">6</span>
                </a>
                <a href="#" onclick="switchPanel('learning-tools'); return false;" class="sidebar-link">
                    <span class="sidebar-icon">üõ†Ô∏è</span>
                    <span>Learning Tools</span>
                </a>
                <a href="#" onclick="switchPanel('community'); return false;" class="sidebar-link">
                    <span class="sidebar-icon">üë•</span>
                    <span>Community</span>
                </a>
                <a href="#" onclick="switchPanel('parent-portal'); return false;" class="sidebar-link">
                    <span class="sidebar-icon">üë®‚Äçüë©‚Äçüëß</span>
                    <span>Parent Portal</span>
                </a>
                <hr class="my-4 border-gray-300">
                <a href="#" onclick="switchPanel('documents'); return false;" class="sidebar-link">
                    <span class="sidebar-icon">üìÅ</span>
                    <span>Documents</span>
                </a>
                <a href="#" onclick="switchPanel('blog'); return false;" class="sidebar-link">
                    <span class="sidebar-icon">üìù</span>
                    <span>Blog</span>
                    <span class="badge-count">7</span>
                </a>
                <hr class="my-4 border-gray-300">
                <a href="#" onclick="switchPanel('ratings-and-reviews'); return false;" class="sidebar-link">
                    <span class="sidebar-icon">‚≠ê</span>
                    <span>Ratings & Reviews</span>
                </a>
                <a href="#" onclick="switchPanel('earnings-investments'); return false;" class="sidebar-link">
                    <span class="sidebar-icon"
                        style="font-family: 'Times New Roman', serif; font-weight: bold; font-size: 1.1rem;">‚Ñ∞</span>
                    <span>Earnings & Investments</span>
                </a>
                <a href="#" onclick="switchPanel('become-tutor'); return false;" class="sidebar-link">
                    <span class="sidebar-icon">üéì</span>
                    <span>Become a Tutor</span>
                </a>
                <hr class="my-4 border-gray-300">
                <a href="#" onclick="switchPanel('settings'); return false;" class="sidebar-link">
                    <span class="sidebar-icon">‚öôÔ∏è</span>
                    <span>Settings</span>
                </a>
            </div>
        </div>
    </aside>

    <!-- Sidebar Overlay (for mobile) -->
    <div id="sidebar-overlay" class="sidebar-overlay"></div>

    <!-- Rotating Ad Section - 4 Placeholder Ads -->
    <div class="ad-container premium-ad" style="margin-top: 2rem;">
        <!-- Ad Slide 1 -->
        <div class="ad-slide active" onclick="openAdAnalyticsModal()">
            <div class="ad-animation">
                <div class="pulse-ring"></div>
                <div class="pulse-ring"></div>
            </div>
            <div class="ad-content">
                <span class="ad-label">Ad 1</span>
                <h3 class="ad-title">Unlock Your Full Potential</h3>
                <p class="ad-text">Premium tutoring available</p>
                <button class="ad-cta" onclick="openAdAnalyticsModal()">Learn More</button>
            </div>
            <div class="ad-visual">
                <div class="ad-circles">
                    <div class="circle circle-1"></div>
                    <div class="circle circle-2"></div>
                    <div class="circle circle-3"></div>
                </div>
            </div>
        </div>

        <!-- Ad Slide 2 -->
        <div class="ad-slide" onclick="openAdAnalyticsModal()">
            <div class="ad-animation">
                <div class="pulse-ring"></div>
                <div class="pulse-ring"></div>
            </div>
            <div class="ad-content">
                <span class="ad-label">Ad 2</span>
                <h3 class="ad-title">Study Materials & Books</h3>
                <p class="ad-text">Access learning resources</p>
                <button class="ad-cta" onclick="openAdAnalyticsModal()">Browse Now</button>
            </div>
            <div class="ad-visual">
                <div class="ad-circles">
                    <div class="circle circle-1"></div>
                    <div class="circle circle-2"></div>
                    <div class="circle circle-3"></div>
                </div>
            </div>
        </div>

        <!-- Ad Slide 3 -->
        <div class="ad-slide" onclick="openAdAnalyticsModal()">
            <div class="ad-animation">
                <div class="pulse-ring"></div>
                <div class="pulse-ring"></div>
            </div>
            <div class="ad-content">
                <span class="ad-label">Ad 3</span>
                <h3 class="ad-title">Find Your Perfect Tutor</h3>
                <p class="ad-text">Personalized learning experience</p>
                <button class="ad-cta" onclick="openAdAnalyticsModal()">Find Tutors</button>
            </div>
            <div class="ad-visual">
                <div class="ad-circles">
                    <div class="circle circle-1"></div>
                    <div class="circle circle-2"></div>
                    <div class="circle circle-3"></div>
                </div>
            </div>
        </div>

        <!-- Ad Slide 4 -->
        <div class="ad-slide" onclick="openAdAnalyticsModal()">
            <div class="ad-animation">
                <div class="pulse-ring"></div>
                <div class="pulse-ring"></div>
            </div>
            <div class="ad-content">
                <span class="ad-label">Ad 4</span>
                <h3 class="ad-title">Your Ad Space Here</h3>
                <p class="ad-text">Connect with students</p>
                <button class="ad-cta" onclick="openAdAnalyticsModal()">Advertise</button>
            </div>
            <div class="ad-visual">
                <div class="ad-circles">
                    <div class="circle circle-1"></div>
                    <div class="circle circle-2"></div>
                    <div class="circle circle-3"></div>
                </div>
            </div>
        </div>
    </div>

    
    <!-- Main Content -->
    <section class="py-8" style="padding-top: 1rem;">
        <div class="container mx-auto px-4">


            <!-- Main Content with Widgets -->
            <div class="flex gap-6">
                <!-- Left Content Area -->
                <div class="flex-1" style="min-width: 0;">
                    <!-- Panels Section -->
                    <div class="panels-container">
                        <!-- Dashboard Panel (Default) -->
                        <div id="dashboard-panel" class="panel-content active">


                            <!-- Hero Section -->
                            <section class="hero-section animate__animated animate__fadeIn">
                                <h2 class="hero-title">
                                    <span id="typedText">Empowering My Future Through Learning</span>
                                    <span id="cursor" class="cursor-blink">|</span>
                                </h2>
                                <p id="hero-subtitle" class="hero-subtitle">Achieving academic excellence through
                                    dedication and expert guidance</p>
                                <div class="hero-stats">
                                    <div class="stat-item animate__animated animate__fadeInUp"
                                        style="animation-delay: 0.2s">
                                        <span class="stat-number" data-target="6" data-suffix="+">0</span>
                                        <span class="stat-label">Active Courses</span>
                                    </div>
                                    <div class="stat-item animate__animated animate__fadeInUp"
                                        style="animation-delay: 0.3s">
                                        <span class="stat-number" data-target="24" data-suffix="hrs">0</span>
                                        <span class="stat-label">Study Hours</span>
                                    </div>
                                    <div class="stat-item animate__animated animate__fadeInUp"
                                        style="animation-delay: 0.4s">
                                        <span class="stat-number" data-target="3.8" data-suffix=""
                                            data-decimal="1">0</span>
                                        <span class="stat-label">GPA</span>
                                    </div>
                                </div>
                            </section>

                            <!-- Profile Header Section (Only visible in Dashboard) -->
                            <section class="profile-header-section mb-8">
                                <!-- Error Message Container -->
                                <div id="profile-error" style="display: none; background: linear-gradient(135deg, #ef4444, #dc2626); color: white; padding: 1rem 1.5rem; border-radius: 12px; margin-bottom: 1rem; text-align: center; font-weight: 500; box-shadow: 0 4px 12px rgba(239, 68, 68, 0.3);">
                                    Loading failed. Please refresh the page.
                                </div>

                                <div class="cover-image-container relative">
                                    <img id="cover-img"
                                        src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='1200' height='300'%3E%3Crect width='1200' height='300' fill='%23e5e7eb'/%3E%3Ctext x='50%25' y='50%25' text-anchor='middle' dy='.3em' fill='%239ca3af' font-family='sans-serif' font-size='20'%3E1200x300%3C/text%3E%3C/svg%3E"
                                        alt="Cover" class="cover-img">
                                    <div class="cover-overlay"></div>
                                    <!-- Cover Upload Button -->
                                    <button onclick="openCoverUploadModal()" class="cover-upload-btn">
                                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                d="M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z">
                                            </path>
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                d="M15 13a3 3 0 11-6 0 3 3 0 016 0z"></path>
                                        </svg>
                                    </button>
                                </div>

                                <div class="profile-main-info">
                                    <div class="profile-info-wrapper">
                                        <div class="profile-avatar-container">
                                            <img id="profile-avatar"
                                                src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='150' height='150'%3E%3Crect width='150' height='150' fill='%23e5e7eb'/%3E%3Ctext x='50%25' y='50%25' text-anchor='middle' dy='.3em' fill='%239ca3af' font-family='sans-serif' font-size='16'%3E150x150%3C/text%3E%3C/svg%3E"
                                                alt="Student Profile" class="profile-avatar">
                                            <span class="online-indicator"></span>

                                            <!-- Add Story Button (Ring around profile picture) -->
                                            <button onclick="openUploadStoryModal()"
                                                style="position: absolute; top: -5px; left: -5px; right: -5px; bottom: -5px;
                                                border-radius: 50%; background: linear-gradient(45deg, #f59e0b, #ef4444, #8b5cf6, #3b82f6);
                                                border: none; cursor: pointer; padding: 3px; z-index: 0; transition: all 0.3s ease;" title="Add Story">
                                                <div
                                                    style="width: 100%; height: 100%; border-radius: 50%; background: var(--card-bg);">
                                                </div>
                                            </button>

                                            <!-- Profile Picture Upload Button -->
                                            <button onclick="openProfileUploadModal()" class="avatar-upload-btn"
                                                style="z-index: 10;">
                                                <svg class="w-4 h-4" fill="none" stroke="currentColor"
                                                    viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round"
                                                        stroke-width="2"
                                                        d="M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z">
                                                    </path>
                                                    <path stroke-linecap="round" stroke-linejoin="round"
                                                        stroke-width="2" d="M15 13a3 3 0 11-6 0 3 3 0 016 0z"></path>
                                                </svg>
                                            </button>

                                            <!-- Add Story Plus Icon -->
                                            <button onclick="openUploadStoryModal()"
                                                style="position: absolute; bottom: 0; right: 0; background: linear-gradient(135deg, #f59e0b, #ef4444);
                                                color: white; border: 3px solid var(--card-bg); border-radius: 50%; width: 32px; height: 32px;
                                                display: flex; align-items: center; justify-content: center; cursor: pointer; z-index: 15;
                                                font-size: 18px; font-weight: bold; transition: all 0.3s ease; box-shadow: 0 2px 8px rgba(0,0,0,0.2);"
                                                title="Add Story">
                                                +
                                            </button>
                                        </div>

                                        <div class="profile-details-section" style="flex: 1; padding-top: 1.5rem;">
                                            <div class="profile-name-row" style="margin-bottom: 1.25rem;">
                                                <h1 class="profile-name" id="studentName"
                                                    style="margin-bottom: 0.5rem; white-space: nowrap !important; word-break: keep-all !important; max-width: none !important; width: auto !important; display: inline-block !important;">
                                                    Student Name</h1>
                                                <!-- Username field under name -->
                                                <div id="studentUsername"
                                                    style="font-size: 0.95rem; color: var(--text-muted); font-weight: 500; margin-bottom: 1rem;">
                                                    <!-- Username will be populated dynamically -->
                                                </div>
                                                <div class="badges-row"
                                                    style="display: flex; flex-wrap: wrap; gap: 0.75rem; margin-bottom: 1rem; margin-top: 1rem;">
                                                    <span class="profile-badge verified" id="verification-badge">‚úî
                                                        Verified Student</span>
                                                    <span class="profile-badge school" id="subject-badge">üìö
                                                        Grade 12</span>
                                                    <span class="profile-badge expert">‚≠ê Honor Roll Student</span>
                                                </div>
                                            </div>


                                            <div class="rating-section" style="margin-bottom: 1rem;">
                                                <div class="rating-wrapper"
                                                    style="display: flex; align-items: center; gap: 0.75rem;">
                                                    <div class="rating-tooltip-container">
                                                        <div class="rating-stars" id="rating-stars"
                                                            style="color: #f59e0b; font-size: 1.5rem; letter-spacing: 2px;">
                                                            ‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ</div>
                                                        <div class="rating-tooltip" id="rating-tooltip">
                                                            <h4
                                                                style="margin: 0 0 1rem 0; font-size: 0.9rem; font-weight: 600; color: var(--heading);">
                                                                Rating Breakdown</h4>

                                                            <div class="rating-metric">
                                                                <div class="metric-header">
                                                                    <span class="metric-label">Class Activity</span>
                                                                    <span class="metric-score">4.6</span>
                                                                </div>
                                                                <div class="metric-bar">
                                                                    <div class="metric-fill" style="width: 92%"></div>
                                                                </div>
                                                            </div>

                                                            <div class="rating-metric">
                                                                <div class="metric-header">
                                                                    <span class="metric-label">Discipline</span>
                                                                    <span class="metric-score">4.7</span>
                                                                </div>
                                                                <div class="metric-bar">
                                                                    <div class="metric-fill" style="width: 94%"></div>
                                                                </div>
                                                            </div>

                                                            <div class="rating-metric">
                                                                <div class="metric-header">
                                                                    <span class="metric-label">Punctuality</span>
                                                                    <span class="metric-score">4.4</span>
                                                                </div>
                                                                <div class="metric-bar">
                                                                    <div class="metric-fill" style="width: 88%"></div>
                                                                </div>
                                                            </div>

                                                            <div class="rating-metric">
                                                                <div class="metric-header">
                                                                    <span class="metric-label">Communication</span>
                                                                    <span class="metric-score">4.3</span>
                                                                </div>
                                                                <div class="metric-bar">
                                                                    <div class="metric-fill" style="width: 86%"></div>
                                                                </div>
                                                            </div>

                                                            <div class="rating-metric">
                                                                <div class="metric-header">
                                                                    <span class="metric-label">Subject Intake</span>
                                                                    <span class="metric-score">4.5</span>
                                                                </div>
                                                                <div class="metric-bar">
                                                                    <div class="metric-fill" style="width: 90%"></div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <span class="rating-value" id="student-rating"
                                                        style="font-size: 1.5rem; font-weight: 700; color: #f59e0b;">4.5</span>
                                                    <span class="rating-count" id="rating-count"
                                                        style="color: var(--text-secondary); font-size: 0.95rem; font-weight: 500;">(12
                                                        reviews)</span>
                                                </div>
                                            </div>

                                            <!-- Gender & Location -->
                                            <div class="profile-contact-info" id="gender-location-container"
                                                style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 0.75rem; margin-bottom: 0.75rem;">
                                                <!-- Gender -->
                                                <div id="gender-container"
                                                    style="display: flex; align-items: center; gap: 0.75rem; padding: 0.75rem 1rem; background: rgba(var(--button-bg-rgb), 0.05); border-radius: 12px;">
                                                    <span style="font-size: 1.25rem;">üë§</span>
                                                    <div style="flex: 1;">
                                                        <div
                                                            style="font-size: 0.75rem; color: var(--text-muted); margin-bottom: 0.125rem;">
                                                            Gender</div>
                                                        <div id="student-gender"
                                                            style="color: var(--text-muted); font-size: 0.875rem; font-weight: 500; font-style: italic;">
                                                            No gender yet</div>
                                                    </div>
                                                </div>

                                                <!-- Location -->
                                                <div id="location-container"
                                                    style="display: flex; align-items: center; gap: 0.75rem; padding: 0.75rem 1rem; background: rgba(var(--button-bg-rgb), 0.05); border-radius: 12px;">
                                                    <span style="font-size: 1.25rem;">üìç</span>
                                                    <div style="flex: 1;">
                                                        <div
                                                            style="font-size: 0.75rem; color: var(--text-muted); margin-bottom: 0.125rem;">
                                                            Location</div>
                                                        <div id="student-location"
                                                            style="color: var(--text-muted); font-size: 0.875rem; font-weight: 500; font-style: italic;">
                                                            No location yet</div>
                                                    </div>
                                                </div>
                                            </div>

                                            <!-- Contact Information (Email & Phone) -->
                                            <div class="profile-contact-info" id="contact-info-container"
                                                style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 0.75rem; margin-bottom: 0.75rem;">
                                                <!-- Email -->
                                                <div id="email-container"
                                                    style="display: flex; align-items: center; gap: 0.75rem; padding: 0.75rem 1rem; background: rgba(var(--button-bg-rgb), 0.05); border-radius: 12px;">
                                                    <span style="font-size: 1.25rem;">üìß</span>
                                                    <div style="flex: 1; overflow: hidden;">
                                                        <div
                                                            style="font-size: 0.75rem; color: var(--text-muted); margin-bottom: 0.125rem;">
                                                            Email</div>
                                                        <div id="student-email"
                                                            style="color: var(--text-muted); font-size: 0.875rem; font-weight: 500; font-style: italic; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;">
                                                            No email yet</div>
                                                    </div>
                                                </div>

                                                <!-- Phone -->
                                                <div id="phone-container"
                                                    style="display: flex; align-items: center; gap: 0.75rem; padding: 0.75rem 1rem; background: rgba(var(--button-bg-rgb), 0.05); border-radius: 12px;">
                                                    <span style="font-size: 1.25rem;">üì±</span>
                                                    <div style="flex: 1;">
                                                        <div
                                                            style="font-size: 0.75rem; color: var(--text-muted); margin-bottom: 0.125rem;">
                                                            Phone</div>
                                                        <div id="student-phone"
                                                            style="color: var(--text-muted); font-size: 0.875rem; font-weight: 500; font-style: italic;">
                                                            No phone yet</div>
                                                    </div>
                                                </div>
                                            </div>

                                            <!-- Currently Studying At & Grade Level -->
                                            <div class="profile-contact-info"
                                                style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 0.75rem; margin-bottom: 0.75rem;">
                                                <div id="school-container"
                                                    style="display: flex; align-items: center; gap: 0.75rem; padding: 0.75rem 1rem; background: rgba(var(--button-bg-rgb), 0.05); border-radius: 12px;">
                                                    <span style="font-size: 1.25rem;">üè´</span>
                                                    <div style="flex: 1;">
                                                        <div
                                                            style="font-size: 0.75rem; color: var(--text-muted); margin-bottom: 0.125rem;">
                                                            Currently Studying At</div>
                                                        <div id="student-school"
                                                            style="color: var(--text-muted); font-size: 0.875rem; font-weight: 500; font-style: italic;">
                                                            No school yet</div>
                                                    </div>
                                                </div>
                                                <div id="grade-container"
                                                    style="display: flex; align-items: center; gap: 0.75rem; padding: 0.75rem 1rem; background: rgba(var(--button-bg-rgb), 0.05); border-radius: 12px;">
                                                    <span style="font-size: 1.25rem;">üéì</span>
                                                    <div style="flex: 1;">
                                                        <div
                                                            style="font-size: 0.75rem; color: var(--text-muted); margin-bottom: 0.125rem;">
                                                            Grade Level</div>
                                                        <div id="student-grade"
                                                            style="color: var(--text-muted); font-size: 0.875rem; font-weight: 500; font-style: italic;">
                                                            No grade yet</div>
                                                    </div>
                                                </div>
                                            </div>

                                            <!-- Interested In & Preferred Learning Method -->
                                            <div class="profile-contact-info"
                                                style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 0.75rem; margin-bottom: 0.75rem;">
                                                <div id="subjects-container"
                                                    style="display: flex; align-items: center; gap: 0.75rem; padding: 0.75rem 1rem; background: rgba(var(--button-bg-rgb), 0.05); border-radius: 12px;">
                                                    <span style="font-size: 1.25rem;">üìö</span>
                                                    <div style="flex: 1;">
                                                        <div
                                                            style="font-size: 0.75rem; color: var(--text-muted); margin-bottom: 0.125rem;">
                                                            Interested In</div>
                                                        <div id="student-subjects"
                                                            style="color: var(--text-muted); font-size: 0.875rem; font-weight: 500; font-style: italic;">
                                                            No interests yet</div>
                                                    </div>
                                                </div>
                                                <div id="learning-methods-container"
                                                    style="display: flex; align-items: center; gap: 0.75rem; padding: 0.75rem 1rem; background: rgba(var(--button-bg-rgb), 0.05); border-radius: 12px;">
                                                    <span style="font-size: 1.25rem;">üéØ</span>
                                                    <div style="flex: 1;">
                                                        <div
                                                            style="font-size: 0.75rem; color: var(--text-muted); margin-bottom: 0.125rem;">
                                                            Preferred Learning Method</div>
                                                        <div id="student-learning-methods"
                                                            style="color: var(--text-muted); font-size: 0.875rem; font-weight: 500; font-style: italic;">
                                                            No learning methods yet</div>
                                                    </div>
                                                </div>
                                            </div>

                                            <!-- Languages & Hobbies -->
                                            <div class="profile-contact-info"
                                                style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 0.75rem; margin-bottom: 0.75rem;">
                                                <div id="languages-display-container"
                                                    style="display: flex; align-items: center; gap: 0.75rem; padding: 0.75rem 1rem; background: rgba(var(--button-bg-rgb), 0.05); border-radius: 12px;">
                                                    <span style="font-size: 1.25rem;">üåê</span>
                                                    <div style="flex: 1;">
                                                        <div
                                                            style="font-size: 0.75rem; color: var(--text-muted); margin-bottom: 0.125rem;">
                                                            Languages</div>
                                                        <div id="student-languages"
                                                            style="color: var(--text-muted); font-size: 0.875rem; font-weight: 500; font-style: italic;">
                                                            No languages yet</div>
                                                    </div>
                                                </div>
                                                <div id="hobbies-display-container"
                                                    style="display: flex; align-items: center; gap: 0.75rem; padding: 0.75rem 1rem; background: rgba(var(--button-bg-rgb), 0.05); border-radius: 12px;">
                                                    <span style="font-size: 1.25rem;">üé®</span>
                                                    <div style="flex: 1;">
                                                        <div
                                                            style="font-size: 0.75rem; color: var(--text-muted); margin-bottom: 0.125rem;">
                                                            Hobbies & Interests</div>
                                                        <div id="student-hobbies"
                                                            style="color: var(--text-muted); font-size: 0.875rem; font-weight: 500; font-style: italic;">
                                                            No hobbies yet</div>
                                                    </div>
                                                </div>
                                            </div>

                                            <div class="profile-quote">
                                                <span id="student-quote" style="color: var(--text-muted); font-style: italic;">No quote yet</span>
                                            </div>

                                            <!-- Connections Section -->
                                            <div class="profile-connections" style="margin-top: 1.5rem;">
                                                <div class="connections-header"
                                                    style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                                                    <h4
                                                        style="font-weight: 600; font-size: 0.95rem; color: var(--heading);">
                                                        <span style="margin-right: 0.5rem;">üë•</span>Community
                                                    </h4>
                                                    <button onclick="openCommunityModal()" class="btn-sm"
                                                        style="font-size: 0.75rem; padding: 0.25rem 0.75rem;">
                                                        View All
                                                    </button>
                                                </div>
                                                <div class="connections-stats"
                                                    style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 1rem; text-align: center;">
                                                    <div class="stat-box" onclick="openCommunityModal('requests')"
                                                        style="padding: 0.75rem; background: rgba(var(--button-bg-rgb), 0.05); border-radius: var(--radius-md); cursor: pointer; transition: all 0.2s ease;"
                                                        onmouseover="this.style.background='rgba(var(--button-bg-rgb), 0.1)'; this.style.transform='translateY(-2px)'"
                                                        onmouseout="this.style.background='rgba(var(--button-bg-rgb), 0.05)'; this.style.transform='none'">
                                                        <div style="font-size: 1.5rem; font-weight: 700; color: var(--heading);"
                                                            id="profile-header-requests-count">0</div>
                                                        <div
                                                            style="font-size: 0.75rem; color: var(--text-muted); margin-top: 0.25rem;">
                                                            üì© Requests</div>
                                                    </div>
                                                    <div class="stat-box" onclick="openCommunityModal('connections')"
                                                        style="padding: 0.75rem; background: rgba(var(--button-bg-rgb), 0.05); border-radius: var(--radius-md); cursor: pointer; transition: all 0.2s ease;"
                                                        onmouseover="this.style.background='rgba(var(--button-bg-rgb), 0.1)'; this.style.transform='translateY(-2px)'"
                                                        onmouseout="this.style.background='rgba(var(--button-bg-rgb), 0.05)'; this.style.transform='none'">
                                                        <div style="font-size: 1.5rem; font-weight: 700; color: var(--heading);"
                                                            id="profile-header-connections-count">0</div>
                                                        <div
                                                            style="font-size: 0.75rem; color: var(--text-muted); margin-top: 0.25rem;">
                                                            üîó Connections</div>
                                                    </div>
                                                </div>
                                            </div>

                                            <div class="profile-actions">
                                                <button onclick="openEditProfileModal()" class="btn-primary">
                                                    <span class="mr-2">‚úèÔ∏è</span>
                                                    Edit Profile
                                                </button>
                                                <button onclick="openChatModal()" class="btn-secondary ml-2">
                                                    <span class="mr-2">üí¨</span>
                                                    Message
                                                </button>
                                                <button onclick="shareProfile()" class="btn-secondary ml-2">
                                                    <span class="mr-2">üîó</span>
                                                    Share Profile
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </section>

                            <!-- About Section -->
                            <section
                                style="background: var(--card-bg); border-radius: 16px; padding: 2rem; margin-bottom: 2rem; box-shadow: 0 2px 8px rgba(0,0,0,0.08);">
                                <h3
                                    style="font-size: 1.5rem; font-weight: 700; margin-bottom: 1rem; color: var(--heading);">
                                    About Me</h3>
                                <p id="student-bio" style="color: var(--text-muted); line-height: 1.7; font-style: italic;">No bio yet</p>
                            </section>


                            <!-- Page Header -->
                            <div class="mb-8 animate-fadeIn">
                                <h1 class="text-3xl font-bold mb-2">Student Statistics</h1>
                                <p class="text-gray-600">Statstics of your academic activities, courses, and performance
                                </p>
                            </div>


                            <!-- All Statistics Cards -->
                            <div class="dashboard-grid mb-8">
                                <!-- Learning Statistics -->
                                <div class="card p-4">
                                    <div class="flex items-center gap-3 mb-2">
                                        <span class="text-3xl">üìö</span>
                                        <h3 class="text-lg font-semibold">Total Courses</h3>
                                    </div>
                                    <p class="text-2xl font-bold" id="stat-total-courses">0</p>
                                    <span class="text-sm text-gray-500">All time</span>
                                </div>

                                <div class="card p-4">
                                    <div class="flex items-center gap-3 mb-2">
                                        <span class="text-3xl">üìñ</span>
                                        <h3 class="text-lg font-semibold">Active Courses</h3>
                                    </div>
                                    <p class="text-2xl font-bold text-blue-600" id="stat-active-courses">0</p>
                                    <span class="text-sm text-gray-500">Current</span>
                                </div>

                                <div class="card p-4">
                                    <div class="flex items-center gap-3 mb-2">
                                        <span class="text-3xl">üë®‚Äçüè´</span>
                                        <h3 class="text-lg font-semibold">My Tutors</h3>
                                    </div>
                                    <p class="text-2xl font-bold" id="stat-tutors">0</p>
                                    <span class="text-sm text-gray-500" id="stat-tutors-list">-</span>
                                </div>

                                <div class="card p-4">
                                    <div class="flex items-center gap-3 mb-2">
                                        <span class="text-3xl">üìÖ</span>
                                        <h3 class="text-lg font-semibold">Assignments Completed</h3>
                                    </div>
                                    <p class="text-2xl font-bold text-purple-600" id="stat-assignments">0</p>
                                    <span class="text-sm text-gray-500">This year</span>
                                </div>
                                
                                <div class="card p-4">
                                    <div class="flex items-center gap-3 mb-2">
                                        <span class="text-3xl">üéØ</span>
                                        <h3 class="text-lg font-semibold">Completion Rate</h3>
                                    </div>
                                    <p class="text-2xl font-bold text-green-600" id="stat-completion-rate">0%</p>
                                    <span class="text-sm text-gray-500">Courses completed</span>
                                </div>

                                <div class="card p-4">
                                    <div class="flex items-center gap-3 mb-2">
                                        <span class="text-3xl">üìà</span>
                                        <h3 class="text-lg font-semibold">Improvement Rate</h3>
                                    </div>
                                    <p class="text-2xl font-bold text-yellow-600" id="stat-improvement-rate">0%</p>
                                    <span class="text-sm text-gray-500">Learning progress</span>
                                </div>

                                <div class="card p-4">
                                    <div class="flex items-center gap-3 mb-2">
                                        <span class="text-3xl">‚≠ê</span>
                                        <h3 class="text-lg font-semibold">Rating</h3>
                                    </div>
                                    <p class="text-2xl font-bold text-green-600"><span id="stat-rating">0.0</span>/5.0
                                    </p>
                                    <span class="text-sm text-gray-500">From reviews</span>
                                </div>

                                <div class="card p-4">
                                    <div class="flex items-center gap-3 mb-2">
                                        <span class="text-3xl">üìä</span>
                                        <h3 class="text-lg font-semibold">GPA</h3>
                                    </div>
                                    <p class="text-2xl font-bold text-orange-600"><span id="stat-gpa">0.0</span>/4.0
                                    </p>
                                    <span class="text-sm text-gray-500">Current</span>
                                </div>
                            </div>


                            <!-- Reviews Section -->
                            <div class="card p-6 mb-8">
                                <h3 class="text-xl font-semibold mb-4">Recent Feedback from Tutors</h3>
                                <div id="recent-feedback-container" class="space-y-4">
                                    <!-- Reviews will be loaded dynamically -->
                                    <div style="text-align: center; padding: 3rem 2rem; color: var(--text-secondary);">
                                        <div style="font-size: 3rem; margin-bottom: 1rem; opacity: 0.5;">‚è≥</div>
                                        <p style="font-size: 1.125rem; font-weight: 500;">Loading feedback...</p>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Overview Panel -->
                        <div id="analysis-panel" class="panel-content hidden">
                            <h2
                                style="font-size: 2rem; font-weight: 700; margin-bottom: 2rem; color: var(--heading); display: flex; align-items: center; gap: 0.75rem;">
                                <span>üë§</span> Student Overview
                            </h2>

                            <!-- Academic Profile Summary -->
                            <section
                                style="background: var(--card-bg); border-radius: 16px; padding: 2rem; margin-bottom: 2rem; box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);">
                                <h3
                                    style="font-size: 1.5rem; font-weight: 600; margin-bottom: 1.5rem; color: var(--heading); display: flex; align-items: center; gap: 0.5rem;">
                                    <span>üìã</span> Academic Profile
                                </h3>
                                <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 1.5rem;">
                                    <div
                                        style="padding: 1.25rem; background: rgba(var(--button-bg-rgb), 0.05); border-radius: 12px; border-left: 4px solid #3b82f6;">
                                        <p
                                            style="font-size: 0.875rem; color: var(--text-secondary); margin-bottom: 0.5rem;">
                                            Student ID</p>
                                        <p style="font-size: 1.25rem; font-weight: 600; color: var(--heading);">
                                            STD-2024-0542</p>
                                    </div>
                                    <div
                                        style="padding: 1.25rem; background: rgba(var(--button-bg-rgb), 0.05); border-radius: 12px; border-left: 4px solid #10b981;">
                                        <p
                                            style="font-size: 0.875rem; color: var(--text-secondary); margin-bottom: 0.5rem;">
                                            Grade Level</p>
                                        <p style="font-size: 1.25rem; font-weight: 600; color: var(--heading);">Grade 12
                                            (Senior Year)</p>
                                    </div>
                                    <div
                                        style="padding: 1.25rem; background: rgba(var(--button-bg-rgb), 0.05); border-radius: 12px; border-left: 4px solid #f59e0b;">
                                        <p
                                            style="font-size: 0.875rem; color: var(--text-secondary); margin-bottom: 0.5rem;">
                                            Academic Track</p>
                                        <p style="font-size: 1.25rem; font-weight: 600; color: var(--heading);">Natural
                                            Sciences</p>
                                    </div>
                                    <div
                                        style="padding: 1.25rem; background: rgba(var(--button-bg-rgb), 0.05); border-radius: 12px; border-left: 4px solid #8b5cf6;">
                                        <p
                                            style="font-size: 0.875rem; color: var(--text-secondary); margin-bottom: 0.5rem;">
                                            Enrollment Date</p>
                                        <p style="font-size: 1.25rem; font-weight: 600; color: var(--heading);">January
                                            2020</p>
                                    </div>
                                    <div
                                        style="padding: 1.25rem; background: rgba(var(--button-bg-rgb), 0.05); border-radius: 12px; border-left: 4px solid #ef4444;">
                                        <p
                                            style="font-size: 0.875rem; color: var(--text-secondary); margin-bottom: 0.5rem;">
                                            Expected Graduation</p>
                                        <p style="font-size: 1.25rem; font-weight: 600; color: var(--heading);">June
                                            2025</p>
                                    </div>
                                    <div
                                        style="padding: 1.25rem; background: rgba(var(--button-bg-rgb), 0.05); border-radius: 12px; border-left: 4px solid #06b6d4;">
                                        <p
                                            style="font-size: 0.875rem; color: var(--text-secondary); margin-bottom: 0.5rem;">
                                            Years in School</p>
                                        <p style="font-size: 1.25rem; font-weight: 600; color: var(--heading);">4 Years
                                        </p>
                                    </div>
                                </div>
                            </section>

                            <!-- Learning Progress Tracker -->
                            <section
                                style="background: var(--card-bg); border-radius: 16px; padding: 2rem; margin-bottom: 2rem; box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);">
                                <h3
                                    style="font-size: 1.5rem; font-weight: 600; margin-bottom: 1.5rem; color: var(--heading); display: flex; align-items: center; gap: 0.5rem;">
                                    <span>üìà</span> Learning Progress Tracker
                                </h3>
                                <div style="display: flex; flex-direction: column; gap: 1.5rem;">
                                    <!-- Mathematics Progress -->
                                    <div>
                                        <div
                                            style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.5rem;">
                                            <span style="font-weight: 600; color: var(--heading);">üìê Mathematics</span>
                                            <span style="font-weight: 600; color: #3b82f6;">92%</span>
                                        </div>
                                        <div
                                            style="width: 100%; height: 12px; background: rgba(var(--button-bg-rgb), 0.1); border-radius: 6px; overflow: hidden;">
                                            <div
                                                style="width: 92%; height: 100%; background: linear-gradient(90deg, #3b82f6, #2563eb); border-radius: 6px; transition: width 1s ease;">
                                            </div>
                                        </div>
                                        <p
                                            style="font-size: 0.875rem; color: var(--text-secondary); margin-top: 0.25rem;">
                                            Excellent problem-solving skills, advanced calculus mastery</p>
                                    </div>

                                    <!-- Physics Progress -->
                                    <div>
                                        <div
                                            style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.5rem;">
                                            <span style="font-weight: 600; color: var(--heading);">‚öõÔ∏è Physics</span>
                                            <span style="font-weight: 600; color: #10b981;">88%</span>
                                        </div>
                                        <div
                                            style="width: 100%; height: 12px; background: rgba(var(--button-bg-rgb), 0.1); border-radius: 6px; overflow: hidden;">
                                            <div
                                                style="width: 88%; height: 100%; background: linear-gradient(90deg, #10b981, #059669); border-radius: 6px; transition: width 1s ease;">
                                            </div>
                                        </div>
                                        <p
                                            style="font-size: 0.875rem; color: var(--text-secondary); margin-top: 0.25rem;">
                                            Strong theoretical understanding, improving lab skills</p>
                                    </div>

                                    <!-- Chemistry Progress -->
                                    <div>
                                        <div
                                            style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.5rem;">
                                            <span style="font-weight: 600; color: var(--heading);">üß™ Chemistry</span>
                                            <span style="font-weight: 600; color: #8b5cf6;">95%</span>
                                        </div>
                                        <div
                                            style="width: 100%; height: 12px; background: rgba(var(--button-bg-rgb), 0.1); border-radius: 6px; overflow: hidden;">
                                            <div
                                                style="width: 95%; height: 100%; background: linear-gradient(90deg, #8b5cf6, #7c3aed); border-radius: 6px; transition: width 1s ease;">
                                            </div>
                                        </div>
                                        <p
                                            style="font-size: 0.875rem; color: var(--text-secondary); margin-top: 0.25rem;">
                                            Outstanding organic chemistry knowledge, lab excellence</p>
                                    </div>

                                    <!-- Biology Progress -->
                                    <div>
                                        <div
                                            style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.5rem;">
                                            <span style="font-weight: 600; color: var(--heading);">üß¨ Biology</span>
                                            <span style="font-weight: 600; color: #22c55e;">87%</span>
                                        </div>
                                        <div
                                            style="width: 100%; height: 12px; background: rgba(var(--button-bg-rgb), 0.1); border-radius: 6px; overflow: hidden;">
                                            <div
                                                style="width: 87%; height: 100%; background: linear-gradient(90deg, #22c55e, #16a34a); border-radius: 6px; transition: width 1s ease;">
                                            </div>
                                        </div>
                                        <p
                                            style="font-size: 0.875rem; color: var(--text-secondary); margin-top: 0.25rem;">
                                            Strong genetics knowledge, active in lab research</p>
                                    </div>

                                    <!-- English Progress -->
                                    <div>
                                        <div
                                            style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.5rem;">
                                            <span style="font-weight: 600; color: var(--heading);">üìö English</span>
                                            <span style="font-weight: 600; color: #f59e0b;">90%</span>
                                        </div>
                                        <div
                                            style="width: 100%; height: 12px; background: rgba(var(--button-bg-rgb), 0.1); border-radius: 6px; overflow: hidden;">
                                            <div
                                                style="width: 90%; height: 100%; background: linear-gradient(90deg, #f59e0b, #d97706); border-radius: 6px; transition: width 1s ease;">
                                            </div>
                                        </div>
                                        <p
                                            style="font-size: 0.875rem; color: var(--text-secondary); margin-top: 0.25rem;">
                                            Strong writing skills, active debate team participant</p>
                                    </div>
                                </div>
                            </section>

                            <!-- Study Habits & Patterns -->
                            <section
                                style="background: var(--card-bg); border-radius: 16px; padding: 2rem; margin-bottom: 2rem; box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);">
                                <h3
                                    style="font-size: 1.5rem; font-weight: 600; margin-bottom: 1.5rem; color: var(--heading); display: flex; align-items: center; gap: 0.5rem;">
                                    <span>üìñ</span> Study Habits & Patterns
                                </h3>
                                <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 1.5rem;">
                                    <div
                                        style="padding: 1.5rem; background: linear-gradient(135deg, rgba(59, 130, 246, 0.1), rgba(37, 99, 235, 0.05)); border-radius: 12px;">
                                        <div
                                            style="display: flex; align-items: center; gap: 1rem; margin-bottom: 1rem;">
                                            <span style="font-size: 2.5rem;">‚è∞</span>
                                            <div>
                                                <p style="font-size: 0.875rem; color: var(--text-secondary);">Average
                                                    Study Time</p>
                                                <p style="font-size: 1.5rem; font-weight: 700; color: var(--heading);">
                                                    24 hrs/week</p>
                                            </div>
                                        </div>
                                        <p style="font-size: 0.875rem; color: var(--text); line-height: 1.6;">Consistent
                                            study schedule, prefers evening sessions (6-9 PM)</p>
                                    </div>

                                    <div
                                        style="padding: 1.5rem; background: linear-gradient(135deg, rgba(16, 185, 129, 0.1), rgba(5, 150, 105, 0.05)); border-radius: 12px;">
                                        <div
                                            style="display: flex; align-items: center; gap: 1rem; margin-bottom: 1rem;">
                                            <span style="font-size: 2.5rem;">üéØ</span>
                                            <div>
                                                <p style="font-size: 0.875rem; color: var(--text-secondary);">Assignment
                                                    Completion</p>
                                                <p style="font-size: 1.5rem; font-weight: 700; color: var(--heading);">
                                                    98%</p>
                                            </div>
                                        </div>
                                        <p style="font-size: 0.875rem; color: var(--text); line-height: 1.6;">Excellent
                                            time management, rarely misses deadlines</p>
                                    </div>

                                    <div
                                        style="padding: 1.5rem; background: linear-gradient(135deg, rgba(245, 158, 11, 0.1), rgba(217, 119, 6, 0.05)); border-radius: 12px;">
                                        <div
                                            style="display: flex; align-items: center; gap: 1rem; margin-bottom: 1rem;">
                                            <span style="font-size: 2.5rem;">üë•</span>
                                            <div>
                                                <p style="font-size: 0.875rem; color: var(--text-secondary);">Learning
                                                    Style</p>
                                                <p style="font-size: 1.5rem; font-weight: 700; color: var(--heading);">
                                                    Collaborative</p>
                                            </div>
                                        </div>
                                        <p style="font-size: 0.875rem; color: var(--text); line-height: 1.6;">Excels in
                                            group projects, helps peers understand concepts</p>
                                    </div>

                                    <div
                                        style="padding: 1.5rem; background: linear-gradient(135deg, rgba(139, 92, 246, 0.1), rgba(124, 58, 237, 0.05)); border-radius: 12px;">
                                        <div
                                            style="display: flex; align-items: center; gap: 1rem; margin-bottom: 1rem;">
                                            <span style="font-size: 2.5rem;">üîç</span>
                                            <div>
                                                <p style="font-size: 0.875rem; color: var(--text-secondary);">Research
                                                    Skills</p>
                                                <p style="font-size: 1.5rem; font-weight: 700; color: var(--heading);">
                                                    Advanced</p>
                                            </div>
                                        </div>
                                        <p style="font-size: 0.875rem; color: var(--text); line-height: 1.6;">
                                            Independently researches topics, uses credible sources</p>
                                    </div>
                                </div>
                            </section>

                            <!-- Attendance & Participation -->
                            <section
                                style="background: var(--card-bg); border-radius: 16px; padding: 2rem; margin-bottom: 2rem; box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);">
                                <h3
                                    style="font-size: 1.5rem; font-weight: 600; margin-bottom: 1.5rem; color: var(--heading); display: flex; align-items: center; gap: 0.5rem;">
                                    <span>‚úÖ</span> Attendance & Participation
                                </h3>
                                <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 1.5rem;">
                                    <div
                                        style="text-align: center; padding: 1.5rem; background: linear-gradient(135deg, rgba(34, 197, 94, 0.1), rgba(22, 163, 74, 0.05)); border-radius: 12px;">
                                        <div style="font-size: 3rem; margin-bottom: 0.5rem;">96%</div>
                                        <p style="font-weight: 600; color: var(--heading); margin-bottom: 0.25rem;">
                                            Attendance Rate</p>
                                        <p style="font-size: 0.875rem; color: var(--text-secondary);">4 absences this
                                            year</p>
                                    </div>
                                    <div
                                        style="text-align: center; padding: 1.5rem; background: linear-gradient(135deg, rgba(59, 130, 246, 0.1), rgba(37, 99, 235, 0.05)); border-radius: 12px;">
                                        <div style="font-size: 3rem; margin-bottom: 0.5rem;">94%</div>
                                        <p style="font-weight: 600; color: var(--heading); margin-bottom: 0.25rem;">
                                            Class Participation</p>
                                        <p style="font-size: 0.875rem; color: var(--text-secondary);">Active contributor
                                        </p>
                                    </div>
                                    <div
                                        style="text-align: center; padding: 1.5rem; background: linear-gradient(135deg, rgba(139, 92, 246, 0.1), rgba(124, 58, 237, 0.05)); border-radius: 12px;">
                                        <div style="font-size: 3rem; margin-bottom: 0.5rem;">100%</div>
                                        <p style="font-weight: 600; color: var(--heading); margin-bottom: 0.25rem;">
                                            Punctuality</p>
                                        <p style="font-size: 0.875rem; color: var(--text-secondary);">Never late</p>
                                    </div>
                                </div>
                            </section>

                            <!-- Tutor Engagement History -->
                            <section
                                style="background: var(--card-bg); border-radius: 16px; padding: 2rem; box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);">
                                <h3
                                    style="font-size: 1.5rem; font-weight: 600; margin-bottom: 1.5rem; color: var(--heading); display: flex; align-items: center; gap: 0.5rem;">
                                    <span>üë®‚Äçüè´</span> Tutor Engagement History
                                </h3>
                                <div style="display: flex; flex-direction: column; gap: 1rem;">
                                    <div
                                        style="display: flex; align-items: center; gap: 1rem; padding: 1.25rem; background: rgba(var(--button-bg-rgb), 0.05); border-radius: 12px; border-left: 4px solid #3b82f6;">
                                        <div style="width: 60px; height: 60px; border-radius: 50%; background: linear-gradient(135deg, #3b82f6, #1d4ed8); display: flex; align-items: center; justify-content: center; color: white; font-weight: 700; font-size: 1.25rem; flex-shrink: 0;">TA</div>
                                        <div style="flex: 1;">
                                            <p style="font-weight: 600; color: var(--heading); margin-bottom: 0.25rem;">
                                                Dr. Tesfaye Alemu</p>
                                            <p style="font-size: 0.875rem; color: var(--text-secondary);">Physics ‚Ä¢ 24
                                                sessions completed</p>
                                        </div>
                                        <div style="text-align: right;">
                                            <p style="font-size: 0.75rem; color: var(--text-secondary);">Last Session
                                            </p>
                                            <p style="font-weight: 600; color: var(--heading);">Jan 15, 2024</p>
                                        </div>
                                    </div>
                                    <div
                                        style="display: flex; align-items: center; gap: 1rem; padding: 1.25rem; background: rgba(var(--button-bg-rgb), 0.05); border-radius: 12px; border-left: 4px solid #10b981;">
                                        <div style="width: 60px; height: 60px; border-radius: 50%; background: linear-gradient(135deg, #f59e0b, #d97706); display: flex; align-items: center; justify-content: center; color: white; font-weight: 700; font-size: 1.25rem; flex-shrink: 0;">SB</div>
                                        <div style="flex: 1;">
                                            <p style="font-weight: 600; color: var(--heading); margin-bottom: 0.25rem;">
                                                Prof. Sara Bekele</p>
                                            <p style="font-size: 0.875rem; color: var(--text-secondary);">Mathematics ‚Ä¢
                                                18 sessions completed</p>
                                        </div>
                                        <div style="text-align: right;">
                                            <p style="font-size: 0.75rem; color: var(--text-secondary);">Last Session
                                            </p>
                                            <p style="font-weight: 600; color: var(--heading);">Jan 12, 2024</p>
                                        </div>
                                    </div>
                                    <div
                                        style="display: flex; align-items: center; gap: 1rem; padding: 1.25rem; background: rgba(var(--button-bg-rgb), 0.05); border-radius: 12px; border-left: 4px solid #f59e0b;">
                                        <div style="width: 60px; height: 60px; border-radius: 50%; background: linear-gradient(135deg, #8b5cf6, #6d28d9); display: flex; align-items: center; justify-content: center; color: white; font-weight: 700; font-size: 1.25rem; flex-shrink: 0;">MH</div>
                                        <div style="flex: 1;">
                                            <p style="font-weight: 600; color: var(--heading); margin-bottom: 0.25rem;">
                                                Dr. Mekonnen Haile</p>
                                            <p style="font-size: 0.875rem; color: var(--text-secondary);">Chemistry ‚Ä¢ 12
                                                sessions completed</p>
                                        </div>
                                        <div style="text-align: right;">
                                            <p style="font-size: 0.75rem; color: var(--text-secondary);">Last Session
                                            </p>
                                            <p style="font-weight: 600; color: var(--heading);">Jan 8, 2024</p>
                                        </div>
                                    </div>
                                </div>
                            </section>

                            <!-- Academic Performance Section -->
                            <h2
                                style="font-size: 2rem; font-weight: 700; margin: 3rem 0 2rem 0; color: var(--heading); display: flex; align-items: center; gap: 0.75rem;">
                                <span>üìà</span> Academic Performance
                            </h2>

                            <!-- Performance Summary Stats -->
                            <section
                                style="background: var(--card-bg); border-radius: 16px; padding: 2rem; margin-bottom: 2rem; box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);">
                                <h3
                                    style="font-size: 1.5rem; font-weight: 600; margin-bottom: 1.5rem; color: var(--heading); display: flex; align-items: center; gap: 0.5rem;">
                                    <span>üìä</span> Performance Summary
                                </h3>
                                <div
                                    style="display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: 1.5rem;">
                                    <div
                                        style="padding: 1.75rem; background: linear-gradient(135deg, rgba(59, 130, 246, 0.1), rgba(37, 99, 235, 0.05)); border-radius: 12px; text-align: center; border: 1px solid rgba(59, 130, 246, 0.2);">
                                        <div
                                            style="font-size: 3rem; font-weight: 700; color: #3b82f6; margin-bottom: 0.5rem;">
                                            3.8</div>
                                        <div
                                            style="font-size: 0.875rem; color: var(--text-secondary); font-weight: 600; margin-bottom: 0.25rem;">
                                            Overall GPA</div>
                                        <div style="font-size: 0.75rem; color: #10b981; font-weight: 500;">‚Üë +0.2 from
                                            last semester</div>
                                    </div>
                                    <div
                                        style="padding: 1.75rem; background: linear-gradient(135deg, rgba(16, 185, 129, 0.1), rgba(5, 150, 105, 0.05)); border-radius: 12px; text-align: center; border: 1px solid rgba(16, 185, 129, 0.2);">
                                        <div
                                            style="font-size: 3rem; font-weight: 700; color: #10b981; margin-bottom: 0.5rem;">
                                            92%</div>
                                        <div
                                            style="font-size: 0.875rem; color: var(--text-secondary); font-weight: 600; margin-bottom: 0.25rem;">
                                            Average Score</div>
                                        <div style="font-size: 0.75rem; color: #10b981; font-weight: 500;">Top 5% of
                                            class</div>
                                    </div>
                                    <div
                                        style="padding: 1.75rem; background: linear-gradient(135deg, rgba(245, 158, 11, 0.1), rgba(217, 119, 6, 0.05)); border-radius: 12px; text-align: center; border: 1px solid rgba(245, 158, 11, 0.2);">
                                        <div
                                            style="font-size: 3rem; font-weight: 700; color: #f59e0b; margin-bottom: 0.5rem;">
                                            5/120</div>
                                        <div
                                            style="font-size: 0.875rem; color: var(--text-secondary); font-weight: 600; margin-bottom: 0.25rem;">
                                            Class Ranking</div>
                                        <div style="font-size: 0.75rem; color: #10b981; font-weight: 500;">‚Üë Improved
                                            from 8th</div>
                                    </div>
                                    <div
                                        style="padding: 1.75rem; background: linear-gradient(135deg, rgba(139, 92, 246, 0.1), rgba(124, 58, 237, 0.05)); border-radius: 12px; text-align: center; border: 1px solid rgba(139, 92, 246, 0.2);">
                                        <div
                                            style="font-size: 3rem; font-weight: 700; color: #8b5cf6; margin-bottom: 0.5rem;">
                                            A</div>
                                        <div
                                            style="font-size: 0.875rem; color: var(--text-secondary); font-weight: 600; margin-bottom: 0.25rem;">
                                            Grade Level</div>
                                        <div style="font-size: 0.75rem; color: #10b981; font-weight: 500;">Honor Roll
                                            Status</div>
                                    </div>
                                </div>
                            </section>

                            <!-- GPA Trend Over Time -->
                            <section
                                style="background: var(--card-bg); border-radius: 16px; padding: 2rem; margin-bottom: 2rem; box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);">
                                <h3
                                    style="font-size: 1.5rem; font-weight: 600; margin-bottom: 1.5rem; color: var(--heading); display: flex; align-items: center; gap: 0.5rem;">
                                    <span>üìâ</span> GPA Trend (4-Year History)
                                </h3>
                                <div
                                    style="display: flex; align-items: flex-end; justify-content: space-around; height: 300px; border-bottom: 2px solid rgba(var(--border-rgb), 0.2); position: relative;">
                                    <!-- Y-axis labels -->
                                    <div
                                        style="position: absolute; left: -30px; top: 0; height: 100%; display: flex; flex-direction: column; justify-content: space-between; font-size: 0.75rem; color: var(--text-secondary);">
                                        <span>4.0</span>
                                        <span>3.5</span>
                                        <span>3.0</span>
                                        <span>2.5</span>
                                        <span>2.0</span>
                                    </div>

                                    <!-- Grade 9 -->
                                    <div
                                        style="display: flex; flex-direction: column; align-items: center; gap: 0.5rem; flex: 1;">
                                        <div
                                            style="width: 60px; height: 180px; background: linear-gradient(180deg, #3b82f6, #2563eb); border-radius: 8px 8px 0 0; position: relative; display: flex; align-items: flex-start; justify-content: center; padding-top: 0.5rem;">
                                            <span
                                                style="color: white; font-weight: 700; font-size: 1.125rem;">3.6</span>
                                        </div>
                                        <span style="font-weight: 600; color: var(--text); font-size: 0.875rem;">Grade
                                            9</span>
                                        <span style="font-size: 0.75rem; color: var(--text-secondary);">2021</span>
                                    </div>

                                    <!-- Grade 10 -->
                                    <div
                                        style="display: flex; flex-direction: column; align-items: center; gap: 0.5rem; flex: 1;">
                                        <div
                                            style="width: 60px; height: 200px; background: linear-gradient(180deg, #10b981, #059669); border-radius: 8px 8px 0 0; position: relative; display: flex; align-items: flex-start; justify-content: center; padding-top: 0.5rem;">
                                            <span
                                                style="color: white; font-weight: 700; font-size: 1.125rem;">3.7</span>
                                        </div>
                                        <span style="font-weight: 600; color: var(--text); font-size: 0.875rem;">Grade
                                            10</span>
                                        <span style="font-size: 0.75rem; color: var(--text-secondary);">2022</span>
                                    </div>

                                    <!-- Grade 11 -->
                                    <div
                                        style="display: flex; flex-direction: column; align-items: center; gap: 0.5rem; flex: 1;">
                                        <div
                                            style="width: 60px; height: 200px; background: linear-gradient(180deg, #f59e0b, #d97706); border-radius: 8px 8px 0 0; position: relative; display: flex; align-items: flex-start; justify-content: center; padding-top: 0.5rem;">
                                            <span
                                                style="color: white; font-weight: 700; font-size: 1.125rem;">3.7</span>
                                        </div>
                                        <span style="font-weight: 600; color: var(--text); font-size: 0.875rem;">Grade
                                            11</span>
                                        <span style="font-size: 0.75rem; color: var(--text-secondary);">2023</span>
                                    </div>

                                    <!-- Grade 12 (Current) -->
                                    <div
                                        style="display: flex; flex-direction: column; align-items: center; gap: 0.5rem; flex: 1;">
                                        <div
                                            style="width: 60px; height: 240px; background: linear-gradient(180deg, #8b5cf6, #7c3aed); border-radius: 8px 8px 0 0; position: relative; display: flex; align-items: flex-start; justify-content: center; padding-top: 0.5rem; box-shadow: 0 4px 12px rgba(139, 92, 246, 0.3);">
                                            <span
                                                style="color: white; font-weight: 700; font-size: 1.125rem;">3.8</span>
                                        </div>
                                        <span style="font-weight: 600; color: var(--text); font-size: 0.875rem;">Grade
                                            12</span>
                                        <span
                                            style="font-size: 0.75rem; color: #8b5cf6; font-weight: 600;">Current</span>
                                    </div>
                                </div>
                            </section>

                            <!-- Current Semester Grades -->
                            <section
                                style="background: var(--card-bg); border-radius: 16px; padding: 2rem; margin-bottom: 2rem; box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);">
                                <h3
                                    style="font-size: 1.5rem; font-weight: 600; margin-bottom: 1.5rem; color: var(--heading); display: flex; align-items: center; gap: 0.5rem;">
                                    <span>üìö</span> Current Semester Grades
                                </h3>
                                <div style="display: grid; gap: 1.25rem;">
                                    <!-- Advanced Mathematics -->
                                    <div
                                        style="padding: 1.25rem; background: rgba(var(--button-bg-rgb), 0.03); border-radius: 12px; border-left: 4px solid #10b981;">
                                        <div
                                            style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.75rem;">
                                            <div>
                                                <div
                                                    style="font-weight: 600; color: var(--heading); margin-bottom: 0.25rem; font-size: 1.125rem;">
                                                    Advanced Mathematics</div>
                                                <div style="font-size: 0.875rem; color: var(--text-secondary);">Mr.
                                                    Getachew Tesfaye ‚Ä¢ Semester 2</div>
                                            </div>
                                            <div style="text-align: right;">
                                                <div style="font-weight: 700; font-size: 1.75rem; color: #10b981;">A
                                                </div>
                                                <div style="font-size: 0.875rem; color: var(--text-secondary);">92%
                                                </div>
                                            </div>
                                        </div>
                                        <div
                                            style="width: 100%; height: 10px; background: rgba(0,0,0,0.1); border-radius: 5px; overflow: hidden;">
                                            <div
                                                style="width: 92%; height: 100%; background: linear-gradient(90deg, #10b981, #059669); border-radius: 5px; transition: width 1s ease;">
                                            </div>
                                        </div>
                                        <div
                                            style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 1rem; margin-top: 1rem; padding-top: 1rem; border-top: 1px solid rgba(var(--border-rgb), 0.1);">
                                            <div style="text-align: center;">
                                                <p
                                                    style="font-size: 0.75rem; color: var(--text-secondary); margin-bottom: 0.25rem;">
                                                    Assignments</p>
                                                <p style="font-weight: 700; color: var(--heading);">94%</p>
                                            </div>
                                            <div style="text-align: center;">
                                                <p
                                                    style="font-size: 0.75rem; color: var(--text-secondary); margin-bottom: 0.25rem;">
                                                    Exams</p>
                                                <p style="font-weight: 700; color: var(--heading);">90%</p>
                                            </div>
                                            <div style="text-align: center;">
                                                <p
                                                    style="font-size: 0.75rem; color: var(--text-secondary); margin-bottom: 0.25rem;">
                                                    Participation</p>
                                                <p style="font-weight: 700; color: var(--heading);">95%</p>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Physics -->
                                    <div
                                        style="padding: 1.25rem; background: rgba(var(--button-bg-rgb), 0.03); border-radius: 12px; border-left: 4px solid #3b82f6;">
                                        <div
                                            style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.75rem;">
                                            <div>
                                                <div
                                                    style="font-weight: 600; color: var(--heading); margin-bottom: 0.25rem; font-size: 1.125rem;">
                                                    Physics</div>
                                                <div style="font-size: 0.875rem; color: var(--text-secondary);">Mr.
                                                    Solomon Assefa ‚Ä¢ Semester 2</div>
                                            </div>
                                            <div style="text-align: right;">
                                                <div style="font-weight: 700; font-size: 1.75rem; color: #3b82f6;">B+
                                                </div>
                                                <div style="font-size: 0.875rem; color: var(--text-secondary);">88%
                                                </div>
                                            </div>
                                        </div>
                                        <div
                                            style="width: 100%; height: 10px; background: rgba(0,0,0,0.1); border-radius: 5px; overflow: hidden;">
                                            <div
                                                style="width: 88%; height: 100%; background: linear-gradient(90deg, #3b82f6, #2563eb); border-radius: 5px; transition: width 1s ease;">
                                            </div>
                                        </div>
                                        <div
                                            style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 1rem; margin-top: 1rem; padding-top: 1rem; border-top: 1px solid rgba(var(--border-rgb), 0.1);">
                                            <div style="text-align: center;">
                                                <p
                                                    style="font-size: 0.75rem; color: var(--text-secondary); margin-bottom: 0.25rem;">
                                                    Lab Work</p>
                                                <p style="font-weight: 700; color: var(--heading);">86%</p>
                                            </div>
                                            <div style="text-align: center;">
                                                <p
                                                    style="font-size: 0.75rem; color: var(--text-secondary); margin-bottom: 0.25rem;">
                                                    Exams</p>
                                                <p style="font-weight: 700; color: var(--heading);">89%</p>
                                            </div>
                                            <div style="text-align: center;">
                                                <p
                                                    style="font-size: 0.75rem; color: var(--text-secondary); margin-bottom: 0.25rem;">
                                                    Projects</p>
                                                <p style="font-weight: 700; color: var(--heading);">92%</p>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Chemistry -->
                                    <div
                                        style="padding: 1.25rem; background: rgba(var(--button-bg-rgb), 0.03); border-radius: 12px; border-left: 4px solid #8b5cf6;">
                                        <div
                                            style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.75rem;">
                                            <div>
                                                <div
                                                    style="font-weight: 600; color: var(--heading); margin-bottom: 0.25rem; font-size: 1.125rem;">
                                                    Chemistry</div>
                                                <div style="font-size: 0.875rem; color: var(--text-secondary);">Dr.
                                                    Hanna Bekele ‚Ä¢ Semester 2</div>
                                            </div>
                                            <div style="text-align: right;">
                                                <div style="font-weight: 700; font-size: 1.75rem; color: #8b5cf6;">A
                                                </div>
                                                <div style="font-size: 0.875rem; color: var(--text-secondary);">95%
                                                </div>
                                            </div>
                                        </div>
                                        <div
                                            style="width: 100%; height: 10px; background: rgba(0,0,0,0.1); border-radius: 5px; overflow: hidden;">
                                            <div
                                                style="width: 95%; height: 100%; background: linear-gradient(90deg, #8b5cf6, #7c3aed); border-radius: 5px; transition: width 1s ease;">
                                            </div>
                                        </div>
                                        <div
                                            style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 1rem; margin-top: 1rem; padding-top: 1rem; border-top: 1px solid rgba(var(--border-rgb), 0.1);">
                                            <div style="text-align: center;">
                                                <p
                                                    style="font-size: 0.75rem; color: var(--text-secondary); margin-bottom: 0.25rem;">
                                                    Lab Work</p>
                                                <p style="font-weight: 700; color: var(--heading);">97%</p>
                                            </div>
                                            <div style="text-align: center;">
                                                <p
                                                    style="font-size: 0.75rem; color: var(--text-secondary); margin-bottom: 0.25rem;">
                                                    Exams</p>
                                                <p style="font-weight: 700; color: var(--heading);">94%</p>
                                            </div>
                                            <div style="text-align: center;">
                                                <p
                                                    style="font-size: 0.75rem; color: var(--text-secondary); margin-bottom: 0.25rem;">
                                                    Research</p>
                                                <p style="font-weight: 700; color: var(--heading);">96%</p>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Biology -->
                                    <div
                                        style="padding: 1.25rem; background: rgba(var(--button-bg-rgb), 0.03); border-radius: 12px; border-left: 4px solid #22c55e;">
                                        <div
                                            style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.75rem;">
                                            <div>
                                                <div
                                                    style="font-weight: 600; color: var(--heading); margin-bottom: 0.25rem; font-size: 1.125rem;">
                                                    Biology</div>
                                                <div style="font-size: 0.875rem; color: var(--text-secondary);">Dr.
                                                    Yohannes Molla ‚Ä¢ Semester 2</div>
                                            </div>
                                            <div style="text-align: right;">
                                                <div style="font-weight: 700; font-size: 1.75rem; color: #22c55e;">B+
                                                </div>
                                                <div style="font-size: 0.875rem; color: var(--text-secondary);">87%
                                                </div>
                                            </div>
                                        </div>
                                        <div
                                            style="width: 100%; height: 10px; background: rgba(0,0,0,0.1); border-radius: 5px; overflow: hidden;">
                                            <div
                                                style="width: 87%; height: 100%; background: linear-gradient(90deg, #22c55e, #16a34a); border-radius: 5px; transition: width 1s ease;">
                                            </div>
                                        </div>
                                        <div
                                            style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 1rem; margin-top: 1rem; padding-top: 1rem; border-top: 1px solid rgba(var(--border-rgb), 0.1);">
                                            <div style="text-align: center;">
                                                <p
                                                    style="font-size: 0.75rem; color: var(--text-secondary); margin-bottom: 0.25rem;">
                                                    Lab Work</p>
                                                <p style="font-weight: 700; color: var(--heading);">90%</p>
                                            </div>
                                            <div style="text-align: center;">
                                                <p
                                                    style="font-size: 0.75rem; color: var(--text-secondary); margin-bottom: 0.25rem;">
                                                    Exams</p>
                                                <p style="font-weight: 700; color: var(--heading);">85%</p>
                                            </div>
                                            <div style="text-align: center;">
                                                <p
                                                    style="font-size: 0.75rem; color: var(--text-secondary); margin-bottom: 0.25rem;">
                                                    Projects</p>
                                                <p style="font-weight: 700; color: var(--heading);">88%</p>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- English Literature -->
                                    <div
                                        style="padding: 1.25rem; background: rgba(var(--button-bg-rgb), 0.03); border-radius: 12px; border-left: 4px solid #f59e0b;">
                                        <div
                                            style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.75rem;">
                                            <div>
                                                <div
                                                    style="font-weight: 600; color: var(--heading); margin-bottom: 0.25rem; font-size: 1.125rem;">
                                                    English Literature</div>
                                                <div style="font-size: 0.875rem; color: var(--text-secondary);">Ms.
                                                    Tigist Wolde ‚Ä¢ Semester 2</div>
                                            </div>
                                            <div style="text-align: right;">
                                                <div style="font-weight: 700; font-size: 1.75rem; color: #f59e0b;">A-
                                                </div>
                                                <div style="font-size: 0.875rem; color: var(--text-secondary);">90%
                                                </div>
                                            </div>
                                        </div>
                                        <div
                                            style="width: 100%; height: 10px; background: rgba(0,0,0,0.1); border-radius: 5px; overflow: hidden;">
                                            <div
                                                style="width: 90%; height: 100%; background: linear-gradient(90deg, #f59e0b, #d97706); border-radius: 5px; transition: width 1s ease;">
                                            </div>
                                        </div>
                                        <div
                                            style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 1rem; margin-top: 1rem; padding-top: 1rem; border-top: 1px solid rgba(var(--border-rgb), 0.1);">
                                            <div style="text-align: center;">
                                                <p
                                                    style="font-size: 0.75rem; color: var(--text-secondary); margin-bottom: 0.25rem;">
                                                    Essays</p>
                                                <p style="font-weight: 700; color: var(--heading);">92%</p>
                                            </div>
                                            <div style="text-align: center;">
                                                <p
                                                    style="font-size: 0.75rem; color: var(--text-secondary); margin-bottom: 0.25rem;">
                                                    Exams</p>
                                                <p style="font-weight: 700; color: var(--heading);">88%</p>
                                            </div>
                                            <div style="text-align: center;">
                                                <p
                                                    style="font-size: 0.75rem; color: var(--text-secondary); margin-bottom: 0.25rem;">
                                                    Participation</p>
                                                <p style="font-weight: 700; color: var(--heading);">92%</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </section>
                        </div>

                        <!-- My Courses Panel -->
                        <div id="my-courses-panel" class="panel-content hidden">
                            <div class="panel-header mb-6">
                                <div class="flex justify-between items-center mb-4">
                                    <div>
                                        <h2 class="text-2xl font-bold text-gray-800 dark:text-gray-200">üìö My Courses</h2>
                                        <p class="text-sm text-gray-500 dark:text-gray-400 mt-1">Courses you're enrolled in</p>
                                    </div>
                                    <button class="btn-primary px-4 py-2 bg-blue-500 hover:bg-blue-600 text-white rounded-lg font-semibold transition-all flex items-center gap-2"
                                        onclick="window.location.href='../branch/find-tutors.html'">
                                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
                                        </svg>
                                        Add Course
                                    </button>
                                </div>
                                <!-- Live Search -->
                                <div class="relative">
                                    <input type="text"
                                           id="courses-search-input"
                                           placeholder="Search your courses by name, tutor, or category..."
                                           class="w-full px-4 py-3 pl-12 rounded-xl border-2 border-gray-200 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-800 dark:text-gray-200 placeholder-gray-400 dark:placeholder-gray-500 focus:border-blue-500 dark:focus:border-blue-400 focus:outline-none transition-all"
                                           oninput="StudentCoursesManager.searchCourses(this.value)">
                                    <svg class="w-5 h-5 absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
                                    </svg>
                                    <span id="courses-search-count" class="absolute right-4 top-1/2 transform -translate-y-1/2 text-sm text-gray-500 dark:text-gray-400 hidden"></span>
                                </div>
                            </div>
                            <div class="course-filters mb-6">
                                <button class="filter-chip active">All Courses</button>
                                <button class="filter-chip">Active</button>
                                <button class="filter-chip">Completed</button>
                                <button class="filter-chip">Upcoming</button>
                            </div>
                            <div id="courses-grid" class="courses-grid">
                                <!-- Courses will be loaded dynamically -->
                                <p class="text-gray-600">Your enrolled courses will appear here.</p>
                            </div>
                        </div>

                        <!-- My Tutors Panel -->
                        <div id="my-tutors-panel" class="panel-content hidden">
                            <div class="panel-header mb-6">
                                <div class="flex justify-between items-center mb-4">
                                    <div>
                                        <h2 class="text-2xl font-bold text-gray-800 dark:text-gray-200">üë®‚Äçüè´ My Tutors</h2>
                                        <p class="text-sm text-gray-500 dark:text-gray-400 mt-1">Tutors you're enrolled with</p>
                                    </div>
                                    <button class="btn-primary px-4 py-2 bg-blue-500 hover:bg-blue-600 text-white rounded-lg font-semibold transition-all flex items-center gap-2"
                                        onclick="window.location.href='../branch/find-tutors.html'">
                                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
                                        </svg>
                                        Find New Tutor
                                    </button>
                                </div>
                                <!-- Live Search -->
                                <div class="relative">
                                    <input type="text"
                                           id="tutors-search-input"
                                           placeholder="Search your tutors by name, subject, or location..."
                                           class="w-full px-4 py-3 pl-12 rounded-xl border-2 border-gray-200 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-800 dark:text-gray-200 placeholder-gray-400 dark:placeholder-gray-500 focus:border-blue-500 dark:focus:border-blue-400 focus:outline-none transition-all"
                                           oninput="studentTutorsManager.searchTutors(this.value)">
                                    <svg class="w-5 h-5 absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
                                    </svg>
                                    <span id="tutors-search-count" class="absolute right-4 top-1/2 transform -translate-y-1/2 text-sm text-gray-500 dark:text-gray-400 hidden"></span>
                                </div>
                            </div>
                            <div id="tutors-grid" class="tutors-grid">
                                <!-- Tutors will be loaded dynamically by tutors-manager.js using TutorCardCreator -->
                                <div class="flex items-center justify-center py-12">
                                    <div class="text-center">
                                        <div class="animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mx-auto mb-4"></div>
                                        <p class="text-gray-600 dark:text-gray-400">Loading your tutors...</p>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Schedule Panel -->
                        <div id="schedule-panel" class="panel-content hidden">
                            <div class="mb-8">
                                <h1 class="text-3xl font-bold mb-2">Schedule & Sessions</h1>
                                <p class="text-gray-600">Manage your personal schedules and tutoring sessions</p>
                            </div>

                            <!-- Schedule Type Filter Cards (always visible) -->
                            <div id="schedule-type-cards" class="schedule-type-cards grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
                                <!-- Schedule Card -->
                                <div class="schedule-type-card card p-4 cursor-pointer border-2 transition active"
                                     onclick="switchScheduleSection('schedules')" data-section="schedules">
                                    <div class="flex items-center gap-3">
                                        <div class="text-3xl">üìÖ</div>
                                        <div>
                                            <h3 class="font-bold text-lg">My Schedules</h3>
                                            <p class="text-sm text-gray-600">Personal study plans & reminders</p>
                                            <span id="student-schedules-count" class="text-xs bg-blue-500 text-white px-2 py-0.5 rounded-full">0</span>
                                        </div>
                                    </div>
                                </div>

                                <!-- Sessions Card -->
                                <div class="schedule-type-card card p-4 cursor-pointer border-2 transition"
                                     onclick="switchScheduleSection('sessions')" data-section="sessions">
                                    <div class="flex items-center gap-3">
                                        <div class="text-3xl">üë®‚Äçüè´</div>
                                        <div>
                                            <h3 class="font-bold text-lg">My Sessions</h3>
                                            <p class="text-sm text-gray-600">Tutoring sessions with your tutors</p>
                                            <span id="student-sessions-count" class="text-xs bg-purple-500 text-white px-2 py-0.5 rounded-full">0</span>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Status Tabs (visible when viewing schedules/sessions) -->
                            <div id="schedule-status-tabs" class="status-tabs mb-4"
                                style="display: flex; gap: 1rem; border-bottom: 2px solid var(--border-color); padding-bottom: 0.5rem;">
                                <button class="status-tab active" onclick="filterScheduleStatus('all')" data-status="all">All</button>
                                <button class="status-tab" onclick="filterScheduleStatus('pending')" data-status="pending">Pending</button>
                                <button class="status-tab" onclick="filterScheduleStatus('active')" data-status="active">Active</button>
                                <button class="status-tab" onclick="filterScheduleStatus('completed')" data-status="completed">Completed</button>
                            </div>

                            <!-- Schedules List Container (shown when My Schedules card is active) -->
                            <div id="schedules-section" class="schedule-section">
                                <div class="flex items-center justify-between mb-4">
                                    <h3 class="text-lg font-semibold text-gray-700">My Schedules</h3>
                                    <button class="btn-primary" onclick="openCreateScheduleModal()">+ New Schedule</button>
                                </div>
                                <div id="schedule-calendar" class="schedule-list">
                                    <!-- Schedules will be loaded dynamically from database -->
                                    <div class="text-center py-8 text-gray-500">
                                        <i class="fas fa-spinner fa-spin text-3xl mb-3"></i>
                                        <p>Loading your schedules...</p>
                                    </div>
                                </div>
                            </div>

                            <!-- Sessions List Container (shown when My Sessions card is active) -->
                            <div id="sessions-section" class="schedule-section hidden">
                                <div class="flex items-center justify-between mb-4">
                                    <h3 class="text-lg font-semibold text-gray-700">My Sessions</h3>
                                </div>
                                <div id="sessions-list" class="sessions-list">
                                    <!-- Sessions will be loaded dynamically from database -->
                                    <div class="text-center py-8 text-gray-500">
                                        <i class="fas fa-spinner fa-spin text-3xl mb-3"></i>
                                        <p>Loading your sessions...</p>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Learning Tools Panel -->
                        <div id="learning-tools-panel" class="panel-content hidden">
                            <div class="mb-8">
                                <h1 class="text-3xl font-bold mb-2">Learning Tools</h1>
                                <p class="text-gray-600">Interactive tools to enhance your learning experience</p>
                            </div>

                            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                                <div class="card p-8 text-center cursor-pointer hover:shadow-lg transition"
                                    onclick="openDigitalLab()">
                                    <div class="text-8xl mb-6">üî¨</div>
                                    <h4 class="text-2xl font-bold mb-3">Digital Lab</h4>
                                    <p class="text-gray-600 mb-4">Virtual science experiments and simulations</p>
                                </div>
                                <div class="card p-8 text-center cursor-pointer hover:shadow-lg transition"
                                    onclick="openStudentWhiteboard()">
                                    <div class="text-8xl mb-6">üìù</div>
                                    <h4 class="text-2xl font-bold mb-3">Digital Whiteboard</h4>
                                    <p class="text-gray-600 mb-4">Interactive learning board with your tutors</p>
                                </div>
                                <div class="card p-8 text-center cursor-pointer hover:shadow-lg transition"
                                    onclick="openStudentCoursework()">
                                    <div class="text-8xl mb-6">üìã</div>
                                    <h4 class="text-2xl font-bold mb-3">My Quizzes</h4>
                                    <p class="text-gray-600 mb-4">View and complete quizzes from tutors</p>
                                </div>
                            </div>
                        </div>

                        <!-- Documents Panel (Teaching/Learning Materials) -->
                        <div id="documents-panel" class="panel-content hidden">
                            <div class="flex items-center justify-between mb-6">
                                <div>
                                    <h1 class="text-3xl font-bold mb-2">Documents</h1>
                                    <p class="text-gray-600">Your study materials and documents shared by your tutors</p>
                                </div>
                                <!-- Storage Used Stat -->
                                <div class="flex items-center gap-2 px-4 py-2 bg-gray-100 rounded-lg">
                                    <span class="text-xl">üíæ</span>
                                    <div>
                                        <p class="text-xs text-gray-500">Storage</p>
                                        <p class="text-sm font-bold" id="student-storage-used">0.0 GB</p>
                                    </div>
                                </div>
                            </div>

                            <!-- View Tabs: Folders vs Documents -->
                            <div class="flex items-center gap-4 mb-6 border-b">
                                <button id="student-folders-tab" onclick="switchStudentDocsViewTab('folders')"
                                    class="px-4 py-3 font-semibold text-blue-600 border-b-2 border-blue-600 -mb-px">
                                    <i class="fas fa-folder mr-2"></i>Folders
                                </button>
                                <button id="student-documents-tab" onclick="switchStudentDocsViewTab('documents')"
                                    class="px-4 py-3 font-semibold text-gray-500 hover:text-gray-700">
                                    <i class="fas fa-file-alt mr-2"></i>All Documents
                                </button>
                            </div>

                            <!-- FOLDERS VIEW -->
                            <div id="student-folders-view">
                                <!-- Folders Search -->
                                <div class="mb-4">
                                    <div class="relative max-w-md">
                                        <input type="text" id="student-folders-search"
                                            class="w-full px-4 py-2 pl-10 border rounded-full focus:outline-none focus:ring-2 focus:ring-blue-500"
                                            placeholder="Search folders..."
                                            oninput="searchFolders(this.value)">
                                        <i class="fas fa-search absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"></i>
                                    </div>
                                </div>
                                <!-- Folders Grid - Rendered dynamically by folder-manager.js -->
                                <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-6 gap-4 mb-6" id="student-docs-folders">
                                    <!-- New Folder Card (always shown) -->
                                    <div class="card p-4 text-center cursor-pointer hover:shadow-lg transition border-2 border-dashed border-gray-300 hover:border-blue-400"
                                        onclick="openCreateFolderModal()">
                                        <div class="text-4xl mb-2 text-gray-400">‚ûï</div>
                                        <p class="font-semibold text-sm text-gray-500">New Folder</p>
                                    </div>
                                    <!-- Folder cards will be rendered dynamically by folder-manager.js -->
                                </div>
                            </div>

                            <!-- DOCUMENTS VIEW (Hidden by default) -->
                            <div id="student-documents-view" class="hidden">

                                <!-- Document Source Tabs: All / My Documents / From Tutors -->
                                <div class="flex gap-3 mb-4 p-1 bg-gray-100 rounded-lg w-fit">
                                    <button class="doc-source-tab px-4 py-2 rounded-md bg-blue-500 text-white font-medium transition-all flex items-center gap-2"
                                        data-source="all" onclick="switchDocSource('all')">
                                        <i class="fas fa-layer-group"></i> All
                                        <span class="bg-white/20 px-2 py-0.5 rounded-full text-xs" id="doc-count-all">0</span>
                                    </button>
                                    <button class="doc-source-tab px-4 py-2 rounded-md bg-gray-200 text-gray-700 font-medium transition-all flex items-center gap-2"
                                        data-source="own" onclick="switchDocSource('own')">
                                        <i class="fas fa-user"></i> My Documents
                                        <span class="bg-gray-300 px-2 py-0.5 rounded-full text-xs" id="doc-count-own">0</span>
                                    </button>
                                    <button class="doc-source-tab px-4 py-2 rounded-md bg-gray-200 text-gray-700 font-medium transition-all flex items-center gap-2"
                                        data-source="tutor" onclick="switchDocSource('tutor')">
                                        <i class="fas fa-chalkboard-teacher"></i> From Tutors
                                        <span class="bg-gray-300 px-2 py-0.5 rounded-full text-xs" id="doc-count-tutor">0</span>
                                    </button>
                                </div>

                                <!-- Document Type Filters with Counts + Upload Button -->
                                <div class="flex gap-2 mb-4 flex-wrap items-center">
                                    <button class="student-doc-filter px-4 py-2 rounded-full bg-blue-500 text-white flex items-center gap-2"
                                        onclick="filterStudentDocs('all')">
                                        All Types <span class="bg-white/20 px-2 py-0.5 rounded-full text-xs" id="filter-count-all">0</span>
                                    </button>
                                    <button class="student-doc-filter px-4 py-2 rounded-full bg-gray-200 flex items-center gap-2"
                                        onclick="filterStudentDocs('pdf')">
                                        PDFs <span class="bg-gray-300 px-2 py-0.5 rounded-full text-xs" id="filter-count-pdf">0</span>
                                    </button>
                                    <button class="student-doc-filter px-4 py-2 rounded-full bg-gray-200 flex items-center gap-2"
                                        onclick="filterStudentDocs('notes')">
                                        Notes <span class="bg-gray-300 px-2 py-0.5 rounded-full text-xs" id="filter-count-notes">0</span>
                                    </button>
                                    <button class="student-doc-filter px-4 py-2 rounded-full bg-gray-200 flex items-center gap-2"
                                        onclick="filterStudentDocs('assignments')">
                                        Assignments <span class="bg-gray-300 px-2 py-0.5 rounded-full text-xs" id="filter-count-assignments">0</span>
                                    </button>
                                    <button class="student-doc-filter px-4 py-2 rounded-full bg-gray-200 flex items-center gap-2"
                                        onclick="filterStudentDocs('study-guides')">
                                        Study Guides <span class="bg-gray-300 px-2 py-0.5 rounded-full text-xs" id="filter-count-study-guides">0</span>
                                    </button>
                                    <button class="student-doc-filter px-4 py-2 rounded-full bg-gray-200 flex items-center gap-2"
                                        onclick="filterStudentDocs('other')">
                                        Other <span class="bg-gray-300 px-2 py-0.5 rounded-full text-xs" id="filter-count-other">0</span>
                                    </button>
                                    <!-- Upload Button - pushed to the right -->
                                    <button class="ml-auto px-4 py-2 rounded-full bg-green-500 text-white flex items-center gap-2 hover:bg-green-600 transition-colors"
                                        onclick="openUploadStudentDocModal()">
                                        <i class="fas fa-plus"></i> Upload Document
                                    </button>
                                </div>

                                <!-- Documents Search and Sort Row -->
                                <div class="flex flex-wrap items-center gap-4 mb-6">
                                    <!-- Search -->
                                    <div class="relative flex-1 max-w-md">
                                        <input type="text" id="student-documents-search"
                                            class="w-full px-4 py-2 pl-10 border rounded-full focus:outline-none focus:ring-2 focus:ring-blue-500"
                                            placeholder="Search documents..."
                                            oninput="searchStudentDocuments(this.value)">
                                        <i class="fas fa-search absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"></i>
                                    </div>
                                    <!-- Sort Dropdown - pushed to the right -->
                                    <div class="ml-auto flex items-center gap-2">
                                        <label class="text-sm text-gray-600">Sort by:</label>
                                        <select id="student-documents-sort"
                                            class="px-4 py-2 border rounded-full focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white cursor-pointer"
                                            onchange="sortStudentDocuments(this.value)">
                                            <option value="upload_date">Upload Date</option>
                                            <option value="title">Title (A-Z)</option>
                                            <option value="subject">Subject</option>
                                            <option value="category">Category</option>
                                        </select>
                                    </div>
                                </div>

                                <!-- Documents Grid -->
                                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6" id="student-docs-grid">
                                    <!-- Documents will be loaded dynamically -->
                                    <div class="text-center text-gray-500 py-12 col-span-full" id="student-docs-empty-state">
                                        <div class="text-6xl mb-4">üìÑ</div>
                                        <p class="text-lg font-semibold mb-2">No documents yet</p>
                                        <p class="text-sm">Click "Upload Document" to add your first study material</p>
                                    </div>
                                </div>
                            </div><!-- End student-documents-view -->
                        </div>

                        <!-- Credentials Panel -->
                        <div id="credentials-panel" class="panel-content hidden">
                            <div class="mb-8 flex items-center justify-between">
                                <div>
                                    <h1 class="text-3xl font-bold mb-2">üìÑ My Credentials</h1>
                                    <p class="text-gray-600">Manage your achievements, certificates, and extracurricular activities</p>
                                </div>
                                <button onclick="window.openUploadCredentialModal && window.openUploadCredentialModal()" class="btn-primary">
                                    <i class="fas fa-upload"></i> Upload Credential
                                </button>
                            </div>

                            <!-- Credential Type Cards -->
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                                <!-- Achievements Card -->
                                <div class="card p-6 cursor-pointer hover:shadow-lg transition-shadow"
                                     onclick="window.switchCredentialSection && window.switchCredentialSection('achievement')"
                                     id="cred-card-achievement">
                                    <div class="text-center">
                                        <div class="text-5xl mb-4">üèÜ</div>
                                        <h3 class="font-bold text-lg mb-2">Achievements</h3>
                                        <p class="text-gray-600 text-sm mb-4">Academic awards and accomplishments</p>
                                        <div class="text-3xl font-bold text-yellow-600" id="stat-achievement-count">0</div>
                                        <div class="text-sm text-gray-500">Total achievements</div>
                                    </div>
                                </div>

                                <!-- Academic Certificates Card -->
                                <div class="card p-6 cursor-pointer hover:shadow-lg transition-shadow"
                                     onclick="window.switchCredentialSection && window.switchCredentialSection('academics')"
                                     id="cred-card-academics">
                                    <div class="text-center">
                                        <div class="text-5xl mb-4">üìú</div>
                                        <h3 class="font-bold text-lg mb-2">Academic Certificates</h3>
                                        <p class="text-gray-600 text-sm mb-4">Professional certifications and courses</p>
                                        <div class="text-3xl font-bold text-blue-600" id="stat-academics-count">0</div>
                                        <div class="text-sm text-gray-500">Total certificates</div>
                                    </div>
                                </div>

                                <!-- Extracurricular Card -->
                                <div class="card p-6 cursor-pointer hover:shadow-lg transition-shadow"
                                     onclick="window.switchCredentialSection && window.switchCredentialSection('extracurricular')"
                                     id="cred-card-extracurricular">
                                    <div class="text-center">
                                        <div class="text-5xl mb-4">üéØ</div>
                                        <h3 class="font-bold text-lg mb-2">Extracurricular Activities</h3>
                                        <p class="text-gray-600 text-sm mb-4">Clubs, sports, and volunteer work</p>
                                        <div class="text-3xl font-bold text-green-600" id="stat-extracurricular-count">0</div>
                                        <div class="text-sm text-gray-500">Active activities</div>
                                    </div>
                                </div>
                            </div>

                            <!-- Achievements Section -->
                            <div id="cred-section-achievement" class="credential-section">
                                <div class="mb-6">
                                    <h2 class="text-2xl font-bold mb-4">üèÜ Achievements</h2>

                                    <!-- Achievements Grid -->
                                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4" id="achievements-grid">
                                        <!-- Achievements will be loaded dynamically -->
                                        <div class="text-center text-gray-500 py-12 col-span-full" id="achievements-empty-state">
                                            <div class="text-6xl mb-4">üèÜ</div>
                                            <p class="text-lg font-semibold mb-2">No achievements yet</p>
                                            <p class="text-sm">Click "Upload Credential" to add your first achievement</p>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Academic Certificates Section -->
                            <div id="cred-section-academics" class="credential-section hidden">
                                <div class="mb-6">
                                    <h2 class="text-2xl font-bold mb-4">üìú Academic Certificates</h2>

                                    <!-- Certificates Grid -->
                                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4" id="certificates-grid">
                                        <!-- Certificates will be loaded dynamically -->
                                        <div class="text-center text-gray-500 py-12 col-span-full" id="certificates-empty-state">
                                            <div class="text-6xl mb-4">üìú</div>
                                            <p class="text-lg font-semibold mb-2">No certificates yet</p>
                                            <p class="text-sm">Click "Upload Credential" to add your first certificate</p>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Extracurricular Activities Section -->
                            <div id="cred-section-extracurricular" class="credential-section hidden">
                                <div class="mb-6">
                                    <h2 class="text-2xl font-bold mb-4">üéØ Extracurricular Activities</h2>

                                    <!-- Activities List -->
                                    <div class="space-y-4" id="extracurricular-list">
                                        <!-- Extracurricular activities will be loaded dynamically -->
                                        <div class="text-center text-gray-500 py-12" id="extracurricular-empty-state">
                                            <div class="text-6xl mb-4">üéØ</div>
                                            <p class="text-lg font-semibold mb-2">No extracurricular activities yet</p>
                                            <p class="text-sm">Click "Upload Credential" to add your first activity</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Notes Panel -->
                        <div id="notes-panel" class="panel-content hidden">
                            <!-- Notes Panel Header -->
                            <div class="dashboard-header">
                                <div class="dashboard-title-section">
                                    <h1 class="dashboard-title">
                                        <i class="fas fa-sticky-note"></i>
                                        My Notes
                                    </h1>
                                    <p class="dashboard-subtitle">Organize your thoughts and knowledge</p>
                                </div>
                                <div class="dashboard-actions">
                                    <button class="btn btn-primary" onclick="NotesManager.createNewNote()">
                                        <i class="fas fa-plus"></i> New Note
                                    </button>
                                </div>
                            </div>

                            <!-- Stats Bar -->
                            <div class="stats-bar">
                                <div class="stat-item">
                                    <div class="stat-icon">
                                        <i class="fas fa-file-alt"></i>
                                    </div>
                                    <div class="stat-info">
                                        <span class="stat-number" id="totalNotes">0</span>
                                        <span class="stat-label">Total Notes</span>
                                    </div>
                                </div>
                                <div class="stat-item">
                                    <div class="stat-icon words">
                                        <i class="fas fa-font"></i>
                                    </div>
                                    <div class="stat-info">
                                        <span class="stat-number" id="totalWords">0</span>
                                        <span class="stat-label">Total Words</span>
                                    </div>
                                </div>
                                <div class="stat-item">
                                    <div class="stat-icon courses">
                                        <i class="fas fa-book"></i>
                                    </div>
                                    <div class="stat-info">
                                        <span class="stat-number" id="totalCourses">0</span>
                                        <span class="stat-label">Courses</span>
                                    </div>
                                </div>
                                <div class="stat-item">
                                    <div class="stat-icon recent">
                                        <i class="fas fa-clock"></i>
                                    </div>
                                    <div class="stat-info">
                                        <span class="stat-number" id="recentNotes">0</span>
                                        <span class="stat-label">This Week</span>
                                    </div>
                                </div>
                            </div>

                            <!-- Controls Bar: Search, Filter, Sort -->
                            <div class="controls-bar">
                                <div class="search-box">
                                    <i class="fas fa-search search-icon"></i>
                                    <input type="text" class="search-input" id="searchInput" placeholder="Search notes..." oninput="NotesManager.searchNotes(this.value)">
                                </div>
                                <div class="filter-buttons">
                                    <button class="filter-btn active" data-filter="all" onclick="NotesManager.filterNotes('all', this)">
                                        <i class="fas fa-th"></i> All Notes
                                    </button>
                                    <button class="filter-btn" data-filter="recent" onclick="NotesManager.filterNotes('recent', this)">
                                        <i class="fas fa-clock"></i> Recent
                                    </button>
                                    <button class="filter-btn" data-filter="favorites" onclick="NotesManager.filterNotes('favorites', this)">
                                        <i class="fas fa-star"></i> Favorites
                                    </button>
                                    <button class="filter-btn" data-filter="media" onclick="NotesManager.filterNotes('media', this)">
                                        <i class="fas fa-microphone"></i> Media Notes
                                    </button>
                                </div>
                                <select class="sort-select" id="sortSelect" onchange="NotesManager.sortNotes()">
                                    <option value="date-desc">Newest First</option>
                                    <option value="date-asc">Oldest First</option>
                                    <option value="title">Title A-Z</option>
                                    <option value="course">By Course</option>
                                </select>
                            </div>

                            <!-- Notes Grid -->
                            <div class="notes-grid" id="notesGrid">
                                <!-- New Note Card (always shown first) -->
                                <div class="note-card new-note" onclick="NotesManager.createNewNote()">
                                    <div class="new-note-content">
                                        <div class="new-note-icon">
                                            <i class="fas fa-plus"></i>
                                        </div>
                                        <h3>Create New Note</h3>
                                        <p>Start writing your next note</p>
                                    </div>
                                </div>
                                <!-- Note cards will be rendered here by NotesManager.renderDashboard() -->
                            </div>

                            <!-- Empty State (shown when no notes exist) -->
                            <div class="notes-empty-state" id="notesEmptyState" style="display: none;">
                                <div class="empty-icon">
                                    <i class="fas fa-sticky-note"></i>
                                </div>
                                <h3>No Notes Yet</h3>
                                <p>Start taking notes to organize your learning journey</p>
                                <button class="btn btn-primary" onclick="NotesManager.createNewNote()">
                                    <i class="fas fa-plus"></i> Create Your First Note
                                </button>
                            </div>
                        </div>

                        <!-- My Session Requests Panel -->
                        <div id="my-requests-panel" class="panel-content hidden">
                            <div class="mb-8">
                                <h1 class="text-3xl font-bold mb-2">My Requests</h1>
                                <p class="text-gray-600">Manage your course, school, and tutor requests</p>
                            </div>

                            <!-- Request Type Filter Cards -->
                            <div class="request-type-cards grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6">
                                <div class="request-type-card card p-4 cursor-pointer border-2 transition active"
                                    onclick="filterStudentRequestType('courses')" data-type="courses">
                                    <div class="flex items-center gap-3">
                                        <div class="text-3xl">üìö</div>
                                        <div>
                                            <h3 class="font-bold text-lg">Requested Courses</h3>
                                            <p class="text-sm text-gray-600">View course requests</p>
                                        </div>
                                    </div>
                                </div>

                                <div class="request-type-card card p-4 cursor-pointer border-2 transition"
                                    onclick="filterStudentRequestType('schools')" data-type="schools">
                                    <div class="flex items-center gap-3">
                                        <div class="text-3xl">üè´</div>
                                        <div>
                                            <h3 class="font-bold text-lg">Requested Schools</h3>
                                            <p class="text-sm text-gray-600">View school requests</p>
                                        </div>
                                    </div>
                                </div>

                                <div class="request-type-card card p-4 cursor-pointer border-2 transition"
                                    onclick="filterStudentRequestType('tutors')" data-type="tutors">
                                    <div class="flex items-center gap-3">
                                        <div class="text-3xl">üë®‚Äçüè´</div>
                                        <div>
                                            <h3 class="font-bold text-lg">Requested Tutors</h3>
                                            <p class="text-sm text-gray-600">View tutor requests</p>
                                        </div>
                                    </div>
                                </div>

                                <div class="request-type-card card p-4 cursor-pointer border-2 transition"
                                    onclick="filterStudentRequestType('parenting')" data-type="parenting">
                                    <div class="flex items-center gap-3">
                                        <div class="text-3xl">üë™</div>
                                        <div>
                                            <h3 class="font-bold text-lg">Parenting Invitations</h3>
                                            <p class="text-sm text-gray-600">Students inviting you as parent</p>
                                            <span id="student-parenting-invitation-count" class="text-xs bg-purple-500 text-white px-2 py-0.5 rounded-full hidden">0</span>
                                        </div>
                                    </div>
                                </div>
                                <div class="request-type-card card p-4 cursor-pointer border-2 transition"
                                    onclick="filterStudentRequestType('child-invitations')" data-type="child-invitations">
                                    <div class="flex items-center gap-3">
                                        <div class="text-3xl">üë∂</div>
                                        <div>
                                            <h3 class="font-bold text-lg">Child Invitations</h3>
                                            <p class="text-sm text-gray-600">Parents inviting you as child</p>
                                            <span id="student-child-invitation-count" class="text-xs bg-green-500 text-white px-2 py-0.5 rounded-full hidden">0</span>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Request Status Sub-Tabs -->
                            <div class="status-tabs mb-6"
                                style="display: flex; gap: 1rem; border-bottom: 2px solid var(--border-color); padding-bottom: 0.5rem;">
                                <button class="status-tab active"
                                    onclick="filterStudentRequestStatus('all')" data-status="all">
                                    All
                                </button>
                                <button class="status-tab"
                                    onclick="filterStudentRequestStatus('pending')"
                                    data-status="pending">
                                    Pending
                                </button>
                                <button class="status-tab"
                                    onclick="filterStudentRequestStatus('accepted')"
                                    data-status="accepted">
                                    Accepted
                                </button>
                                <button class="status-tab"
                                    onclick="filterStudentRequestStatus('rejected')"
                                    data-status="rejected">
                                    Rejected
                                </button>
                            </div>

                            <!-- Parenting Direction Tabs (Received/Sent) - Only shown for parenting type -->
                            <div id="student-parenting-direction-tabs" class="mb-6 hidden" style="display: none;">
                                <div style="display: flex; gap: 0; border-bottom: 2px solid var(--border-color);">
                                    <button id="student-parenting-received-tab" class="parenting-direction-tab active"
                                        onclick="switchStudentParentingDirection('received')"
                                        style="padding: 0.75rem 1.5rem; font-weight: 600; color: var(--button-bg); border-bottom: 2px solid var(--button-bg); margin-bottom: -2px; background: transparent; cursor: pointer; transition: all 0.3s ease; display: flex; align-items: center; gap: 0.5rem;">
                                        <i class="fas fa-inbox"></i> Invitations Received
                                        <span id="student-parenting-received-count" class="text-xs font-medium px-2 py-0.5 rounded-full hidden" style="background: rgba(139, 92, 246, 0.1); color: #8b5cf6;">0</span>
                                    </button>
                                    <button id="student-parenting-sent-tab" class="parenting-direction-tab"
                                        onclick="switchStudentParentingDirection('sent')"
                                        style="padding: 0.75rem 1.5rem; font-weight: 600; color: var(--text-muted); border-bottom: 2px solid transparent; margin-bottom: -2px; background: transparent; cursor: pointer; transition: all 0.3s ease; display: flex; align-items: center; gap: 0.5rem;">
                                        <i class="fas fa-paper-plane"></i> Invitations Sent
                                        <span id="student-parenting-sent-count" class="text-xs font-medium px-2 py-0.5 rounded-full hidden" style="background: rgba(245, 158, 11, 0.1); color: #f59e0b;">0</span>
                                    </button>
                                </div>
                            </div>

                            <!-- Requests List Container -->
                            <div id="student-requests-list">
                                <!-- Requests will be loaded dynamically -->
                                <div class="text-center py-8 text-gray-500">
                                    <i class="fas fa-spinner fa-spin text-3xl mb-3"></i>
                                    <p>Loading your requests...</p>
                                </div>
                            </div>
                        </div>

                        <!-- Events Panel -->
                        <div id="events-panel" class="panel-content hidden">
                            <div class="panel-header">
                                <h2 class="text-2xl font-bold">üìÖ Events</h2>
                                <button class="btn-primary" onclick="openComingSoonModal('Create Event')">+ Create
                                    Event</button>
                            </div>
                            <div id="events-grid" class="events-grid">
                                <!-- Events will be loaded dynamically -->
                                <p class="text-gray-600">Upcoming events will appear here.</p>
                            </div>
                        </div>

                        <!-- Clubs Panel -->
                        <div id="clubs-panel" class="panel-content hidden">
                            <div class="panel-header">
                                <h2 class="text-2xl font-bold">üé≠ Clubs</h2>
                                <button class="btn-primary" onclick="openComingSoonModal('Join Club')">+ Join
                                    Club</button>
                            </div>
                            <div id="clubs-grid" class="clubs-grid">
                                <!-- Clubs will be loaded dynamically -->
                                <p class="text-gray-600">Your clubs and activities will appear here.</p>
                            </div>
                        </div>

                        <!-- Blog Panel -->
                        <div id="blog-panel" class="panel-content hidden">
                            <div class="panel-header">
                                <h2 class="text-2xl font-bold">üìù Student Blog</h2>
                                <button class="btn-primary" onclick="openComingSoonModal('Write Post')">+ Write
                                    Post</button>
                            </div>
                            <div id="blog-grid" class="blog-grid">
                                <!-- Blog posts will be loaded dynamically -->
                                <p class="text-gray-600">Your blog posts will appear here.</p>
                            </div>
                        </div>

                        <!-- Community Panel (Enhanced - adapted from parent-profile.html) -->
                        <div class="panel-content hidden" id="community-panel">
                            <div class="mb-8">
                                <h1 class="text-3xl font-bold mb-2">Community</h1>
                                <p class="text-gray-600">Connect with tutors, students, parents, and join events & clubs
                                </p>
                            </div>

                            <!-- Main Section Cards (Clickable Cards instead of Tabs) -->
                            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                                <div onclick="switchCommunityMainTab('connections')" id="connections-main-tab"
                                    class="card p-6 bg-gradient-to-br from-blue-50 to-indigo-50 border-blue-200 cursor-pointer hover:shadow-lg transition-all duration-200 community-main-card active-community-card"
                                    style="display: flex; flex-direction: column; min-height: 140px; overflow: visible;">
                                    <div class="flex items-center justify-between mb-3">
                                        <span class="text-blue-600" style="font-size: 2.5rem; line-height: 1;">üë•</span>
                                    </div>
                                    <h3 class="text-xl font-bold text-gray-800 mb-2" style="line-height: 1.3;">
                                        Connections</h3>
                                    <p class="text-sm text-gray-600 mb-2" style="line-height: 1.4; flex-grow: 1;">Manage
                                        your network</p>
                                    <p class="text-xs text-blue-600 font-medium" style="margin-top: auto;">Click to open
                                    </p>
                                </div>
                                <div onclick="switchCommunityMainTab('events')" id="events-main-tab"
                                    class="card p-6 bg-gradient-to-br from-green-50 to-emerald-50 border-green-200 cursor-pointer hover:shadow-lg transition-all duration-200 community-main-card"
                                    style="display: flex; flex-direction: column; min-height: 140px; overflow: visible;">
                                    <div class="flex items-center justify-between mb-3">
                                        <span class="text-green-600"
                                            style="font-size: 2.5rem; line-height: 1;">üìÖ</span>
                                    </div>
                                    <h3 class="text-xl font-bold text-gray-800 mb-2" style="line-height: 1.3;">Events
                                    </h3>
                                    <p class="text-sm text-gray-600 mb-2" style="line-height: 1.4; flex-grow: 1;">Join &
                                        discover events</p>
                                    <p class="text-xs text-green-600 font-medium" style="margin-top: auto;">Click to
                                        open</p>
                                </div>
                                <div onclick="switchCommunityMainTab('clubs')" id="clubs-main-tab"
                                    class="card p-6 bg-gradient-to-br from-purple-50 to-pink-50 border-purple-200 cursor-pointer hover:shadow-lg transition-all duration-200 community-main-card"
                                    style="display: flex; flex-direction: column; min-height: 140px; overflow: visible;">
                                    <div class="flex items-center justify-between mb-3">
                                        <span class="text-purple-600"
                                            style="font-size: 2.5rem; line-height: 1;">üé≠</span>
                                    </div>
                                    <h3 class="text-xl font-bold text-gray-800 mb-2" style="line-height: 1.3;">Clubs
                                    </h3>
                                    <p class="text-sm text-gray-600 mb-2" style="line-height: 1.4; flex-grow: 1;">
                                        Explore & join clubs</p>
                                    <p class="text-xs text-purple-600 font-medium" style="margin-top: auto;">Click to
                                        open</p>
                                </div>
                                <div onclick="switchCommunityMainTab('requests')" id="requests-main-tab"
                                    class="card p-6 bg-gradient-to-br from-orange-50 to-amber-50 border-orange-200 cursor-pointer hover:shadow-lg transition-all duration-200 community-main-card"
                                    style="display: flex; flex-direction: column; min-height: 140px; overflow: visible;">
                                    <div class="flex items-center justify-between mb-3">
                                        <span class="text-orange-600"
                                            style="font-size: 2.5rem; line-height: 1;">üì¨</span>
                                    </div>
                                    <h3 class="text-xl font-bold text-gray-800 mb-2" style="line-height: 1.3;">Requests
                                    </h3>
                                    <p class="text-sm text-gray-600 mb-2" style="line-height: 1.4; flex-grow: 1;">
                                        Pending requests</p>
                                    <p class="text-xs text-orange-600 font-medium" style="margin-top: auto;">Click to
                                        open</p>
                                </div>
                            </div>

                            <!-- Connections Tab Content -->
                            <div id="connections-main-tab-content" class="community-main-tab-content">
                                <!-- Sub-Section Tabs (Regular Tabs) -->
                                <div class="flex gap-4 mb-6 border-b border-gray-200">
                                    <button onclick="toggleConnectionsSubSection('all')" id="all-connections-tab"
                                        class="connections-sub-tab px-6 py-3 font-semibold text-blue-600 border-b-2 border-blue-600 transition-all">
                                        All Connections
                                    </button>
                                    <button onclick="toggleConnectionsSubSection('tutors')" id="tutors-connections-tab"
                                        class="connections-sub-tab px-6 py-3 font-semibold text-gray-500 hover:text-gray-700 transition-all">
                                        Tutors
                                    </button>
                                    <button onclick="toggleConnectionsSubSection('students')"
                                        id="students-connections-tab"
                                        class="connections-sub-tab px-6 py-3 font-semibold text-gray-500 hover:text-gray-700 transition-all">
                                        Students
                                    </button>
                                    <button onclick="toggleConnectionsSubSection('parents')"
                                        id="parents-connections-tab"
                                        class="connections-sub-tab px-6 py-3 font-semibold text-gray-500 hover:text-gray-700 transition-all">
                                        Parents
                                    </button>
                                </div>

                                <!-- Connections Sub-Sections -->
                                <div class="space-y-8">
                                    <!-- All Connections Section -->
                                    <div id="all-connections-subsection" class="card p-6 connections-subsection">
                                        <div class="flex items-center justify-between mb-6">
                                            <div>
                                                <h3 class="text-xl font-bold flex items-center gap-2">
                                                    <span class="text-blue-600">üë•</span>
                                                    All Connections
                                                </h3>
                                                <p class="text-sm text-gray-600 mt-1">View all your connections in one
                                                    place</p>
                                            </div>
                                            <div class="flex items-center gap-3">
                                                <input type="text" id="all-connections-search"
                                                    placeholder="Search connections..."
                                                    class="p-2 border-2 rounded-lg text-sm"
                                                    oninput="searchAllConnections(this.value)">
                                            </div>
                                        </div>
                                        <!-- Connections Grid -->
                                        <div id="all-connections-grid"
                                            class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 max-h-96 overflow-y-auto">
                                            <!-- Will be populated by JS -->
                                        </div>
                                    </div>

                                    <!-- Tutors Section -->
                                    <div id="tutors-connections-subsection"
                                        class="card p-6 connections-subsection hidden">
                                        <div class="flex items-center justify-between mb-6">
                                            <div>
                                                <h3 class="text-xl font-bold flex items-center gap-2">
                                                    <span class="text-green-600">üë®‚Äçüè´</span>
                                                    Tutor Connections
                                                </h3>
                                                <p class="text-sm text-gray-600 mt-1">Tutors you're learning from</p>
                                            </div>
                                            <div class="flex items-center gap-3">
                                                <input type="text" id="tutor-connections-search"
                                                    placeholder="Search tutors..."
                                                    class="p-2 border-2 rounded-lg text-sm"
                                                    oninput="searchTutorConnections(this.value)">
                                            </div>
                                        </div>
                                        <div id="tutor-connections-grid"
                                            class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 max-h-96 overflow-y-auto">
                                            <!-- Will be populated by JS -->
                                        </div>
                                    </div>

                                    <!-- Students Section -->
                                    <div id="students-connections-subsection"
                                        class="card p-6 connections-subsection hidden">
                                        <div class="flex items-center justify-between mb-6">
                                            <div>
                                                <h3 class="text-xl font-bold flex items-center gap-2">
                                                    <span class="text-purple-600">üë®‚Äçüéì</span>
                                                    Student Connections
                                                </h3>
                                                <p class="text-sm text-gray-600 mt-1">Fellow students in your network
                                                </p>
                                            </div>
                                            <div class="flex items-center gap-3">
                                                <input type="text" id="student-connections-search"
                                                    placeholder="Search students..."
                                                    class="p-2 border-2 rounded-lg text-sm"
                                                    oninput="searchStudentConnections(this.value)">
                                            </div>
                                        </div>
                                        <div id="student-connections-grid"
                                            class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 max-h-96 overflow-y-auto">
                                            <!-- Will be populated by JS -->
                                        </div>
                                    </div>

                                    <!-- Parents Section -->
                                    <div id="parents-connections-subsection"
                                        class="card p-6 connections-subsection hidden">
                                        <div class="flex items-center justify-between mb-6">
                                            <div>
                                                <h3 class="text-xl font-bold flex items-center gap-2">
                                                    <span class="text-orange-600">üë®‚Äçüë©‚Äçüëß</span>
                                                    Parent Connections
                                                </h3>
                                                <p class="text-sm text-gray-600 mt-1">Parents you're connected with</p>
                                            </div>
                                            <div class="flex items-center gap-3">
                                                <input type="text" id="parent-connections-search"
                                                    placeholder="Search parents..."
                                                    class="p-2 border-2 rounded-lg text-sm"
                                                    oninput="searchParentConnections(this.value)">
                                            </div>
                                        </div>
                                        <div id="parent-connections-grid"
                                            class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 max-h-96 overflow-y-auto">
                                            <!-- Will be populated by JS -->
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Events Tab Content -->
                            <div id="events-main-tab-content" class="community-main-tab-content hidden">
                                <!-- Section Header with Search -->
                                <div class="section-header" style="display: flex; justify-content: space-between; align-items: center; padding: 1rem; margin-bottom: 1rem;">
                                    <h3 style="font-size: 1.25rem; font-weight: 600; color: var(--heading);">üìÖ Events</h3>
                                    <div class="search-box" style="position: relative;">
                                        <i class="fas fa-search" style="position: absolute; left: 12px; top: 50%; transform: translateY(-50%); color: var(--text-muted);"></i>
                                        <input type="text" id="events-panel-search" placeholder="Search events..."
                                            style="padding: 0.5rem 0.75rem 0.5rem 2.25rem; border: 1px solid var(--border-color); border-radius: 8px; background: var(--card-bg); color: var(--text); font-size: 0.875rem; width: 200px;"
                                            oninput="searchEventsPanel(this.value)">
                                    </div>
                                </div>

                                <!-- Section Filters (Tabs) -->
                                <div class="section-filters" style="display: flex; gap: 0.5rem; padding: 0 1rem 1rem; flex-wrap: wrap;">
                                    <button class="filter-btn active" data-filter="joined" onclick="filterEventsPanelBy('joined')"
                                        style="padding: 0.5rem 1rem; border-radius: 20px; font-size: 0.875rem; font-weight: 500; background: var(--button-bg); color: white; border: none; cursor: pointer; transition: all 0.2s;">
                                        ‚úÖ Joined <span class="filter-count" id="joined-events-count" style="margin-left: 0.25rem; padding: 0.1rem 0.5rem; background: rgba(255,255,255,0.2); border-radius: 10px;">0</span>
                                    </button>
                                    <button class="filter-btn" data-filter="upcoming" onclick="filterEventsPanelBy('upcoming')"
                                        style="padding: 0.5rem 1rem; border-radius: 20px; font-size: 0.875rem; font-weight: 500; background: transparent; color: var(--text); border: 1px solid var(--border-color); cursor: pointer; transition: all 0.2s;">
                                        üìÖ Upcoming <span class="filter-count" id="upcoming-events-count" style="margin-left: 0.25rem; padding: 0.1rem 0.5rem; background: rgba(var(--border-rgb), 0.1); border-radius: 10px;">0</span>
                                    </button>
                                    <button class="filter-btn" data-filter="past" onclick="filterEventsPanelBy('past')"
                                        style="padding: 0.5rem 1rem; border-radius: 20px; font-size: 0.875rem; font-weight: 500; background: transparent; color: var(--text); border: 1px solid var(--border-color); cursor: pointer; transition: all 0.2s;">
                                        üìú Past <span class="filter-count" id="past-events-count" style="margin-left: 0.25rem; padding: 0.1rem 0.5rem; background: rgba(var(--border-rgb), 0.1); border-radius: 10px;">0</span>
                                    </button>
                                </div>

                                <!-- Events Grid - Single unified grid -->
                                <div id="events-panel-grid" class="events-grid" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 1rem; padding: 1rem;">
                                    <div class="loading-container" style="grid-column: 1 / -1; text-align: center; padding: 3rem;">
                                        <div class="loading-spinner" style="width: 40px; height: 40px; border: 3px solid var(--border-color); border-top-color: var(--button-bg); border-radius: 50%; animation: spin 1s linear infinite; margin: 0 auto;"></div>
                                        <p class="loading-text" style="margin-top: 1rem; color: var(--text-muted);">Loading events...</p>
                                    </div>
                                </div>
                            </div>

                            <!-- Clubs Tab Content -->
                            <div id="clubs-main-tab-content" class="community-main-tab-content hidden">
                                <!-- Section Header with Search -->
                                <div class="section-header" style="display: flex; justify-content: space-between; align-items: center; padding: 1rem; margin-bottom: 1rem;">
                                    <h3 style="font-size: 1.25rem; font-weight: 600; color: var(--heading);">üéØ Clubs</h3>
                                    <div class="search-box" style="position: relative;">
                                        <i class="fas fa-search" style="position: absolute; left: 12px; top: 50%; transform: translateY(-50%); color: var(--text-muted);"></i>
                                        <input type="text" id="clubs-panel-search" placeholder="Search clubs..."
                                            style="padding: 0.5rem 0.75rem 0.5rem 2.25rem; border: 1px solid var(--border-color); border-radius: 8px; background: var(--card-bg); color: var(--text); font-size: 0.875rem; width: 200px;"
                                            oninput="searchClubsPanel(this.value)">
                                    </div>
                                </div>

                                <!-- Section Filters (Tabs) -->
                                <div class="section-filters" style="display: flex; gap: 0.5rem; padding: 0 1rem 1rem; flex-wrap: wrap;">
                                    <button class="filter-btn active" data-filter="joined" onclick="filterClubsPanelBy('joined')"
                                        style="padding: 0.5rem 1rem; border-radius: 20px; font-size: 0.875rem; font-weight: 500; background: var(--button-bg); color: white; border: none; cursor: pointer; transition: all 0.2s;">
                                        üé≠ Joined <span class="filter-count" id="joined-clubs-count" style="margin-left: 0.25rem; padding: 0.1rem 0.5rem; background: rgba(255,255,255,0.2); border-radius: 10px;">0</span>
                                    </button>
                                    <button class="filter-btn" data-filter="discover" onclick="filterClubsPanelBy('discover')"
                                        style="padding: 0.5rem 1rem; border-radius: 20px; font-size: 0.875rem; font-weight: 500; background: transparent; color: var(--text); border: 1px solid var(--border-color); cursor: pointer; transition: all 0.2s;">
                                        üîç Discover <span class="filter-count" id="discover-clubs-count" style="margin-left: 0.25rem; padding: 0.1rem 0.5rem; background: rgba(var(--border-rgb), 0.1); border-radius: 10px;">0</span>
                                    </button>
                                </div>

                                <!-- Clubs Grid - Single unified grid -->
                                <div id="clubs-panel-grid" class="clubs-grid" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 1rem; padding: 1rem;">
                                    <div class="loading-container" style="grid-column: 1 / -1; text-align: center; padding: 3rem;">
                                        <div class="loading-spinner" style="width: 40px; height: 40px; border: 3px solid var(--border-color); border-top-color: var(--button-bg); border-radius: 50%; animation: spin 1s linear infinite; margin: 0 auto;"></div>
                                        <p class="loading-text" style="margin-top: 1rem; color: var(--text-muted);">Loading clubs...</p>
                                    </div>
                                </div>
                            </div>

                            <!-- Requests Tab Content -->
                            <div id="requests-main-tab-content" class="community-main-tab-content hidden">
                                <!-- Section Header with Search -->
                                <div class="section-header" style="display: flex; justify-content: space-between; align-items: center; padding: 1rem; margin-bottom: 1rem;">
                                    <h3 style="font-size: 1.25rem; font-weight: 600; color: var(--heading);">üì© Requests</h3>
                                    <div class="search-box" style="position: relative;">
                                        <i class="fas fa-search" style="position: absolute; left: 12px; top: 50%; transform: translateY(-50%); color: var(--text-muted);"></i>
                                        <input type="text" id="requests-panel-search" placeholder="Search requests..."
                                            style="padding: 0.5rem 0.75rem 0.5rem 2.25rem; border: 1px solid var(--border-color); border-radius: 8px; background: var(--card-bg); color: var(--text); font-size: 0.875rem; width: 200px;"
                                            oninput="searchRequestsPanel(this.value)">
                                    </div>
                                </div>

                                <!-- Section Filters (Tabs) -->
                                <div class="section-filters" style="display: flex; gap: 0.5rem; padding: 0 1rem 1rem; flex-wrap: wrap;">
                                    <button class="filter-btn active" data-filter="received" onclick="filterRequestsPanelBy('received')"
                                        style="padding: 0.5rem 1rem; border-radius: 20px; font-size: 0.875rem; font-weight: 500; background: var(--button-bg); color: white; border: none; cursor: pointer; transition: all 0.2s;">
                                        üì• Received <span class="filter-count" id="received-requests-count" style="margin-left: 0.25rem; padding: 0.1rem 0.5rem; background: rgba(255,255,255,0.2); border-radius: 10px;">0</span>
                                    </button>
                                    <button class="filter-btn" data-filter="sent" onclick="filterRequestsPanelBy('sent')"
                                        style="padding: 0.5rem 1rem; border-radius: 20px; font-size: 0.875rem; font-weight: 500; background: transparent; color: var(--text); border: 1px solid var(--border-color); cursor: pointer; transition: all 0.2s;">
                                        üì§ Sent <span class="filter-count" id="sent-requests-count" style="margin-left: 0.25rem; padding: 0.1rem 0.5rem; background: rgba(var(--border-rgb), 0.1); border-radius: 10px;">0</span>
                                    </button>
                                </div>

                                <!-- Requests Grid - Single unified grid -->
                                <div id="requests-panel-grid" class="connections-grid" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 1rem; padding: 1rem;">
                                    <div class="loading-container" style="grid-column: 1 / -1; text-align: center; padding: 3rem;">
                                        <div class="loading-spinner" style="width: 40px; height: 40px; border: 3px solid var(--border-color); border-top-color: var(--button-bg); border-radius: 50%; animation: spin 1s linear infinite; margin: 0 auto;"></div>
                                        <p class="loading-text" style="margin-top: 1rem; color: var(--text-muted);">Loading requests...</p>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Parent Portal Panel -->
                        <div id="parent-portal-panel" class="panel-content hidden">
                            <div class="panel-header mb-6">
                                <div class="flex justify-between items-center mb-4">
                                    <div>
                                        <h2 class="text-2xl font-bold text-gray-800 dark:text-gray-200">üë®‚Äçüë©‚Äçüëß Parent Portal</h2>
                                        <p class="text-sm text-gray-500 dark:text-gray-400 mt-1">Connect with your parents and share your academic progress</p>
                                    </div>
                                    <button id="invite-parent-btn" class="btn-primary px-4 py-2 text-white rounded-lg font-semibold transition-all flex items-center gap-2 shadow-lg"
                                        style="background: linear-gradient(135deg, var(--button-bg), var(--button-hover));"
                                        onclick="openInviteParentModal()">
                                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M18 9v3m0 0v3m0-3h3m-3 0h-3m-2-5a4 4 0 11-8 0 4 4 0 018 0zM3 20a6 6 0 0112 0v1H3v-1z"></path>
                                        </svg>
                                        Invite Parent
                                    </button>
                                </div>
                            </div>

                            <!-- Tabs for Linked Parents and Pending Parents -->
                            <div class="parent-portal-tabs mb-6" style="display: flex; gap: 0; border-bottom: 2px solid var(--border-color);">
                                <button id="linked-parents-tab" class="parent-portal-tab active" onclick="switchParentPortalTab('linked')"
                                    style="padding: 0.75rem 1.5rem; font-weight: 600; color: var(--button-bg); border-bottom: 2px solid var(--button-bg); margin-bottom: -2px; background: transparent; cursor: pointer; transition: all 0.3s ease; display: flex; align-items: center; gap: 0.5rem;">
                                    <span style="color: #10b981;">‚úì</span> Linked Parents
                                    <span id="linked-parents-count" class="text-xs font-medium px-2 py-0.5 rounded-full" style="background: rgba(var(--button-bg-rgb), 0.1); color: var(--button-bg);">0</span>
                                </button>
                                <button id="pending-parents-tab" class="parent-portal-tab" onclick="switchParentPortalTab('pending')"
                                    style="padding: 0.75rem 1.5rem; font-weight: 600; color: var(--text-muted); border-bottom: 2px solid transparent; margin-bottom: -2px; background: transparent; cursor: pointer; transition: all 0.3s ease; display: flex; align-items: center; gap: 0.5rem;">
                                    <span style="color: #f59e0b;">‚è≥</span> Pending Invitations
                                    <span id="pending-invitations-count" class="text-xs font-medium px-2 py-0.5 rounded-full hidden" style="background: rgba(245, 158, 11, 0.1); color: #f59e0b;">0</span>
                                </button>
                            </div>

                            <!-- Linked Parents Tab Content -->
                            <div id="linked-parents-content" class="parent-portal-tab-content">
                                <div id="linked-parents-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                                    <!-- Linked parents will be loaded dynamically -->
                                    <div class="flex items-center justify-center py-8 col-span-full">
                                        <div class="text-center">
                                            <div class="text-5xl mb-4 opacity-50">üë®‚Äçüë©‚Äçüëß</div>
                                            <p class="text-gray-500 dark:text-gray-400">No parents linked yet</p>
                                            <p class="text-sm text-gray-400 dark:text-gray-500 mt-1">Click "Invite Parent" to connect with your parents</p>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Pending Invitations Tab Content -->
                            <div id="pending-parents-content" class="parent-portal-tab-content" style="display: none;">
                                <div id="pending-invitations-list" class="space-y-3">
                                    <!-- Pending invitations will be loaded dynamically -->
                                    <div class="flex items-center justify-center py-8">
                                        <div class="text-center">
                                            <div class="text-5xl mb-4 opacity-50">‚è≥</div>
                                            <p class="text-gray-500 dark:text-gray-400">No pending invitations</p>
                                            <p class="text-sm text-gray-400 dark:text-gray-500 mt-1">Invitations you send will appear here until accepted</p>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Information Cards -->
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mt-8">
                                <div class="card p-6 bg-gradient-to-br from-blue-50 to-indigo-50 dark:from-blue-900/20 dark:to-indigo-900/20 border border-blue-200 dark:border-blue-700/50 rounded-xl">
                                    <div class="flex items-start gap-4">
                                        <div class="text-3xl">üîí</div>
                                        <div>
                                            <h4 class="font-semibold text-gray-800 dark:text-gray-200 mb-2">Security Verification</h4>
                                            <p class="text-sm text-gray-600 dark:text-gray-400">When inviting parents, you'll need to verify your identity by entering your father and grandfather name. This ensures only you can add parents to your account.</p>
                                        </div>
                                    </div>
                                </div>
                                <div class="card p-6 bg-gradient-to-br from-green-50 to-emerald-50 dark:from-green-900/20 dark:to-emerald-900/20 border border-green-200 dark:border-green-700/50 rounded-xl">
                                    <div class="flex items-start gap-4">
                                        <div class="text-3xl">üëÄ</div>
                                        <div>
                                            <h4 class="font-semibold text-gray-800 dark:text-gray-200 mb-2">What Parents Can See</h4>
                                            <p class="text-sm text-gray-600 dark:text-gray-400">Linked parents can view your academic progress, session history, tutor interactions, and receive notifications about your learning journey.</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Ratings and Reviews Panel -->
                        <div id="ratings-and-reviews-panel" class="panel-content hidden">
                            <section
                                style="background: var(--card-bg); border-radius: 16px; padding: 2rem; margin-bottom: 2rem; box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);">
                                <div
                                    style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem; flex-wrap: wrap; gap: 1rem;">
                                    <h2
                                        style="font-size: 1.75rem; font-weight: 700; margin: 0; color: var(--heading); display: flex; align-items: center; gap: 0.75rem;">
                                        <span>‚≠ê</span> Ratings & Reviews
                                    </h2>
                                </div>

                                <!-- Overall Rating Section (From Student Reviews) -->
                                <section class="overall-rating-section"
                                    style="background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%); border-radius: 16px; padding: 2rem; margin-bottom: 2rem; box-shadow: 0 4px 16px rgba(245,158,11,0.3); color: white;">
                                    <div
                                        style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 2rem;">
                                        <div style="flex: 1; min-width: 200px;">
                                            <div id="overall-rating-label"
                                                style="font-size: 0.95rem; font-weight: 600; margin-bottom: 0.5rem; opacity: 0.95;">
                                                Overall Student Rating</div>
                                            <div
                                                style="display: flex; align-items: baseline; gap: 0.75rem; margin-bottom: 0.75rem;">
                                                <div id="overall-rating-value"
                                                    style="font-size: 3.5rem; font-weight: 700; line-height: 1;">0.0
                                                </div>
                                                <div style="font-size: 1.25rem; opacity: 0.9;">/ 5.0</div>
                                            </div>
                                            <div id="overall-rating-stars"
                                                style="color: rgba(255,255,255,0.95); font-size: 1rem; margin-bottom: 1rem;">
                                                ‚òÜ‚òÜ‚òÜ‚òÜ‚òÜ
                                            </div>
                                            <div id="overall-rating-count" style="font-size: 0.95rem; opacity: 0.9;">
                                                Based on 0 tutor reviews</div>
                                        </div>

                                        <div style="flex: 2; min-width: 300px;">
                                            <div id="rating-breakdown"
                                                style="display: flex; flex-direction: column; gap: 0.75rem;">
                                                <!-- Behavioral Categories (Dynamic) -->
                                                <div style="display: flex; align-items: center; gap: 0.75rem;">
                                                    <span style="font-size: 0.875rem; width: 180px;">Subject Understanding</span>
                                                    <div
                                                        style="flex: 1; height: 8px; background: rgba(255,255,255,0.2); border-radius: 4px; overflow: hidden;">
                                                        <div id="rating-bar-subject"
                                                            style="height: 100%; width: 0%; background: white; border-radius: 4px; transition: width 0.5s ease;">
                                                        </div>
                                                    </div>
                                                    <span id="rating-count-subject"
                                                        style="font-size: 0.875rem; width: 40px; text-align: right;">0.0</span>
                                                </div>
                                                <div style="display: flex; align-items: center; gap: 0.75rem;">
                                                    <span style="font-size: 0.875rem; width: 180px;">Communication Skills</span>
                                                    <div
                                                        style="flex: 1; height: 8px; background: rgba(255,255,255,0.2); border-radius: 4px; overflow: hidden;">
                                                        <div id="rating-bar-communication"
                                                            style="height: 100%; width: 0%; background: white; border-radius: 4px; transition: width 0.5s ease;">
                                                        </div>
                                                    </div>
                                                    <span id="rating-count-communication"
                                                        style="font-size: 0.875rem; width: 40px; text-align: right;">0.0</span>
                                                </div>
                                                <div style="display: flex; align-items: center; gap: 0.75rem;">
                                                    <span style="font-size: 0.875rem; width: 180px;">Discipline</span>
                                                    <div
                                                        style="flex: 1; height: 8px; background: rgba(255,255,255,0.2); border-radius: 4px; overflow: hidden;">
                                                        <div id="rating-bar-discipline"
                                                            style="height: 100%; width: 0%; background: white; border-radius: 4px; transition: width 0.5s ease;">
                                                        </div>
                                                    </div>
                                                    <span id="rating-count-discipline"
                                                        style="font-size: 0.875rem; width: 40px; text-align: right;">0.0</span>
                                                </div>
                                                <div style="display: flex; align-items: center; gap: 0.75rem;">
                                                    <span style="font-size: 0.875rem; width: 180px;">Punctuality</span>
                                                    <div
                                                        style="flex: 1; height: 8px; background: rgba(255,255,255,0.2); border-radius: 4px; overflow: hidden;">
                                                        <div id="rating-bar-punctuality"
                                                            style="height: 100%; width: 0%; background: white; border-radius: 4px; transition: width 0.5s ease;">
                                                        </div>
                                                    </div>
                                                    <span id="rating-count-punctuality"
                                                        style="font-size: 0.875rem; width: 40px; text-align: right;">0.0</span>
                                                </div>
                                                <div style="display: flex; align-items: center; gap: 0.75rem;">
                                                    <span style="font-size: 0.875rem; width: 180px;">Class Activity</span>
                                                    <div
                                                        style="flex: 1; height: 8px; background: rgba(255,255,255,0.2); border-radius: 4px; overflow: hidden;">
                                                        <div id="rating-bar-class-activity"
                                                            style="height: 100%; width: 0%; background: white; border-radius: 4px; transition: width 0.5s ease;">
                                                        </div>
                                                    </div>
                                                    <span id="rating-count-class-activity"
                                                        style="font-size: 0.875rem; width: 40px; text-align: right;">0.0</span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </section>

                                <!-- Reviews from Tutors -->
                                <div style="margin-bottom: 2rem;">
                                    <h3 id="reviews-title"
                                        style="font-size: 1.5rem; font-weight: 600; margin-bottom: 1rem; color: var(--heading); display: flex; align-items: center; gap: 0.5rem;">
                                        <span>üìù</span> Reviews from Tutors
                                    </h3>
                                    <p id="reviews-subtitle"
                                        style="color: var(--text-secondary); font-size: 0.95rem; margin-bottom: 1rem;">
                                        See what tutors are saying about your performance</p>

                                    <!-- Star Filter Tabs -->
                                    <div id="star-filter-tabs"
                                        style="display: flex; gap: 0.5rem; margin-bottom: 1.5rem; overflow-x: auto; padding-bottom: 0.5rem;">
                                        <button class="star-filter-tab active" data-filter="all"
                                            style="padding: 0.5rem 1rem; border: 2px solid var(--primary-color); border-radius: 20px; background: linear-gradient(135deg, #f59e0b, #d97706); color: white; font-weight: 600; cursor: pointer; transition: all 0.3s ease; white-space: nowrap; font-size: 0.875rem;">
                                            All Reviews
                                        </button>
                                        <button class="star-filter-tab" data-filter="5"
                                            style="padding: 0.5rem 1rem; border: 2px solid rgba(245, 158, 11, 0.3); border-radius: 20px; background: var(--card-bg); color: var(--text); font-weight: 600; cursor: pointer; transition: all 0.3s ease; white-space: nowrap; font-size: 0.875rem;">
                                            ‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ (5)
                                        </button>
                                        <button class="star-filter-tab" data-filter="4"
                                            style="padding: 0.5rem 1rem; border: 2px solid rgba(245, 158, 11, 0.3); border-radius: 20px; background: var(--card-bg); color: var(--text); font-weight: 600; cursor: pointer; transition: all 0.3s ease; white-space: nowrap; font-size: 0.875rem;">
                                            ‚òÖ‚òÖ‚òÖ‚òÖ‚òÜ (4)
                                        </button>
                                        <button class="star-filter-tab" data-filter="3"
                                            style="padding: 0.5rem 1rem; border: 2px solid rgba(245, 158, 11, 0.3); border-radius: 20px; background: var(--card-bg); color: var(--text); font-weight: 600; cursor: pointer; transition: all 0.3s ease; white-space: nowrap; font-size: 0.875rem;">
                                            ‚òÖ‚òÖ‚òÖ‚òÜ‚òÜ (3)
                                        </button>
                                        <button class="star-filter-tab" data-filter="2"
                                            style="padding: 0.5rem 1rem; border: 2px solid rgba(245, 158, 11, 0.3); border-radius: 20px; background: var(--card-bg); color: var(--text); font-weight: 600; cursor: pointer; transition: all 0.3s ease; white-space: nowrap; font-size: 0.875rem;">
                                            ‚òÖ‚òÖ‚òÜ‚òÜ‚òÜ (2)
                                        </button>
                                        <button class="star-filter-tab" data-filter="1"
                                            style="padding: 0.5rem 1rem; border: 2px solid rgba(245, 158, 11, 0.3); border-radius: 20px; background: var(--card-bg); color: var(--text); font-weight: 600; cursor: pointer; transition: all 0.3s ease; white-space: nowrap; font-size: 0.875rem;">
                                            ‚òÖ‚òÜ‚òÜ‚òÜ‚òÜ (1)
                                        </button>
                                    </div>

                                    <div id="reviews-container"
                                        style="display: flex; flex-direction: column; gap: 1.5rem;">
                                        <!-- Loading state -->
                                        <div style="text-align: center; padding: 3rem;">
                                            <i class="fas fa-spinner fa-spin" style="font-size: 2rem; color: var(--primary-color); margin-bottom: 1rem;"></i>
                                            <p style="color: var(--text-secondary);">Loading reviews...</p>
                                        </div>
                                    </div>
                                </div>
                            </section>
                        </div>

                        <!-- Become Tutor Panel -->
                        <div id="become-tutor-panel" class="panel-content hidden">
                            <h2 class="text-2xl font-bold mb-6">üéì Become a Tutor</h2>
                            <div class="become-tutor-section">
                                <div class="requirements-card mb-6 p-6 rounded-lg border">
                                    <h3 class="text-xl font-bold mb-4">Requirements</h3>
                                    <ul class="space-y-2">
                                        <li>‚úì Maintain a GPA of 3.5 or higher</li>
                                        <li>‚úì Complete tutor training program</li>
                                        <li>‚úì Get recommendation from 2 teachers</li>
                                        <li>‚úì Pass subject proficiency test</li>
                                    </ul>
                                </div>
                                <button class="btn-primary" onclick="openComingSoonModal('Apply to Become Tutor')">Apply
                                    Now</button>
                            </div>
                        </div>

                        <!-- My Products Panel -->
                        <div id="my-products-panel" class="panel-content hidden">
                            <div class="panel-header">
                                <h2 class="text-2xl font-bold">üì¶ My Products & Collections</h2>
                            </div>
                            <div class="product-filters mb-6">
                                <button class="filter-chip active">All Items</button>
                                <button class="filter-chip">Purchased</button>
                                <button class="filter-chip">Wishlist</button>
                                <button class="filter-chip">Favorites</button>
                            </div>
                            <div id="products-grid" class="products-grid">
                                <!-- Products will be loaded dynamically -->
                                <p class="text-gray-600">Your products and collections will appear here.</p>
                            </div>
                        </div>

                        <!-- Earnings & Investments Panel -->
                        <div id="earnings-investments-panel" class="panel-content hidden">
                            <div class="mb-8">
                                <h1 class="text-3xl font-bold mb-2">Earnings & Investments</h1>
                                <p class="text-gray-600">Track your income streams and investment portfolio</p>
                            </div>

                            <!-- Tabs -->
                            <div class="flex gap-4 mb-6 border-b border-gray-200">
                                <button onclick="switchEarningsTab('earnings')" id="earnings-tab"
                                    class="earnings-tab-btn px-6 py-3 font-semibold text-blue-600 border-b-2 border-blue-600 transition-all">
                                    Earnings
                                </button>
                                <button onclick="switchEarningsTab('investments')" id="investments-tab"
                                    class="earnings-tab-btn px-6 py-3 font-semibold text-gray-500 hover:text-gray-700 transition-all">
                                    Investments
                                </button>
                            </div>

                            <!-- Earnings Tab Content -->
                            <div id="earnings-tab-content" class="earnings-tab-content">
                                <!-- Summary Cards (3 Cards: Total, Affiliate, Tutoring) -->
                                <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                                    <div onclick="toggleEarningsSection('total')"
                                        class="card p-6 bg-gradient-to-br from-green-50 to-emerald-50 border-green-200 cursor-pointer hover:shadow-lg transition-all duration-200 active-earnings-card">
                                        <div class="flex items-center justify-between mb-2">
                                            <span class="text-green-600 text-2xl">üí∞</span>
                                            <span class="text-xs text-green-600 font-semibold">ALL SOURCES</span>
                                        </div>
                                        <p class="text-sm text-gray-600 mb-1">Total Earnings</p>
                                        <h3 class="text-2xl font-bold text-gray-800" id="total-earnings">0 ETB</h3>
                                        <p class="text-xs text-green-600 mt-2 font-medium">Click to view all</p>
                                    </div>
                                    <div onclick="toggleEarningsSection('affiliate')"
                                        class="card p-6 bg-gradient-to-br from-blue-50 to-indigo-50 border-blue-200 cursor-pointer hover:shadow-lg transition-all duration-200">
                                        <div class="flex items-center justify-between mb-2">
                                            <span class="text-blue-600 text-2xl">ü§ù</span>
                                            <span class="text-xs text-blue-600 font-semibold">AFFILIATE</span>
                                        </div>
                                        <p class="text-sm text-gray-600 mb-1">Affiliate Earnings</p>
                                        <h3 class="text-2xl font-bold text-gray-800" id="affiliate-earnings">0 ETB</h3>
                                        <p class="text-xs text-blue-600 mt-2 font-medium">Click to view</p>
                                    </div>
                                    <div onclick="toggleEarningsSection('tutoring')"
                                        class="card p-6 bg-gradient-to-br from-orange-50 to-amber-50 border-orange-200 cursor-pointer hover:shadow-lg transition-all duration-200">
                                        <div class="flex items-center justify-between mb-2">
                                            <span class="text-orange-600 text-2xl">üìö</span>
                                            <span class="text-xs text-orange-600 font-semibold">TUTORING</span>
                                        </div>
                                        <p class="text-sm text-gray-600 mb-1">Tutoring Sessions</p>
                                        <h3 class="text-2xl font-bold text-gray-800" id="tutoring-earnings">0 ETB</h3>
                                        <p class="text-xs text-orange-600 mt-2 font-medium">Click to view</p>
                                    </div>
                                </div>

                                <!-- Earnings Sections -->
                                <div class="space-y-8">
                                    <!-- Total Earnings Section -->
                                    <div id="total-earnings-section" class="card p-6 earnings-section">
                                        <div class="flex items-center justify-between mb-6">
                                            <div>
                                                <h3 class="text-xl font-bold flex items-center gap-2">
                                                    <span class="text-green-600">üí∞</span>
                                                    Total Earnings - All Sources
                                                </h3>
                                                <p class="text-sm text-gray-600 mt-1">Combined view of all your earnings
                                                </p>
                                            </div>
                                            <div class="flex items-center gap-3">
                                                <select id="total-period-selector" onchange="loadTotalEarningsData()"
                                                    class="p-2 border-2 rounded-lg text-sm font-medium">
                                                    <option value="1">Last Month</option>
                                                    <option value="3">Last 3 Months</option>
                                                    <option value="6" selected>Last 6 Months</option>
                                                    <option value="12">Last Year</option>
                                                </select>
                                            </div>
                                        </div>
                                        <!-- Total Earnings Chart -->
                                        <div class="mb-6 bg-gray-50 p-4 rounded-lg" style="height: 300px;">
                                            <canvas id="total-earnings-chart"></canvas>
                                        </div>
                                        <!-- Combined List -->
                                        <div id="total-earnings-list" class="space-y-3 max-h-96 overflow-y-auto">
                                            <!-- Will be populated by JS -->
                                        </div>
                                    </div>

                                    <!-- Affiliate Earnings Section (with 3 tabs: Advertisement, Subscription, Commission) -->
                                    <div id="affiliate-earnings-section" class="card p-6 earnings-section hidden">
                                        <div class="flex items-center justify-between mb-6">
                                            <div>
                                                <h3 class="text-xl font-bold flex items-center gap-2">
                                                    <span class="text-blue-600">ü§ù</span>
                                                    Affiliate Earnings
                                                </h3>
                                                <p class="text-sm text-gray-600 mt-1">Earnings from ads, referrals, and connections</p>
                                            </div>
                                            <div class="flex items-center gap-3">
                                                <select id="affiliate-period-selector" onchange="loadAffiliateData()"
                                                    class="p-2 border-2 rounded-lg text-sm font-medium">
                                                    <option value="1">Last Month</option>
                                                    <option value="3">Last 3 Months</option>
                                                    <option value="6" selected>Last 6 Months</option>
                                                    <option value="12">Last Year</option>
                                                </select>
                                            </div>
                                        </div>

                                        <!-- Affiliate Sub-Tabs -->
                                        <div class="flex gap-2 mb-6 border-b border-gray-200">
                                            <button onclick="switchAffiliateTab('advertisement')" id="advertisement-tab"
                                                class="affiliate-tab-btn px-4 py-2 font-medium text-blue-600 border-b-2 border-blue-600 transition-all flex items-center gap-2">
                                                <span>üì∫</span> Advertisement
                                            </button>
                                            <button onclick="switchAffiliateTab('subscription')" id="subscription-tab"
                                                class="affiliate-tab-btn px-4 py-2 font-medium text-gray-500 hover:text-gray-700 transition-all flex items-center gap-2">
                                                <span>‚≠ê</span> Subscription
                                            </button>
                                            <button onclick="switchAffiliateTab('commission')" id="commission-tab"
                                                class="affiliate-tab-btn px-4 py-2 font-medium text-gray-500 hover:text-gray-700 transition-all flex items-center gap-2">
                                                <span>üîó</span> Commission
                                            </button>
                                        </div>

                                        <!-- Advertisement Tab Content -->
                                        <div id="advertisement-tab-content" class="affiliate-tab-content">
                                            <div class="bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4">
                                                <p class="text-sm text-blue-800">
                                                    <strong>Advertisement Earnings:</strong> Revenue from ads displayed to users who signed up through your referral link.
                                                </p>
                                            </div>
                                            <!-- Affiliate Levels Info (Single Row, Clickable) -->
                                            <div id="advertisement-affiliate-levels" class="flex flex-wrap gap-3 mb-6">
                                                <!-- Will be populated by JS with clickable affiliate tier level cards -->
                                            </div>
                                            <div class="mb-6 bg-gray-50 p-4 rounded-lg" style="height: 250px;">
                                                <canvas id="advertisement-earnings-chart"></canvas>
                                            </div>
                                            <div id="advertisement-earnings-list" class="space-y-3 max-h-96 overflow-y-auto min-h-[200px]">
                                                <!-- Will be populated by JS -->
                                            </div>
                                        </div>

                                        <!-- Subscription Tab Content -->
                                        <div id="subscription-tab-content" class="affiliate-tab-content hidden">
                                            <div class="bg-purple-50 border border-purple-200 rounded-lg p-4 mb-4">
                                                <p class="text-sm text-purple-800">
                                                    <strong>Subscription Earnings:</strong> Commission from users you referred who subscribed to premium plans.
                                                </p>
                                            </div>
                                            <!-- Affiliate Levels Info (Single Row, Clickable) -->
                                            <div id="subscription-affiliate-levels" class="flex flex-wrap gap-3 mb-6">
                                                <!-- Will be populated by JS with clickable affiliate tier level cards -->
                                            </div>
                                            <div class="mb-6 bg-gray-50 p-4 rounded-lg" style="height: 250px;">
                                                <canvas id="subscription-earnings-chart"></canvas>
                                            </div>
                                            <div id="subscription-earnings-list" class="space-y-3 max-h-96 overflow-y-auto min-h-[200px]">
                                                <!-- Will be populated by JS -->
                                            </div>
                                        </div>

                                        <!-- Commission Tab Content -->
                                        <div id="commission-tab-content" class="affiliate-tab-content hidden">
                                            <div class="bg-green-50 border border-green-200 rounded-lg p-4 mb-4">
                                                <p class="text-sm text-green-800">
                                                    <strong>Commission Earnings:</strong> Your share from tutor-student connections you facilitated.
                                                </p>
                                            </div>
                                            <!-- Affiliate Levels Info (Single Row, Clickable) -->
                                            <div id="commission-affiliate-levels" class="flex flex-wrap gap-3 mb-6">
                                                <!-- Will be populated by JS with clickable affiliate tier level cards -->
                                            </div>
                                            <div class="mb-6 bg-gray-50 p-4 rounded-lg" style="height: 250px;">
                                                <canvas id="commission-earnings-chart"></canvas>
                                            </div>
                                            <div id="commission-earnings-list" class="space-y-3 max-h-96 overflow-y-auto min-h-[200px]">
                                                <!-- Will be populated by JS -->
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Tutoring Earnings Section -->
                                    <div id="tutoring-earnings-section" class="card p-6 earnings-section hidden">
                                        <div class="flex items-center justify-between mb-6">
                                            <div>
                                                <h3 class="text-xl font-bold flex items-center gap-2">
                                                    <span class="text-orange-600">üìö</span>
                                                    Tutoring Session Earnings
                                                </h3>
                                                <p class="text-sm text-gray-600 mt-1">Income from teaching sessions</p>
                                            </div>
                                            <div class="flex items-center gap-3">
                                                <select id="tutoring-period-selector" onchange="loadTutoringData()"
                                                    class="p-2 border-2 rounded-lg text-sm font-medium">
                                                    <option value="1">Last Month</option>
                                                    <option value="3">Last 3 Months</option>
                                                    <option value="6" selected>Last 6 Months</option>
                                                    <option value="12">Last Year</option>
                                                </select>
                                            </div>
                                        </div>
                                        <!-- Line Graph -->
                                        <div class="mb-6 bg-gray-50 p-4 rounded-lg" style="height: 250px;">
                                            <canvas id="tutoring-earnings-chart"></canvas>
                                        </div>
                                        <!-- List of Sessions -->
                                        <div id="tutoring-earnings-list" class="space-y-3 max-h-96 overflow-y-auto">
                                            <!-- Will be populated by JS -->
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Investments Tab Content -->
                            <div id="investments-tab-content" class="earnings-tab-content hidden">
                                <!-- Investment Summary Cards -->
                                <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                                    <div class="card p-6 bg-gradient-to-br from-blue-50 to-indigo-50 border-blue-200">
                                        <div class="flex items-center justify-between mb-2">
                                            <span class="text-blue-600 text-2xl">üíº</span>
                                            <span class="text-xs text-blue-600 font-semibold">INVESTED</span>
                                        </div>
                                        <p class="text-sm text-gray-600 mb-1">Total Investment</p>
                                        <h3 class="text-2xl font-bold text-gray-800" id="total-invested">0 ETB</h3>
                                    </div>
                                    <div class="card p-6 bg-gradient-to-br from-purple-50 to-pink-50 border-purple-200">
                                        <div class="flex items-center justify-between mb-2">
                                            <span class="text-purple-600 text-2xl">üëÅÔ∏è</span>
                                            <span class="text-xs text-purple-600 font-semibold">IMPRESSIONS</span>
                                        </div>
                                        <p class="text-sm text-gray-600 mb-1">Total Impressions</p>
                                        <h3 class="text-2xl font-bold text-gray-800" id="total-impressions">0</h3>
                                    </div>
                                    <div
                                        class="card p-6 bg-gradient-to-br from-green-50 to-emerald-50 border-green-200">
                                        <div class="flex items-center justify-between mb-2">
                                            <span class="text-green-600 text-2xl">üìä</span>
                                            <span class="text-xs text-green-600 font-semibold">CPM</span>
                                        </div>
                                        <p class="text-sm text-gray-600 mb-1">Cost Per Mille</p>
                                        <h3 class="text-2xl font-bold text-gray-800" id="average-cpm">0 ETB</h3>
                                    </div>
                                </div>

                                <!-- Investments List -->
                                <div class="card p-6">
                                    <div class="flex items-center justify-between mb-6">
                                        <h3 class="text-xl font-bold flex items-center gap-2">
                                            <span class="text-blue-600">üí∞</span>
                                            Investment Portfolio
                                        </h3>
                                        <button
                                            class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors">
                                            + Add Investment
                                        </button>
                                    </div>
                                    <div id="investments-list" class="space-y-4">
                                        <!-- Purchase Card 1: Mathematics Advanced Course -->
                                        <div
                                            class="card p-6 hover:shadow-lg transition-all duration-300 border-l-4 border-blue-500">
                                            <div class="flex items-start justify-between mb-4">
                                                <div class="flex items-center gap-4 flex-1">
                                                    <div
                                                        class="w-16 h-16 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-lg flex items-center justify-center text-white text-2xl">
                                                        üìö
                                                    </div>
                                                    <div class="flex-1">
                                                        <h4 class="font-bold text-lg text-gray-800 mb-1">Mathematics
                                                            Advanced Course</h4>
                                                        <p class="text-sm text-gray-600">Grade 12 - Advanced Calculus &
                                                            Algebra</p>
                                                        <div class="flex items-center gap-2 mt-2">
                                                            <span
                                                                class="bg-green-100 text-green-800 text-xs px-3 py-1 rounded-full font-semibold">Completed</span>
                                                            <span
                                                                class="bg-blue-100 text-blue-800 text-xs px-3 py-1 rounded-full font-semibold">Course</span>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="text-right">
                                                    <div class="text-2xl font-bold text-blue-600">850 ETB</div>
                                                    <div class="text-xs text-gray-500 mt-1">Jan 15, 2024</div>
                                                </div>
                                            </div>

                                            <div
                                                class="grid grid-cols-2 md:grid-cols-4 gap-4 p-4 bg-gray-50 rounded-lg mb-4">
                                                <div>
                                                    <div class="text-xs text-gray-500 mb-1">Amount</div>
                                                    <div class="font-semibold text-gray-800">850 ETB</div>
                                                </div>
                                                <div>
                                                    <div class="text-xs text-gray-500 mb-1">Date</div>
                                                    <div class="font-semibold text-gray-800">Jan 15, 2024</div>
                                                </div>
                                                <div>
                                                    <div class="text-xs text-gray-500 mb-1">Status</div>
                                                    <div class="font-semibold text-green-600">Completed</div>
                                                </div>
                                                <div>
                                                    <div class="text-xs text-gray-500 mb-1">Payment Method</div>
                                                    <div class="font-semibold text-gray-800">Chapa Pay</div>
                                                </div>
                                            </div>

                                            <div class="flex gap-2">
                                                <button
                                                    class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-sm font-medium">
                                                    View Certificate
                                                </button>
                                                <button
                                                    class="px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors text-sm font-medium">
                                                    Download Invoice
                                                </button>
                                                <button
                                                    class="px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors text-sm font-medium">
                                                    Leave Review
                                                </button>
                                            </div>
                                        </div>

                                        <!-- Purchase Card 2: Physics Tutoring Session Package -->
                                        <div
                                            class="card p-6 hover:shadow-lg transition-all duration-300 border-l-4 border-purple-500">
                                            <div class="flex items-start justify-between mb-4">
                                                <div class="flex items-center gap-4 flex-1">
                                                    <div
                                                        class="w-16 h-16 bg-gradient-to-br from-purple-500 to-pink-600 rounded-lg flex items-center justify-center text-white text-2xl">
                                                        üéØ
                                                    </div>
                                                    <div class="flex-1">
                                                        <h4 class="font-bold text-lg text-gray-800 mb-1">Physics
                                                            Tutoring Session Package</h4>
                                                        <p class="text-sm text-gray-600">10 Sessions with Dr. Abebe
                                                            Kebede</p>
                                                        <div class="flex items-center gap-2 mt-2">
                                                            <span
                                                                class="bg-yellow-100 text-yellow-800 text-xs px-3 py-1 rounded-full font-semibold">In
                                                                Progress</span>
                                                            <span
                                                                class="bg-purple-100 text-purple-800 text-xs px-3 py-1 rounded-full font-semibold">Tutoring</span>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="text-right">
                                                    <div class="text-2xl font-bold text-purple-600">1,200 ETB</div>
                                                    <div class="text-xs text-gray-500 mt-1">Feb 3, 2024</div>
                                                </div>
                                            </div>

                                            <div
                                                class="grid grid-cols-2 md:grid-cols-4 gap-4 p-4 bg-gray-50 rounded-lg mb-4">
                                                <div>
                                                    <div class="text-xs text-gray-500 mb-1">Amount</div>
                                                    <div class="font-semibold text-gray-800">1,200 ETB</div>
                                                </div>
                                                <div>
                                                    <div class="text-xs text-gray-500 mb-1">Date</div>
                                                    <div class="font-semibold text-gray-800">Feb 3, 2024</div>
                                                </div>
                                                <div>
                                                    <div class="text-xs text-gray-500 mb-1">Status</div>
                                                    <div class="font-semibold text-yellow-600">In Progress</div>
                                                </div>
                                                <div>
                                                    <div class="text-xs text-gray-500 mb-1">Payment Method</div>
                                                    <div class="font-semibold text-gray-800">M-Pesa</div>
                                                </div>
                                            </div>

                                            <div class="mb-3 p-3 bg-blue-50 rounded-lg border border-blue-200">
                                                <div class="flex items-center gap-2 text-sm">
                                                    <span class="font-semibold text-blue-800">Progress:</span>
                                                    <span class="text-blue-600">6 of 10 sessions completed</span>
                                                </div>
                                                <div class="w-full bg-blue-200 rounded-full h-2 mt-2">
                                                    <div class="bg-blue-600 h-2 rounded-full" style="width: 60%"></div>
                                                </div>
                                            </div>

                                            <div class="flex gap-2">
                                                <button
                                                    class="px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors text-sm font-medium">
                                                    View Schedule
                                                </button>
                                                <button
                                                    class="px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors text-sm font-medium">
                                                    Download Invoice
                                                </button>
                                                <button
                                                    class="px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors text-sm font-medium">
                                                    Contact Tutor
                                                </button>
                                            </div>
                                        </div>

                                        <!-- Purchase Card 3: Chemistry Study Materials Bundle -->
                                        <div
                                            class="card p-6 hover:shadow-lg transition-all duration-300 border-l-4 border-green-500">
                                            <div class="flex items-start justify-between mb-4">
                                                <div class="flex items-center gap-4 flex-1">
                                                    <div
                                                        class="w-16 h-16 bg-gradient-to-br from-green-500 to-emerald-600 rounded-lg flex items-center justify-center text-white text-2xl">
                                                        üß™
                                                    </div>
                                                    <div class="flex-1">
                                                        <h4 class="font-bold text-lg text-gray-800 mb-1">Chemistry Study
                                                            Materials Bundle</h4>
                                                        <p class="text-sm text-gray-600">Grade 11 - Organic Chemistry (3
                                                            PDFs + 5 Videos)</p>
                                                        <div class="flex items-center gap-2 mt-2">
                                                            <span
                                                                class="bg-green-100 text-green-800 text-xs px-3 py-1 rounded-full font-semibold">Delivered</span>
                                                            <span
                                                                class="bg-green-100 text-green-800 text-xs px-3 py-1 rounded-full font-semibold">Materials</span>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="text-right">
                                                    <div class="text-2xl font-bold text-green-600">350 ETB</div>
                                                    <div class="text-xs text-gray-500 mt-1">Jan 28, 2024</div>
                                                </div>
                                            </div>

                                            <div
                                                class="grid grid-cols-2 md:grid-cols-4 gap-4 p-4 bg-gray-50 rounded-lg mb-4">
                                                <div>
                                                    <div class="text-xs text-gray-500 mb-1">Amount</div>
                                                    <div class="font-semibold text-gray-800">350 ETB</div>
                                                </div>
                                                <div>
                                                    <div class="text-xs text-gray-500 mb-1">Date</div>
                                                    <div class="font-semibold text-gray-800">Jan 28, 2024</div>
                                                </div>
                                                <div>
                                                    <div class="text-xs text-gray-500 mb-1">Status</div>
                                                    <div class="font-semibold text-green-600">Delivered</div>
                                                </div>
                                                <div>
                                                    <div class="text-xs text-gray-500 mb-1">Payment Method</div>
                                                    <div class="font-semibold text-gray-800">Telebirr</div>
                                                </div>
                                            </div>

                                            <div class="flex gap-2">
                                                <button
                                                    class="px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors text-sm font-medium">
                                                    Access Materials
                                                </button>
                                                <button
                                                    class="px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors text-sm font-medium">
                                                    Download Invoice
                                                </button>
                                                <button
                                                    class="px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors text-sm font-medium">
                                                    Leave Review
                                                </button>
                                            </div>
                                        </div>

                                        <!-- Purchase Card 4: Biology Lab Access Subscription -->
                                        <div
                                            class="card p-6 hover:shadow-lg transition-all duration-300 border-l-4 border-orange-500">
                                            <div class="flex items-start justify-between mb-4">
                                                <div class="flex items-center gap-4 flex-1">
                                                    <div
                                                        class="w-16 h-16 bg-gradient-to-br from-orange-500 to-red-600 rounded-lg flex items-center justify-center text-white text-2xl">
                                                        üî¨
                                                    </div>
                                                    <div class="flex-1">
                                                        <h4 class="font-bold text-lg text-gray-800 mb-1">Biology Lab
                                                            Access Subscription</h4>
                                                        <p class="text-sm text-gray-600">3-Month Premium Digital Lab
                                                            Access</p>
                                                        <div class="flex items-center gap-2 mt-2">
                                                            <span
                                                                class="bg-green-100 text-green-800 text-xs px-3 py-1 rounded-full font-semibold">Active</span>
                                                            <span
                                                                class="bg-orange-100 text-orange-800 text-xs px-3 py-1 rounded-full font-semibold">Subscription</span>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="text-right">
                                                    <div class="text-2xl font-bold text-orange-600">600 ETB</div>
                                                    <div class="text-xs text-gray-500 mt-1">Feb 10, 2024</div>
                                                </div>
                                            </div>

                                            <div
                                                class="grid grid-cols-2 md:grid-cols-4 gap-4 p-4 bg-gray-50 rounded-lg mb-4">
                                                <div>
                                                    <div class="text-xs text-gray-500 mb-1">Amount</div>
                                                    <div class="font-semibold text-gray-800">600 ETB</div>
                                                </div>
                                                <div>
                                                    <div class="text-xs text-gray-500 mb-1">Date</div>
                                                    <div class="font-semibold text-gray-800">Feb 10, 2024</div>
                                                </div>
                                                <div>
                                                    <div class="text-xs text-gray-500 mb-1">Status</div>
                                                    <div class="font-semibold text-green-600">Active</div>
                                                </div>
                                                <div>
                                                    <div class="text-xs text-gray-500 mb-1">Payment Method</div>
                                                    <div class="font-semibold text-gray-800">Bank Transfer</div>
                                                </div>
                                            </div>

                                            <div class="mb-3 p-3 bg-orange-50 rounded-lg border border-orange-200">
                                                <div class="flex items-center justify-between text-sm">
                                                    <span class="font-semibold text-orange-800">Subscription:</span>
                                                    <span class="text-orange-600">Expires May 10, 2024 (60 days
                                                        left)</span>
                                                </div>
                                            </div>

                                            <div class="flex gap-2">
                                                <button
                                                    class="px-4 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700 transition-colors text-sm font-medium">
                                                    Access Lab
                                                </button>
                                                <button
                                                    class="px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors text-sm font-medium">
                                                    Renew Now
                                                </button>
                                                <button
                                                    class="px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors text-sm font-medium">
                                                    Download Invoice
                                                </button>
                                            </div>
                                        </div>

                                        <!-- Purchase Card 5: SAT Prep Course with Mock Tests -->
                                        <div
                                            class="card p-6 hover:shadow-lg transition-all duration-300 border-l-4 border-indigo-500">
                                            <div class="flex items-start justify-between mb-4">
                                                <div class="flex items-center gap-4 flex-1">
                                                    <div
                                                        class="w-16 h-16 bg-gradient-to-br from-indigo-500 to-blue-600 rounded-lg flex items-center justify-center text-white text-2xl">
                                                        üìù
                                                    </div>
                                                    <div class="flex-1">
                                                        <h4 class="font-bold text-lg text-gray-800 mb-1">SAT Prep Course
                                                            with Mock Tests</h4>
                                                        <p class="text-sm text-gray-600">Complete SAT Preparation (Math
                                                            + English + 10 Mock Tests)</p>
                                                        <div class="flex items-center gap-2 mt-2">
                                                            <span
                                                                class="bg-blue-100 text-blue-800 text-xs px-3 py-1 rounded-full font-semibold">Scheduled</span>
                                                            <span
                                                                class="bg-indigo-100 text-indigo-800 text-xs px-3 py-1 rounded-full font-semibold">Exam
                                                                Prep</span>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="text-right">
                                                    <div class="text-2xl font-bold text-indigo-600">1,500 ETB</div>
                                                    <div class="text-xs text-gray-500 mt-1">Feb 15, 2024</div>
                                                </div>
                                            </div>

                                            <div
                                                class="grid grid-cols-2 md:grid-cols-4 gap-4 p-4 bg-gray-50 rounded-lg mb-4">
                                                <div>
                                                    <div class="text-xs text-gray-500 mb-1">Amount</div>
                                                    <div class="font-semibold text-gray-800">1,500 ETB</div>
                                                </div>
                                                <div>
                                                    <div class="text-xs text-gray-500 mb-1">Date</div>
                                                    <div class="font-semibold text-gray-800">Feb 15, 2024</div>
                                                </div>
                                                <div>
                                                    <div class="text-xs text-gray-500 mb-1">Status</div>
                                                    <div class="font-semibold text-blue-600">Scheduled</div>
                                                </div>
                                                <div>
                                                    <div class="text-xs text-gray-500 mb-1">Payment Method</div>
                                                    <div class="font-semibold text-gray-800">Chapa Pay</div>
                                                </div>
                                            </div>

                                            <div class="mb-3 p-3 bg-indigo-50 rounded-lg border border-indigo-200">
                                                <div class="flex items-center gap-2 text-sm">
                                                    <span class="font-semibold text-indigo-800">Course Start:</span>
                                                    <span class="text-indigo-600">March 1, 2024 at 9:00 AM</span>
                                                </div>
                                            </div>

                                            <div class="flex gap-2">
                                                <button
                                                    class="px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors text-sm font-medium">
                                                    View Details
                                                </button>
                                                <button
                                                    class="px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors text-sm font-medium">
                                                    Add to Calendar
                                                </button>
                                                <button
                                                    class="px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors text-sm font-medium">
                                                    Download Invoice
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Settings Panel -->
                        <div id="settings-panel" class="panel-content hidden">
                            <div class="mb-8">
                                <h1 class="text-3xl font-bold mb-2">Settings</h1>
                                <p class="text-gray-600">Manage your account settings and preferences</p>
                            </div>

                            <!-- Account & Security Section -->
                            <div class="settings-section mb-8">
                                <h2 class="text-xl font-semibold mb-4 text-gray-700 flex items-center gap-2">
                                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"></path>
                                    </svg>
                                    Account & Security
                                </h2>

                                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                                    <!-- Verify Personal Info Card -->
                                    <div class="card p-6 cursor-pointer hover:shadow-lg transition-all duration-300 border-2 border-transparent hover:border-blue-500"
                                        onclick="openVerifyPersonalInfoModal()">
                                        <div class="flex flex-col items-center text-center">
                                            <div class="w-16 h-16 bg-gradient-to-br from-blue-500 to-purple-600 rounded-full flex items-center justify-center shadow-lg mb-4">
                                                <span class="text-3xl">üîê</span>
                                            </div>
                                            <h3 class="text-lg font-bold mb-2 text-gray-800">Verify Personal Info</h3>
                                            <p class="text-sm text-gray-600">Personal details and contact verification</p>
                                        </div>
                                    </div>

                                    <!-- Two-Factor Authentication Card -->
                                    <div class="card p-6 cursor-pointer hover:shadow-lg transition-all duration-300 border-2 border-transparent hover:border-indigo-500"
                                        onclick="openTwoFactorAuthModal()">
                                        <div class="flex flex-col items-center text-center">
                                            <div class="w-16 h-16 bg-gradient-to-br from-indigo-500 to-blue-600 rounded-full flex items-center justify-center shadow-lg mb-4">
                                                <span class="text-3xl">üõ°Ô∏è</span>
                                            </div>
                                            <h3 class="text-lg font-bold mb-2 text-gray-800">Two-Factor Auth</h3>
                                            <p class="text-sm text-gray-600">Extra security with 2FA</p>
                                            <span id="2fa-status-badge" class="mt-2 inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800">
                                                Not Enabled
                                            </span>
                                        </div>
                                    </div>

                                    <!-- Login Activity Card -->
                                    <div class="card p-6 cursor-pointer hover:shadow-lg transition-all duration-300 border-2 border-transparent hover:border-cyan-500"
                                        onclick="openLoginActivityModal()">
                                        <div class="flex flex-col items-center text-center">
                                            <div class="w-16 h-16 bg-gradient-to-br from-cyan-500 to-teal-600 rounded-full flex items-center justify-center shadow-lg mb-4">
                                                <span class="text-3xl">üì±</span>
                                            </div>
                                            <h3 class="text-lg font-bold mb-2 text-gray-800">Login Activity</h3>
                                            <p class="text-sm text-gray-600">Active sessions and history</p>
                                        </div>
                                    </div>

                                    <!-- Connected Accounts Card -->
                                    <div class="card p-6 cursor-pointer hover:shadow-lg transition-all duration-300 border-2 border-transparent hover:border-orange-500"
                                        onclick="openConnectedAccountsModal()">
                                        <div class="flex flex-col items-center text-center">
                                            <div class="w-16 h-16 bg-gradient-to-br from-orange-500 to-amber-600 rounded-full flex items-center justify-center shadow-lg mb-4">
                                                <span class="text-3xl">üîó</span>
                                            </div>
                                            <h3 class="text-lg font-bold mb-2 text-gray-800">Connected Accounts</h3>
                                            <p class="text-sm text-gray-600">Manage Google and other links</p>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Payments & Subscription Section -->
                            <div class="settings-section mb-8">
                                <h2 class="text-xl font-semibold mb-4 text-gray-700 flex items-center gap-2">
                                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"></path>
                                    </svg>
                                    Payments & Subscription
                                </h2>

                                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                                    <!-- Payment Method Card -->
                                    <div class="card p-6 cursor-pointer hover:shadow-lg transition-all duration-300 border-2 border-transparent hover:border-green-500"
                                        onclick="openPaymentMethodModal()">
                                        <div class="flex flex-col items-center text-center">
                                            <div class="w-16 h-16 bg-gradient-to-br from-green-500 to-emerald-600 rounded-full flex items-center justify-center shadow-lg mb-4">
                                                <span class="text-3xl">üí≥</span>
                                            </div>
                                            <h3 class="text-lg font-bold mb-2 text-gray-800">Payment Method</h3>
                                            <p class="text-sm text-gray-600">Manage your payment options</p>
                                        </div>
                                    </div>

                                    <!-- Subscription Card -->
                                    <div class="card p-6 cursor-pointer hover:shadow-lg transition-all duration-300 border-2 border-transparent hover:border-purple-500"
                                        onclick="openSubscriptionModal()">
                                        <div class="flex flex-col items-center text-center">
                                            <div class="w-16 h-16 bg-gradient-to-br from-purple-500 to-pink-600 rounded-full flex items-center justify-center shadow-lg mb-4">
                                                <span class="text-3xl">‚≠ê</span>
                                            </div>
                                            <h3 class="text-lg font-bold mb-2 text-gray-800">Subscription & Storage</h3>
                                            <p class="text-sm text-gray-600">Upgrade plan and unlock features</p>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Personalization Section -->
                            <div class="settings-section mb-8">
                                <h2 class="text-xl font-semibold mb-4 text-gray-700 flex items-center gap-2">
                                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 21a4 4 0 01-4-4V5a2 2 0 012-2h4a2 2 0 012 2v12a4 4 0 01-4 4zm0 0h12a2 2 0 002-2v-4a2 2 0 00-2-2h-2.343M11 7.343l1.657-1.657a2 2 0 012.828 0l2.829 2.829a2 2 0 010 2.828l-8.486 8.485M7 17h.01"></path>
                                    </svg>
                                    Personalization
                                </h2>

                                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                                    <!-- Appearance Card -->
                                    <div class="card p-6 cursor-pointer hover:shadow-lg transition-all duration-300 border-2 border-transparent hover:border-violet-500"
                                        onclick="openAppearanceModal()">
                                        <div class="flex flex-col items-center text-center">
                                            <div class="w-16 h-16 bg-gradient-to-br from-violet-500 to-purple-600 rounded-full flex items-center justify-center shadow-lg mb-4">
                                                <span class="text-3xl">üé®</span>
                                            </div>
                                            <h3 class="text-lg font-bold mb-2 text-gray-800">Appearance</h3>
                                            <p class="text-sm text-gray-600">Theme, font size, and display</p>
                                        </div>
                                    </div>

                                    <!-- Language Preferences Card -->
                                    <div class="card p-6 cursor-pointer hover:shadow-lg transition-all duration-300 border-2 border-transparent hover:border-sky-500"
                                        onclick="openLanguagePreferencesModal()">
                                        <div class="flex flex-col items-center text-center">
                                            <div class="w-16 h-16 bg-gradient-to-br from-sky-500 to-blue-600 rounded-full flex items-center justify-center shadow-lg mb-4">
                                                <span class="text-3xl">üåê</span>
                                            </div>
                                            <h3 class="text-lg font-bold mb-2 text-gray-800">Language</h3>
                                            <p class="text-sm text-gray-600">UI language and translation</p>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Data & Privacy Section -->
                            <div class="settings-section mb-8">
                                <h2 class="text-xl font-semibold mb-4 text-gray-700 flex items-center gap-2">
                                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                                    </svg>
                                    Data & Privacy
                                </h2>

                                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                                    <!-- Export Data Card -->
                                    <div class="card p-6 cursor-pointer hover:shadow-lg transition-all duration-300 border-2 border-transparent hover:border-teal-500"
                                        onclick="openExportDataModal()">
                                        <div class="flex flex-col items-center text-center">
                                            <div class="w-16 h-16 bg-gradient-to-br from-teal-500 to-cyan-600 rounded-full flex items-center justify-center shadow-lg mb-4">
                                                <span class="text-3xl">üì¶</span>
                                            </div>
                                            <h3 class="text-lg font-bold mb-2 text-gray-800">Export Data</h3>
                                            <p class="text-sm text-gray-600">Download your personal data</p>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Feedback & Support Section -->
                            <div class="settings-section mb-8">
                                <h2 class="text-xl font-semibold mb-4 text-gray-700 flex items-center gap-2">
                                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"></path>
                                    </svg>
                                    Feedback & Support
                                </h2>

                                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                                    <!-- Review & Rate Astegni Card -->
                                    <div class="card p-6 cursor-pointer hover:shadow-lg transition-all duration-300 border-2 border-transparent hover:border-yellow-500"
                                        onclick="openReviewAstegniModal()">
                                        <div class="flex flex-col items-center text-center">
                                            <div class="w-16 h-16 bg-gradient-to-br from-yellow-500 to-orange-500 rounded-full flex items-center justify-center shadow-lg mb-4">
                                                <span class="text-3xl">‚≠ê</span>
                                            </div>
                                            <h3 class="text-lg font-bold mb-2 text-gray-800">Review Astegni</h3>
                                            <p class="text-sm text-gray-600">Share your feedback with us</p>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Danger Zone Section -->
                            <div class="settings-section">
                                <h2 class="text-xl font-semibold mb-4 text-red-600 flex items-center gap-2">
                                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path>
                                    </svg>
                                    Danger Zone
                                </h2>

                                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                                    <!-- Leave Astegni Card -->
                                    <div class="card p-6 cursor-pointer hover:shadow-lg transition-all duration-300 border-2 border-transparent hover:border-red-500"
                                        onclick="openLeaveAstegniModal()">
                                        <div class="flex flex-col items-center text-center">
                                            <div class="w-16 h-16 bg-gradient-to-br from-red-500 to-red-700 rounded-full flex items-center justify-center shadow-lg mb-4">
                                                <span class="text-3xl">üö™</span>
                                            </div>
                                            <h3 class="text-lg font-bold mb-2 text-gray-800">Leave Astegni</h3>
                                            <p class="text-sm text-gray-600">Delete account permanently</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Right Sidebar Widgets (Persistent across all panels) -->
                <div class="right-widgets">

                    <!-- Ad Widget -->
                    <div class="widget-card" style="padding: 1.5rem; margin-bottom: 1.5rem;">
                        <div class="widget-header" style="margin-bottom: 0.75rem; display: flex; justify-content: flex-end;">
                            <span style="font-size: 0.65rem; color: var(--text-secondary); background: var(--bg-secondary); padding: 0.2rem 0.5rem; border-radius: 4px;">Ad</span>
                        </div>
                        <div class="ad-content" id="ad-container-student" style="min-height: 170px; display: flex; flex-direction: column; align-items: center; justify-content: center; background: linear-gradient(135deg, var(--bg-secondary) 0%, var(--card-bg) 100%); border-radius: 12px; padding: 1.5rem 1rem 2rem; cursor: pointer; overflow: hidden; position: relative;">
                            <div id="ad-message-container-student" style="text-align: center; position: relative; width: 100%; height: 90px; overflow: hidden;">
                                <div class="ad-message-student active" style="position: absolute; width: 100%; transition: all 0.6s ease; opacity: 1; transform: scale(1);">
                                    <div style="font-size: 1.8rem; margin-bottom: 0.5rem;">üì£</div>
                                    <p style="font-size: 1rem; font-weight: 600; color: var(--heading);">Your Ad Goes Here</p>
                                </div>
                                <div class="ad-message-student" style="position: absolute; width: 100%; transition: all 0.6s ease; opacity: 0; transform: scale(0.8);">
                                    <div style="font-size: 1.8rem; margin-bottom: 0.5rem;">üéØ</div>
                                    <p style="font-size: 1rem; font-weight: 600; color: var(--heading);">Target Millions of Audience</p>
                                </div>
                                <div class="ad-message-student" style="position: absolute; width: 100%; transition: all 0.6s ease; opacity: 0; transform: scale(0.8);">
                                    <div style="font-size: 1.8rem; margin-bottom: 0.5rem;">üìà</div>
                                    <p style="font-size: 1rem; font-weight: 600; color: var(--heading);">Grow Your Business</p>
                                </div>
                                <div class="ad-message-student" style="position: absolute; width: 100%; transition: all 0.6s ease; opacity: 0; transform: scale(0.8);">
                                    <div style="font-size: 1.8rem; margin-bottom: 0.5rem;">üöÄ</div>
                                    <p style="font-size: 1rem; font-weight: 600; color: var(--heading);">Reach Your Audience</p>
                                </div>
                                <div class="ad-message-student" style="position: absolute; width: 100%; transition: all 0.6s ease; opacity: 0; transform: scale(0.8);">
                                    <div style="font-size: 1.8rem; margin-bottom: 0.5rem;">üíº</div>
                                    <p style="font-size: 1rem; font-weight: 600; color: var(--heading);">Advertise With Us</p>
                                </div>
                            </div>
                            <div id="ad-ticker-student" style="position: absolute; bottom: 0; left: 0; right: 0; height: 22px; background: rgba(0,0,0,0.05); overflow: hidden;">
                                <div id="ad-ticker-content-student" style="position: absolute; white-space: nowrap; font-size: 0.7rem; color: var(--text-secondary); line-height: 22px;">
                                    <span style="padding: 0 2rem;">Reach millions of engaged learners</span>
                                    <span style="padding: 0 2rem;">Premium ad placements available</span>
                                    <span style="padding: 0 2rem;">Contact us to advertise</span>
                                    <span style="padding: 0 2rem;">Boost your brand visibility</span>
                                    <span style="padding: 0 2rem;">Reach millions of engaged learners</span>
                                    <span style="padding: 0 2rem;">Premium ad placements available</span>
                                </div>
                            </div>
                        </div>
                        <style>
                            @keyframes tickerScrollStudent { 0% { transform: translateX(0); } 100% { transform: translateX(-50%); } }
                            #ad-ticker-content-student { animation: tickerScrollStudent 20s linear infinite; }
                            .ad-message-student { visibility: hidden; }
                            .ad-message-student.active { opacity: 1 !important; transform: scale(1) !important; visibility: visible !important; }
                            .ad-message-student.fade-out { opacity: 0 !important; transform: scale(0.8) !important; visibility: visible !important; }
                        </style>
                        <script>
                            (function() {
                                const messages = document.querySelectorAll('#ad-message-container-student .ad-message-student');
                                let currentIndex = 0;
                                function rotateMessages() {
                                    const prevIndex = currentIndex;
                                    currentIndex = (currentIndex + 1) % messages.length;
                                    messages[prevIndex].classList.remove('active');
                                    messages[prevIndex].classList.add('fade-out');
                                    messages[currentIndex].classList.add('active');
                                    setTimeout(() => { messages[prevIndex].classList.remove('fade-out'); }, 600);
                                }
                                setInterval(rotateMessages, 10000);
                            })();
                        </script>
                    </div>
                    
                    <!-- Overall Progress Widget -->
                    <div class="widget-card">
                        <h3 class="text-lg font-semibold mb-4">üìä Overall Progress</h3>
                        <div class="text-center">
                            <!-- Simple Progress Circle -->
                            <div style="position: relative; width: 160px; height: 160px; margin: 0 auto 1rem;">
                                <svg width="160" height="160" style="transform: rotate(-90deg);">
                                    <!-- Background circle -->
                                    <circle cx="80" cy="80" r="70" fill="none" stroke="#e5e7eb" stroke-width="12">
                                    </circle>
                                    <!-- Progress circle -->
                                    <circle cx="80" cy="80" r="70" fill="none" stroke="url(#progressGradient)"
                                        stroke-width="12" stroke-dasharray="440" stroke-dashoffset="66"
                                        stroke-linecap="round"></circle>
                                    <!-- Gradient definition -->
                                    <defs>
                                        <linearGradient id="progressGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                                            <stop offset="0%" style="stop-color:#667eea;stop-opacity:1" />
                                            <stop offset="100%" style="stop-color:#764ba2;stop-opacity:1" />
                                        </linearGradient>
                                    </defs>
                                </svg>
                                <!-- Percentage text in center -->
                                <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);">
                                    <div
                                        style="font-size: 2.5rem; font-weight: 700; background: linear-gradient(135deg, #667eea, #764ba2); -webkit-background-clip: text; -webkit-text-fill-color: transparent;">
                                        85%</div>
                                    <div style="font-size: 0.875rem; color: #6b7280; margin-top: 0.25rem;">Complete
                                    </div>
                                </div>
                            </div>

                            <!-- Progress Stats -->
                            <div
                                style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 0.75rem; text-align: center;">
                                <div
                                    style="padding: 0.75rem; background: linear-gradient(135deg, rgba(102, 126, 234, 0.1), rgba(118, 75, 162, 0.05)); border-radius: 8px;">
                                    <div style="font-size: 1.5rem; font-weight: 700; color: #667eea;">6</div>
                                    <div style="font-size: 0.75rem; color: #6b7280;">Active Courses</div>
                                </div>
                                <div
                                    style="padding: 0.75rem; background: linear-gradient(135deg, rgba(16, 185, 129, 0.1), rgba(5, 150, 105, 0.05)); border-radius: 8px;">
                                    <div style="font-size: 1.5rem; font-weight: 700; color: #10b981;">+12%</div>
                                    <div style="font-size: 0.75rem; color: #6b7280;">Improvement Rate</div>
                                </div>
                                <div
                                    style="padding: 0.75rem; background: linear-gradient(135deg, rgba(245, 158, 11, 0.1), rgba(217, 119, 6, 0.05)); border-radius: 8px;">
                                    <div style="font-size: 1.5rem; font-weight: 700; color: #f59e0b;">3.8</div>
                                    <div style="font-size: 0.75rem; color: #6b7280;">GPA</div>
                                </div>
                                <div
                                    style="padding: 0.75rem; background: linear-gradient(135deg, rgba(139, 92, 246, 0.1), rgba(124, 58, 237, 0.05)); border-radius: 8px;">
                                    <div style="font-size: 1.5rem; font-weight: 700; color: #8b5cf6;">12</div>
                                    <div style="font-size: 0.75rem; color: #6b7280;">Overall rating</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Learning Streak Widget -->
                    <div class="widget-card">
                        <h3 class="text-lg font-semibold mb-4">üî• Learning Streak</h3>
                        <div class="text-center">
                            <div class="text-4xl font-bold text-orange-500">18</div>
                            <div class="text-sm text-gray-600">Consecutive Days</div>
                            <div class="mt-4 grid grid-cols-7 gap-1">
                                <span class="text-xs">üî•</span>
                                <span class="text-xs">üî•</span>
                                <span class="text-xs">üî•</span>
                                <span class="text-xs">üî•</span>
                                <span class="text-xs">üî•</span>
                                <span class="text-xs opacity-30">üî•</span>
                                <span class="text-xs opacity-30">üî•</span>
                            </div>
                            <div class="text-xs text-gray-500 mt-2">Great job! Keep learning!</div>
                        </div>
                    </div>

                    <!-- Today's Schedule Widget -->
                    <div class="widget-card">
                        <h3 class="text-lg font-semibold mb-4">üìÖ Today's Classes</h3>
                        <div class="space-y-3">
                            <div class="p-3 bg-blue-50 rounded-lg">
                                <div class="flex justify-between items-center mb-1">
                                    <span class="text-sm font-semibold">Mathematics</span>
                                    <span class="text-xs text-gray-600">10:00 AM</span>
                                </div>
                                <div class="text-xs text-gray-600">Dr. Abebe - Online</div>
                            </div>
                            <div class="p-3 bg-green-50 rounded-lg">
                                <div class="flex justify-between items-center mb-1">
                                    <span class="text-sm font-semibold">Physics</span>
                                    <span class="text-xs text-gray-600">2:00 PM</span>
                                </div>
                                <div class="text-xs text-gray-600">Prof. Sara - In-person</div>
                            </div>
                            <div class="p-3 bg-purple-50 rounded-lg">
                                <div class="flex justify-between items-center mb-1">
                                    <span class="text-sm font-semibold">Chemistry</span>
                                    <span class="text-xs text-gray-600">4:30 PM</span>
                                </div>
                                <div class="text-xs text-gray-600">Dr. Yohannes - Online</div>
                            </div>
                            <button
                                class="w-full mt-2 px-4 py-2 text-sm bg-blue-500 text-white rounded-lg hover:bg-blue-600">
                                View Full Schedule
                            </button>
                        </div>
                    </div>

                    <!-- Quick Stats Widget -->
                    <div class="widget-card">
                        <h3 class="text-lg font-semibold mb-4">üìä This Week</h3>
                        <div class="space-y-3">
                            <div class="flex justify-between items-center">
                                <span class="text-sm text-gray-600">Assignments Completed</span>
                                <span class="font-semibold text-green-600">12/15</span>
                            </div>
                            <div class="w-full bg-gray-200 rounded-full h-2">
                                <div class="bg-green-500 h-2 rounded-full" style="width: 80%"></div>
                            </div>

                            <div class="flex justify-between items-center">
                                <span class="text-sm text-gray-600">Study Hours</span>
                                <span class="font-semibold text-blue-600">18h</span>
                            </div>
                            <div class="w-full bg-gray-200 rounded-full h-2">
                                <div class="bg-blue-500 h-2 rounded-full" style="width: 72%"></div>
                            </div>

                            <div class="flex justify-between items-center">
                                <span class="text-sm text-gray-600">Class Attendance</span>
                                <span class="font-semibold text-purple-600">95%</span>
                            </div>
                            <div class="w-full bg-gray-200 rounded-full h-2">
                                <div class="bg-purple-500 h-2 rounded-full" style="width: 95%"></div>
                            </div>

                            <div class="flex justify-between items-center">
                                <span class="text-sm text-gray-600">Weekly Goal</span>
                                <span class="font-semibold text-orange-600">88%</span>
                            </div>
                            <div class="w-full bg-gray-200 rounded-full h-2">
                                <div class="bg-orange-500 h-2 rounded-full" style="width: 88%"></div>
                            </div>
                        </div>
                    </div>

                    <!-- Trending Tutors Widget -->
                    <div class="widget-card">
                        <h3 class="text-lg font-semibold mb-4">üî• Trending Tutors</h3>
                        <div class="space-y-3">
                            <div class="flex items-center gap-3 p-3 hover:bg-gray-50 rounded-lg transition-all">
                                <div class="w-12 h-12 rounded-full flex items-center justify-center text-white font-bold text-sm flex-shrink-0" style="background: linear-gradient(135deg, #3b82f6, #1d4ed8);">AT</div>
                                <div class="flex-1">
                                    <p class="font-semibold text-sm">Dr. Abebe Tadesse</p>
                                    <p class="text-xs text-gray-500">‚≠ê 4.9 ‚Ä¢ Mathematics</p>
                                </div>
                                <a href="../view-profiles/view-tutor.html"
                                    class="px-3 py-1 text-white text-xs font-semibold rounded transition-colors" style="background: var(--button-bg);">View</a>
                            </div>
                            <div class="flex items-center gap-3 p-3 hover:bg-gray-50 rounded-lg transition-all">
                                <div class="w-12 h-12 rounded-full flex items-center justify-center text-white font-bold text-sm flex-shrink-0" style="background: linear-gradient(135deg, #f59e0b, #d97706);">SA</div>
                                <div class="flex-1">
                                    <p class="font-semibold text-sm">Prof. Sara Alemayehu</p>
                                    <p class="text-xs text-gray-500">‚≠ê 4.8 ‚Ä¢ Physics</p>
                                </div>
                                <a href="../view-profiles/view-tutor.html"
                                    class="px-3 py-1 text-white text-xs font-semibold rounded transition-colors" style="background: var(--button-bg);">View</a>
                            </div>
                            <div class="flex items-center gap-3 p-3 hover:bg-gray-50 rounded-lg transition-all">
                                <div class="w-12 h-12 rounded-full flex items-center justify-center text-white font-bold text-sm flex-shrink-0" style="background: linear-gradient(135deg, #8b5cf6, #6d28d9);">MB</div>
                                <div class="flex-1">
                                    <p class="font-semibold text-sm">Dr. Mulugeta Bekele</p>
                                    <p class="text-xs text-gray-500">‚≠ê 4.7 ‚Ä¢ Chemistry</p>
                                </div>
                                <a href="../view-profiles/view-tutor.html"
                                    class="px-3 py-1 text-white text-xs font-semibold rounded transition-colors" style="background: var(--button-bg);">View</a>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
            <!-- End of flex gap-6 container -->

        </div>
        <!-- End of content-wrapper -->
        </main>

        <!-- Invite Parent Modal - loaded dynamically from common-modals -->

        <!-- Edit Profile Modal -->
        <div id="editProfileModal" class="modal hidden">
            <div class="modal-overlay" onclick="closeEditProfileModal()"></div>
            <div class="modal-content enhanced-modal" style="max-width: 900px; max-height: 90vh; overflow-y: auto;">
                <div class="modal-header">
                    <h2>‚úèÔ∏è Edit Profile</h2>
                    <button class="modal-close" onclick="closeEditProfileModal()">√ó</button>
                </div>
                <div class="modal-body" style="padding: 2rem;">
                    <form id="editProfileForm">

                        <!-- Hero Titles Section -->
                        <div class="form-section" style="margin-bottom: 2rem;">
                            <h3 style="color: var(--text-primary); margin-bottom: 1rem; font-size: 1.2rem; display: flex; align-items: center; gap: 0.5rem;">
                                <span>üéØ</span> Hero Titles
                            </h3>
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                                <div class="form-group">
                                    <label>Hero Titles (Multiple)</label>
                                    <div id="hero-titles-container" style="display: flex; flex-direction: column; gap: 0.5rem;">
                                        <input type="text" class="form-input hero-title-input" placeholder="Enter hero title (e.g., 'Future Engineer')" style="margin-bottom: 0.5rem;">
                                    </div>
                                    <button type="button" class="btn-secondary" onclick="addHeroTitle()" style="margin-top: 0.5rem; width: 100%;">
                                        + Add Another Title
                                    </button>
                                </div>

                                <div class="form-group">
                                    <label>Hero Subtitle</label>
                                    <input type="text" class="form-input" id="edit-hero-subtitle" placeholder="Enter hero subtitle (e.g., 'Passionate about Math & Science')">
                                </div>
                            </div>
                        </div>

                        <!-- Basic Information Section -->
                        <div class="form-section" style="margin-bottom: 2rem;">
                            <h3 style="color: var(--text-primary); margin-bottom: 1rem; font-size: 1.2rem; display: flex; align-items: center; gap: 0.5rem;">
                                <span>üë§</span> Basic Information
                            </h3>
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                                <div class="form-group">
                                    <label>Username</label>
                                    <input type="text" class="form-input" id="edit-username" placeholder="Enter username">
                                </div>
                                <div class="form-group">
                                    <label>Location</label>
                                    <input type="text" class="form-input" id="edit-location" placeholder="City, Country (e.g., Addis Ababa, Ethiopia)">

                                    <!-- Location Access Checkbox -->
                                    <div style="margin-top: 0.75rem;">
                                        <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer; font-size: 0.875rem; color: var(--text-secondary); margin: 0;">
                                            <input type="checkbox" id="allow-location-access" style="width: 16px; height: 16px; cursor: pointer;">
                                            <span>Allow location access</span>
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Academic Information Section -->
                        <div class="form-section" style="margin-bottom: 2rem;">
                            <h3 style="color: var(--text-primary); margin-bottom: 1rem; font-size: 1.2rem; display: flex; align-items: center; gap: 0.5rem;">
                                <span>üéì</span> Academic Information
                            </h3>
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                                <div class="form-group">
                                    <label>Currently Studying At</label>
                                    <input type="text" class="form-input" id="edit-studying-at" placeholder="School/Institution name">
                                </div>
                                <div class="form-group">
                                    <label>Grade Level</label>
                                    <select class="form-input" id="edit-grade-level">
                                        <option value="">Select grade level</option>
                                        <option value="KG">KG</option>
                                        <option value="Grade 1">Grade 1</option>
                                        <option value="Grade 2">Grade 2</option>
                                        <option value="Grade 3">Grade 3</option>
                                        <option value="Grade 4">Grade 4</option>
                                        <option value="Grade 5">Grade 5</option>
                                        <option value="Grade 6">Grade 6</option>
                                        <option value="Grade 7">Grade 7</option>
                                        <option value="Grade 8">Grade 8</option>
                                        <option value="Grade 9">Grade 9</option>
                                        <option value="Grade 10">Grade 10</option>
                                        <option value="Grade 11">Grade 11</option>
                                        <option value="Grade 12">Grade 12</option>
                                        <option value="University">University</option>
                                    </select>
                                </div>
                            </div>

                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                                <div class="form-group">
                                    <label>Interested In (Subjects - Multiple)</label>
                                    <div id="interested-in-container" style="display: flex; flex-direction: column; gap: 0.5rem;">
                                        <input type="text" class="form-input interested-in-input" placeholder="Enter subject (e.g., Mathematics)" style="margin-bottom: 0.5rem;">
                                    </div>
                                    <button type="button" class="btn-secondary" onclick="addInterestedIn()" style="margin-top: 0.5rem; width: 100%;">
                                        + Add Another Subject
                                    </button>
                                </div>

                                <div class="form-group">
                                    <label>Preferred Learning Method</label>
                                    <div style="display: flex; gap: 2rem; margin-top: 0.5rem;">
                                        <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                                            <input type="checkbox" id="learning-online" value="Online" style="width: 18px; height: 18px; cursor: pointer;">
                                            <span>Online</span>
                                        </label>
                                        <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                                            <input type="checkbox" id="learning-in-person" value="In-person" style="width: 18px; height: 18px; cursor: pointer;">
                                            <span>In-person</span>
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Learning Preferences Section -->
                        <div class="form-section" style="margin-bottom: 2rem;">
                            <h3 style="color: var(--text-primary); margin-bottom: 1rem; font-size: 1.2rem; display: flex; align-items: center; gap: 0.5rem;">
                                <span>üìö</span> Languages & Hobbies
                            </h3>
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                                <div class="form-group">
                                    <label>Languages (Multiple)</label>
                                    <div id="languages-container" style="display: flex; flex-direction: column; gap: 0.5rem;">
                                        <input type="text" class="form-input language-input" placeholder="Enter language (e.g., English, Amharic)" style="margin-bottom: 0.5rem;">
                                    </div>
                                    <button type="button" class="btn-secondary" onclick="addLanguage()" style="margin-top: 0.5rem; width: 100%;">
                                        + Add Another Language
                                    </button>
                                </div>

                                <div class="form-group">
                                    <label>Hobbies (Multiple)</label>
                                    <div id="hobbies-container" style="display: flex; flex-direction: column; gap: 0.5rem;">
                                        <input type="text" class="form-input hobby-input" placeholder="Enter hobby (e.g., Reading, Sports)" style="margin-bottom: 0.5rem;">
                                    </div>
                                    <button type="button" class="btn-secondary" onclick="addHobby()" style="margin-top: 0.5rem; width: 100%;">
                                        + Add Another Hobby
                                    </button>
                                </div>
                            </div>
                        </div>

                        <!-- Personal Information Section -->
                        <div class="form-section" style="margin-bottom: 2rem;">
                            <h3 style="color: var(--text-primary); margin-bottom: 1rem; font-size: 1.2rem; display: flex; align-items: center; gap: 0.5rem;">
                                <span>üé®</span> About Me & Goals
                            </h3>
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                                <div class="form-group">
                                    <label>About Me</label>
                                    <textarea class="form-textarea" id="edit-about" rows="4"
                                        placeholder="Tell us about yourself..."></textarea>
                                </div>

                                <div class="form-group">
                                    <label>Career Aspirations</label>
                                    <textarea class="form-textarea" id="edit-career-aspirations" rows="4"
                                        placeholder="What do you want to become? Your future goals..."></textarea>
                                </div>
                            </div>
                            <div style="display: grid; grid-template-columns: 1fr; gap: 1rem; margin-top: 1rem;">
                                <div class="form-group">
                                    <label>Favorite Quote</label>
                                    <textarea class="form-textarea" id="edit-quote" rows="2" placeholder="Enter a quote that inspires you"></textarea>
                                </div>
                            </div>
                        </div>

                    </form>
                </div>
                <div class="modal-footer" style="display: flex; gap: 1rem; justify-content: flex-end; padding: 1.5rem;">
                    <button class="btn-secondary" onclick="closeEditProfileModal()" style="padding: 0.75rem 2rem;">
                        Cancel
                    </button>
                    <button class="btn-primary" onclick="saveStudentProfile()" style="padding: 0.75rem 2rem;">
                        üíæ Save Changes
                    </button>
                </div>
            </div>
        </div>

        <!-- Cover Upload Modal -->
        <div class="upload-cover-modal" id="coverUploadModal" style="display: none;">
            <div class="modal-content">
                <div class="modal-inner">
                    <div class="modal-header">
                        <h2 class="modal-title">Upload Cover Photo</h2>
                        <button class="modal-close" onclick="closeCoverUploadModal()">&times;</button>
                    </div>

                    <div class="upload-area" id="coverUploadArea"
                        onclick="document.getElementById('coverInput').click()">
                        <span class="upload-icon">üì∑</span>
                        <p class="upload-text">Click to upload or drag and drop</p>
                        <p class="upload-hint">Recommended: 1920x400px (JPG, PNG, GIF)</p>
                        <input type="file" id="coverInput" class="upload-input" accept="image/*"
                            onchange="handleImageSelect(event, 'cover')">
                    </div>

                    <div class="preview-container" id="coverPreview" style="display: none;">
                        <img src="" alt="Cover preview" class="preview-image" id="coverPreviewImage">
                        <div class="preview-info">
                            <div class="file-info">
                                <span>File Name:</span>
                                <span id="coverFileName">-</span>
                            </div>
                            <div class="file-info">
                                <span>File Size:</span>
                                <span id="coverFileSize">-</span>
                            </div>
                            <div class="file-info">
                                <span>Dimensions:</span>
                                <span id="coverDimensions">-</span>
                            </div>
                        </div>
                    </div>

                    <div class="upload-progress" id="coverProgress" style="display: none;">
                        <div class="progress-bar">
                            <div class="progress-fill" id="coverProgressFill"></div>
                        </div>
                        <p class="progress-text" id="coverProgressText">Uploading... 0%</p>
                    </div>

                    <div class="upload-spinner" id="coverSpinner" style="display: none;"></div>

                    <div class="upload-actions">
                        <button class="btn-upload secondary" onclick="resetUpload('cover')">Change Image</button>
                        <button class="btn-upload primary" onclick="uploadImage('cover')">Upload Cover</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Profile Upload Modal -->
        <div class="upload-profile-modal" id="profileUploadModal" style="display: none;">
            <div class="modal-content">
                <div class="modal-inner">
                    <div class="modal-header">
                        <h2 class="modal-title">Upload Profile Picture</h2>
                        <button class="modal-close" onclick="closeProfileUploadModal()">&times;</button>
                    </div>

                    <div class="upload-area" id="profileUploadArea"
                        onclick="document.getElementById('profileInput').click()">
                        <span class="upload-icon">üë§</span>
                        <p class="upload-text">Click to upload or drag and drop</p>
                        <p class="upload-hint">Recommended: 500x500px (JPG, PNG, GIF)</p>
                        <input type="file" id="profileInput" class="upload-input" accept="image/*"
                            onchange="handleImageSelect(event, 'profile')">
                    </div>

                    <div class="preview-container" id="profilePreview" style="display: none;">
                        <img src="" alt="Profile preview" class="preview-image" id="profilePreviewImage">
                        <div class="preview-info">
                            <div class="file-info">
                                <span>File Name:</span>
                                <span id="profileFileName">-</span>
                            </div>
                            <div class="file-info">
                                <span>File Size:</span>
                                <span id="profileFileSize">-</span>
                            </div>
                            <div class="file-info">
                                <span>Dimensions:</span>
                                <span id="profileDimensions">-</span>
                            </div>
                        </div>
                    </div>

                    <div class="upload-progress" id="profileProgress" style="display: none;">
                        <div class="progress-bar">
                            <div class="progress-fill" id="profileProgressFill"></div>
                        </div>
                        <p class="progress-text" id="profileProgressText">Uploading... 0%</p>
                    </div>

                    <div class="upload-spinner" id="profileSpinner" style="display: none;"></div>

                    <div class="upload-actions">
                        <button class="btn-upload secondary" onclick="resetUpload('profile')">Change Image</button>
                        <button class="btn-upload primary" onclick="uploadImage('profile')">Upload Profile</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Upload Credential Modal -->
        <div id="upload-credential-modal" class="modal hidden">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 class="modal-title">üì§ Upload Credential</h3>
                    <button class="modal-close" onclick="window.closeUploadCredentialModal && window.closeUploadCredentialModal()">√ó</button>
                </div>

                <form id="uploadCredentialForm" onsubmit="window.handleCredentialUpload && window.handleCredentialUpload(event)">
                    <div class="modal-body space-y-4">
                        <!-- Credential Type -->
                        <div class="form-group">
                            <label for="credentialType" class="form-label">Credential Type<span class="text-red-500">*</span></label>
                            <select id="credentialType" name="credentialType" class="form-input" required>
                                <option value="">Select credential type...</option>
                                <option value="achievement">Achievement</option>
                                <option value="academic_certificate">Academic Certificate</option>
                                <option value="extracurricular">Extracurricular Activity</option>
                            </select>
                        </div>

                        <!-- Credential Title -->
                        <div class="form-group">
                            <label for="credentialTitle" class="form-label">Credential Title<span class="text-red-500">*</span></label>
                            <input type="text" id="credentialTitle" name="credentialTitle" class="form-input"
                                   placeholder="e.g., Honor Roll Certificate" required>
                        </div>

                        <!-- Description -->
                        <div class="form-group">
                            <label for="credentialDescription" class="form-label">Description</label>
                            <textarea id="credentialDescription" name="credentialDescription" class="form-input"
                                      rows="3" placeholder="Brief description of the credential..."></textarea>
                        </div>

                        <!-- Issued By -->
                        <div class="form-group">
                            <label for="issuedBy" class="form-label">Issued By / Organization</label>
                            <input type="text" id="issuedBy" name="issuedBy" class="form-input"
                                   placeholder="e.g., Coursera, School, Organization">
                        </div>

                        <!-- Date of Issue -->
                        <div class="form-group">
                            <label for="credentialDate" class="form-label">Date of Issue</label>
                            <input type="date" id="credentialDate" name="credentialDate" class="form-input">
                        </div>

                        <!-- Expiry Date (Optional) -->
                        <div class="form-group">
                            <label for="expiryDate" class="form-label">Expiry Date (Optional)</label>
                            <input type="date" id="expiryDate" name="expiryDate" class="form-input">
                        </div>

                        <!-- File Upload -->
                        <div class="form-group">
                            <label for="credentialFile" class="form-label">Upload File<span class="text-red-500">*</span></label>
                            <input type="file" id="credentialFile" name="credentialFile" class="form-input"
                                   accept=".pdf,.jpg,.jpeg,.png,.doc,.docx" required>
                            <p class="text-sm text-gray-500 mt-1">Accepted formats: PDF, JPG, PNG, DOC, DOCX (Max 10MB)</p>
                        </div>

                        <!-- Featured Toggle -->
                        <div class="form-group">
                            <label class="form-label">Featured Credential</label>
                            <div style="display: flex; align-items: center; gap: 12px;">
                                <label class="toggle-switch">
                                    <input type="checkbox" id="isFeaturedToggle" name="isFeatured">
                                    <span class="toggle-slider"></span>
                                </label>
                                <span id="featuredStatusText" style="font-size: 14px; color: var(--text-secondary);">Not Featured</span>
                            </div>
                            <p class="text-sm text-gray-500 mt-1">Featured credentials appear prominently on your profile</p>
                        </div>
                    </div>

                    <div class="modal-footer">
                        <button type="button" class="btn-secondary" onclick="window.closeUploadCredentialModal && window.closeUploadCredentialModal()">Cancel</button>
                        <button type="submit" class="btn-primary">
                            <i class="fas fa-upload"></i> Upload Credential
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Coming Soon Modal -->
        <div id="coming-soon-modal" class="modal hidden">
            <div class="modal-content enhanced coming-soon-content">
                <button class="modal-close-enhanced" onclick="closeModal('coming-soon-modal')">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12">
                        </path>
                    </svg>
                </button>

                <div class="coming-soon-header">
                    <div class="coming-soon-icon">
                        <svg class="w-16 h-16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z">
                            </path>
                        </svg>
                    </div>
                    <h3 class="modal-title">Coming Soon!</h3>
                    <p class="modal-subtitle" id="coming-soon-message">We're working hard to bring you this feature.
                        Stay tuned!</p>
                </div>
            </div>
        </div>

        <!-- Toast Notification Container -->
        <div id="toast-container" class="toast-container"></div>

        <!-- Ad Analytics Modal -->
        <div class="modal hidden" id="adAnalyticsModal">
            <div class="modal-overlay" onclick="closeAdAnalyticsModal()"></div>
            <div class="modal-content ad-analytics-modal">
                <div class="modal-header">
                    <h2>Advertisement Analytics</h2>
                    <button class="modal-close" onclick="closeAdAnalyticsModal()">√ó</button>
                </div>
                <div class="modal-body">
                    <p>Premium advertising opportunities available. Contact us to learn more about promoting your
                        content on Astegni.</p>
                </div>
            </div>
        </div>

        <!-- Folder Modal (View Folder Contents) -->
        <div id="folder-modal" class="fixed inset-0 bg-black/50 hidden z-50 flex items-center justify-center p-4">
            <div class="bg-white rounded-2xl w-full max-w-2xl max-h-[80vh] overflow-hidden shadow-2xl">
                <div class="flex items-center justify-between p-4 border-b bg-gradient-to-r from-purple-600 to-blue-600">
                    <div class="flex items-center gap-3">
                        <span id="folder-modal-icon" class="text-3xl">üìÅ</span>
                        <div>
                            <h2 id="folder-modal-title" class="text-xl font-bold text-white">Folder Name</h2>
                            <p id="folder-modal-count" class="text-sm text-white/80">0 items</p>
                        </div>
                    </div>
                    <button onclick="closeFolderModal()" class="p-2 hover:bg-white/20 rounded-lg transition-colors">
                        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                        </svg>
                    </button>
                </div>
                <div class="p-4 overflow-y-auto max-h-[60vh]">
                    <div id="folder-modal-content" class="grid grid-cols-2 sm:grid-cols-3 gap-4">
                        <!-- Folder contents will be rendered here -->
                    </div>
                    <div id="folder-empty-state" class="hidden text-center py-8">
                        <div class="text-5xl mb-3">üì≠</div>
                        <p class="text-gray-500">This folder is empty</p>
                        <button onclick="closeFolderModal(); openUploadStudentDocModal();" class="mt-4 px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors">
                            Add Documents
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Create/Edit Folder Modal -->
        <div id="create-folder-modal" class="fixed inset-0 bg-black/50 hidden z-50 flex items-center justify-center p-4">
            <div class="bg-white rounded-2xl w-full max-w-md overflow-hidden shadow-2xl">
                <div class="p-4 border-b bg-gradient-to-r from-green-500 to-teal-500">
                    <h2 id="create-folder-title" class="text-xl font-bold text-white">Create New Folder</h2>
                </div>
                <form id="folder-form" class="p-6" onsubmit="event.preventDefault(); saveFolder();">
                    <input type="hidden" id="edit-folder-id" value="">
                    <div class="mb-4">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Folder Name</label>
                        <input type="text" id="folder-name-input" required placeholder="Enter folder name"
                            class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent">
                    </div>
                    <div class="mb-4">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Icon</label>
                        <div id="folder-icon-grid" class="grid grid-cols-8 gap-2">
                            <button type="button" onclick="selectFolderIcon('üìÅ')" class="folder-icon-btn p-2 rounded hover:bg-gray-100 text-xl border-2 border-transparent active" data-icon="üìÅ">üìÅ</button>
                            <button type="button" onclick="selectFolderIcon('üìÇ')" class="folder-icon-btn p-2 rounded hover:bg-gray-100 text-xl border-2 border-transparent" data-icon="üìÇ">üìÇ</button>
                            <button type="button" onclick="selectFolderIcon('üìö')" class="folder-icon-btn p-2 rounded hover:bg-gray-100 text-xl border-2 border-transparent" data-icon="üìö">üìö</button>
                            <button type="button" onclick="selectFolderIcon('üìñ')" class="folder-icon-btn p-2 rounded hover:bg-gray-100 text-xl border-2 border-transparent" data-icon="üìñ">üìñ</button>
                            <button type="button" onclick="selectFolderIcon('üéì')" class="folder-icon-btn p-2 rounded hover:bg-gray-100 text-xl border-2 border-transparent" data-icon="üéì">üéì</button>
                            <button type="button" onclick="selectFolderIcon('üíº')" class="folder-icon-btn p-2 rounded hover:bg-gray-100 text-xl border-2 border-transparent" data-icon="üíº">üíº</button>
                            <button type="button" onclick="selectFolderIcon('üî¨')" class="folder-icon-btn p-2 rounded hover:bg-gray-100 text-xl border-2 border-transparent" data-icon="üî¨">üî¨</button>
                            <button type="button" onclick="selectFolderIcon('üé®')" class="folder-icon-btn p-2 rounded hover:bg-gray-100 text-xl border-2 border-transparent" data-icon="üé®">üé®</button>
                            <button type="button" onclick="selectFolderIcon('üèÜ')" class="folder-icon-btn p-2 rounded hover:bg-gray-100 text-xl border-2 border-transparent" data-icon="üèÜ">üèÜ</button>
                            <button type="button" onclick="selectFolderIcon('‚≠ê')" class="folder-icon-btn p-2 rounded hover:bg-gray-100 text-xl border-2 border-transparent" data-icon="‚≠ê">‚≠ê</button>
                            <button type="button" onclick="selectFolderIcon('üìù')" class="folder-icon-btn p-2 rounded hover:bg-gray-100 text-xl border-2 border-transparent" data-icon="üìù">üìù</button>
                            <button type="button" onclick="selectFolderIcon('üìã')" class="folder-icon-btn p-2 rounded hover:bg-gray-100 text-xl border-2 border-transparent" data-icon="üìã">üìã</button>
                            <button type="button" onclick="selectFolderIcon('üóÇÔ∏è')" class="folder-icon-btn p-2 rounded hover:bg-gray-100 text-xl border-2 border-transparent" data-icon="üóÇÔ∏è">üóÇÔ∏è</button>
                            <button type="button" onclick="selectFolderIcon('üí°')" class="folder-icon-btn p-2 rounded hover:bg-gray-100 text-xl border-2 border-transparent" data-icon="üí°">üí°</button>
                            <button type="button" onclick="selectFolderIcon('üéØ')" class="folder-icon-btn p-2 rounded hover:bg-gray-100 text-xl border-2 border-transparent" data-icon="üéØ">üéØ</button>
                            <button type="button" onclick="selectFolderIcon('üåü')" class="folder-icon-btn p-2 rounded hover:bg-gray-100 text-xl border-2 border-transparent" data-icon="üåü">üåü</button>
                        </div>
                        <input type="hidden" id="selected-folder-icon" value="üìÅ">
                    </div>
                    <div class="mb-6">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Color</label>
                        <div id="folder-color-selector" class="flex gap-2">
                            <button type="button" onclick="selectFolderColor('purple')" class="folder-color-btn w-8 h-8 rounded-full border-2 border-transparent hover:scale-110 transition active ring-2 ring-offset-2 ring-gray-400" style="background-color: #8B5CF6;" data-color="purple"></button>
                            <button type="button" onclick="selectFolderColor('blue')" class="folder-color-btn w-8 h-8 rounded-full border-2 border-transparent hover:scale-110 transition" style="background-color: #3B82F6;" data-color="blue"></button>
                            <button type="button" onclick="selectFolderColor('green')" class="folder-color-btn w-8 h-8 rounded-full border-2 border-transparent hover:scale-110 transition" style="background-color: #10B981;" data-color="green"></button>
                            <button type="button" onclick="selectFolderColor('yellow')" class="folder-color-btn w-8 h-8 rounded-full border-2 border-transparent hover:scale-110 transition" style="background-color: #F59E0B;" data-color="yellow"></button>
                            <button type="button" onclick="selectFolderColor('red')" class="folder-color-btn w-8 h-8 rounded-full border-2 border-transparent hover:scale-110 transition" style="background-color: #EF4444;" data-color="red"></button>
                            <button type="button" onclick="selectFolderColor('pink')" class="folder-color-btn w-8 h-8 rounded-full border-2 border-transparent hover:scale-110 transition" style="background-color: #EC4899;" data-color="pink"></button>
                            <button type="button" onclick="selectFolderColor('gray')" class="folder-color-btn w-8 h-8 rounded-full border-2 border-transparent hover:scale-110 transition" style="background-color: #6B7280;" data-color="gray"></button>
                        </div>
                        <input type="hidden" id="selected-folder-color" value="purple">
                    </div>
                    <div class="flex gap-3">
                        <button type="button" onclick="closeCreateFolderModal()" class="flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors">Cancel</button>
                        <button type="submit" class="flex-1 px-4 py-2 bg-gradient-to-r from-green-500 to-teal-500 text-white rounded-lg hover:opacity-90 transition-opacity">Save Folder</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Folder Context Menu -->
        <div id="folder-context-menu" class="fixed hidden bg-white rounded-lg shadow-xl border z-[100] min-w-[180px] py-2">
            <button onclick="renameFolderAction()" class="w-full px-4 py-2 text-left hover:bg-gray-100 flex items-center gap-2 text-gray-700">
                <span>‚úèÔ∏è</span> Rename
            </button>
            <button onclick="changeFolderIconAction()" class="w-full px-4 py-2 text-left hover:bg-gray-100 flex items-center gap-2 text-gray-700">
                <span>üé®</span> Change Icon
            </button>
            <div class="border-t my-1"></div>
            <button onclick="zipFolderAction()" class="w-full px-4 py-2 text-left hover:bg-gray-100 flex items-center gap-2 text-gray-700">
                <span>üì¶</span> Zip Folder
            </button>
            <button onclick="mergeFolderAction()" class="w-full px-4 py-2 text-left hover:bg-gray-100 flex items-center gap-2 text-gray-700">
                <span>üîó</span> Merge With...
            </button>
            <div class="border-t my-1"></div>
            <button onclick="cutFolderAction()" class="w-full px-4 py-2 text-left hover:bg-gray-100 flex items-center gap-2 text-gray-700">
                <span>‚úÇÔ∏è</span> Cut
            </button>
            <button onclick="copyFolderAction()" class="w-full px-4 py-2 text-left hover:bg-gray-100 flex items-center gap-2 text-gray-700">
                <span>üìã</span> Copy
            </button>
            <div class="border-t my-1"></div>
            <button onclick="deleteFolderAction()" class="w-full px-4 py-2 text-left hover:bg-red-50 flex items-center gap-2 text-red-600">
                <span>üóëÔ∏è</span> Delete
            </button>
        </div>

        <!-- Merge Folder Modal -->
        <div id="merge-folder-modal" class="fixed inset-0 bg-black/50 hidden z-50 flex items-center justify-center p-4">
            <div class="bg-white rounded-2xl w-full max-w-md overflow-hidden shadow-2xl">
                <div class="p-4 border-b bg-gradient-to-r from-blue-500 to-indigo-500">
                    <h2 class="text-xl font-bold text-white">Merge Folders</h2>
                    <p class="text-sm text-white/80">Select a folder to merge with "<span id="merge-source-folder"></span>"</p>
                </div>
                <div class="p-4 max-h-[50vh] overflow-y-auto">
                    <div id="merge-folder-list" class="space-y-2">
                        <!-- Target folders will be listed here -->
                    </div>
                </div>
                <div class="p-4 border-t flex gap-3">
                    <button onclick="closeMergeFolderModal()" class="flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors">Cancel</button>
                    <button onclick="confirmMergeFolder()" class="flex-1 px-4 py-2 bg-gradient-to-r from-blue-500 to-indigo-500 text-white rounded-lg hover:opacity-90 transition-opacity">Merge</button>
                </div>
            </div>
        </div>

        </div>
        <!-- End of container mx-auto px-4 -->
    </section>

    <!-- Bottom Widgets Section -->
    <section class="bottom-widgets" style="margin-top: 3rem; margin-bottom: 3rem;">
        <div class="container mx-auto px-4">
            <div class="bottom-widgets-grid"
                style="display: grid; grid-template-columns: repeat(auto-fit, minmax(320px, 1fr)); gap: 1.5rem;">

                <!-- News Widget -->
                <div class="sidebar-widget news-widget card" onclick="openComingSoonModal('news')"
                    style="cursor: pointer; padding: 1.5rem; background: var(--card-bg); border-radius: 16px; transition: transform 0.3s ease, box-shadow 0.3s ease;"
                    onmouseover="this.style.transform='translateY(-4px)'; this.style.boxShadow='0 8px 16px rgba(0,0,0,0.1)'"
                    onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='none'">
                    <div class="widget-header"
                        style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                        <h3 style="font-size: 1.25rem; font-weight: 600; margin: 0;">üì∞ Latest News</h3>
                        <a href="#" onclick="openComingSoonModal('news'); return false;"
                            style="color: var(--button-bg); text-decoration: none; font-size: 0.875rem;">View All</a>
                    </div>

                    <div class="news-carousel" style="position: relative; overflow: hidden;">
                        <div class="news-card-container" id="newsCardContainer">
                            <div class="news-card active" data-news-index="0"
                                style="opacity: 1; transition: opacity 0.5s ease;">
                                <div class="news-card-header"
                                    style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.75rem;">
                                    <span class="news-category-badge"
                                        style="background: linear-gradient(135deg, #667eea, #764ba2); color: white; padding: 0.25rem 0.75rem; border-radius: 12px; font-size: 0.75rem; font-weight: 600;">Education</span>
                                    <span class="news-time" style="color: var(--text-muted); font-size: 0.875rem;">2h
                                        ago</span>
                                </div>
                                <div class="news-card-image" style="margin-bottom: 1rem;">
                                    <img src="https://images.unsplash.com/photo-1427504494785-3a9ca7044f45?w=400"
                                        alt="Education News"
                                        style="width: 100%; height: 200px; object-fit: cover; border-radius: 8px;">
                                </div>
                                <div class="news-card-content">
                                    <h4
                                        style="font-size: 1.125rem; font-weight: 600; margin-bottom: 0.5rem; color: var(--heading);">
                                        New Education Reforms Transform Ethiopian Schools</h4>
                                    <p
                                        style="color: var(--text); opacity: 0.8; font-size: 0.875rem; line-height: 1.6; margin-bottom: 1rem;">
                                        Latest educational initiatives are revolutionizing how students learn across
                                        Ethiopia...</p>
                                    <div class="news-stats" style="display: flex; gap: 1rem; flex-wrap: wrap;">
                                        <span class="news-stat"
                                            style="display: flex; align-items: center; gap: 0.25rem; font-size: 0.875rem; color: var(--text-muted);">üî•
                                            Trending</span>
                                        <span class="news-stat"
                                            style="display: flex; align-items: center; gap: 0.25rem; font-size: 0.875rem; color: var(--text-muted);">üëÅÔ∏è
                                            1.2k views</span>
                                        <span class="news-stat"
                                            style="display: flex; align-items: center; gap: 0.25rem; font-size: 0.875rem; color: var(--text-muted);">üí¨
                                            45 comments</span>
                                    </div>
                                </div>
                            </div>
                            <div class="news-card" data-news-index="1"
                                style="display: none; opacity: 0; transition: opacity 0.5s ease;">
                                <div class="news-card-header"
                                    style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.75rem;">
                                    <span class="news-category-badge"
                                        style="background: linear-gradient(135deg, #f093fb, #f5576c); color: white; padding: 0.25rem 0.75rem; border-radius: 12px; font-size: 0.75rem; font-weight: 600;">Technology</span>
                                    <span class="news-time" style="color: var(--text-muted); font-size: 0.875rem;">5h
                                        ago</span>
                                </div>
                                <div class="news-card-image" style="margin-bottom: 1rem;">
                                    <img src="https://images.unsplash.com/photo-1488590528505-98d2b5aba04b?w=400"
                                        alt="Tech News"
                                        style="width: 100%; height: 200px; object-fit: cover; border-radius: 8px;">
                                </div>
                                <div class="news-card-content">
                                    <h4
                                        style="font-size: 1.125rem; font-weight: 600; margin-bottom: 0.5rem; color: var(--heading);">
                                        Digital Learning Platforms Surge in Popularity</h4>
                                    <p
                                        style="color: var(--text); opacity: 0.8; font-size: 0.875rem; line-height: 1.6; margin-bottom: 1rem;">
                                        Ethiopian students embrace online education tools for enhanced learning
                                        experiences...</p>
                                    <div class="news-stats" style="display: flex; gap: 1rem; flex-wrap: wrap;">
                                        <span class="news-stat"
                                            style="display: flex; align-items: center; gap: 0.25rem; font-size: 0.875rem; color: var(--text-muted);">üí°
                                            Innovation</span>
                                        <span class="news-stat"
                                            style="display: flex; align-items: center; gap: 0.25rem; font-size: 0.875rem; color: var(--text-muted);">üëÅÔ∏è
                                            890 views</span>
                                        <span class="news-stat"
                                            style="display: flex; align-items: center; gap: 0.25rem; font-size: 0.875rem; color: var(--text-muted);">üí¨
                                            32 comments</span>
                                    </div>
                                </div>
                            </div>
                            <div class="news-card" data-news-index="2"
                                style="display: none; opacity: 0; transition: opacity 0.5s ease;">
                                <div class="news-card-header"
                                    style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.75rem;">
                                    <span class="news-category-badge"
                                        style="background: linear-gradient(135deg, #4facfe, #00f2fe); color: white; padding: 0.25rem 0.75rem; border-radius: 12px; font-size: 0.75rem; font-weight: 600;">Study
                                        Tips</span>
                                    <span class="news-time" style="color: var(--text-muted); font-size: 0.875rem;">1d
                                        ago</span>
                                </div>
                                <div class="news-card-image" style="margin-bottom: 1rem;">
                                    <img src="https://images.unsplash.com/photo-1522202176988-66273c2fd55f?w=400"
                                        alt="Study Tips"
                                        style="width: 100%; height: 200px; object-fit: cover; border-radius: 8px;">
                                </div>
                                <div class="news-card-content">
                                    <h4
                                        style="font-size: 1.125rem; font-weight: 600; margin-bottom: 0.5rem; color: var(--heading);">
                                        Top Study Techniques Every Student Should Know</h4>
                                    <p
                                        style="color: var(--text); opacity: 0.8; font-size: 0.875rem; line-height: 1.6; margin-bottom: 1rem;">
                                        Evidence-based study methods to boost your academic performance and retention...
                                    </p>
                                    <div class="news-stats" style="display: flex; gap: 1rem; flex-wrap: wrap;">
                                        <span class="news-stat"
                                            style="display: flex; align-items: center; gap: 0.25rem; font-size: 0.875rem; color: var(--text-muted);">üìö
                                            Featured</span>
                                        <span class="news-stat"
                                            style="display: flex; align-items: center; gap: 0.25rem; font-size: 0.875rem; color: var(--text-muted);">üëÅÔ∏è
                                            2.1k views</span>
                                        <span class="news-stat"
                                            style="display: flex; align-items: center; gap: 0.25rem; font-size: 0.875rem; color: var(--text-muted);">üí¨
                                            67 comments</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Bookstore Widget -->
                <div class="sidebar-widget bookstore-widget card" onclick="openComingSoonModal('store')"
                    style="cursor: pointer; padding: 1.5rem; background: var(--card-bg); border-radius: 16px; transition: transform 0.3s ease, box-shadow 0.3s ease;"
                    onmouseover="this.style.transform='translateY(-4px)'; this.style.boxShadow='0 8px 16px rgba(0,0,0,0.1)'"
                    onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='none'">
                    <div class="widget-header"
                        style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                        <h3 style="font-size: 1.25rem; font-weight: 600; margin: 0; color: var(--heading);">üìö Bookstore
                        </h3>
                        <span
                            style="background: var(--button-bg); color: white; padding: 0.5rem 0.75rem; border-radius: 8px; font-size: 0.75rem; font-weight: 600;">Coming
                            Soon</span>
                    </div>

                    <!-- Bookstore Content -->
                    <div class="bookstore-content">
                        <div class="bookstore-main" style="text-align: center; margin-bottom: 1.5rem;">
                            <div class="bookstore-icon" style="font-size: 4rem; margin-bottom: 0.5rem;">üìñ</div>
                            <div class="bookstore-title-animated"
                                style="position: relative; height: 2.5rem; overflow: hidden;">
                                <div class="bookstore-title"
                                    style="font-size: 1.5rem; font-weight: bold; margin-bottom: 0.5rem; color: var(--heading); position: absolute; width: 100%; opacity: 1; transition: opacity 0.6s ease, transform 0.6s ease;">
                                    Educational Books</div>
                            </div>
                            <div class="bookstore-subtitle" style="font-size: 1rem; color: var(--text);">Buy, Sell &
                                Rent Textbooks</div>
                        </div>
                        <div class="bookstore-features"
                            style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 1rem;">
                            <div class="feature-item"
                                style="background: var(--highlight-bg); padding: 0.75rem; border-radius: 8px; text-align: center;">
                                <span style="display: block; font-size: 1.5rem; margin-bottom: 0.25rem;">üìó</span>
                                <span style="display: block; font-size: 0.875rem; color: var(--text);">New Books</span>
                            </div>
                            <div class="feature-item"
                                style="background: var(--highlight-bg); padding: 0.75rem; border-radius: 8px; text-align: center;">
                                <span style="display: block; font-size: 1.5rem; margin-bottom: 0.25rem;">üìò</span>
                                <span style="display: block; font-size: 0.875rem; color: var(--text);">Used Books</span>
                            </div>
                            <div class="feature-item"
                                style="background: var(--highlight-bg); padding: 0.75rem; border-radius: 8px; text-align: center;">
                                <span style="display: block; font-size: 1.5rem; margin-bottom: 0.25rem;">üí∞</span>
                                <span style="display: block; font-size: 0.875rem; color: var(--text);">Best
                                    Prices</span>
                            </div>
                            <div class="feature-item"
                                style="background: var(--highlight-bg); padding: 0.75rem; border-radius: 8px; text-align: center;">
                                <span style="display: block; font-size: 1.5rem; margin-bottom: 0.25rem;">üöö</span>
                                <span style="display: block; font-size: 0.875rem; color: var(--text);">Fast
                                    Delivery</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Gamestore Widget -->
                <div class="sidebar-widget gamestore-widget card" onclick="openComingSoonModal('gamestore')"
                    style="cursor: pointer; padding: 1.5rem; background: var(--card-bg); border-radius: 16px; transition: transform 0.3s ease, box-shadow 0.3s ease;"
                    onmouseover="this.style.transform='translateY(-4px)'; this.style.boxShadow='0 8px 16px rgba(0,0,0,0.1)'"
                    onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='none'">
                    <div class="widget-header"
                        style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                        <h3 style="font-size: 1.25rem; font-weight: 600; margin: 0; color: var(--heading);">üéÆ Gamestore
                        </h3>
                        <span
                            style="background: var(--button-bg); color: white; padding: 0.5rem 0.75rem; border-radius: 8px; font-size: 0.75rem; font-weight: 600;">Coming
                            Soon</span>
                    </div>
                    <div class="gamestore-content">
                        <div class="gamestore-main" style="text-align: center; margin-bottom: 1.5rem;">
                            <div class="gamestore-icon" style="font-size: 4rem; margin-bottom: 0.5rem;">üéÆ</div>
                            <div class="gamestore-title-animated"
                                style="position: relative; height: 2.5rem; overflow: hidden;">
                                <div class="gamestore-title"
                                    style="font-size: 1.5rem; font-weight: bold; margin-bottom: 0.5rem; color: var(--heading); position: absolute; width: 100%; opacity: 1; transition: opacity 0.6s ease, transform 0.6s ease;">
                                    Educational Games</div>
                            </div>
                            <div class="gamestore-subtitle" style="font-size: 1rem; color: var(--text);">Learn While
                                Playing</div>
                        </div>
                        <div class="gamestore-features"
                            style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 1rem;">
                            <div class="feature-item"
                                style="background: var(--highlight-bg); padding: 0.75rem; border-radius: 8px; text-align: center;">
                                <span style="display: block; font-size: 1.5rem; margin-bottom: 0.25rem;">üßÆ</span>
                                <span style="display: block; font-size: 0.875rem; color: var(--text);">Puzzle
                                    Games</span>
                            </div>
                            <div class="feature-item"
                                style="background: var(--highlight-bg); padding: 0.75rem; border-radius: 8px; text-align: center;">
                                <span style="display: block; font-size: 1.5rem; margin-bottom: 0.25rem;">üéØ</span>
                                <span style="display: block; font-size: 0.875rem; color: var(--text);">Strategy
                                    Games</span>
                            </div>
                            <div class="feature-item"
                                style="background: var(--highlight-bg); padding: 0.75rem; border-radius: 8px; text-align: center;">
                                <span style="display: block; font-size: 1.5rem; margin-bottom: 0.25rem;">üèÜ</span>
                                <span style="display: block; font-size: 0.875rem; color: var(--text);">Top Rated</span>
                            </div>
                            <div class="feature-item"
                                style="background: var(--highlight-bg); padding: 0.75rem; border-radius: 8px; text-align: center;">
                                <span style="display: block; font-size: 1.5rem; margin-bottom: 0.25rem;">üéÅ</span>
                                <span style="display: block; font-size: 0.875rem; color: var(--text);">Free to
                                    Play</span>
                            </div>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </section>

    <!-- ============================================ -->
    <!-- EDIT PROFILE MODAL -->
    <!-- ============================================ -->
    <div id="edit-profile-modal" class="modal hidden">
        <div class="modal-overlay" onclick="closeEditProfileModal()"></div>
        <div class="modal-content enhanced-modal">
            <div class="modal-header">
                <h2>Edit Profile</h2>
                <button class="modal-close" onclick="closeEditProfileModal()">√ó</button>
            </div>
            <div class="modal-body">
                <form id="editStudentProfileForm">
                    <div class="form-row">
                        <div class="form-group">
                            <label>First Name *</label>
                            <input type="text" id="editFirstName" class="form-input" required>
                        </div>
                        <div class="form-group">
                            <label>Father Name *</label>
                            <input type="text" id="editFatherName" class="form-input" required>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>Grand Father Name *</label>
                        <input type="text" id="editGrandFatherName" class="form-input" required>
                    </div>

                    <div class="form-group">
                        <label>Username *</label>
                        <input type="text" id="editUsername" class="form-input" required>
                    </div>

                    <div class="form-group">
                        <label>Gender</label>
                        <select id="editGender" class="form-select">
                            <option value="">Select Gender</option>
                            <option value="male">Male</option>
                            <option value="female">Female</option>
                        </select>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label>Email</label>
                            <input type="email" id="editEmail" class="form-input" placeholder="your.email@example.com">
                        </div>
                        <div class="form-group">
                            <label>Phone Number</label>
                            <input type="tel" id="editPhone" class="form-input" placeholder="+251 912 345 678">
                        </div>
                    </div>

                    <div class="form-group">
                        <label>Grade Level</label>
                        <input type="text" id="editGradeLevel" class="form-input" placeholder="e.g., Grade 12">
                    </div>

                    <div class="form-group">
                        <label>Subjects (comma-separated)</label>
                        <input type="text" id="editSubjects" class="form-input"
                            placeholder="e.g., Math, Physics, Chemistry">
                        <small class="form-hint">Separate multiple subjects with commas</small>
                    </div>

                    <div class="form-group">
                        <label>Preferred Languages (comma-separated)</label>
                        <input type="text" id="editLanguages" class="form-input" placeholder="e.g., English, Amharic">
                        <small class="form-hint">Languages you prefer to study in</small>
                    </div>

                    <div class="form-group">
                        <label>Location</label>
                        <input type="text" id="editLocation" class="form-input" placeholder="e.g., Addis Ababa">
                    </div>

                    <div class="form-group">
                        <label>About Me</label>
                        <textarea id="editBio" class="form-input" rows="4"
                            placeholder="Tell us about yourself..."></textarea>
                    </div>

                    <div class="form-group">
                        <label>Favorite Quote</label>
                        <input type="text" id="editQuote" class="form-input" placeholder="Your motivational quote">
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn-secondary" onclick="closeEditProfileModal()">Cancel</button>
                <button class="btn-primary" onclick="saveStudentProfile()">Save Changes</button>
            </div>
        </div>
    </div>

    <!-- Enhanced Footer -->
    <footer class="footer-section" id="footer" role="contentinfo">
        <div class="footer-wave" aria-hidden="true">
            <svg viewBox="0 0 1440 120" preserveAspectRatio="none">
                <defs>
                    <linearGradient id="wave-gradient" x1="0%" y1="0%" x2="100%" y2="0%">
                        <stop offset="0%" style="stop-color:var(--footer-accent);stop-opacity:0" />
                        <stop offset="25%" style="stop-color:var(--footer-accent);stop-opacity:1" />
                        <stop offset="75%" style="stop-color:var(--footer-hover);stop-opacity:1" />
                        <stop offset="100%" style="stop-color:var(--footer-hover);stop-opacity:0" />
                    </linearGradient>
                </defs>
                <!-- Main wave fill with explicit class -->
                <path class="wave-fill"
                    d="M0,64L48,69.3C96,75,192,85,288,80C384,75,480,53,576,48C672,43,768,53,864,58.7C960,64,1056,64,1152,58.7C1248,53,1344,43,1392,37.3L1440,32L1440,120L1392,120C1344,120,1248,120,1152,120C1056,120,960,120,864,120C768,120,672,120,576,120C480,120,384,120,288,120C192,120,96,120,48,120L0,120Z">
                </path>
                <!-- Animated line following the wave curve -->
                <path class="wave-line"
                    d="M0,64L48,69.3C96,75,192,85,288,80C384,75,480,53,576,48C672,43,768,53,864,58.7C960,64,1056,64,1152,58.7C1248,53,1344,43,1392,37.3L1440,32">
                </path>
            </svg>
        </div>

        <div class="container">
            <div class="footer-content">
                <div class="footer-section-item">
                    <h3 class="footer-title">About Astegni</h3>
                    <p class="footer-description">Ethiopia's premier educational platform connecting students with
                        expert tutors and quality learning resources.</p>
                    <div class="footer-stats">
                        <div class="stat-item">
                            <span class="stat-number">10k+</span>
                            <span class="stat-label">Active Users</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-number">500+</span>
                            <span class="stat-label">Courses</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-number">95%</span>
                            <span class="stat-label">Success Rate</span>
                        </div>
                    </div>
                </div>

                <div class="footer-section-item">
                    <h3 class="footer-title">Quick Links</h3>
                    <ul class="footer-links">
                        <li><a href="#" class="footer-link">About Us</a></li>
                        <li><a href="#" class="footer-link">How It Works</a></li>
                        <li><a href="#" class="footer-link">Pricing</a></li>
                        <li><a href="#" class="footer-link">Success Stories</a></li>
                        <li><a href="#" class="footer-link">Blog</a></li>
                        <li><a href="#" class="footer-link">Careers</a></li>
                    </ul>
                </div>

                <div class="footer-section-item">
                    <h3 class="footer-title">Support</h3>
                    <ul class="footer-links">
                        <li><a href="#" class="footer-link">Help Center</a></li>
                        <li><a href="#" class="footer-link">Contact Us</a></li>
                        <li><a href="#" class="footer-link">FAQs</a></li>
                        <li><a href="#" class="footer-link">Terms of Service</a></li>
                        <li><a href="#" class="footer-link">Privacy Policy</a></li>
                        <li><a href="#" class="footer-link">Safety</a></li>
                    </ul>
                </div>

                <div class="footer-section-item">
                    <h3 class="footer-title">Connect With Us</h3>
                    <div class="social-links">
                        <a href="#" aria-label="Facebook" class="social-link" target="_blank" rel="noopener noreferrer">
                            <svg class="w-6 h-6" width="20" height="20" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M18 2h-3a5 5 0 00-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 011-1h3V2z"></path>
                            </svg>
                        </a>
                        <a href="#" aria-label="Twitter" class="social-link" target="_blank" rel="noopener noreferrer">
                            <svg class="w-6 h-6" width="20" height="20" fill="currentColor" viewBox="0 0 24 24">
                                <path
                                    d="M23 3a10.9 10.9 0 01-3.14 1.53 4.48 4.48 0 00-7.86 3v1A10.66 10.66 0 013 4s-4 9 5 13a11.64 11.64 0 01-7 2c9 5 20 0 20-11.5a4.5 4.5 0 00-.08-.83A7.72 7.72 0 0023 3z">
                                </path>
                            </svg>
                        </a>
                        <a href="#" aria-label="LinkedIn" class="social-link" target="_blank" rel="noopener noreferrer">
                            <svg class="w-6 h-6" width="20" height="20" fill="currentColor" viewBox="0 0 24 24">
                                <path
                                    d="M16 8a6 6 0 016 6v7h-4v-7a2 2 0 00-2-2 2 2 0 00-2 2v7h-4v-7a6 6 0 016-6zM2 9h4v12H2z">
                                </path>
                                <circle cx="4" cy="4" r="2"></circle>
                            </svg>
                        </a>
                        <a href="#" aria-label="Instagram" class="social-link" target="_blank"
                            rel="noopener noreferrer">
                            <svg class="w-6 h-6" width="20" height="20" fill="currentColor" viewBox="0 0 24 24">
                                <rect x="2" y="2" width="20" height="20" rx="5" ry="5"></rect>
                                <path d="M16 11.37A4 4 0 1112.63 8 4 4 0 0116 11.37z"></path>
                                <line x1="17.5" y1="6.5" x2="17.51" y2="6.5"></line>
                            </svg>
                        </a>
                        <a href="https://www.youtube.com/@Astegni" aria-label="YouTube" class="social-link"
                            target="_blank" rel="noopener noreferrer">
                            <svg class="w-6 h-6" width="20" height="20" fill="currentColor" viewBox="0 0 24 24">
                                <path
                                    d="M22.54 6.42a2.78 2.78 0 00-1.94-2C18.88 4 12 4 12 4s-6.88 0-8.6.46a2.78 2.78 0 00-1.94 2A29 29 0 001 12a29 29 0 00.46 5.58A2.78 2.78 0 003.4 19.6c1.72.46 8.6.46 8.6.46s6.88 0 8.6-.46a2.78 2.78 0 001.94-2A29 29 0 0023 12a29 29 0 00-.46-5.58zM9.75 15.02V8.98L15.5 12l-5.75 3.02z">
                                </path>
                            </svg>
                        </a>
                    </div>

                    <div class="newsletter-signup">
                        <h4>Subscribe to Newsletter</h4>
                        <form class="newsletter-form" id="newsletterForm">
                            <input type="email" placeholder="Your email address" class="newsletter-input"
                                id="emailInput" aria-label="Email address" required>
                            <button type="submit" class="newsletter-btn" id="submitBtn">Subscribe</button>
                            <div class="newsletter-feedback" id="feedback"></div>
                        </form>
                    </div>
                </div>
            </div>

            <div class="footer-bottom-content">
                <div class="footer-badges">
                    <div class="company-brand">
                        <span>From the deep of</span>
                        <span class="trademark-symbol">‚Ñ¢</span>
                        <span class="company-text">Eshtaol</span>
                    </div>
                    <a href="tel:+251935244245" class="phone-link">
                        <span class="phone-icon">üìû</span>
                        <span>+251-935-24-42-45</span>
                        <span>+251-997-40-98-66</span>
                    </a>
                </div>
                <div class="footer-badges">
                    <p class="copyright">¬© </p>
                    <p>2025 Astegni. All rights reserved.</p>
                </div>
                <div class="footer-badges">
                    <span class="badge glow" tabindex="0">üîí SSL Secured</span>
                    <span class="badge" tabindex="0">‚úì Verified Platform</span>
                    <span class="badge" tabindex="0">üèÜ Future Awards Winner</span>
                </div>
            </div>
            <!-- TODO: counting cards should count from users where role = 'parent', 'student', 'tutor', etc... register-modal, reviews section professional-reviews-card should be enhanced. -->
        </div>
    </footer>


    <!-- Core Page Structure Scripts -->
    <script src="../js/page-structure/loadingManager.js"></script>
    <script src="../js/page-structure/adManager.js"></script>
    <script src="../js/page-structure/footerManager.js"></script>
    <script src="../js/page-structure/settingsManager.js"></script>
    <script src="../js/page-structure/badgeManager.js"></script>
    <script src="../js/page-structure/notificationManager.js"></script>
    <script src="../js/page-structure/videoPlayerManager.js"></script>
    <script src="../js/page-structure/bottomWidgetManager.js"></script>
    <script src="../js/page-structure/rightSidebarManager.js"></script>
    <script src="../js/page-structure/leftSidebarManager.js"></script>
    <script src="../js/page-structure/profileDropdownManager.js"></script>
    <script src="../js/page-structure/comingSoonManager.js"></script>
    <script src="../js/page-structure/editProfileManager.js"></script>
    <script src="../js/page-structure/followerModalManager.js"></script>
    <script src="../js/page-structure/shareModalManager.js"></script>

    <!-- Initialization (Auto-initializes all loaded managers) -->
    <script src="../js/page-structure/initializationManager.js"></script>

    <!-- Authentication Manager (MUST BE LOADED BEFORE PROFILE SCRIPTS) -->
    <script src="../js/root/nav.js"></script>
    <script src="../js/root/auth.js?v=20251217"></script>
    <!-- Access Restricted Modal - MUST load before ProfileCompletionGuard -->
    <script src="../js/common-modals/access-restricted-modal.js?v=20251229"></script>
    <!-- Profile Completion Guard - checks profile and KYC before protected features -->
    <script src="../js/root/profile-completion-guard.js?v=20251224"></script>

    <!-- Theme Toggle - for theme persistence across pages -->
    <script src="../js/root/theme-toggle.js"></script>

    <!-- Profile System -->
    <script src="../js/root/profile-system.js?v=20251218"></script>

    <!-- Common Modals -->
    <script src="../js/index/init-modals.js"></script>
    <script src="../js/common-modals/coming-soon-modal.js"></script>
    <script src="../js/common-modals/ad-modal.js"></script>
    <script src="../js/common-modals/ad-rotation-manager.js"></script>

    <!-- Stats Counter for Hero Section -->
    <script src="../js/find-tutors/stats-counter.js"></script>

    <!-- ============================================ -->
    <!-- STUDENT PROFILE MODULES (Modularized)       -->
    <!-- Load in strict order for proper initialization -->
    <!-- ============================================ -->

    <!-- 1. State Management (Must load first) -->
    <script src="../js/student-profile/state-manager.js"></script>

    <!-- 1.3 Protected API Wrapper (2FA protection for settings, requests panels) -->
    <!-- Note: Session requests on view-tutor.html are also 2FA protected (in session-request-handler.js) -->
    <script src="../js/common-modals/protected-api-wrapper.js"></script>

    <!-- 1.5 Panel Manager (for panel switching) -->
    <script src="../js/student-profile/panel-manager.js"></script>

    <!-- 1.6 Resource Manager -->
    <script src="../js/student-profile/resource-manager.js"></script>

    <!-- 1.7 Sidebar Manager (for hamburger menu) -->
    <script src="../js/student-profile/sidebar-manager.js"></script>

    <!-- 2. API Service -->
    <script src="../js/student-profile/api-service.js"></script>

    <!-- 2.5. Child Invitation Manager (MUST load before global-functions.js) -->
    <script src="../js/common-modals/child-invitation-manager.js"></script>

    <!-- 3. Global Functions (for HTML onclick handlers) -->
    <script src="../js/student-profile/global-functions.js?v=20251230"></script>

    <!-- 8. Additional Features -->
    <script src="../js/student-profile/session-requests-manager.js?v=20251218"></script>

    <!-- 9. Backend Integration Modules -->
    <script src="../js/student-profile/profile-data-loader.js"></script>
    <script src="../js/student-profile/image-upload-handler.js"></script>
    <script src="../js/student-profile/profile-edit-handler.js"></script>
    <script src="../js/student-profile/upload-modal-handler.js"></script>
    <script src="../js/student-profile/profile-edit-manager.js?v=20251230a"></script>

    <!-- Earnings & Investments Manager -->
    <script src="../js/tutor-profile/earnings-investments-manager.js"></script>

    <!-- Community Manager (shared across profiles) -->
    <script src="../js/common-modals/communityManager.js"></script>

    <!-- Community Modal Manager (for opening/closing community modal) -->
    <script src="../js/common-modals/community-modal-manager.js"></script>

    <!-- Modal Loader (for loading modals dynamically) -->
    <script src="../modals/tutor-profile/modal-loader.js"></script>

    <!-- Two-Factor Authentication Manager -->
    <script src="../js/common-modals/tfa-manager.js?v=20251227"></script>

    <!-- Logout Modal JavaScript -->
    <script src="../js/common-modals/logout-modal.js"></script>

    <!-- Subscription Modal JavaScript (Dynamic - fetches plans based on role) -->
    <script src="../js/common-modals/subscription-modal.js"></script>

    <!-- Chat Modal JavaScript -->
    <script src="../js/common-modals/chat-modal.js"></script>
    <script src="../js/common-modals/truevoice-manager.js"></script>
    <script src="../js/common-modals/view-request-modal.js"></script>

    <!-- Student Community Manager -->
    <script src="../js/student-profile/student-community-manager.js"></script>

    <!-- Student Reviews Manager -->
    <script src="../js/student-profile/student-profile-reviews.js"></script>

    <!-- Tutors Manager -->
    <!-- Tutor Card Creator for My Tutors panel (must load before tutors-manager) -->
    <script src="../js/find-tutors/tutor-card-creator.js"></script>
    <script src="../js/student-profile/tutors-manager.js"></script>

    <!-- Courses Manager for My Courses panel -->
    <script src="../js/student-profile/courses-manager.js"></script>

    <!-- Parent Portal Manager -->
    <script src="../js/student-profile/parent-portal-manager.js"></script>

    <!-- Shared Folder Manager -->
    <script src="../js/shared/folder-manager.js"></script>

    <!-- Digital Whiteboard System -->
    <script src="../js/tutor-profile/whiteboard-manager.js"></script>

    <!-- Coursework Manager -->
    <script src="../js/tutor-profile/coursework-manager.js"></script>

    <!-- 11. Initialize (MUST BE LAST) -->
    <script src="../js/student-profile/init.js"></script>

    <script>
        // ============================================
        //   BOOKSTORE WIDGET - FADE IN/OUT ANIMATION
        // ============================================
        (function () {
            const bookstoreTitles = [
                { icon: 'üìñ', text: 'Educational Books', emoji: 'üìö' },
                { icon: 'üìö', text: 'Fiction & Novels', emoji: 'üìñ' },
                { icon: 'üî¨', text: 'Science Textbooks', emoji: 'üß™' },
                { icon: 'üìê', text: 'Mathematics Books', emoji: '‚ûó' },
                { icon: 'üî•', text: 'Trending Books', emoji: 'üî•' },
                { icon: 'üí∞', text: 'Special Discounts', emoji: 'üè∑Ô∏è' },
                { icon: 'üéÅ', text: 'Bundle Deals', emoji: 'üì¶' },
                { icon: '‚ú®', text: 'Coming Soon!', emoji: 'üéâ' }
            ];

            let currentBookIndex = 0;
            const bookstoreTitleContainer = document.querySelector('.bookstore-title-animated');
            const bookstoreIcon = document.querySelector('.bookstore-icon');

            if (bookstoreTitleContainer && bookstoreIcon) {
                const titleElement = bookstoreTitleContainer.querySelector('.bookstore-title');

                function animateBookstoreTitle() {
                    // Fade out
                    titleElement.style.opacity = '0';
                    titleElement.style.transform = 'translateY(-10px)';

                    setTimeout(() => {
                        // Update content
                        currentBookIndex = (currentBookIndex + 1) % bookstoreTitles.length;
                        const currentTitle = bookstoreTitles[currentBookIndex];
                        titleElement.textContent = currentTitle.text;
                        bookstoreIcon.textContent = currentTitle.icon;

                        // Fade in
                        titleElement.style.transform = 'translateY(10px)';
                        setTimeout(() => {
                            titleElement.style.opacity = '1';
                            titleElement.style.transform = 'translateY(0)';
                        }, 50);
                    }, 600);
                }

                // Start animation every 3 seconds
                setInterval(animateBookstoreTitle, 3000);
            }
        })();

        // ============================================
        //   GAMESTORE WIDGET - FADE IN/OUT ANIMATION
        // ============================================
        (function () {
            const gamestoreTitles = [
                { icon: 'üéÆ', text: 'Educational Games', emoji: 'üéÆ' },
                { icon: 'üßÆ', text: 'Puzzle Games', emoji: 'üß©' },
                { icon: 'üéØ', text: 'Strategy Games', emoji: '‚ôüÔ∏è' },
                { icon: 'üèÜ', text: 'Top Rated Games', emoji: '‚≠ê' },
                { icon: 'üî•', text: 'Trending Games', emoji: 'üî•' },
                { icon: 'üí∞', text: 'Special Discounts', emoji: 'üè∑Ô∏è' },
                { icon: 'üéÅ', text: 'Bundle Deals', emoji: 'üì¶' },
                { icon: '‚ú®', text: 'Coming Soon!', emoji: 'üéâ' }
            ];

            let currentGameIndex = 0;
            const gamestoreTitleContainer = document.querySelector('.gamestore-title-animated');
            const gamestoreIcon = document.querySelector('.gamestore-icon');

            if (gamestoreTitleContainer && gamestoreIcon) {
                const titleElement = gamestoreTitleContainer.querySelector('.gamestore-title');

                function animateGamestoreTitle() {
                    // Fade out
                    titleElement.style.opacity = '0';
                    titleElement.style.transform = 'translateY(-10px)';

                    setTimeout(() => {
                        // Update content
                        currentGameIndex = (currentGameIndex + 1) % gamestoreTitles.length;
                        const currentTitle = gamestoreTitles[currentGameIndex];
                        titleElement.textContent = currentTitle.text;
                        gamestoreIcon.textContent = currentTitle.icon;

                        // Fade in
                        titleElement.style.transform = 'translateY(10px)';
                        setTimeout(() => {
                            titleElement.style.opacity = '1';
                            titleElement.style.transform = 'translateY(0)';
                        }, 50);
                    }, 600);
                }

                // Start animation every 3 seconds
                setInterval(animateGamestoreTitle, 3000);
            }
        })();
    </script>

    <!-- Floating Action Button (FAB) for Quick Actions -->
    <div class="fab-container" style="position: fixed; bottom: 2rem; right: 2rem; z-index: 1000;">
        <!-- Main FAB Button -->
        <button class="fab-main" id="fabMain" onclick="toggleFabMenu()"
            style="width: 60px; height: 60px; border-radius: 50%; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border: none; color: white; font-size: 1.5rem; cursor: pointer; box-shadow: 0 8px 24px rgba(102, 126, 234, 0.4); transition: all 0.3s ease; display: flex; align-items: center; justify-content: center;">
            <span id="fabIcon">‚ö°</span>
        </button>

        <!-- FAB Menu Items -->
        <div class="fab-menu" id="fabMenu"
            style="position: absolute; bottom: 70px; right: 0; display: none; flex-direction: column; gap: 1rem;">
            <!-- Resources -->
            <div class="fab-item" onclick="navigateToContent('documents')"
                style="display: flex; align-items: center; gap: 1rem; cursor: pointer; animation: fadeInUp 0.3s ease;">
                <span
                    style="background: white; color: #667eea; padding: 0.5rem; border-radius: 8px; font-size: 0.875rem; font-weight: 600; box-shadow: 0 4px 12px rgba(0,0,0,0.1); white-space: nowrap;">Documents</span>
                <div
                    style="width: 48px; height: 48px; border-radius: 50%; background: linear-gradient(135deg, #667eea, #764ba2); display: flex; align-items: center; justify-content: center; color: white; font-size: 1.25rem; box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);">
                    üìÅ
                </div>
            </div>

            <!-- Schedule -->
            <div class="fab-item" onclick="navigateToContent('schedule')"
                style="display: flex; align-items: center; gap: 1rem; cursor: pointer; animation: fadeInUp 0.3s ease 0.1s; animation-fill-mode: both; opacity: 0;">
                <span
                    style="background: white; color: #667eea; padding: 0.5rem; border-radius: 8px; font-size: 0.875rem; font-weight: 600; box-shadow: 0 4px 12px rgba(0,0,0,0.1); white-space: nowrap;">Schedule</span>
                <div
                    style="width: 48px; height: 48px; border-radius: 50%; background: linear-gradient(135deg, #22c55e, #16a34a); display: flex; align-items: center; justify-content: center; color: white; font-size: 1.25rem; box-shadow: 0 4px 12px rgba(34, 197, 94, 0.3);">
                    üìÖ
                </div>
            </div>

            <!-- Tutors -->
            <div class="fab-item" onclick="navigateToContent('my-tutors')"
                style="display: flex; align-items: center; gap: 1rem; cursor: pointer; animation: fadeInUp 0.3s ease 0.2s; animation-fill-mode: both; opacity: 0;">
                <span
                    style="background: white; color: #667eea; padding: 0.5rem; border-radius: 8px; font-size: 0.875rem; font-weight: 600; box-shadow: 0 4px 12px rgba(0,0,0,0.1); white-space: nowrap;">Tutors</span>
                <div
                    style="width: 48px; height: 48px; border-radius: 50%; background: linear-gradient(135deg, #f59e0b, #d97706); display: flex; align-items: center; justify-content: center; color: white; font-size: 1.25rem; box-shadow: 0 4px 12px rgba(245, 158, 11, 0.3);">
                    üë®‚Äçüè´
                </div>
            </div>

            <!-- Courses -->
            <div class="fab-item" onclick="navigateToContent('my-courses')"
                style="display: flex; align-items: center; gap: 1rem; cursor: pointer; animation: fadeInUp 0.3s ease 0.3s; animation-fill-mode: both; opacity: 0;">
                <span
                    style="background: white; color: #667eea; padding: 0.5rem; border-radius: 8px; font-size: 0.875rem; font-weight: 600; box-shadow: 0 4px 12px rgba(0,0,0,0.1); white-space: nowrap;">Courses</span>
                <div
                    style="width: 48px; height: 48px; border-radius: 50%; background: linear-gradient(135deg, #8b5cf6, #7c3aed); display: flex; align-items: center; justify-content: center; color: white; font-size: 1.25rem; box-shadow: 0 4px 12px rgba(139, 92, 246, 0.3);">
                    üìö
                </div>
            </div>
        </div>
    </div>

    <style>
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .fab-main:hover {
            transform: scale(1.1);
            box-shadow: 0 12px 32px rgba(102, 126, 234, 0.5);
        }

        .fab-main:active {
            transform: scale(0.95);
        }

        .fab-item:hover {
            transform: translateX(-5px);
        }

        .fab-item div:hover {
            transform: scale(1.1);
        }
    </style>

    <script>
        // ============================================
        //   FORWARD DECLARATIONS FOR ONCLICK HANDLERS
        //   These must be at the top so onclick handlers work
        // ============================================

        // Forward declare functions that are used by onclick handlers in HTML
        // The actual implementations are below
        var switchCredentialSection;
        var switchDocumentSection;
        var openUploadCredentialModal;
        var closeUploadCredentialModal;
        var openUploadDocumentModal;
        var closeUploadDocumentModal;
        var handleCredentialUpload;
        var deleteCredential;
        var deleteDocument;
        var editStudentCredential;
        var editStudentDocument;
        var loadCredentialsByType;
        var loadCredentialStats;
        var initializeCredentialsPanel;
        var initializeDocumentsPanel;

        let fabOpen = false;

        function toggleFabMenu() {
            const fabMenu = document.getElementById('fabMenu');
            const fabIcon = document.getElementById('fabIcon');
            const fabMain = document.getElementById('fabMain');

            fabOpen = !fabOpen;

            if (fabOpen) {
                fabMenu.style.display = 'flex';
                fabIcon.textContent = '‚úï';
                fabMain.style.transform = 'rotate(180deg)';
            } else {
                fabMenu.style.display = 'none';
                fabIcon.textContent = '‚ö°';
                fabMain.style.transform = 'rotate(0deg)';
            }
        }

        // Close FAB menu when clicking outside
        document.addEventListener('click', function (event) {
            const fabContainer = document.querySelector('.fab-container');
            if (fabOpen && !fabContainer.contains(event.target)) {
                toggleFabMenu();
            }
        });

        // ============================================
        //   CREDENTIAL UPLOAD MODAL FUNCTIONS
        // ============================================

        // Open Upload Credential Modal
        function openUploadCredentialModal() {
            const modal = document.getElementById('upload-credential-modal');
            if (modal) {
                modal.classList.remove('hidden');
                modal.style.display = 'flex';
                // Reset form
                const form = document.getElementById('uploadCredentialForm');
                if (form) {
                    form.reset();
                }
            } else {
                console.error('Upload credential modal not found');
            }
        }
        // Legacy alias
        function openUploadDocumentModal() { openUploadCredentialModal(); }

        // Close Upload Credential Modal
        function closeUploadCredentialModal() {
            const modal = document.getElementById('upload-credential-modal');
            if (!modal) return;

            // Reset form
            const form = document.getElementById('uploadCredentialForm');
            if (form) {
                form.reset();
                // Remove edit mode attributes
                form.removeAttribute('data-edit-mode');
                form.removeAttribute('data-credential-id');
            }

            // Reset modal title
            const modalTitle = modal.querySelector('.modal-title');
            if (modalTitle) {
                modalTitle.textContent = 'üì§ Upload Credential';
            }

            // Reset file input to required
            const fileInput = document.getElementById('credentialFile');
            if (fileInput) {
                fileInput.required = true;
                const fileLabel = fileInput.previousElementSibling;
                if (fileLabel && fileLabel.tagName === 'LABEL') {
                    fileLabel.innerHTML = 'Upload File<span class="text-red-500">*</span>';
                }
            }

            // Hide modal
            modal.classList.add('hidden');
            modal.style.display = 'none';
        }
        // Legacy alias
        function closeUploadDocumentModal() { closeUploadCredentialModal(); }


        // Handle Credential Upload
        async function handleCredentialUpload(event) {
            event.preventDefault();

            const token = localStorage.getItem('token');

            if (!token) {
                alert('Please log in to upload credentials');
                return false;
            }

            // Check if we're in edit mode
            const form = event.target;
            const isEditMode = form.getAttribute('data-edit-mode') === 'true';
            const credentialId = form.getAttribute('data-credential-id');

            // Get form data
            const formData = new FormData();
            formData.append('document_type', document.getElementById('credentialType').value);
            formData.append('title', document.getElementById('credentialTitle').value);
            formData.append('description', document.getElementById('credentialDescription').value || '');
            formData.append('issued_by', document.getElementById('issuedBy').value || '');
            formData.append('date_of_issue', document.getElementById('credentialDate').value || '');
            formData.append('expiry_date', document.getElementById('expiryDate').value || '');
            formData.append('is_featured', document.getElementById('isFeaturedToggle').checked);

            // File is optional in edit mode
            const fileInput = document.getElementById('credentialFile');
            if (fileInput.files.length > 0) {
                formData.append('file', fileInput.files[0]);
            }

            // Show loading state
            const submitBtn = event.target.querySelector('button[type="submit"]');
            const originalBtnText = submitBtn.innerHTML;
            submitBtn.disabled = true;
            submitBtn.innerHTML = `<i class="fas fa-spinner fa-spin"></i> ${isEditMode ? 'Updating...' : 'Uploading...'}`;

            try {
                let response;
                // Add uploader_role for unified credentials endpoint
                formData.append('uploader_role', 'student');

                if (isEditMode && credentialId) {
                    // Update existing credential using unified endpoint
                    response = await fetch(`http://localhost:8000/api/documents/${credentialId}`, {
                        method: 'PUT',
                        headers: {
                            'Authorization': `Bearer ${token}`
                        },
                        body: formData
                    });
                } else {
                    // Upload new credential using unified endpoint
                    response = await fetch('http://localhost:8000/api/documents/upload', {
                        method: 'POST',
                        headers: {
                            'Authorization': `Bearer ${token}`
                        },
                        body: formData
                    });
                }

                const result = await response.json();

                if (response.ok) {
                    alert(isEditMode ? 'Credential updated successfully!' : 'Credential uploaded successfully!');
                    closeUploadCredentialModal();

                    // Map section name to credential type and reload
                    const sectionToTypeMap = {
                        'achievement': 'achievement',
                        'academics': 'academic_certificate',
                        'extracurricular': 'extracurricular'
                    };
                    const credentialType = sectionToTypeMap[currentCredentialSection] || currentCredentialSection;
                    await loadCredentialsByType(credentialType);

                    // Reload stats
                    await loadCredentialStats();
                } else {
                    alert((isEditMode ? 'Update' : 'Upload') + ' failed: ' + (result.detail || 'Unknown error'));
                }
            } catch (error) {
                console.error((isEditMode ? 'Update' : 'Upload') + ' error:', error);
                alert('An error occurred. Please try again.');
            } finally {
                // Restore button state
                submitBtn.disabled = false;
                submitBtn.innerHTML = originalBtnText;
            }

            return false;
        }
        // Legacy alias
        function handleDocumentUpload(event) { return handleCredentialUpload(event); }

        // Load credentials by type
        async function loadCredentialsByType(type) {
            const token = localStorage.getItem('token');
            if (!token) {
                console.warn('[Credentials] No authentication token found');
                return;
            }

            // Show loading state
            showCredentialLoadingState(type);

            try {
                console.log(`[Credentials] Loading credentials for type: ${type}`);
                // Use unified documents endpoint with uploader_role filter (reads from credentials table)
                const response = await fetch(`http://localhost:8000/api/documents?document_type=${type}&uploader_role=student`, {
                    headers: {
                        'Authorization': `Bearer ${token}`
                    }
                });

                console.log(`[Credentials] Response status: ${response.status}`);

                if (response.ok) {
                    const credentials = await response.json();
                    console.log(`[Credentials] Successfully loaded ${credentials.length} credentials`);
                    renderCredentials(type, credentials);
                } else if (response.status === 401) {
                    console.error('[Credentials] Authentication failed - token may be expired');
                    showCredentialErrorState(type, 'Authentication failed. Please log in again.');
                } else if (response.status === 403) {
                    console.error('[Credentials] Access forbidden - user may not be a student');
                    showCredentialErrorState(type, 'Access denied. Only students can view credentials.');
                } else if (response.status === 404) {
                    console.warn('[Credentials] Student profile not found');
                    showCredentialErrorState(type, 'Student profile not found.');
                } else {
                    const errorData = await response.json();
                    console.error(`[Credentials] Failed to load credentials (${response.status}):`, errorData);
                    showCredentialErrorState(type, errorData.detail || 'Failed to load credentials');
                }
            } catch (error) {
                console.error('[Credentials] Exception while loading credentials:', error);
                showCredentialErrorState(type, 'Network error. Please check your connection.');
            }
        }

        // Legacy alias for backward compatibility
        async function loadDocumentsByType(type) {
            return loadCredentialsByType(type);
        }

        // Show loading state for credentials
        function showCredentialLoadingState(type) {
            const containerMap = {
                'achievement': 'achievements-grid',
                'academic_certificate': 'certificates-grid',
                'extracurricular': 'extracurricular-list'
            };

            const emptyStateMap = {
                'achievement': 'achievements-empty-state',
                'academic_certificate': 'certificates-empty-state',
                'extracurricular': 'extracurricular-empty-state'
            };

            const container = document.getElementById(containerMap[type]);
            const emptyState = document.getElementById(emptyStateMap[type]);

            if (!container) return;

            // Clear existing cards
            const existingCards = container.querySelectorAll('.credential-card');
            existingCards.forEach(card => card.remove());

            // Hide empty state
            if (emptyState) {
                emptyState.classList.add('hidden');
            }

            // Show loading indicator
            const loadingDiv = document.createElement('div');
            loadingDiv.className = 'credential-loading text-center text-gray-500 py-12 col-span-full';
            loadingDiv.innerHTML = `
                <i class="fas fa-spinner fa-spin text-4xl mb-4"></i>
                <p class="text-lg">Loading credentials...</p>
            `;
            container.appendChild(loadingDiv);
        }

        // Legacy alias
        function showDocumentLoadingState(type) {
            showCredentialLoadingState(type);
        }

        // Show error state for credentials
        function showCredentialErrorState(type, errorMessage) {
            const containerMap = {
                'achievement': 'achievements-grid',
                'academic_certificate': 'certificates-grid',
                'extracurricular': 'extracurricular-list'
            };

            const container = document.getElementById(containerMap[type]);
            if (!container) return;

            // Clear loading state
            const loadingDiv = container.querySelector('.credential-loading');
            if (loadingDiv) loadingDiv.remove();

            // Show error message
            const errorDiv = document.createElement('div');
            errorDiv.className = 'credential-error text-center text-red-500 py-12 col-span-full';
            errorDiv.innerHTML = `
                <i class="fas fa-exclamation-triangle text-4xl mb-4"></i>
                <p class="text-lg font-semibold mb-2">Error Loading Credentials</p>
                <p class="text-sm">${errorMessage}</p>
                <button onclick="loadCredentialsByType('${type}')" class="mt-4 btn-secondary">
                    <i class="fas fa-redo"></i> Retry
                </button>
            `;
            container.appendChild(errorDiv);
        }

        // Legacy alias
        function showDocumentErrorState(type, errorMessage) {
            showCredentialErrorState(type, errorMessage);
        }

        // Load credential statistics
        async function loadCredentialStats() {
            const token = localStorage.getItem('token');
            if (!token) return;

            try {
                // Use unified documents stats endpoint with uploader_role filter (reads from credentials table)
                const response = await fetch('http://localhost:8000/api/documents/stats?uploader_role=student', {
                    headers: {
                        'Authorization': `Bearer ${token}`
                    }
                });

                if (response.ok) {
                    const stats = await response.json();
                    updateCredentialCardStats(stats);
                }
            } catch (error) {
                console.error('Error loading stats:', error);
            }
        }

        // Legacy alias
        async function loadDocumentStats() {
            return loadCredentialStats();
        }

        // Update credential card statistics
        function updateCredentialCardStats(stats) {
            // The unified documents API returns: { total_credentials, by_type: { achievement, academic_certificate, extracurricular } }
            const byType = stats.by_type || {};

            // Update achievements card
            const achievementCount = document.getElementById('stat-achievement-count');
            if (achievementCount) {
                achievementCount.textContent = byType.achievement || 0;
            }

            // Update academics card (maps to academic_certificate in database)
            const academicsCount = document.getElementById('stat-academics-count');
            if (academicsCount) {
                academicsCount.textContent = byType.academic_certificate || 0;
            }

            // Update extracurricular card
            const extracurricularCount = document.getElementById('stat-extracurricular-count');
            if (extracurricularCount) {
                extracurricularCount.textContent = byType.extracurricular || 0;
            }
        }

        // Legacy alias
        function updateDocumentCardStats(stats) {
            updateCredentialCardStats(stats);
        }

        // Render credentials dynamically from database
        function renderCredentials(type, credentials) {
            console.log(`[Credentials] Rendering ${credentials.length} credentials for type: ${type}`);

            // Map credential type to grid/list container IDs
            const containerMap = {
                'achievement': 'achievements-grid',
                'academic_certificate': 'certificates-grid',
                'extracurricular': 'extracurricular-list'
            };

            const emptyStateMap = {
                'achievement': 'achievements-empty-state',
                'academic_certificate': 'certificates-empty-state',
                'extracurricular': 'extracurricular-empty-state'
            };

            const container = document.getElementById(containerMap[type]);
            const emptyState = document.getElementById(emptyStateMap[type]);

            if (!container) {
                console.error(`[Credentials] Container not found for type: ${type}`);
                return;
            }

            // Clear loading/error states and existing credential cards
            const loadingDiv = container.querySelector('.credential-loading');
            const errorDiv = container.querySelector('.credential-error');
            const existingCards = container.querySelectorAll('.credential-card');

            if (loadingDiv) loadingDiv.remove();
            if (errorDiv) errorDiv.remove();
            existingCards.forEach(card => card.remove());

            // If no credentials, show empty state
            if (!credentials || credentials.length === 0) {
                if (emptyState) {
                    emptyState.classList.remove('hidden');
                }
                console.log(`[Credentials] No credentials found for type: ${type}`);
                return;
            }

            // Hide empty state
            if (emptyState) {
                emptyState.classList.add('hidden');
            }

            // Render credentials based on type
            if (type === 'extracurricular') {
                // Render as list items for extracurricular
                credentials.forEach(cred => {
                    const listItem = createExtracurricularListItem(cred);
                    container.appendChild(listItem);
                });
            } else {
                // Render as grid cards for achievements and certificates
                credentials.forEach(cred => {
                    const card = createCredentialCard(cred, type);
                    container.appendChild(card);
                });
            }

            console.log(`[Credentials] Successfully rendered ${credentials.length} credentials`);
        }

        // Legacy alias
        function renderDocuments(type, documents) {
            renderCredentials(type, documents);
        }

        // Create credential card for achievements and certificates
        function createCredentialCard(cred, type) {
            const card = document.createElement('div');
            card.className = 'credential-card bg-white dark:bg-gray-800 p-6 rounded-xl shadow-md hover:shadow-lg transition-shadow';

            const icon = type === 'achievement' ? 'üèÜ' : 'üìú';
            const formattedDate = cred.date_of_issue ? new Date(cred.date_of_issue).toLocaleDateString('en-US', {
                year: 'numeric',
                month: 'long',
                day: 'numeric'
            }) : 'N/A';

            card.innerHTML = `
                <div class="flex items-start justify-between mb-4">
                    <div class="text-4xl">${icon}</div>
                    <div class="flex gap-2">
                        <button onclick="window.editStudentCredential && window.editStudentCredential(${cred.id}, '${type}')"
                                class="text-blue-500 hover:text-blue-700 transition-colors"
                                title="Edit credential">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button onclick="window.deleteCredential && window.deleteCredential(${cred.id}, '${type}')"
                                class="text-red-500 hover:text-red-700 transition-colors"
                                title="Delete credential">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                </div>
                <h3 class="font-bold text-lg mb-2 text-gray-800 dark:text-gray-200">${escapeHtml(cred.title)}</h3>
                ${cred.description ? `<p class="text-gray-600 dark:text-gray-400 text-sm mb-3">${escapeHtml(cred.description)}</p>` : ''}
                <div class="space-y-2 text-sm text-gray-700 dark:text-gray-300">
                    ${cred.issued_by ? `<p><strong>Issued by:</strong> ${escapeHtml(cred.issued_by)}</p>` : ''}
                    <p><strong>Date:</strong> ${formattedDate}</p>
                </div>
                ${cred.document_url ? `
                    <div class="mt-4">
                        <a href="${cred.document_url}"
                           target="_blank"
                           class="inline-flex items-center gap-2 text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300 transition-colors">
                            <i class="fas fa-download"></i>
                            <span>View Credential</span>
                        </a>
                    </div>
                ` : ''}
            `;

            return card;
        }

        // Legacy alias
        function createDocumentCard(doc, type) {
            return createCredentialCard(doc, type);
        }

        // Create list item for extracurricular activities
        function createExtracurricularListItem(cred) {
            const listItem = document.createElement('div');
            listItem.className = 'credential-card bg-white dark:bg-gray-800 p-5 rounded-lg shadow-md hover:shadow-lg transition-shadow border-l-4 border-blue-500';

            const formattedDate = cred.date_of_issue ? new Date(cred.date_of_issue).toLocaleDateString('en-US', {
                year: 'numeric',
                month: 'long',
                day: 'numeric'
            }) : 'N/A';

            listItem.innerHTML = `
                <div class="flex items-start justify-between">
                    <div class="flex-1">
                        <div class="flex items-center gap-3 mb-2">
                            <span class="text-2xl">üéØ</span>
                            <h3 class="font-bold text-lg text-gray-800 dark:text-gray-200">${escapeHtml(cred.title)}</h3>
                        </div>
                        ${cred.description ? `<p class="text-gray-600 dark:text-gray-400 text-sm mb-3 ml-11">${escapeHtml(cred.description)}</p>` : ''}
                        <div class="flex flex-wrap gap-4 text-sm text-gray-700 dark:text-gray-300 ml-11">
                            ${cred.issued_by ? `<p><strong>Organization:</strong> ${escapeHtml(cred.issued_by)}</p>` : ''}
                            <p><strong>Date:</strong> ${formattedDate}</p>
                        </div>
                        ${cred.document_url ? `
                            <div class="mt-3 ml-11">
                                <a href="${cred.document_url}"
                                   target="_blank"
                                   class="inline-flex items-center gap-2 text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300 transition-colors text-sm">
                                    <i class="fas fa-download"></i>
                                    <span>View Credential</span>
                                </a>
                            </div>
                        ` : ''}
                    </div>
                    <div class="flex gap-2 ml-4">
                        <button onclick="window.editStudentCredential && window.editStudentCredential(${cred.id}, 'extracurricular')"
                                class="text-blue-500 hover:text-blue-700 transition-colors"
                                title="Edit activity">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button onclick="window.deleteCredential && window.deleteCredential(${cred.id}, 'extracurricular')"
                                class="text-red-500 hover:text-red-700 transition-colors"
                                title="Delete activity">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                </div>
            `;

            return listItem;
        }

        // Edit credential
        async function editStudentCredential(credentialId, type) {
            console.log('‚úèÔ∏è Editing credential:', credentialId, 'Type:', type);

            try {
                const token = localStorage.getItem('token');
                if (!token) {
                    alert('Please log in to edit credentials');
                    return;
                }

                // Fetch the credential details using unified endpoint
                const response = await fetch(`http://localhost:8000/api/documents?document_type=${type}&uploader_role=student`, {
                    headers: {
                        'Authorization': `Bearer ${token}`
                    }
                });

                if (!response.ok) {
                    throw new Error('Failed to load credential');
                }

                const credentials = await response.json();
                const credentialData = credentials.find(d => d.id === credentialId);

                if (!credentialData) {
                    alert('Credential not found');
                    return;
                }

                // Open the upload modal in edit mode
                const modal = document.getElementById('upload-credential-modal');
                if (!modal) {
                    console.error('Upload credential modal not found');
                    return;
                }

                // Get form elements
                const form = document.getElementById('uploadCredentialForm');
                const typeSelect = document.getElementById('credentialType');
                const titleInput = document.getElementById('credentialTitle');
                const descriptionInput = document.getElementById('credentialDescription');
                const issuedByInput = document.getElementById('issuedBy');
                const dateInput = document.getElementById('credentialDate');
                const expiryInput = document.getElementById('expiryDate');
                const isFeaturedToggle = document.getElementById('isFeaturedToggle');
                const fileInput = document.getElementById('credentialFile');

                // Store credential ID in form for update
                form.setAttribute('data-edit-mode', 'true');
                form.setAttribute('data-credential-id', credentialId);

                // Populate form fields
                if (typeSelect) typeSelect.value = credentialData.document_type || '';
                if (titleInput) titleInput.value = credentialData.title || '';
                if (descriptionInput) descriptionInput.value = credentialData.description || '';
                if (issuedByInput) issuedByInput.value = credentialData.issued_by || '';

                if (dateInput && credentialData.date_of_issue) {
                    const date = new Date(credentialData.date_of_issue);
                    dateInput.value = date.toISOString().split('T')[0];
                }

                if (expiryInput && credentialData.expiry_date) {
                    const expiryDate = new Date(credentialData.expiry_date);
                    expiryInput.value = expiryDate.toISOString().split('T')[0];
                }

                if (isFeaturedToggle) {
                    isFeaturedToggle.checked = credentialData.is_featured || false;
                    // Trigger change event to update status text
                    isFeaturedToggle.dispatchEvent(new Event('change'));
                }

                // Make file input optional in edit mode
                if (fileInput) {
                    fileInput.required = false;
                    const fileLabel = fileInput.previousElementSibling;
                    if (fileLabel && fileLabel.tagName === 'LABEL') {
                        fileLabel.innerHTML = 'Upload New File (Optional)<span class="text-gray-500 text-xs ml-2">Leave empty to keep current file</span>';
                    }
                }

                // Update modal title
                const modalTitle = modal.querySelector('.modal-title');
                if (modalTitle) {
                    modalTitle.textContent = '‚úèÔ∏è Edit Credential';
                }

                // Show modal
                modal.classList.remove('hidden');
                modal.style.display = 'flex';

            } catch (error) {
                console.error('Error loading credential for edit:', error);
                alert('Failed to load credential details. Please try again.');
            }
        }
        // Legacy alias
        function editStudentDocument(documentId, type) { editStudentCredential(documentId, type); }

        // Delete credential
        async function deleteCredential(credentialId, type) {
            if (!confirm('Are you sure you want to delete this credential?')) {
                return;
            }

            const token = localStorage.getItem('token');
            if (!token) {
                alert('Please log in to delete credentials');
                return;
            }

            try {
                // Use unified documents endpoint for deletion
                const response = await fetch(`http://localhost:8000/api/documents/${credentialId}?uploader_role=student`, {
                    method: 'DELETE',
                    headers: {
                        'Authorization': `Bearer ${token}`
                    }
                });

                if (response.ok) {
                    alert('Credential deleted successfully!');
                    // Reload credentials
                    await loadCredentialsByType(type);
                    await loadCredentialStats();
                } else {
                    const error = await response.json();
                    alert('Delete failed: ' + (error.detail || 'Unknown error'));
                }
            } catch (error) {
                console.error('Delete error:', error);
                alert('An error occurred while deleting. Please try again.');
            }
        }
        // Legacy alias
        function deleteDocument(documentId, type) { deleteCredential(documentId, type); }

        // Utility function to escape HTML and prevent XSS
        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        // ============================================
        //   CREDENTIAL SECTION SWITCHING
        // ============================================

        let currentCredentialSection = 'achievement';

        function switchCredentialSection(section) {
            // Hide all credential sections
            const sections = document.querySelectorAll('.credential-section');
            sections.forEach(sec => sec.classList.add('hidden'));

            // Show selected section
            const selectedSection = document.getElementById(`cred-section-${section}`);
            if (selectedSection) {
                selectedSection.classList.remove('hidden');
            }

            // Update card styles to highlight active card
            const cards = document.querySelectorAll('[id^="cred-card-"]');
            cards.forEach(card => {
                card.classList.remove('ring-2', 'ring-blue-500', 'shadow-lg');
            });

            const activeCard = document.getElementById(`cred-card-${section}`);
            if (activeCard) {
                activeCard.classList.add('ring-2', 'ring-blue-500', 'shadow-lg');
            }

            // Update current section
            currentCredentialSection = section;

            // Map UI section names to database credential types
            const sectionToTypeMap = {
                'achievement': 'achievement',
                'academics': 'academic_certificate',
                'extracurricular': 'extracurricular'
            };

            const credentialType = sectionToTypeMap[section] || section;

            // Load credentials for this type
            loadCredentialsByType(credentialType);

            // Smooth scroll to top of section
            const credentialsPanel = document.getElementById('credentials-panel');
            if (credentialsPanel) {
                credentialsPanel.scrollTop = 0;
            }
        }

        // Legacy alias for backward compatibility
        function switchDocumentSection(section) {
            switchCredentialSection(section);
        }

        // Initialize credentials panel (called by panel manager when switching to credentials panel)
        function initializeCredentialsPanel() {
            console.log('[Credentials Panel] Initializing...');

            // Set achievements as default active section
            switchCredentialSection('achievement');

            // Load credential statistics from database
            loadCredentialStats();

            console.log('[Credentials Panel] Initialized successfully');
        }

        // Legacy alias for backward compatibility
        function initializeDocumentsPanel() {
            initializeCredentialsPanel();
        }

        // Make it globally accessible for panel manager and onclick handlers
        // IMPORTANT: These MUST be assigned to window for onclick handlers in HTML to work
        window.initializeCredentialsPanel = initializeCredentialsPanel;
        window.initializeDocumentsPanel = initializeDocumentsPanel; // Legacy
        window.switchCredentialSection = switchCredentialSection;
        window.switchDocumentSection = switchDocumentSection; // Legacy
        window.openUploadCredentialModal = openUploadCredentialModal;
        window.closeUploadCredentialModal = closeUploadCredentialModal;
        window.openUploadDocumentModal = openUploadDocumentModal; // Legacy
        window.closeUploadDocumentModal = closeUploadDocumentModal; // Legacy
        window.handleCredentialUpload = handleCredentialUpload;
        window.deleteCredential = deleteCredential;
        window.deleteDocument = deleteDocument; // Legacy
        window.editStudentCredential = editStudentCredential;
        window.editStudentDocument = editStudentDocument; // Legacy
        window.loadCredentialsByType = loadCredentialsByType;
        window.loadCredentialStats = loadCredentialStats;

        // Log to confirm exports are registered
        console.log('[Credentials] Window exports registered:', {
            switchCredentialSection: typeof window.switchCredentialSection,
            openUploadCredentialModal: typeof window.openUploadCredentialModal,
            deleteCredential: typeof window.deleteCredential
        });

        // Initialize first section on page load (if credentials panel is already visible)
        document.addEventListener('DOMContentLoaded', function() {
            // Only initialize if credentials panel is active on page load
            const credentialsPanel = document.getElementById('credentials-panel');
            if (credentialsPanel && !credentialsPanel.classList.contains('hidden')) {
                initializeCredentialsPanel();
            }
        });

        // Close modal when clicking outside
        window.addEventListener('click', function(event) {
            const modal = document.getElementById('upload-credential-modal');
            if (event.target === modal) {
                closeUploadCredentialModal();
            }
        });

        // Handle featured toggle status text
        document.addEventListener('DOMContentLoaded', function() {
            const featuredToggle = document.getElementById('isFeaturedToggle');
            const featuredStatusText = document.getElementById('featuredStatusText');

            if (featuredToggle && featuredStatusText) {
                featuredToggle.addEventListener('change', function() {
                    if (this.checked) {
                        featuredStatusText.textContent = 'Featured ‚≠ê';
                        featuredStatusText.style.color = 'var(--primary)';
                        featuredStatusText.style.fontWeight = '600';
                    } else {
                        featuredStatusText.textContent = 'Not Featured';
                        featuredStatusText.style.color = 'var(--text-secondary)';
                        featuredStatusText.style.fontWeight = '400';
                    }
                });
            }

            // Initialize folder manager for student profile
            if (typeof initializeFolderManager === 'function') {
                initializeFolderManager('student');
            }
        });

        // ============================================
        //   DOCUMENTS PANEL - FUNCTIONS
        // ============================================

        // Document state
        let allStudentDocuments = [];
        let currentStudentDocFilter = 'all';
        let currentStudentDocSort = 'upload_date';
        let currentStudentFolder = null;
        let currentDocSource = 'all'; // 'all', 'own', 'tutor'

        // Switch between Folders and Documents view
        function switchStudentDocsViewTab(tab) {
            const foldersTab = document.getElementById('student-folders-tab');
            const documentsTab = document.getElementById('student-documents-tab');
            const foldersView = document.getElementById('student-folders-view');
            const documentsView = document.getElementById('student-documents-view');

            if (tab === 'folders') {
                foldersTab.classList.add('text-blue-600', 'border-b-2', 'border-blue-600');
                foldersTab.classList.remove('text-gray-500');
                documentsTab.classList.remove('text-blue-600', 'border-b-2', 'border-blue-600');
                documentsTab.classList.add('text-gray-500');
                foldersView.classList.remove('hidden');
                documentsView.classList.add('hidden');
            } else {
                documentsTab.classList.add('text-blue-600', 'border-b-2', 'border-blue-600');
                documentsTab.classList.remove('text-gray-500');
                foldersTab.classList.remove('text-blue-600', 'border-b-2', 'border-blue-600');
                foldersTab.classList.add('text-gray-500');
                documentsView.classList.remove('hidden');
                foldersView.classList.add('hidden');
                // Load documents when switching to documents view
                loadStudentDocuments();
            }
        }

        // Switch document source (All, My Documents, From Tutors)
        function switchDocSource(source) {
            currentDocSource = source;

            // Update tab styles
            const tabs = document.querySelectorAll('.doc-source-tab');
            tabs.forEach(tab => {
                tab.classList.remove('bg-blue-500', 'text-white');
                tab.classList.add('bg-gray-200', 'text-gray-700');
            });

            const activeTab = document.querySelector(`.doc-source-tab[data-source="${source}"]`);
            if (activeTab) {
                activeTab.classList.remove('bg-gray-200', 'text-gray-700');
                activeTab.classList.add('bg-blue-500', 'text-white');
            }

            // Reload documents with new source filter
            loadStudentDocuments();
        }

        // Load all student documents from API
        // Uses /api/teaching-documents which reads from the 'documents' table (teaching materials)
        // NOT /api/documents which reads from 'credentials' table (achievements, certificates)
        // Can load: own documents, tutor documents (from enrolled tutors), or both
        async function loadStudentDocuments() {
            const token = localStorage.getItem('token');
            if (!token) {
                console.warn('[Documents] No authentication token found');
                return;
            }

            try {
                console.log('[Documents] Loading student teaching documents from documents table...');

                // Build API URL with source filter
                let apiUrl = 'https://api.astegni.com/api/teaching-documents?uploader_role=student';
                if (currentDocSource === 'own') {
                    apiUrl += '&source=own';
                } else if (currentDocSource === 'tutor') {
                    apiUrl += '&source=tutor';
                }
                // 'all' doesn't need source param (default behavior)

                const response = await fetch(apiUrl, {
                    headers: {
                        'Authorization': `Bearer ${token}`
                    }
                });

                if (response.ok) {
                    allStudentDocuments = await response.json();
                    console.log(`[Documents] Loaded ${allStudentDocuments.length} teaching documents (source: ${currentDocSource})`);
                    renderStudentDocuments();
                    updateStudentDocFilterCounts();
                    updateDocSourceCounts();
                } else {
                    console.error('[Documents] Failed to load teaching documents:', response.status);
                    // Show empty state on error
                    allStudentDocuments = [];
                    renderStudentDocuments();
                }
            } catch (error) {
                console.error('[Documents] Error loading teaching documents:', error);
                allStudentDocuments = [];
                renderStudentDocuments();
            }
        }

        // Update document source tab counts
        async function updateDocSourceCounts() {
            const token = localStorage.getItem('token');
            if (!token) return;

            try {
                const response = await fetch('https://api.astegni.com/api/teaching-documents/stats?uploader_role=student', {
                    headers: { 'Authorization': `Bearer ${token}` }
                });

                if (response.ok) {
                    const stats = await response.json();

                    // Update tab counts
                    const allCountEl = document.getElementById('doc-count-all');
                    const ownCountEl = document.getElementById('doc-count-own');
                    const tutorCountEl = document.getElementById('doc-count-tutor');

                    if (allCountEl) allCountEl.textContent = stats.total_documents || 0;
                    if (ownCountEl) ownCountEl.textContent = stats.own_documents || 0;
                    if (tutorCountEl) tutorCountEl.textContent = stats.tutor_documents || 0;
                }
            } catch (error) {
                console.error('[Documents] Error loading stats:', error);
            }
        }

        // Render documents to the grid
        function renderStudentDocuments() {
            const grid = document.getElementById('student-docs-grid');
            const emptyState = document.getElementById('student-docs-empty-state');

            if (!grid) return;

            // Clear existing cards (except empty state)
            const existingCards = grid.querySelectorAll('.document-card');
            existingCards.forEach(card => card.remove());

            // Filter documents based on current filter
            let filteredDocs = allStudentDocuments;
            if (currentStudentDocFilter !== 'all') {
                filteredDocs = allStudentDocuments.filter(doc => {
                    if (currentStudentDocFilter === 'pdf') {
                        return doc.file_type?.toLowerCase().includes('pdf');
                    }
                    return doc.document_type === currentStudentDocFilter;
                });
            }

            // Show/hide empty state
            if (filteredDocs.length === 0) {
                if (emptyState) emptyState.classList.remove('hidden');
                return;
            }
            if (emptyState) emptyState.classList.add('hidden');

            // Render each document
            filteredDocs.forEach(doc => {
                const card = createStudentDocCard(doc);
                grid.appendChild(card);
            });
        }

        // Create a document card
        function createStudentDocCard(doc) {
            const card = document.createElement('div');
            card.className = 'document-card card p-6 hover:shadow-lg transition';
            card.dataset.id = doc.id;

            const icon = getDocumentIcon(doc.file_type || doc.document_type);
            const formattedDate = doc.created_at ? new Date(doc.created_at).toLocaleDateString() : 'N/A';
            const fileSize = doc.file_size ? formatFileSize(doc.file_size) : 'N/A';
            const isOwnDoc = doc.is_own_document !== false;
            const tutorName = doc.tutor_name || 'Tutor';

            // Only show edit/delete menu for own documents
            const menuHtml = isOwnDoc ? `
                <div class="relative">
                    <button class="text-gray-500 hover:text-gray-700 p-2" onclick="toggleStudentDocMenu(${doc.id})">
                        <i class="fas fa-ellipsis-v"></i>
                    </button>
                    <div id="student-doc-menu-${doc.id}" class="hidden absolute right-0 mt-2 w-32 bg-white rounded-lg shadow-lg border z-10">
                        <button onclick="editStudentDoc(${doc.id})" class="w-full text-left px-4 py-2 hover:bg-gray-100 text-sm">
                            <i class="fas fa-edit mr-2"></i>Edit
                        </button>
                        <button onclick="deleteStudentDoc(${doc.id})" class="w-full text-left px-4 py-2 hover:bg-red-50 text-red-600 text-sm">
                            <i class="fas fa-trash mr-2"></i>Delete
                        </button>
                    </div>
                </div>
            ` : '';

            // Show tutor badge for tutor documents
            const sourceBadge = isOwnDoc
                ? `<span class="text-xs px-2 py-1 bg-green-100 text-green-700 rounded-full">My Document</span>`
                : `<span class="text-xs px-2 py-1 bg-blue-100 text-blue-700 rounded-full">From: ${escapeHtml(tutorName)}</span>`;

            card.innerHTML = `
                <div class="flex items-start justify-between mb-4">
                    <div class="text-5xl">${icon}</div>
                    ${menuHtml}
                </div>
                <h3><a href="${doc.document_url || '#'}" target="_blank" class="text-lg font-bold mb-2 hover:text-blue-600 cursor-pointer block">${escapeHtml(doc.title)}</a></h3>
                <p class="text-sm text-gray-600 mb-2">${doc.file_type?.toUpperCase() || 'Document'} ‚Ä¢ ${fileSize}</p>
                ${doc.description ? `<p class="text-sm text-gray-500 mb-3 line-clamp-2">${escapeHtml(doc.description)}</p>` : ''}
                <div class="flex flex-wrap gap-1 mb-3">
                    ${doc.document_type ? `<span class="text-xs px-2 py-1 bg-purple-100 text-purple-700 rounded-full">${doc.document_type}</span>` : ''}
                    ${sourceBadge}
                </div>
                <div class="flex items-center justify-between text-xs text-gray-500">
                    <span>Uploaded: ${formattedDate}</span>
                </div>
            `;

            return card;
        }

        // Get document icon based on file type
        function getDocumentIcon(fileType) {
            const type = (fileType || '').toLowerCase();
            if (type.includes('pdf')) return 'üìÑ';
            if (type.includes('doc') || type.includes('word')) return 'üìù';
            if (type.includes('ppt') || type.includes('presentation')) return 'üìä';
            if (type.includes('xls') || type.includes('excel')) return 'üìà';
            if (type.includes('image') || type.includes('jpg') || type.includes('png')) return 'üñºÔ∏è';
            return 'üìÅ';
        }

        // Format file size
        function formatFileSize(bytes) {
            if (!bytes) return 'N/A';
            const sizes = ['Bytes', 'KB', 'MB', 'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(1024));
            return parseFloat((bytes / Math.pow(1024, i)).toFixed(2)) + ' ' + sizes[i];
        }

        // Toggle document menu
        function toggleStudentDocMenu(docId) {
            // Close all other menus
            document.querySelectorAll('[id^="student-doc-menu-"]').forEach(menu => {
                if (menu.id !== `student-doc-menu-${docId}`) {
                    menu.classList.add('hidden');
                }
            });
            // Toggle this menu
            const menu = document.getElementById(`student-doc-menu-${docId}`);
            if (menu) {
                menu.classList.toggle('hidden');
            }
        }

        // Filter documents
        function filterStudentDocs(filter) {
            currentStudentDocFilter = filter;

            // Update button styles
            document.querySelectorAll('.student-doc-filter').forEach(btn => {
                btn.classList.remove('bg-blue-500', 'text-white');
                btn.classList.add('bg-gray-200');
            });
            event.target.closest('.student-doc-filter').classList.remove('bg-gray-200');
            event.target.closest('.student-doc-filter').classList.add('bg-blue-500', 'text-white');

            renderStudentDocuments();
        }

        // Update filter counts
        function updateStudentDocFilterCounts() {
            const counts = {
                all: allStudentDocuments.length,
                pdf: allStudentDocuments.filter(d => d.file_type?.toLowerCase().includes('pdf')).length,
                notes: allStudentDocuments.filter(d => d.document_type === 'notes').length,
                assignments: allStudentDocuments.filter(d => d.document_type === 'assignments').length,
                'study-guides': allStudentDocuments.filter(d => d.document_type === 'study-guides').length,
                other: allStudentDocuments.filter(d => !['notes', 'assignments', 'study-guides'].includes(d.document_type)).length
            };

            Object.keys(counts).forEach(key => {
                const el = document.getElementById(`filter-count-${key}`);
                if (el) el.textContent = counts[key];
            });
        }

        // Search documents
        function searchStudentDocuments(query) {
            const searchLower = query.toLowerCase();
            const grid = document.getElementById('student-docs-grid');
            const cards = grid.querySelectorAll('.document-card');

            cards.forEach(card => {
                const title = card.querySelector('h3')?.textContent.toLowerCase() || '';
                const desc = card.querySelector('.text-gray-500')?.textContent.toLowerCase() || '';
                if (title.includes(searchLower) || desc.includes(searchLower)) {
                    card.classList.remove('hidden');
                } else {
                    card.classList.add('hidden');
                }
            });
        }

        // Sort documents
        function sortStudentDocuments(sortBy) {
            currentStudentDocSort = sortBy;
            allStudentDocuments.sort((a, b) => {
                switch(sortBy) {
                    case 'title':
                        return (a.title || '').localeCompare(b.title || '');
                    case 'subject':
                        return (a.subject || '').localeCompare(b.subject || '');
                    case 'category':
                        return (a.document_type || '').localeCompare(b.document_type || '');
                    case 'upload_date':
                    default:
                        return new Date(b.created_at) - new Date(a.created_at);
                }
            });
            renderStudentDocuments();
        }

        // Folder functions
        function searchStudentFolders(query) {
            console.log('Searching folders:', query);
            // TODO: Implement folder search
        }

        function createStudentFolder() {
            const folderName = prompt('Enter folder name:');
            if (folderName) {
                console.log('Creating folder:', folderName);
                alert('Folder created: ' + folderName);
                // TODO: Implement folder creation API call
            }
        }

        function openStudentFolder(folderName) {
            console.log('Opening folder:', folderName);
            currentStudentFolder = folderName;
            // Switch to documents view and filter by folder/subject
            switchStudentDocsViewTab('documents');
            // TODO: Filter documents by folder
        }

        function renameStudentFolder(folderName) {
            const newName = prompt('Enter new folder name:', folderName);
            if (newName && newName !== folderName) {
                console.log('Renaming folder:', folderName, 'to', newName);
                // TODO: Implement folder rename
            }
        }

        function deleteStudentFolder(folderName) {
            if (confirm(`Are you sure you want to delete the folder "${folderName}"?`)) {
                console.log('Deleting folder:', folderName);
                // TODO: Implement folder deletion
            }
        }

        // Document CRUD operations
        // Uses /api/teaching-documents which operates on the 'documents' table (teaching materials)
        function openUploadStudentDocModal() {
            // TODO: Implement upload modal that posts to /api/teaching-documents/upload
            alert('Upload document modal coming soon!\n\nThis will upload teaching materials (PDFs, worksheets, notes) to the documents table via /api/teaching-documents/upload endpoint.');
        }

        function editStudentDoc(docId) {
            console.log('Editing document:', docId);
            // TODO: Implement edit modal for teaching documents
        }

        async function deleteStudentDoc(docId) {
            if (!confirm('Are you sure you want to delete this document?')) {
                return;
            }

            const token = localStorage.getItem('token');
            if (!token) {
                alert('Please log in to delete documents');
                return;
            }

            try {
                // Uses /api/teaching-documents which operates on the 'documents' table
                const response = await fetch(`https://api.astegni.com/api/teaching-documents/${docId}`, {
                    method: 'DELETE',
                    headers: {
                        'Authorization': `Bearer ${token}`
                    }
                });

                if (response.ok) {
                    alert('Document deleted successfully!');
                    // Remove from cache and re-render
                    allStudentDocuments = allStudentDocuments.filter(d => d.id !== docId);
                    renderStudentDocuments();
                    updateStudentDocFilterCounts();
                } else {
                    const error = await response.json();
                    alert('Delete failed: ' + (error.detail || 'Unknown error'));
                }
            } catch (error) {
                console.error('Delete error:', error);
                alert('An error occurred while deleting. Please try again.');
            }
        }

        // Initialize documents panel when switched to
        function initializeDocumentsPanel() {
            console.log('[Documents Panel] Initializing...');
            loadStudentDocuments();
        }

        // Listen for panel switch to documents
        window.addEventListener('panelSwitch', (event) => {
            if (event.detail.panelName === 'documents') {
                initializeDocumentsPanel();
            }
        });

        // ============================================
        //   MY REQUESTS PANEL - FILTER FUNCTIONS
        // ============================================

        // Filter functions are now in js/student-profile/global-functions.js:
        // - filterStudentRequestType(type) - loads courses, schools, tutors, or parenting requests
        // - filterStudentRequestStatus(status) - filters by pending, accepted/verified, rejected
        // - loadStudentCourseRequests() - fetches from /api/student/my-course-requests
        // - loadStudentSchoolRequests() - fetches from /api/student/my-school-requests
        // - loadStudentTutorRequests() - fetches from /api/session-requests/my-requests
        // - loadStudentParentingInvitations() - fetches from /api/parent/pending-invitations
        // - loadStudentRequestCounts() - fetches badge counts from /api/student/my-requests/counts

        // Initialize requests panel on load
        document.addEventListener('DOMContentLoaded', function() {
            // Check if my-requests-panel exists
            const requestsPanel = document.getElementById('my-requests-panel');
            if (requestsPanel) {
                // Load initial requests when panel becomes visible
                const observer = new MutationObserver(function(mutations) {
                    mutations.forEach(function(mutation) {
                        if (!requestsPanel.classList.contains('hidden')) {
                            // Load counts for all request types
                            if (typeof loadStudentRequestCounts === 'function') {
                                loadStudentRequestCounts();
                            }
                            // Load current type (defaults to 'courses')
                            if (typeof filterStudentRequestType === 'function') {
                                filterStudentRequestType(currentStudentRequestType || 'courses');
                            }
                        }
                    });
                });
                observer.observe(requestsPanel, { attributes: true, attributeFilter: ['class'] });
            }
        });
    </script>

    <!-- Chat Modal Container -->
    <div id="chat-modal-container"></div>

    <!-- View Request Modal Container (loaded dynamically) -->
    <div id="view-request-modal-container"></div>

    <!-- Notes Modal Container (loaded dynamically) -->
    <div id="notes-modal-container"></div>

    <!-- Load Chat Modal HTML -->
    <script>
        fetch('../modals/common-modals/chat-modal.html')
            .then(response => response.text())
            .then(html => {
                document.getElementById('chat-modal-container').innerHTML = html;
                console.log('‚úÖ Chat Modal loaded');
                // Initialize ChatModalManager after DOM is ready
                if (typeof ChatModalManager !== 'undefined') {
                    ChatModalManager.init();
                    console.log('‚úÖ ChatModalManager initialized');
                }
            })
            .catch(error => console.error('Failed to load chat-modal:', error));

        // Load view-request-modal HTML dynamically
        fetch('../modals/common-modals/view-request-modal.html')
            .then(response => response.text())
            .then(html => {
                document.getElementById('view-request-modal-container').innerHTML = html;
                console.log('‚úÖ View Request Modal loaded for student-profile');
            })
            .catch(error => console.error('Failed to load view-request-modal:', error));
    </script>

    <!-- Settings Panel Modal Scripts -->
    <script src="../js/tutor-profile/settings-panel-personal-verification.js"></script>
    <script src="../js/tutor-profile/payment-method-modal.js"></script>
    <script src="../js/tutor-profile/leave-astegni-modal.js"></script>
    <script src="../js/common-modals/settings-manager.js"></script>
    <script src="../js/common-modals/review-astegni-manager.js"></script>

    <!-- Load Settings Modals HTML -->
    <script>
        // Load verify-personal-info-modal
        fetch('../modals/common-modals/verify-personal-info-modal.html')
            .then(response => response.text())
            .then(html => {
                let container = document.getElementById('modal-container');
                if (!container) {
                    container = document.createElement('div');
                    container.id = 'modal-container';
                    document.body.appendChild(container);
                }
                container.insertAdjacentHTML('beforeend', html);
                console.log('[OK] Verify Personal Info Modal loaded');
            })
            .catch(error => console.error('Failed to load verify-personal-info-modal:', error));

        // Load payment-method-modal
        fetch('../modals/common-modals/payment-method-modal.html')
            .then(response => response.text())
            .then(html => {
                let container = document.getElementById('modal-container');
                if (!container) {
                    container = document.createElement('div');
                    container.id = 'modal-container';
                    document.body.appendChild(container);
                }
                container.insertAdjacentHTML('beforeend', html);
                console.log('[OK] Payment Method Modal loaded');
            })
            .catch(error => console.error('Failed to load payment-method-modal:', error));

        // Load leave-astegni-modal
        fetch('../modals/common-modals/leave-astegni-modal.html')
            .then(response => response.text())
            .then(html => {
                let container = document.getElementById('modal-container');
                if (!container) {
                    container = document.createElement('div');
                    container.id = 'modal-container';
                    document.body.appendChild(container);
                }
                container.insertAdjacentHTML('beforeend', html);
                console.log('[OK] Leave Astegni Modal loaded');
            })
            .catch(error => console.error('Failed to load leave-astegni-modal:', error));

        // Load review-astegni-modal
        fetch('../modals/common-modals/review-astegni-modal.html')
            .then(response => response.text())
            .then(html => {
                let container = document.getElementById('modal-container');
                if (!container) {
                    container = document.createElement('div');
                    container.id = 'modal-container';
                    document.body.appendChild(container);
                }
                container.insertAdjacentHTML('beforeend', html);
                console.log('[OK] Review Astegni Modal loaded');
            })
            .catch(error => console.error('Failed to load review-astegni-modal:', error));
    </script>

    <!-- jsPDF for PDF Export in Notes -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

    <!-- Advanced Notes Manager -->
    <script src="../js/common-modals/advanced-notes.js"></script>

    <!-- Load Notes Modal HTML -->
    <script>
        fetch('../modals/common-modals/notes-modal.html')
            .then(response => response.text())
            .then(html => {
                document.getElementById('notes-modal-container').innerHTML = html;
                console.log('[OK] Notes Modal loaded');
                // Initialize NotesManager after modal is loaded
                if (typeof NotesManager !== 'undefined') {
                    NotesManager.init();
                    console.log('[OK] NotesManager initialized');
                }
            })
            .catch(error => console.error('Failed to load notes-modal:', error));
    </script>

    <!-- Deletion Countdown Banner (shows when user has pending role deletion) -->
    <script src="../js/common-modals/deletion-countdown-banner.js"></script>

    <!-- Ad Rotation Manager -->
    <script src="../js/common-modals/ad-rotation-manager.js"></script>

</body>

</html>

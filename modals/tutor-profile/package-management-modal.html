<!--
  Modal: package-management-modal
  Extracted from: tutor-profile.html
  Purpose: [Auto-extracted modal component]
-->

<div id="package-management-modal" class="hidden">
        <div class="modal-overlay" onclick="closePackageModal()"></div>
        <div class="modal-content package-modal-redesigned">
            <div class="modal-header">
                <button class="package-sidebar-toggle" onclick="togglePackageSidebar()"
                    aria-label="Toggle package sidebar"
                    title="Toggle Sidebar">
                    <i class="fas fa-bars"></i>
                </button>
                <div class="modal-title-container">
                    <h2 class="modal-title" id="modalTitle">ðŸ“¦ Package Management</h2>
                    <p class="modal-subtitle" id="modalSubtitle" style="display: none; margin: 0.5rem 0 0 0; font-size: 0.9rem; font-weight: 400; opacity: 0.9;"></p>
                </div>
                <div class="modal-header-actions">
                    <button class="calculator-toggle-btn" onclick="toggleCalculatorWidget()"
                        aria-label="Toggle Fee Calculator"
                        title="Toggle Fee Calculator">
                        <i class="fas fa-calculator"></i>
                    </button>
                    <button class="modal-close" onclick="closePackageModal()">Ã—</button>
                </div>
            </div>

            <div class="package-layout">
                <!-- Sidebar Backdrop (for mobile overlay) -->
                <div class="sidebar-backdrop" id="sidebarBackdrop" onclick="togglePackageSidebar()"></div>

                <!-- LEFT SIDEBAR: VS Code Style with Icon Bar + Content -->
                <div class="package-sidebar" id="packageSidebar">
                    <!-- Icon Bar -->
                    <div class="sidebar-icon-bar">
                        <button class="sidebar-icon-btn active" data-panel="packages" title="My Packages" onclick="switchPackagePanel('packages')">
                            <i class="fas fa-box"></i>
                        </button>
                        <div style="width: 100%; height: 1px; background: rgba(255, 255, 255, 0.1); margin: 0.5rem 0;"></div>
                        <button class="sidebar-icon-btn" data-panel="market-trend" title="Market Trends" onclick="switchPackagePanel('market-trend')">
                            <i class="fas fa-chart-line"></i>
                        </button>
                    </div>

                    <!-- Collapsible Content Area -->
                    <div class="sidebar-content" id="sidebarContent">
                        <!-- Packages Panel -->
                        <div class="sidebar-panel active" id="packagesPanel">
                            <div class="sidebar-header">
                                <h3>My Packages</h3>
                                <button class="btn-new-package" onclick="createNewPackage()">
                                    <i class="fas fa-plus"></i>
                                </button>
                            </div>
                            <div id="packagesList" class="packages-list">
                                <!-- Package items will be inserted here -->
                            </div>
                        </div>

                        <!-- Market Trend Panel - Removed, now handled by view toggle in main area -->
                    </div>
                </div>

                <!-- MAIN AREA: Package Details & Calculator -->
                <div class="package-main" id="packageEditorContainer">
                    <!-- Package Editor (default view) -->
                    <div id="packageEditor" class="package-editor">
                        <!-- Empty state or selected package details (JS will replace this) -->
                        <div class="empty-state">
                            <i class="fas fa-box-open"></i>
                            <h3>No Package Selected</h3>
                            <p>Select a package from the sidebar or create a new one</p>
                            <button class="btn-create-first" onclick="createNewPackage()">
                                <i class="fas fa-plus mr-2"></i>Create Your First Package
                            </button>
                        </div>
                    </div>

                    <!-- Fee Calculator Widget (fixed position, available for package editor) -->
                    <div class="calculator-widget hidden" id="feeCalculatorWidget">
                        <div class="calculator-widget-header">
                            <i class="fas fa-calculator"></i>
                            <h4>Fee Calculator</h4>
                        </div>

                        <div class="calculator-widget-body">
                            <div class="calculator-inputs-row">
                                <div class="form-field">
                                    <label><i class="fas fa-calendar-week"></i> Days per Week</label>
                                    <input type="number" id="calcDays" value="3" min="1" max="7" oninput="updateCalculator()">
                                </div>
                                <div class="form-field">
                                    <label><i class="fas fa-clock"></i> Hours per Day</label>
                                    <input type="number" id="calcHours" value="1" min="1" max="24" oninput="updateCalculator()">
                                </div>
                            </div>

                            <div class="calculator-results" id="calculatorResults">
                                <!-- Results will be dynamically inserted here -->
                                <div style="text-align: center; padding: 2rem; color: var(--text-secondary);">
                                    <i class="fas fa-info-circle" style="font-size: 2rem; margin-bottom: 1rem; opacity: 0.5;"></i>
                                    <p>Select or create a package to see fee calculations</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- End of .package-main (Package Editor Container) -->

                <!-- MARKET TRENDS AREA: Full-width visualization (hidden by default) -->
                <div id="marketTrendView" class="market-trend-view" style="display: none;">

                        <div class="market-trend-content">

                            <!-- View Selection Cards -->
                            <div class="market-view-cards" id="marketViewCards">
                                <div class="market-view-card active" data-type="line" onclick="changeGraphType('line')">
                                    <div class="market-view-card-icon">
                                        <i class="fas fa-chart-line"></i>
                                    </div>
                                    <div class="market-view-card-content">
                                        <h4 class="market-view-card-title">Line Graph</h4>
                                        <p class="market-view-card-description">Visualize pricing trends over time</p>
                                    </div>
                                </div>

                                <div class="market-view-card" data-type="bar" onclick="changeGraphType('bar')">
                                    <div class="market-view-card-icon">
                                        <i class="fas fa-chart-bar"></i>
                                    </div>
                                    <div class="market-view-card-content">
                                        <h4 class="market-view-card-title">Bar Graph</h4>
                                        <p class="market-view-card-description">Compare metrics side-by-side</p>
                                    </div>
                                </div>

                                <div class="market-view-card" data-type="table" onclick="changeGraphType('table')">
                                    <div class="market-view-card-icon">
                                        <i class="fas fa-table"></i>
                                    </div>
                                    <div class="market-view-card-content">
                                        <h4 class="market-view-card-title">Data Table</h4>
                                        <p class="market-view-card-description">View detailed numerical data</p>
                                    </div>
                                </div>

                                <div class="market-view-card" data-type="price" onclick="changeGraphType('price')">
                                    <div class="market-view-card-icon">
                                        <i class="fas fa-tag"></i>
                                    </div>
                                    <div class="market-view-card-content">
                                        <h4 class="market-view-card-title">Suggest My Price</h4>
                                        <p class="market-view-card-description">Get AI-powered price recommendations</p>
                                    </div>
                                </div>
                            </div>

                            <!-- Pricing Trends Container (Graph + Table) -->
                            <div id="pricingTrendsContainer" class="market-main-container">

                                <!-- Graph View -->
                                <div id="marketGraphContainer" class="market-view-container">
                                    <div class="market-controls">
                                    <div class="market-control-group" style="flex: 1; max-width: 100%;">
                                        <label class="market-control-label">
                                            Time Period (Months): <span id="graphTimeValue" class="market-time-value">3</span>
                                        </label>
                                        <input type="range" id="graphTimePeriod" min="1" max="12" step="1" value="3"
                                               oninput="updateMarketTimePeriodOnly(this.value)" class="market-time-slider">
                                    </div>
                                    <button class="btn-update-graph" onclick="updateMarketGraph()" style="padding: 0.75rem 1.5rem; background: var(--primary-color); color: white; border: none; border-radius: 8px; font-size: 1rem; font-weight: 600; cursor: pointer; transition: all 0.3s; display: flex; align-items: center; gap: 0.5rem; margin-top: 1rem;">
                                        <i class="fas fa-chart-line"></i> Update Graph
                                    </button>
                                </div>
                                <div id="marketSpinner" class="market-spinner"></div>
                                <canvas id="marketChart" class="market-chart hidden"></canvas>
                                <div class="market-dataset-toggles">
                                    <label class="market-dataset-label">
                                        <input type="checkbox" checked data-dataset="0" onchange="toggleMarketDataset(this)" class="market-checkbox">
                                        No. of Tutors
                                    </label>
                                    <label class="market-dataset-label">
                                        <input type="checkbox" checked data-dataset="1" onchange="toggleMarketDataset(this)" class="market-checkbox">
                                        Avg Students
                                    </label>
                                    <label class="market-dataset-label">
                                        <input type="checkbox" checked data-dataset="2" onchange="toggleMarketDataset(this)" class="market-checkbox">
                                        Avg Achievement
                                    </label>
                                    <label class="market-dataset-label">
                                        <input type="checkbox" checked data-dataset="3" onchange="toggleMarketDataset(this)" class="market-checkbox">
                                        Avg Price
                                    </label>
                                    <label class="market-dataset-label">
                                        <input type="checkbox" checked data-dataset="4" onchange="toggleMarketDataset(this)" class="market-checkbox">
                                        Avg Certifications
                                    </label>
                                    <label class="market-dataset-label">
                                        <input type="checkbox" checked data-dataset="5" onchange="toggleMarketDataset(this)" class="market-checkbox">
                                        Avg Experience
                                    </label>
                                </div>
                            </div>

                            <!-- Table View -->
                            <div id="marketTableContainer" class="market-view-container hidden">
                                <div class="market-controls">
                                    <div class="market-control-group">
                                        <label class="market-control-label">
                                            Time Period (Months): <span id="tableTimeValue" class="market-time-value">3</span>
                                        </label>
                                        <input type="range" id="tableTimePeriod" min="1" max="12" step="1" value="3"
                                               oninput="updateMarketTimePeriodOnly(this.value)" class="market-time-slider">
                                    </div>
                                    <button class="btn-update-table" onclick="populateMarketTable()" style="padding: 0.75rem 1.5rem; background: var(--primary-color); color: white; border: none; border-radius: 8px; font-size: 1rem; font-weight: 600; cursor: pointer; transition: all 0.3s; display: flex; align-items: center; gap: 0.5rem; margin-top: 1rem;">
                                        <i class="fas fa-table"></i> Update Table
                                    </button>
                                </div>
                                <div class="market-table-wrapper">
                                    <table class="market-table">
                                        <thead>
                                            <tr>
                                                <th>Rating</th>
                                                <th>No. of Tutors</th>
                                                <th>Avg Students</th>
                                                <th>
                                                    Avg Achievement (%)
                                                    <span class="market-tooltip">
                                                        <i class="fas fa-info-circle"></i>
                                                        <span class="market-tooltip-text">Average percentage improvement or decline in student exam results for tutors with this rating.</span>
                                                    </span>
                                                </th>
                                                <th>
                                                    Avg Certifications
                                                    <span class="market-tooltip">
                                                        <i class="fas fa-info-circle"></i>
                                                        <span class="market-tooltip-text">Average number of teaching certifications held by tutors with this rating.</span>
                                                    </span>
                                                </th>
                                                <th>
                                                    Avg Experience (Years)
                                                    <span class="market-tooltip">
                                                        <i class="fas fa-info-circle"></i>
                                                        <span class="market-tooltip-text">Average years of tutoring experience for tutors with this rating.</span>
                                                    </span>
                                                </th>
                                                <th>Avg Price/Hour (ETB)</th>
                                            </tr>
                                        </thead>
                                        <tbody id="marketTableBody"></tbody>
                                    </table>
                                </div>
                            </div>

                            <!-- Price Suggestion View -->
                            <div id="marketPriceContainer" class="market-view-container market-price-green-bg hidden">
                                <div class="market-controls">
                                    <div class="market-control-group">
                                        <label class="market-control-label">
                                            Time Period (Months): <span id="priceTimeValue" class="market-time-value">3</span>
                                        </label>
                                        <input type="range" id="priceTimePeriod" min="1" max="12" step="1" value="3"
                                               oninput="updatePriceTimePeriod(this.value)" class="market-time-slider">
                                    </div>
                                    <button class="btn-calculate-price" onclick="suggestMarketPrice()" style="padding: 0.75rem 1.5rem; background: var(--primary-color); color: white; border: none; border-radius: 8px; font-size: 1rem; font-weight: 600; cursor: pointer; transition: all 0.3s; display: flex; align-items: center; gap: 0.5rem; margin-top: 1rem;">
                                        <i class="fas fa-calculator"></i> Calculate Price
                                    </button>
                                </div>
                                <div id="marketPriceResult" class="market-price-result-direct"></div>
                            </div>

                            </div>
                            <!-- End of #pricingTrendsContainer -->

                        </div>
                        <!-- End of .market-trend-content -->
                </div>
                <!-- End of #marketTrendView -->
            </div>
            <!-- End of .package-layout -->

            <div class="modal-footer">
                <button type="button" class="btn-secondary" onclick="closePackageModal()">Close</button>
                <button type="button" class="btn-primary" onclick="saveCurrentPackage()" id="savePackageBtn"
                    style="display: none;">
                    <i class="fas fa-save mr-2"></i>Save Package
                </button>
            </div>
        </div>
        <!-- End of .modal-content -->

        <!-- Calculator Widget Backdrop (for mobile/tablet overlay) -->
        <div class="calculator-widget-backdrop"></div>
    </div>

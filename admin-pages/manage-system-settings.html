<!DOCTYPE html>
<html lang="en" data-theme="light">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ASTEGNI - System Settings</title>
    <!-- TailwindCSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Custom Styles -->
    <link rel="stylesheet" href="./css/root.css">
    <link rel="stylesheet" href="./css/admin-profile/admin.css">
    <link rel="stylesheet" href="./css/admin-pages/shared/admin-layout-fix.css">
    <link rel="stylesheet" href="./css/admin-pages/manage-system-settings.css">
    <link rel="stylesheet" href="./css/admin-pages/manage-reviews.css">
    <!-- fab.css removed - not needed for admin pages -->
    <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">

    <!-- Inline styles to ensure right-side widget positioning -->
    <style>
        .admin-main-layout {
            display: flex !important;
            gap: 1.5rem !important;
        }

        .admin-content-area {
            flex: 1 !important;
        }

        .admin-right-widgets {
            width: 320px !important;
            flex-shrink: 0 !important;
        }
    </style>
</head>

<body class="font-sans">

    <!-- Navigation -->
    <nav class="admin-nav p-4 sticky top-0 z-50" role="navigation" aria-label="Main navigation">
        <div class="container mx-auto flex justify-between items-center">
            <!-- Left: Hamburger + Logo -->
            <div class="nav-left flex items-center gap-4">
                <span class="hamburger" id="hamburger">
                    <span></span>
                    <span></span>
                    <span></span>
                </span>
                <a href="manage-system-settings.html" class="logo-container">
                    <div class="logo-text">
                        <span class="logo-main">Astegni</span>
                        <span class="logo-sub">System Settings</span>
                    </div>
                    <span class="logo-badge">Beta</span>
                </a>
            </div>

            <!-- Center: Live Clock -->
            <div class="nav-center">
                <div class="live-clock">
                    <span id="current-time" class="time">--:--:--</span>
                    <span id="current-date" class="date">Loading...</span>
                </div>
            </div>

            <!-- Right: Home, Theme, User Controls -->
            <div class="header-right">
                <!-- Home Icon Link -->
                <a href="index.html" class="icon-button" title="Go to Admin Home">
                    <i class="fas fa-home"></i>
                </a>

                <!-- Theme Toggle (always visible) -->
                <button id="theme-toggle" class="icon-button" onclick="toggleTheme()">
                    <span class="theme-icon">
                        <i class="fas fa-moon" id="moon-icon"></i>
                        <i class="fas fa-sun" id="sun-icon" style="display: none;"></i>
                    </span>
                </button>

                <!-- User Controls (hidden by default, shown when logged in) -->
                <div class="user-controls" id="user-controls" style="display: none;">
                    <!-- Notification Icon -->
                    <button class="icon-button notification-button" onclick="openNotificationModal()">
                        <i class="fas fa-bell"></i>
                        <span class="badge notification-count-badge">5</span>
                    </button>

                    <!-- Profile container -->
                    <div id="profile-container" class="profile-dropdown-container">
                        <button id="profile-dropdown-toggle" class="profile-dropdown-toggle"
                            onclick="toggleProfileDropdown()">
                            <img id="profile-pic" class="profile-pic"
                                 src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='100' height='100' viewBox='0 0 100 100'%3E%3Ccircle cx='50' cy='50' r='50' fill='%234F46E5'/%3E%3Ctext x='50' y='50' text-anchor='middle' dy='.3em' fill='white' font-size='40' font-family='Arial'%3EA%3C/text%3E%3C/svg%3E"
                                 alt="Profile">
                            <span id="profile-name" class="profile-name">Guest</span>
                            <svg class="dropdown-arrow" width="12" height="12" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd"
                                    d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z"
                                    clip-rule="evenodd"></path>
                            </svg>
                        </button>

                        <div id="profile-dropdown-menu" class="profile-dropdown-menu hidden">
                            <!-- User info header -->
                            <a href="javascript:void(0)" id="dropdown-profile-link" class="dropdown-header-link">
                                <div class="dropdown-header">
                                    <img id="dropdown-profile-pic" class="profile-pic"
                                         src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='100' height='100' viewBox='0 0 100 100'%3E%3Ccircle cx='50' cy='50' r='50' fill='%234F46E5'/%3E%3Ctext x='50' y='50' text-anchor='middle' dy='.3em' fill='white' font-size='40' font-family='Arial'%3EA%3C/text%3E%3C/svg%3E"
                                         alt="Profile">
                                    <div class="dropdown-user-info">
                                        <span id="dropdown-user-name" class="dropdown-user-name"></span>
                                        <span id="dropdown-user-email" class="dropdown-user-email"></span>
                                        <span id="dropdown-user-role" class="dropdown-user-role"></span>
                                    </div>
                                    <svg class="dropdown-header-arrow" width="16" height="16" fill="currentColor" viewBox="0 0 20 20">
                                        <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                                    </svg>
                                </div>
                            </a>

                            <div class="dropdown-divider"></div>

                            <!-- Department switcher -->
                            <div id="department-switcher-section" class="department-switcher-section hidden">
                                <div class="dropdown-item-header">Your Departments</div>
                                <div id="department-options" class="department-options"></div>
                                <div class="dropdown-divider"></div>
                            </div>

                            <!-- Add Department button -->
                            <button class="dropdown-item" onclick="openAddDepartmentModal()">
                                <i class="fas fa-plus-circle"></i>
                                <span>Add Department Role</span>
                            </button>

                            <div class="dropdown-divider"></div>

                            <button class="dropdown-item logout-item" onclick="openLogoutModal()">
                                <i class="fas fa-sign-out-alt dropdown-icon"></i>
                                Logout
                            </button>
                        </div>
                    </div>
                </div><!-- /user-controls -->
            </div>
        </div>
    </nav>

    <!-- Sidebar -->
    <aside id="sidebar" class="sidebar-container">
        <div class="sidebar-content">
            <div class="sidebar-nav">
                <h3>System Settings</h3>
                <span class="sidebar-close" id="sidebar-close">&times;</span>

                <a href="#" onclick="switchPanel('dashboard'); return false;" class="sidebar-link active">
                    <span class="sidebar-icon">üè†</span>
                    <span>Dashboard</span>
                </a>
                <a href="#" onclick="switchPanel('credentials'); return false;" class="sidebar-link">
                    <span class="sidebar-icon">üéì</span>
                    <span>Credentials</span>
                </a>
                <hr class="my-4 border-gray-300">
                <a href="#" onclick="switchPanel('general'); return false;" class="sidebar-link">
                    <span class="sidebar-icon">‚öôÔ∏è</span>
                    <span>General Settings</span>
                </a>
                <a href="#" onclick="switchPanel('email'); return false;" class="sidebar-link">
                    <span class="sidebar-icon">üìß</span>
                    <span>Email Configuration</span>
                </a>
                <a href="#" onclick="switchPanel('media'); return false;" class="sidebar-link">
                    <span class="sidebar-icon">üñºÔ∏è</span>
                    <span>Media Management</span>
                </a>
                <a href="#" onclick="switchPanel('pricing'); return false;" class="sidebar-link">
                    <span class="sidebar-icon">üí∞</span>
                    <span>Pricing Management</span>
                </a>
                <a href="#" onclick="switchPanel('api'); return false;" class="sidebar-link">
                    <span class="sidebar-icon">üîå</span>
                    <span>API & Integrations</span>
                </a>
                <a href="#" onclick="switchPanel('sms'); return false;" class="sidebar-link">
                    <span class="sidebar-icon">üì±</span>
                    <span>SMS Configuration</span>
                </a>
                <hr class="my-4 border-gray-300">
                <a href="#" onclick="switchPanel('security'); return false;" class="sidebar-link">
                    <span class="sidebar-icon">üîí</span>
                    <span>Security & Privacy</span>
                </a>
                <a href="#" onclick="switchPanel('backup'); return false;" class="sidebar-link">
                    <span class="sidebar-icon">üíæ</span>
                    <span>Backup & Restore</span>
                </a>
                <a href="#" onclick="switchPanel('maintenance'); return false;" class="sidebar-link">
                    <span class="sidebar-icon">üöß</span>
                    <span>Maintenance Mode</span>
                </a>
                <a href="#" onclick="switchPanel('performance'); return false;" class="sidebar-link">
                    <span class="sidebar-icon">‚ö°</span>
                    <span>Performance Monitor</span>
                </a>
                <hr class="my-4 border-gray-300">
                <a href="#" onclick="switchPanel('impressions'); return false;" class="sidebar-link">
                    <span class="sidebar-icon">üìä</span>
                    <span>Impressions</span>
                </a>
                <a href="#" onclick="switchPanel('reports'); return false;" class="sidebar-link">
                    <span class="sidebar-icon">üìà</span>
                    <span>View Reports</span>
                </a>
                <a href="#" onclick="switchPanel('logs'); return false;" class="sidebar-link">
                    <span class="sidebar-icon">üìã</span>
                    <span>System Logs</span>
                </a>
                <a href="#" onclick="switchPanel('manage-reviews'); return false;" class="sidebar-link">
                    <span class="sidebar-icon">‚≠ê</span>
                    <span>Manage Reviews</span>
                </a>
                <hr class="my-4 border-gray-300">
                <a href="#" onclick="switchPanel('portfolio'); return false;" class="sidebar-link">
                    <span class="sidebar-icon">üìÅ</span>
                    <span>Portfolio</span>
                </a>
                <a href="#" onclick="switchPanel('settings'); return false;" class="sidebar-link">
                    <span class="sidebar-icon">‚öôÔ∏è</span>
                    <span>Settings</span>
                </a>
                <!-- Logout Button at Bottom -->
                <div class="mt-auto pt-4 border-t border-gray-300">
                    <a href="#" onclick="logout(); return false;" class="sidebar-link text-red-500 hover:bg-red-50">
                        <span class="sidebar-icon">üö™</span>
                        <span>Logout</span>
                    </a>
                </div>
            </div>
        </div>
    </aside>

    <!-- Main Content -->
    <section class="py-8">
        <div class="container mx-auto px-4">
            <!-- Main Content with Widgets -->
            <div class="flex gap-6">
                <!-- Left Content Area -->
                <div class="flex-1">
                    <!-- Panels Section -->
                    <div class="panels-container">
                        <!-- Dashboard Panel (Default) -->
                        <div id="dashboard-panel" class="panel-content active">

                            <!-- Profile Header Section (Only visible in Dashboard) -->
                            <section class="profile-header-section mb-8">
                                <div class="cover-image-container relative">
                                    <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='1200' height='300'%3E%3Crect width='1200' height='300' fill='%23e5e7eb'/%3E%3Ctext x='50%25' y='50%25' text-anchor='middle' dy='.3em' fill='%239ca3af' font-family='sans-serif' font-size='20'%3E1200x300%3C/text%3E%3C/svg%3E"
                                        alt="Cover" class="cover-img">
                                    <div class="cover-overlay"></div>
                                    <!-- Cover Upload Button -->
                                    <button onclick="openUploadCoverModal()" class="cover-upload-btn">
                                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                d="M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z">
                                            </path>
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                d="M15 13a3 3 0 11-6 0 3 3 0 016 0z"></path>
                                        </svg>
                                    </button>
                                </div>

                                <div class="profile-main-info">
                                    <div class="profile-info-wrapper">
                                        <div class="profile-avatar-container">
                                            <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='150' height='150'%3E%3Crect width='150' height='150' fill='%23e5e7eb'/%3E%3Ctext x='50%25' y='50%25' text-anchor='middle' dy='.3em' fill='%239ca3af' font-family='sans-serif' font-size='16'%3E150x150%3C/text%3E%3C/svg%3E"
                                                alt="Admin Profile" class="profile-avatar">
                                            <span class="online-indicator"></span>
                                            <!-- Profile Picture Upload Button -->
                                            <button onclick="openUploadProfileModal()" class="avatar-upload-btn">
                                                <svg class="w-4 h-4" fill="none" stroke="currentColor"
                                                    viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round"
                                                        stroke-width="2"
                                                        d="M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z">
                                                    </path>
                                                    <path stroke-linecap="round" stroke-linejoin="round"
                                                        stroke-width="2" d="M15 13a3 3 0 11-6 0 3 3 0 016 0z"></path>
                                                </svg>
                                            </button>
                                        </div>

                                        <div class="profile-details-section">
                                            <div class="profile-name-row">
                                                <h1 class="profile-name" id="adminUsername">Loading...</h1>
                                                <div class="badges-row">
                                                    <!-- Badges will be dynamically loaded from database -->
                                                </div>
                                            </div>

                                            <div class="rating-section">
                                                <div class="rating-wrapper">
                                                    <span class="rating-value">--</span>
                                                    <div class="rating-stars">‚òÜ‚òÜ‚òÜ‚òÜ‚òÜ</div>
                                                    <span class="rating-count">(Loading...)</span>
                                                    <div class="rating-label">Maximum Authority</div>
                                                </div>
                                            </div>

                                            <div class="profile-location">
                                                <span class="location-icon">üìç</span>
                                                <span>Loading...</span>
                                            </div>

                                            <div class="profile-quote">
                                                <span>"Loading profile data..."</span>
                                            </div>

                                            <div class="profile-actions">
                                                <button onclick="openEditProfileModal()" class="btn-primary">
                                                    <span class="mr-2">‚úèÔ∏è</span>
                                                    Edit Profile
                                                </button>
                                            </div>

                                            <!-- About Me Info -->
                                            <div class="profile-info-grid">
                                                <div class="info-item">
                                                    <span class="info-label">üìß Email:</span>
                                                    <span class="info-value" id="profileEmail">Loading...</span>
                                                </div>
                                                <div class="info-item">
                                                    <span class="info-label">üì± Phone:</span>
                                                    <span class="info-value" id="profilePhone">Loading...</span>
                                                </div>
                                                <div class="info-item">
                                                    <span class="info-label">Access Level:</span>
                                                    <span class="info-value" id="profileAccessLevel">Loading...</span>
                                                </div>
                                                <div class="info-item">
                                                    <span class="info-label">System ID:</span>
                                                    <span class="info-value" id="profileSystemId">Loading...</span>
                                                </div>
                                                <div class="info-item">
                                                    <span class="info-label">Last Login:</span>
                                                    <span class="info-value" id="profileLastLogin">Loading...</span>
                                                </div>
                                                <div class="info-description">
                                                    <p id="profileBio">Loading profile bio...
                                                    </p>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </section>

                            <!-- Page Header -->
                            <div class="mb-8 animate-fadeIn">
                                <h1 class="text-3xl font-bold mb-2">System Settings Dashboard</h1>
                                <p class="text-gray-600">Monitor and configure core system settings and platform
                                    parameters</p>
                            </div>

                            <!-- Achievements Section -->
                            <div class="card p-6 mb-8">
                                <h3 class="text-xl font-semibold mb-4">System Status</h3>
                                <div class="grid grid-cols-3 md:grid-cols-6 gap-4">
                                    <div class="text-center">
                                        <div class="text-3xl mb-2">‚úÖ</div>
                                        <div class="text-sm">System Online</div>
                                        <div class="text-xs text-gray-500">100% Uptime</div>
                                    </div>
                                    <div class="text-center">
                                        <div class="text-3xl mb-2">üõ°Ô∏è</div>
                                        <div class="text-sm">Security</div>
                                        <div class="text-xs text-gray-500">SSL Active</div>
                                    </div>
                                    <div class="text-center">
                                        <div class="text-3xl mb-2">‚ö°</div>
                                        <div class="text-sm">Performance</div>
                                        <div class="text-xs text-gray-500">Optimal</div>
                                    </div>
                                    <div class="text-center">
                                        <div class="text-3xl mb-2">üíæ</div>
                                        <div class="text-sm">Backup</div>
                                        <div class="text-xs text-gray-500">Daily Active</div>
                                    </div>
                                    <div class="text-center">
                                        <div class="text-3xl mb-2">üîÑ</div>
                                        <div class="text-sm">Updates</div>
                                        <div class="text-xs text-gray-500">Current</div>
                                    </div>
                                    <div class="text-center">
                                        <div class="text-3xl mb-2">üìä</div>
                                        <div class="text-sm">Monitoring</div>
                                        <div class="text-xs text-gray-500">24/7 Active</div>
                                    </div>
                                </div>
                            </div>


                            <!-- All Statistics Cards -->
                            <div class="dashboard-grid mb-8">
                                <!-- System Stats -->
                                <div class="card p-4">
                                    <h3 class="text-lg font-semibold">Pending Requests</h3>
                                    <p class="text-2xl font-bold text-yellow-600">0</p>
                                    <span class="text-sm text-gray-500">Awaiting review</span>
                                </div>
                                <div class="card p-4">
                                    <h3 class="text-lg font-semibold">Approval Rate</h3>
                                    <p class="text-2xl font-bold text-green-600">0%</p>
                                    <span class="text-sm text-gray-500">Overall rate</span>
                                </div>
                                <div class="card p-4">
                                    <h3 class="text-lg font-semibold">Avg Processing</h3>
                                    <p class="text-2xl font-bold text-blue-600">&lt; 24hrs</p>
                                    <span class="text-sm text-gray-500">Response time</span>
                                </div>
                                <div class="card p-4">
                                    <h3 class="text-lg font-semibold">Client Satisfaction</h3>
                                    <p class="text-2xl font-bold text-purple-600">0%</p>
                                    <span class="text-sm text-gray-500">User feedback</span>
                                </div>
                            </div>


                            <!-- System Activity Log -->
                            <div class="card p-6 mb-8">
                                <h3 class="text-xl font-semibold mb-4">Recent System Activity</h3>
                                <div class="space-y-4">
                                    <div class="border-l-4 border-blue-500 pl-4">
                                        <div class="flex justify-between items-start mb-2">
                                            <div>
                                                <h4 class="font-semibold">Database Backup Completed</h4>
                                                <p class="text-sm text-gray-600">Automated daily backup successful</p>
                                            </div>
                                            <span class="text-xs text-gray-500">2 hours ago</span>
                                        </div>
                                        <p class="text-gray-700">All data backed up to secure cloud storage. Size:
                                            24.5GB</p>
                                    </div>

                                    <div class="border-l-4 border-green-500 pl-4">
                                        <div class="flex justify-between items-start mb-2">
                                            <div>
                                                <h4 class="font-semibold">Security Scan Complete</h4>
                                                <p class="text-sm text-gray-600">No vulnerabilities detected</p>
                                            </div>
                                            <span class="text-xs text-gray-500">5 hours ago</span>
                                        </div>
                                        <p class="text-gray-700">System security scan completed successfully with no
                                            issues found.</p>
                                    </div>

                                    <div class="border-l-4 border-purple-500 pl-4">
                                        <div class="flex justify-between items-start mb-2">
                                            <div>
                                                <h4 class="font-semibold">API Rate Limit Updated</h4>
                                                <p class="text-sm text-gray-600">Configuration change</p>
                                            </div>
                                            <span class="text-xs text-gray-500">12 hours ago</span>
                                        </div>
                                        <p class="text-gray-700">API rate limits increased from 100 to 150 requests per
                                            minute.</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- General Settings Panel -->
                    <div id="general-panel" class="panel-content hidden">
                        <div class="mb-8">
                            <h1 class="text-3xl font-bold mb-2">General Settings</h1>
                            <p class="text-gray-600">Configure platform information and registration settings</p>
                        </div>
                        <div class="card p-6 mb-6">
                            <h3 class="text-xl font-bold mb-4">Platform Information</h3>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div>
                                    <label class="block mb-2 font-semibold">Site Name</label>
                                    <input type="text" id="platform-name" class="w-full p-2 border rounded-lg"
                                        placeholder="Astegni Educational Platform">
                                </div>
                                <div>
                                    <label class="block mb-2 font-semibold">Site URL</label>
                                    <input type="text" id="site-url" class="w-full p-2 border rounded-lg"
                                        placeholder="https://www.astegni.com">
                                </div>
                                <div>
                                    <label class="block mb-2 font-semibold">Site Tagline</label>
                                    <input type="text" id="platform-tagline" class="w-full p-2 border rounded-lg"
                                        placeholder="Quality Education for Everyone">
                                </div>
                                <div class="md:col-span-2">
                                    <label class="block mb-2 font-semibold">Platform Description</label>
                                    <textarea id="platform-description" class="w-full p-2 border rounded-lg" rows="3"
                                        placeholder="Enter platform description..."></textarea>
                                </div>
                                <div>
                                    <label class="block mb-2 font-semibold">Contact Phone</label>
                                    <div class="flex gap-2">
                                        <input type="phone" id="contact-phone" class="flex-1 p-2 border rounded-lg"
                                            placeholder="+251 911 234 567">
                                        <button onclick="addContactPhone()"
                                            class="px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 whitespace-nowrap">
                                            <i class="fas fa-plus mr-1"></i> Add Phone
                                        </button>
                                    </div>
                                    <div id="additional-phones" class="mt-2 space-y-2"></div>
                                </div>
                                <div>
                                    <label class="block mb-2 font-semibold">Email</label>
                                    <div class="flex gap-2">
                                        <input type="email" id="contact-email" class="flex-1 p-2 border rounded-lg"
                                            placeholder="contact@astegni.com">
                                        <button onclick="addContactEmail()"
                                            class="px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 whitespace-nowrap">
                                            <i class="fas fa-plus mr-1"></i> Add Email
                                        </button>
                                    </div>
                                    <div id="additional-emails" class="mt-2 space-y-2"></div>
                                </div>
                                <div>
                                    <label class="block mb-2 font-semibold">Default Language</label>
                                    <select class="w-full p-2 border rounded-lg">
                                        <option>English</option>
                                        <option>Amharic</option>
                                        <option>Oromo</option>
                                        <option>Tigrinya</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block mb-2 font-semibold">Timezone</label>
                                    <select class="w-full p-2 border rounded-lg">
                                        <option>Africa/Addis_Ababa (GMT+3)</option>
                                        <option>UTC</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <div class="card p-6 mb-6">
                            <h3 class="text-xl font-bold mb-4">Registration Settings</h3>
                            <div class="space-y-4">
                                <label class="flex items-center gap-3">
                                    <input type="checkbox" checked class="w-4 h-4">
                                    <span>Allow user registration</span>
                                </label>
                                <label class="flex items-center gap-3">
                                    <input type="checkbox" checked class="w-4 h-4">
                                    <span>Email verification required</span>
                                </label>
                                <label class="flex items-center gap-3">
                                    <input type="checkbox" checked class="w-4 h-4">
                                    <span>Phone verification required</span>
                                </label>
                                <label class="flex items-center gap-3">
                                    <input type="checkbox" checked class="w-4 h-4">
                                    <span>Allow social media login</span>
                                </label>
                            </div>
                        </div>

                        <div class="flex justify-end gap-3">
                            <button class="px-6 py-2 border rounded-lg hover:bg-gray-50">Reset to Default</button>
                            <button onclick="saveGeneralSettings()"
                                class="px-6 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600">Save
                                Changes</button>
                        </div>
                    </div>

                    <!-- Media Management Panel -->
                    <div id="media-panel" class="panel-content hidden">
                        <div class="mb-8">
                            <h1 class="text-3xl font-bold mb-2">Media Management</h1>
                            <p class="text-gray-600">Manage system images, videos, and media settings</p>
                        </div>

                        <!-- System Media Section -->
                        <div class="card p-6 mb-6" id="system-media-section">
                            <div class="flex items-center justify-between mb-4">
                                <div>
                                    <h3 class="text-xl font-bold">
                                        <i class="fas fa-photo-video mr-2 text-blue-600"></i>
                                        System Media
                                    </h3>
                                    <p class="text-sm text-gray-600">Manage system images and videos</p>
                                </div>
                                <button onclick="openSystemMediaUploadModal()"
                                    class="px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors">
                                    <i class="fas fa-plus mr-2"></i>Upload Media
                                </button>
                            </div>

                            <!-- Images and Videos Cards -->
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                                <!-- Images Card -->
                                <div class="media-type-card border-2 border-blue-200 rounded-xl p-6 bg-gradient-to-br from-blue-50 to-white hover:shadow-lg hover:border-blue-400 transition-all cursor-pointer"
                                    onclick="openImageGalleryModal()">
                                    <div class="flex items-center justify-between mb-4">
                                        <div class="w-14 h-14 rounded-xl bg-blue-100 flex items-center justify-center">
                                            <i class="fas fa-images text-2xl text-blue-600"></i>
                                        </div>
                                        <span id="system-images-count" class="px-3 py-1 bg-blue-100 text-blue-700 rounded-full text-sm font-semibold">0 images</span>
                                    </div>
                                    <h4 class="text-xl font-bold text-gray-800 mb-2">System Images</h4>
                                    <p class="text-sm text-gray-600 mb-4">Logos, banners, icons, backgrounds</p>
                                    <div class="flex items-center gap-2 text-xs text-gray-500">
                                        <i class="fas fa-file-image"></i>
                                        <span>PNG, JPG, GIF, SVG, WebP, ICO</span>
                                    </div>
                                    <!-- Image Thumbnails Preview -->
                                    <div id="system-images-preview" class="mt-4 flex gap-2 overflow-hidden">
                                        <!-- Thumbnails will be loaded dynamically -->
                                    </div>
                                </div>

                                <!-- Videos Card -->
                                <div class="media-type-card border-2 border-green-200 rounded-xl p-6 bg-gradient-to-br from-green-50 to-white hover:shadow-lg hover:border-green-400 transition-all cursor-pointer"
                                    onclick="openVideoGalleryModal()">
                                    <div class="flex items-center justify-between mb-4">
                                        <div class="w-14 h-14 rounded-xl bg-green-100 flex items-center justify-center">
                                            <i class="fas fa-video text-2xl text-green-600"></i>
                                        </div>
                                        <span id="system-videos-count" class="px-3 py-1 bg-green-100 text-green-700 rounded-full text-sm font-semibold">0 videos</span>
                                    </div>
                                    <h4 class="text-xl font-bold text-gray-800 mb-2">System Videos</h4>
                                    <p class="text-sm text-gray-600 mb-4">Intro videos, tutorials, promos</p>
                                    <div class="flex items-center gap-2 text-xs text-gray-500">
                                        <i class="fas fa-film"></i>
                                        <span>MP4, AVI, MOV, WMV, WebM</span>
                                    </div>
                                    <!-- Video Thumbnails Preview -->
                                    <div id="system-videos-preview" class="mt-4 flex gap-2 overflow-hidden">
                                        <!-- Thumbnails will be loaded dynamically -->
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Upload Limits Section -->
                        <div class="card p-6 mb-6" id="upload-limits-section">
                            <div class="flex items-center justify-between mb-4">
                                <div>
                                    <h3 class="text-xl font-bold">
                                        <i class="fas fa-hdd mr-2 text-purple-600"></i>
                                        Storage Settings
                                    </h3>
                                    <p class="text-sm text-gray-600">Configure storage limits per subscription plan</p>
                                </div>
                                <button onclick="openAddStorageSettingsModal()"
                                    class="px-6 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors">
                                    <i class="fas fa-plus mr-2"></i>Add Plan Settings
                                </button>
                            </div>

                            <!-- Dynamic Storage Settings Grid -->
                            <div id="upload-limits-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-6">
                                <!-- Storage cards will be loaded dynamically by upload-limits-manager.js -->
                            </div>

                            <!-- Upload Limits Info -->
                            <div class="p-4 bg-purple-50 rounded-lg border border-purple-200">
                                <h5 class="font-semibold mb-2 flex items-center gap-2">
                                    <i class="fas fa-info-circle text-purple-600"></i>
                                    Storage Limit Tiers
                                </h5>
                                <div class="grid grid-cols-1 md:grid-cols-3 gap-3 text-sm text-gray-700">
                                    <div class="flex items-start gap-2">
                                        <i class="fas fa-gift text-gray-500 mt-1"></i>
                                        <div><strong>Free:</strong> Basic storage for all users</div>
                                    </div>
                                    <div class="flex items-start gap-2">
                                        <i class="fas fa-star text-blue-500 mt-1"></i>
                                        <div><strong>Basic:</strong> Enhanced storage for subscribers</div>
                                    </div>
                                    <div class="flex items-start gap-2">
                                        <i class="fas fa-crown text-purple-500 mt-1"></i>
                                        <div><strong>Premium:</strong> Maximum storage for premium users</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Impressions Management Panel -->
                    <div id="impressions-panel" class="panel-content hidden">
                        <div class="mb-8">
                            <h1 class="text-3xl font-bold mb-2">Manage Impressions</h1>
                            <p class="text-gray-600">Track and manage system impressions and analytics</p>
                        </div>

                        <div class="card p-6 mb-6">
                            <h3 class="text-xl font-bold mb-4">Impression Statistics</h3>
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                                <div class="text-center p-4 bg-blue-50 rounded-lg">
                                    <div class="text-3xl font-bold text-blue-600">124,567</div>
                                    <div class="text-gray-600">Total Page Views</div>
                                </div>
                                <div class="text-center p-4 bg-green-50 rounded-lg">
                                    <div class="text-3xl font-bold text-green-600">45,890</div>
                                    <div class="text-gray-600">Unique Visitors</div>
                                </div>
                                <div class="text-center p-4 bg-purple-50 rounded-lg">
                                    <div class="text-3xl font-bold text-purple-600">2.71</div>
                                    <div class="text-gray-600">Avg. Pages per Session</div>
                                </div>
                            </div>
                        </div>

                        <div class="card p-6 mb-6">
                            <h3 class="text-xl font-bold mb-4">Content Impressions</h3>
                            <div class="space-y-4">
                                <div class="flex justify-between items-center p-3 bg-gray-50 rounded-lg">
                                    <span class="font-medium">Video Impressions</span>
                                    <span class="text-gray-600">89,234 views</span>
                                </div>
                                <div class="flex justify-between items-center p-3 bg-gray-50 rounded-lg">
                                    <span class="font-medium">Course Impressions</span>
                                    <span class="text-gray-600">67,890 views</span>
                                </div>
                                <div class="flex justify-between items-center p-3 bg-gray-50 rounded-lg">
                                    <span class="font-medium">Blog Post Impressions</span>
                                    <span class="text-gray-600">45,678 views</span>
                                </div>
                                <div class="flex justify-between items-center p-3 bg-gray-50 rounded-lg">
                                    <span class="font-medium">Ad Impressions</span>
                                    <span class="text-gray-600">23,456 views</span>
                                </div>
                            </div>
                        </div>

                        <div class="card p-6">
                            <h3 class="text-xl font-bold mb-4">Impression Settings</h3>
                            <div class="space-y-4">
                                <div>
                                    <label class="flex items-center gap-3">
                                        <input type="checkbox" checked class="w-4 h-4">
                                        <span>Track page impressions</span>
                                    </label>
                                </div>
                                <div>
                                    <label class="flex items-center gap-3">
                                        <input type="checkbox" checked class="w-4 h-4">
                                        <span>Track video impressions</span>
                                    </label>
                                </div>
                                <div>
                                    <label class="flex items-center gap-3">
                                        <input type="checkbox" checked class="w-4 h-4">
                                        <span>Track ad impressions</span>
                                    </label>
                                </div>
                                <div>
                                    <label class="flex items-center gap-3">
                                        <input type="checkbox" class="w-4 h-4">
                                        <span>Enable detailed analytics</span>
                                    </label>
                                </div>
                            </div>
                            <div class="flex justify-end gap-3 mt-6">
                                <button onclick="saveImpressionSettings()"
                                    class="px-6 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600">
                                    Save Settings
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Email Configuration Panel -->
                    <div id="email-panel" class="panel-content hidden">
                        <div class="mb-8 flex items-center justify-between">
                            <div>
                                <h1 class="text-3xl font-bold mb-2">Email Accounts</h1>
                                <p class="text-gray-600">Manage SMTP email accounts and configurations</p>
                            </div>
                            <button onclick="showAddEmailForm()" class="px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors shadow-lg">
                                <i class="fas fa-plus mr-2"></i>Add Email Account
                            </button>
                        </div>

                        <!-- Email Accounts List -->
                        <div id="email-accounts-list" class="mb-6">
                            <!-- Email cards will be inserted here by JavaScript -->
                        </div>


                        <!-- Email Statistics -->
                        <div class="card p-6 mb-6">
                            <h3 class="text-xl font-bold mb-4">Email Statistics</h3>
                            <div class="grid grid-cols-1 md:grid-cols-4 gap-6">
                                <div class="text-center p-4 bg-blue-50 rounded-lg">
                                    <div class="text-3xl font-bold text-blue-600" id="stat-emails-sent">0</div>
                                    <div class="text-sm text-gray-600 mt-1">Emails Sent Today</div>
                                </div>
                                <div class="text-center p-4 bg-green-50 rounded-lg">
                                    <div class="text-3xl font-bold text-green-600" id="stat-emails-delivered">0</div>
                                    <div class="text-sm text-gray-600 mt-1">Successfully Delivered</div>
                                </div>
                                <div class="text-center p-4 bg-yellow-50 rounded-lg">
                                    <div class="text-3xl font-bold text-yellow-600" id="stat-emails-pending">0</div>
                                    <div class="text-sm text-gray-600 mt-1">Pending in Queue</div>
                                </div>
                                <div class="text-center p-4 bg-red-50 rounded-lg">
                                    <div class="text-3xl font-bold text-red-600" id="stat-emails-failed">0</div>
                                    <div class="text-sm text-gray-600 mt-1">Failed to Send</div>
                                </div>
                            </div>
                            <div class="mt-4 pt-4 border-t">
                                <div class="flex items-center justify-between">
                                    <div class="text-sm text-gray-600">
                                        <i class="fas fa-info-circle mr-1"></i>
                                        Daily limit: <span id="daily-limit-display">1000</span> emails
                                        | Used: <span id="daily-used-display">0</span>
                                        | Remaining: <span id="daily-remaining-display">1000</span>
                                    </div>
                                    <button onclick="viewEmailLogs()" class="px-4 py-2 border rounded-lg hover:bg-gray-50 text-sm">
                                        <i class="fas fa-list mr-2"></i>View Logs
                                    </button>
                                </div>
                            </div>
                        </div>

                        <!-- Email Templates -->
                        <div class="card p-6 mb-6">
                            <div class="flex items-center justify-between mb-4">
                                <h3 class="text-xl font-bold">Email Templates</h3>
                                <button onclick="addNewEmailTemplate()" class="px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600">
                                    <i class="fas fa-plus mr-2"></i>Add Template
                                </button>
                            </div>
                            <div id="email-templates-list" class="space-y-4">
                                <!-- Templates will be loaded dynamically -->
                                <div class="text-center text-gray-500 py-8">
                                    <i class="fas fa-spinner fa-spin text-2xl mb-2"></i>
                                    <p>Loading email templates...</p>
                                </div>
                            </div>
                        </div>

                        <!-- Recent Email Logs -->
                        <div class="card p-6">
                            <h3 class="text-xl font-bold mb-4">Recent Email Activity</h3>
                            <div id="recent-email-logs" class="space-y-3">
                                <!-- Logs will be loaded dynamically -->
                                <div class="text-center text-gray-500 py-8">
                                    <i class="fas fa-inbox text-2xl mb-2"></i>
                                    <p>No recent email activity</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Pricing Management Panel -->
                    <div id="pricing-panel" class="panel-content hidden">
                        <div class="mb-8">
                            <h1 class="text-3xl font-bold mb-2">Pricing Management</h1>
                            <p class="text-gray-600">Configure platform pricing, payment gateways, and commission
                                settings</p>
                        </div>
                        <div class="card p-6 mb-6" id="payment-gateway-section">
                            <div class="flex items-center justify-between mb-4">
                                <div>
                                    <h3 class="text-xl font-bold">
                                        <i class="fas fa-credit-card mr-2 text-blue-600"></i>
                                        Payment Gateways
                                    </h3>
                                    <p class="text-sm text-gray-600">Configure payment gateway integrations for the platform</p>
                                </div>
                                <button onclick="openAddPaymentGatewayModal()"
                                    class="px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors">
                                    <i class="fas fa-plus mr-2"></i>Add Gateway
                                </button>
                            </div>

                            <!-- Dynamic Gateways Grid -->
                            <div id="payment-gateways-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-6">
                                <!-- Gateways will be loaded dynamically by payment-gateway-manager.js -->
                            </div>

                            <!-- Payment Gateway Info -->
                            <div class="p-4 bg-blue-50 rounded-lg border border-blue-200">
                                <h5 class="font-semibold mb-2 flex items-center gap-2">
                                    <i class="fas fa-info-circle text-blue-600"></i>
                                    Supported Payment Methods
                                </h5>
                                <div class="grid grid-cols-1 md:grid-cols-3 gap-3 text-sm text-gray-700">
                                    <div class="flex items-start gap-2">
                                        <i class="fas fa-mobile-alt text-blue-600 mt-1"></i>
                                        <div><strong>TeleBirr:</strong> Mobile money payments</div>
                                    </div>
                                    <div class="flex items-start gap-2">
                                        <i class="fas fa-university text-blue-600 mt-1"></i>
                                        <div><strong>CBE:</strong> Bank transfer payments</div>
                                    </div>
                                    <div class="flex items-start gap-2">
                                        <i class="fas fa-wallet text-blue-600 mt-1"></i>
                                        <div><strong>Custom:</strong> Add other gateways</div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Verification Fee Settings -->
                        <div class="card p-6 mb-6" id="verification-fee-section">
                            <div class="flex items-center justify-between mb-4">
                                <div>
                                    <h3 class="text-xl font-bold">
                                        <i class="fas fa-certificate mr-2 text-indigo-600"></i>
                                        Verification Fee Settings
                                    </h3>
                                    <p class="text-sm text-gray-600">Manage verification fee types with custom pricing</p>
                                </div>
                                <button onclick="openAddVerificationFeeModal()"
                                    class="px-6 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors">
                                    <i class="fas fa-plus mr-2"></i>Add Fee Type
                                </button>
                            </div>

                            <!-- Dynamic Fees Grid -->
                            <div id="verification-fees-grid"
                                class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-6">
                                <!-- Fees will be loaded dynamically by verification-fee-manager.js -->
                            </div>

                            <!-- Verification Features Information -->
                            <div class="p-4 bg-indigo-50 rounded-lg border border-indigo-200">
                                <h5 class="font-semibold mb-2 flex items-center gap-2">
                                    <i class="fas fa-info-circle text-indigo-600"></i>
                                    About Verification Badges
                                </h5>
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-3 text-sm text-gray-700">
                                    <div class="flex items-start gap-2">
                                        <i class="fas fa-check-circle text-indigo-600 mt-1"></i>
                                        <div><strong>Individual:</strong> For students, tutors, and parents</div>
                                    </div>
                                    <div class="flex items-start gap-2">
                                        <i class="fas fa-building text-indigo-600 mt-1"></i>
                                        <div><strong>Organization:</strong> For schools, institutions, and advertisers</div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- CPI (Cost Per Impression) Pricing -->
                        <div class="card p-6 mb-6" id="brand-cpi-section">
                            <div class="flex items-center justify-between mb-4">
                                <div>
                                    <h3 class="text-xl font-bold">
                                        <i class="fas fa-eye mr-2 text-orange-600"></i>
                                        CPI Pricing (Cost Per Impression)
                                    </h3>
                                    <p class="text-sm text-gray-600">Set cost per impression rates with audience and location targeting premiums</p>
                                </div>
                                <button onclick="openCpiSettingsModal()"
                                    class="px-6 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700 transition-colors">
                                    <i class="fas fa-cog mr-2"></i>CPI Settings
                                </button>
                            </div>

                            <!-- CPI Rates Grid -->
                            <div id="cpi-rates-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-6">
                                <!-- CPI rates will be loaded dynamically -->
                            </div>

                            <!-- CPI Pricing Information -->
                            <div class="p-4 bg-orange-50 rounded-lg border border-orange-200">
                                <h5 class="font-semibold mb-2 flex items-center gap-2">
                                    <i class="fas fa-info-circle text-orange-600"></i>
                                    How CPI Pricing Works
                                </h5>
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-3 text-sm text-gray-700">
                                    <div class="flex items-start gap-2">
                                        <i class="fas fa-coins text-orange-600 mt-1"></i>
                                        <div><strong>Base CPI:</strong> Cost per impression for untargeted ads</div>
                                    </div>
                                    <div class="flex items-start gap-2">
                                        <i class="fas fa-users text-orange-600 mt-1"></i>
                                        <div><strong>Audience Exclusion:</strong> Premium charged when excluding Tutors, Students, Parents, Advertisers, or Users</div>
                                    </div>
                                    <div class="flex items-start gap-2">
                                        <i class="fas fa-map-marker-alt text-orange-600 mt-1"></i>
                                        <div><strong>Location Targeting:</strong> International (lowest), National (medium), Regional (highest)</div>
                                    </div>
                                    <div class="flex items-start gap-2">
                                        <i class="fas fa-calculator text-orange-600 mt-1"></i>
                                        <div><strong>Stacking Premiums:</strong> More targeting = higher CPI (base + audience + location)</div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Subscription Plans Settings -->
                        <div class="card p-6 mb-6" id="subscription-pricing-section">
                            <div class="flex items-center justify-between mb-4">
                                <div>
                                    <h3 class="text-xl font-bold">
                                        <i class="fas fa-crown mr-2 text-purple-600"></i>
                                        Subscription Plans
                                    </h3>
                                    <p class="text-sm text-gray-600">Manage subscription plans by user type with custom pricing and discount tiers</p>
                                </div>
                                <div class="flex gap-3">
                                    <button onclick="openAssignFeaturesModal()"
                                        class="px-6 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors">
                                        <i class="fas fa-check-square mr-2"></i>Assign Features
                                    </button>
                                    <button onclick="openAddSubscriptionPlanModal()"
                                        class="px-6 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors">
                                        <i class="fas fa-plus mr-2"></i>Add Plan
                                    </button>
                                </div>
                            </div>

                            <!-- Subscription Type Tabs -->
                            <div class="subscription-type-tabs mb-6">
                                <div class="flex flex-wrap gap-2 border-b border-gray-200 pb-2" id="subscription-tabs">
                                    <button onclick="switchSubscriptionTab('tutor')"
                                        class="subscription-tab active px-4 py-2 rounded-t-lg font-medium transition-all flex items-center gap-2"
                                        data-tab="tutor">
                                        <i class="fas fa-chalkboard-teacher text-blue-600"></i>
                                        <span>Tutor</span>
                                        <span class="tab-count bg-blue-100 text-blue-700 text-xs px-2 py-0.5 rounded-full">0</span>
                                    </button>
                                    <button onclick="switchSubscriptionTab('student')"
                                        class="subscription-tab px-4 py-2 rounded-t-lg font-medium transition-all flex items-center gap-2"
                                        data-tab="student">
                                        <i class="fas fa-user-graduate text-green-600"></i>
                                        <span>Student</span>
                                        <span class="tab-count bg-green-100 text-green-700 text-xs px-2 py-0.5 rounded-full">0</span>
                                    </button>
                                    <button onclick="switchSubscriptionTab('parent')"
                                        class="subscription-tab px-4 py-2 rounded-t-lg font-medium transition-all flex items-center gap-2"
                                        data-tab="parent">
                                        <i class="fas fa-user-friends text-yellow-600"></i>
                                        <span>Parent</span>
                                        <span class="tab-count bg-yellow-100 text-yellow-700 text-xs px-2 py-0.5 rounded-full">0</span>
                                    </button>
                                    <button onclick="switchSubscriptionTab('institute')"
                                        class="subscription-tab px-4 py-2 rounded-t-lg font-medium transition-all flex items-center gap-2"
                                        data-tab="institute">
                                        <i class="fas fa-building text-red-600"></i>
                                        <span>Institute</span>
                                        <span class="tab-count bg-red-100 text-red-700 text-xs px-2 py-0.5 rounded-full">0</span>
                                    </button>
                                    <button onclick="switchSubscriptionTab('advertiser')"
                                        class="subscription-tab px-4 py-2 rounded-t-lg font-medium transition-all flex items-center gap-2"
                                        data-tab="advertiser">
                                        <i class="fas fa-bullhorn text-orange-600"></i>
                                        <span>Advertiser</span>
                                        <span class="tab-count bg-orange-100 text-orange-700 text-xs px-2 py-0.5 rounded-full">0</span>
                                    </button>
                                </div>
                            </div>

                            <!-- Tab Content Containers -->
                            <div id="subscription-tab-content">
                                <!-- Tutor Plans -->
                                <div id="subscription-tab-tutor" class="subscription-tab-panel active">
                                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 subscription-plans-grid" data-type="tutor">
                                        <!-- Tutor plans loaded dynamically -->
                                    </div>
                                </div>
                                <!-- Student Plans -->
                                <div id="subscription-tab-student" class="subscription-tab-panel hidden">
                                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 subscription-plans-grid" data-type="student">
                                        <!-- Student plans loaded dynamically -->
                                    </div>
                                </div>
                                <!-- Parent Plans -->
                                <div id="subscription-tab-parent" class="subscription-tab-panel hidden">
                                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 subscription-plans-grid" data-type="parent">
                                        <!-- Parent plans loaded dynamically -->
                                    </div>
                                </div>
                                <!-- Institute Plans -->
                                <div id="subscription-tab-institute" class="subscription-tab-panel hidden">
                                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 subscription-plans-grid" data-type="institute">
                                        <!-- Institute plans loaded dynamically -->
                                    </div>
                                </div>
                                <!-- Advertiser Plans -->
                                <div id="subscription-tab-advertiser" class="subscription-tab-panel hidden">
                                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 subscription-plans-grid" data-type="advertiser">
                                        <!-- Advertiser plans loaded dynamically -->
                                    </div>
                                </div>
                            </div>

                            <!-- Legacy grid for backwards compatibility (hidden) -->
                            <div id="subscription-plans-grid" class="hidden"></div>

                            <!-- Subscription Features Information -->
                            <div class="p-4 bg-purple-50 rounded-lg border border-purple-200 mt-6">
                                <h5 class="font-semibold mb-2 flex items-center gap-2">
                                    <i class="fas fa-info-circle text-purple-600"></i>
                                    Subscription Plan Discounts
                                </h5>
                                <div class="grid grid-cols-1 md:grid-cols-3 gap-3 text-sm text-gray-700">
                                    <div class="flex items-start gap-2">
                                        <i class="fas fa-calendar-alt text-purple-600 mt-1"></i>
                                        <div><strong>3 Months:</strong> Quarterly subscription discount</div>
                                    </div>
                                    <div class="flex items-start gap-2">
                                        <i class="fas fa-calendar-check text-purple-600 mt-1"></i>
                                        <div><strong>6 Months:</strong> Half-yearly subscription discount</div>
                                    </div>
                                    <div class="flex items-start gap-2">
                                        <i class="fas fa-calendar text-purple-600 mt-1"></i>
                                        <div><strong>Yearly:</strong> Annual subscription discount</div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- New Tutor Starting Price Settings -->
                        <div class="card p-6 mb-6" id="tutor-base-price-section">
                            <div class="flex items-center justify-between mb-4">
                                <div>
                                    <h3 class="text-xl font-bold">
                                        <i class="fas fa-tag mr-2 text-teal-600"></i>
                                        New Tutor Starting Price
                                    </h3>
                                    <p class="text-sm text-gray-600">Set default starting prices for new tutors without market data history</p>
                                </div>
                                <button onclick="openAddBasePriceModal()"
                                    class="px-6 py-2 bg-teal-600 text-white rounded-lg hover:bg-teal-700 transition-colors">
                                    <i class="fas fa-plus mr-2"></i>Add Price Rule
                                </button>
                            </div>

                            <!-- Base Price Rules Grid -->
                            <div id="base-price-rules-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-6">
                                <!-- Base price rules will be loaded dynamically -->
                            </div>

                            <!-- Base Price Information -->
                            <div class="p-4 bg-teal-50 rounded-lg border border-teal-200">
                                <h5 class="font-semibold mb-2 flex items-center gap-2">
                                    <i class="fas fa-info-circle text-teal-600"></i>
                                    How Starting Prices Work
                                </h5>
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-3 text-sm text-gray-700">
                                    <div class="flex items-start gap-2">
                                        <i class="fas fa-graduation-cap text-teal-600 mt-1"></i>
                                        <div><strong>Subject-Based:</strong> Different prices for Math, Science, Languages, etc.</div>
                                    </div>
                                    <div class="flex items-start gap-2">
                                        <i class="fas fa-laptop-house text-teal-600 mt-1"></i>
                                        <div><strong>Session Format:</strong> Online, In-Person, or Hybrid pricing</div>
                                    </div>
                                    <div class="flex items-start gap-2">
                                        <i class="fas fa-certificate text-teal-600 mt-1"></i>
                                        <div><strong>Credential Bonus:</strong> Additional price for verified credentials</div>
                                    </div>
                                    <div class="flex items-start gap-2">
                                        <i class="fas fa-chart-line text-teal-600 mt-1"></i>
                                        <div><strong>Auto-Upgrade:</strong> System automatically suggests market-based prices once tutor has history</div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Affiliate Management -->
                        <div class="card p-6" id="affiliate-management-section">
                            <div class="flex items-center justify-between mb-4">
                                <div>
                                    <h3 class="text-xl font-bold">
                                        <i class="fas fa-users mr-2 text-purple-600"></i>
                                        Affiliate Program
                                    </h3>
                                    <p class="text-sm text-gray-600">Configure multi-tier affiliate commission structure by business type</p>
                                </div>
                                <div class="flex gap-2">
                                    <button onclick="openAffiliateProgramSettingsModal()"
                                        class="px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors border">
                                        <i class="fas fa-cog mr-2"></i>Settings
                                    </button>
                                    <button onclick="openAddAffiliateTierModal()"
                                        class="px-6 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors">
                                        <i class="fas fa-plus mr-2"></i>Add Tier
                                    </button>
                                </div>
                            </div>

                            <!-- Business Type Tabs -->
                            <div class="affiliate-business-type-tabs mb-6">
                                <div class="flex flex-wrap gap-2 border-b border-gray-200 pb-2" id="affiliate-business-tabs">
                                    <button onclick="switchAffiliateBusinessTab('tutoring')"
                                        class="affiliate-business-tab active px-4 py-2 rounded-t-lg font-medium transition-all flex items-center gap-2"
                                        data-tab="tutoring">
                                        <i class="fas fa-chalkboard-teacher text-blue-600"></i>
                                        <span>Tutoring Sessions</span>
                                        <span class="tab-count bg-blue-100 text-blue-700 text-xs px-2 py-0.5 rounded-full">0</span>
                                    </button>
                                    <button onclick="switchAffiliateBusinessTab('subscription')"
                                        class="affiliate-business-tab px-4 py-2 rounded-t-lg font-medium transition-all flex items-center gap-2"
                                        data-tab="subscription">
                                        <i class="fas fa-crown text-purple-600"></i>
                                        <span>Subscriptions</span>
                                        <span class="tab-count bg-purple-100 text-purple-700 text-xs px-2 py-0.5 rounded-full">0</span>
                                    </button>
                                    <button onclick="switchAffiliateBusinessTab('advertisement')"
                                        class="affiliate-business-tab px-4 py-2 rounded-t-lg font-medium transition-all flex items-center gap-2"
                                        data-tab="advertisement">
                                        <i class="fas fa-ad text-orange-600"></i>
                                        <span>Advertisements</span>
                                        <span class="tab-count bg-orange-100 text-orange-700 text-xs px-2 py-0.5 rounded-full">0</span>
                                    </button>
                                </div>
                            </div>

                            <!-- Tab Content Containers -->
                            <div id="affiliate-business-tab-content">
                                <!-- Tutoring Tab -->
                                <div id="affiliate-business-tab-tutoring" class="affiliate-business-tab-panel active">
                                    <div class="mb-4 p-3 bg-blue-50 rounded-lg border border-blue-200">
                                        <p class="text-sm text-gray-700">
                                            <i class="fas fa-info-circle text-blue-600 mr-2"></i>
                                            <strong>Tutoring Sessions:</strong> Commission from transactions when referred users hire tutors. Up to 18% across 4 tiers.
                                        </p>
                                    </div>
                                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 affiliate-tiers-grid" data-business-type="tutoring">
                                        <!-- Tutoring tiers loaded dynamically -->
                                    </div>
                                </div>

                                <!-- Subscription Tab -->
                                <div id="affiliate-business-tab-subscription" class="affiliate-business-tab-panel hidden">
                                    <div class="mb-4 p-3 bg-purple-50 rounded-lg border border-purple-200">
                                        <p class="text-sm text-gray-700">
                                            <i class="fas fa-info-circle text-purple-600 mr-2"></i>
                                            <strong>Subscriptions:</strong> Commission from subscription purchases by referred users. Multi-tier structure available.
                                        </p>
                                    </div>
                                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 affiliate-tiers-grid" data-business-type="subscription">
                                        <!-- Subscription tiers loaded dynamically -->
                                    </div>
                                </div>

                                <!-- Advertisement Tab -->
                                <div id="affiliate-business-tab-advertisement" class="affiliate-business-tab-panel hidden">
                                    <div class="mb-4 p-3 bg-orange-50 rounded-lg border border-orange-200">
                                        <p class="text-sm text-gray-700">
                                            <i class="fas fa-info-circle text-orange-600 mr-2"></i>
                                            <strong>Advertisements:</strong> Commission from ad impressions viewed by the referrer and their referred users' network.
                                        </p>
                                    </div>
                                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 affiliate-tiers-grid" data-business-type="advertisement">
                                        <!-- Advertisement tiers loaded dynamically -->
                                    </div>
                                </div>
                            </div>

                            <!-- Legacy grid for backwards compatibility (hidden) -->
                            <div id="affiliate-tiers-grid" class="hidden">
                                <!-- Old grid, kept for backwards compatibility -->
                            </div>

                            <!-- Affiliate Program Info -->
                            <div class="p-4 bg-purple-50 rounded-lg border border-purple-200 mt-6">
                                <h5 class="font-semibold mb-3 flex items-center gap-2">
                                    <i class="fas fa-info-circle text-purple-600"></i>
                                    How the Affiliate System Works
                                </h5>
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 text-sm text-gray-700">
                                    <div class="space-y-2">
                                        <h6 class="font-semibold text-purple-700">Commission Tiers:</h6>
                                        <div class="flex items-start gap-2">
                                            <i class="fas fa-user text-purple-600 mt-1"></i>
                                            <div><strong>Level 1:</strong> Direct referral commission</div>
                                        </div>
                                        <div class="flex items-start gap-2">
                                            <i class="fas fa-user-friends text-purple-600 mt-1"></i>
                                            <div><strong>Level 2:</strong> Referral's referral commission</div>
                                        </div>
                                        <div class="flex items-start gap-2">
                                            <i class="fas fa-users text-purple-600 mt-1"></i>
                                            <div><strong>Level 3-4:</strong> Extended network commission (up to 18% total)</div>
                                        </div>
                                    </div>
                                    <div class="space-y-2">
                                        <h6 class="font-semibold text-purple-700">Business Types:</h6>
                                        <div class="flex items-start gap-2">
                                            <i class="fas fa-chalkboard-teacher text-blue-600 mt-1"></i>
                                            <div><strong>Tutoring:</strong> Commission from tutor hiring transactions</div>
                                        </div>
                                        <div class="flex items-start gap-2">
                                            <i class="fas fa-crown text-purple-600 mt-1"></i>
                                            <div><strong>Subscriptions:</strong> Commission from subscription purchases</div>
                                        </div>
                                        <div class="flex items-start gap-2">
                                            <i class="fas fa-ad text-orange-600 mt-1"></i>
                                            <div><strong>Advertisements:</strong> Commission from ad impressions viewed by referrer and their network</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Security Panel -->
                    <div id="security-panel" class="panel-content hidden">
                        <div class="mb-8">
                            <h1 class="text-3xl font-bold mb-2">Security & Privacy</h1>
                            <p class="text-gray-600">Manage security settings and privacy controls</p>
                        </div>
                        <div class="card p-6 mb-6">
                            <h3 class="text-xl font-bold mb-4">Security Settings</h3>
                            <div class="space-y-4">
                                <label class="flex items-center justify-between p-3 border rounded-lg">
                                    <div>
                                        <div class="font-semibold">Two-Factor Authentication</div>
                                        <div class="text-sm text-gray-500">Require 2FA for admin accounts</div>
                                    </div>
                                    <input type="checkbox" checked class="w-4 h-4">
                                </label>
                                <label class="flex items-center justify-between p-3 border rounded-lg">
                                    <div>
                                        <div class="font-semibold">Session Timeout</div>
                                        <div class="text-sm text-gray-500">Auto logout after inactivity</div>
                                    </div>
                                    <select class="p-2 border rounded-lg">
                                        <option>15 minutes</option>
                                        <option>30 minutes</option>
                                        <option>1 hour</option>
                                        <option>Never</option>
                                    </select>
                                </label>
                                <label class="flex items-center justify-between p-3 border rounded-lg">
                                    <div>
                                        <div class="font-semibold">Password Policy</div>
                                        <div class="text-sm text-gray-500">Minimum password requirements</div>
                                    </div>
                                    <select class="p-2 border rounded-lg">
                                        <option>Strong (8+ chars, mixed case, numbers)</option>
                                        <option>Medium (6+ chars)</option>
                                        <option>Basic (4+ chars)</option>
                                    </select>
                                </label>
                                <label class="flex items-center justify-between p-3 border rounded-lg">
                                    <div>
                                        <div class="font-semibold">Rate Limiting</div>
                                        <div class="text-sm text-gray-500">Max login attempts per hour</div>
                                    </div>
                                    <input type="number" class="w-20 p-2 border rounded-lg" placeholder="5">
                                </label>
                            </div>
                        </div>

                        <div class="card p-6">
                            <h3 class="text-xl font-bold mb-4">Privacy Settings</h3>
                            <div class="space-y-4">
                                <label class="flex items-center gap-3">
                                    <input type="checkbox" checked class="w-4 h-4">
                                    <span>Enable GDPR compliance features</span>
                                </label>
                                <label class="flex items-center gap-3">
                                    <input type="checkbox" checked class="w-4 h-4">
                                    <span>Allow users to download their data</span>
                                </label>
                                <label class="flex items-center gap-3">
                                    <input type="checkbox" checked class="w-4 h-4">
                                    <span>Allow users to delete their account</span>
                                </label>
                                <label class="flex items-center gap-3">
                                    <input type="checkbox" class="w-4 h-4">
                                    <span>Anonymous browsing mode available</span>
                                </label>
                            </div>
                        </div>
                    </div>

                    <!-- Backup Panel -->
                    <div id="backup-panel" class="panel-content hidden">
                        <div class="mb-8">
                            <h1 class="text-3xl font-bold mb-2">Backup & Restore</h1>
                            <p class="text-gray-600">Configure automatic backups and view backup history</p>
                        </div>
                        <div class="card p-6 mb-6">
                            <h3 class="text-xl font-bold mb-4">Backup Configuration</h3>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div>
                                    <label class="block mb-2 font-semibold">Automatic Backup</label>
                                    <select class="w-full p-2 border rounded-lg">
                                        <option>Daily at 2:00 AM</option>
                                        <option>Weekly on Sunday</option>
                                        <option>Monthly on 1st</option>
                                        <option>Disabled</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block mb-2 font-semibold">Backup Storage</label>
                                    <select class="w-full p-2 border rounded-lg">
                                        <option>Local Storage</option>
                                        <option>AWS S3</option>
                                        <option>Google Drive</option>
                                        <option>Backblaze B2</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block mb-2 font-semibold">Retention Period</label>
                                    <select class="w-full p-2 border rounded-lg">
                                        <option>7 days</option>
                                        <option>14 days</option>
                                        <option>30 days</option>
                                        <option>90 days</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block mb-2 font-semibold">Include Media Files</label>
                                    <select class="w-full p-2 border rounded-lg">
                                        <option>Yes</option>
                                        <option>No</option>
                                    </select>
                                </div>
                            </div>
                            <div class="mt-6 flex gap-3">
                                <button onclick="createManualBackup()"
                                    class="px-4 py-2 bg-blue-500 text-white rounded-lg">Create Manual Backup</button>
                                <button class="px-4 py-2 bg-green-500 text-white rounded-lg">Test Backup
                                    Configuration</button>
                            </div>
                        </div>

                        <div class="card p-6">
                            <h3 class="text-xl font-bold mb-4">Recent Backups</h3>
                            <div class="overflow-x-auto">
                                <table class="w-full">
                                    <thead>
                                        <tr class="border-b">
                                            <th class="p-3 text-left">Date</th>
                                            <th class="p-3 text-left">Type</th>
                                            <th class="p-3 text-left">Size</th>
                                            <th class="p-3 text-left">Status</th>
                                            <th class="p-3 text-left">Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr class="border-b">
                                            <td class="p-3">Jan 28, 2025 02:00 AM</td>
                                            <td class="p-3">Automatic</td>
                                            <td class="p-3">2.3 GB</td>
                                            <td class="p-3">
                                                <span
                                                    class="px-2 py-1 bg-green-100 text-green-800 rounded text-sm">Success</span>
                                            </td>
                                            <td class="p-3">
                                                <button class="text-blue-600 hover:underline mr-3">Download</button>
                                                <button class="text-green-600 hover:underline mr-3">Restore</button>
                                                <button class="text-red-600 hover:underline">Delete</button>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>

                    <!-- SMS Configuration Panel -->
                    <div id="sms-panel" class="panel-content hidden">
                        <div class="mb-8 flex items-center justify-between">
                            <div>
                                <h1 class="text-3xl font-bold mb-2">SMS Providers</h1>
                                <p class="text-gray-600">Manage SMS provider accounts and configurations</p>
                            </div>
                            <button onclick="showAddSMSProviderModal()" class="px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors shadow-lg">
                                <i class="fas fa-plus mr-2"></i>Add SMS Provider
                            </button>
                        </div>

                        <!-- SMS Providers List -->
                        <div id="sms-providers-list" class="mb-6">
                            <!-- SMS provider cards will be inserted here by JavaScript -->
                        </div>

                        <!-- SMS Configuration Form (Hidden by default, shown when provider is configured) -->
                        <div id="sms-config-container" class="card p-6 mb-6 hidden">
                            <h3 class="text-xl font-bold mb-6"><span id="current-provider-name">Provider</span> Configuration</h3>
                            <form id="sms-config-form" class="space-y-6">
                                <!-- Twilio Account SID -->
                                <div>
                                    <label class="block text-sm font-semibold mb-2">
                                        Twilio Account SID <span class="text-red-500">*</span>
                                    </label>
                                    <input type="text" id="twilio-account-sid"
                                        class="w-full p-3 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                                        placeholder="ACxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx">
                                    <p class="text-xs text-gray-500 mt-1">
                                        <i class="fas fa-info-circle"></i> Find this in your Twilio console under Account Info
                                    </p>
                                </div>

                                <!-- Twilio Auth Token -->
                                <div>
                                    <label class="block text-sm font-semibold mb-2">
                                        Twilio Auth Token <span class="text-red-500">*</span>
                                    </label>
                                    <div class="relative">
                                        <input type="password" id="twilio-auth-token"
                                            class="w-full p-3 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 pr-12"
                                            placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢">
                                        <button type="button" onclick="togglePasswordVisibility('twilio-auth-token')"
                                            class="absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 hover:text-gray-700">
                                            <i class="fas fa-eye"></i>
                                        </button>
                                    </div>
                                    <p class="text-xs text-gray-500 mt-1">
                                        <i class="fas fa-info-circle"></i> Your Twilio authentication token (keep this secure)
                                    </p>
                                </div>

                                <!-- Twilio From Number -->
                                <div>
                                    <label class="block text-sm font-semibold mb-2">
                                        Twilio Phone Number <span class="text-red-500">*</span>
                                    </label>
                                    <input type="tel" id="twilio-from-number"
                                        class="w-full p-3 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                                        placeholder="+1234567890">
                                    <p class="text-xs text-gray-500 mt-1">
                                        <i class="fas fa-info-circle"></i> Your Twilio phone number with country code (e.g., +1234567890)
                                    </p>
                                </div>

                                <!-- Default Country Code -->
                                <div>
                                    <label class="block text-sm font-semibold mb-2">
                                        Default Country Code
                                    </label>
                                    <select id="default-country-code"
                                        class="w-full p-3 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                                        <option value="+251">+251 (Ethiopia)</option>
                                        <option value="+1">+1 (USA/Canada)</option>
                                        <option value="+44">+44 (UK)</option>
                                        <option value="+91">+91 (India)</option>
                                        <option value="+234">+234 (Nigeria)</option>
                                        <option value="+254">+254 (Kenya)</option>
                                    </select>
                                    <p class="text-xs text-gray-500 mt-1">
                                        <i class="fas fa-info-circle"></i> Used when phone numbers don't include a country code
                                    </p>
                                </div>

                                <!-- SMS Enabled Toggle -->
                                <div class="flex items-center justify-between p-4 bg-gray-50 rounded-lg">
                                    <div>
                                        <label class="block text-sm font-semibold">Enable SMS Service</label>
                                        <p class="text-xs text-gray-500 mt-1">Turn SMS notifications on or off</p>
                                    </div>
                                    <label class="relative inline-flex items-center cursor-pointer">
                                        <input type="checkbox" id="sms-enabled" class="sr-only peer" checked>
                                        <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"></div>
                                    </label>
                                </div>

                                <!-- Daily SMS Limit -->
                                <div>
                                    <label class="block text-sm font-semibold mb-2">
                                        Daily SMS Limit
                                    </label>
                                    <input type="number" id="daily-sms-limit"
                                        class="w-full p-3 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                                        placeholder="1000" value="1000" min="0">
                                    <p class="text-xs text-gray-500 mt-1">
                                        <i class="fas fa-info-circle"></i> Maximum number of SMS messages to send per day (0 = unlimited)
                                    </p>
                                </div>

                                <!-- OTP Settings -->
                                <div class="border-t pt-6">
                                    <h4 class="font-semibold mb-4">OTP Settings</h4>

                                    <div class="space-y-4">
                                        <div>
                                            <label class="block text-sm font-semibold mb-2">
                                                OTP Expiry Time (minutes)
                                            </label>
                                            <input type="number" id="otp-expiry-minutes"
                                                class="w-full p-3 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                                                placeholder="5" value="5" min="1" max="60">
                                        </div>

                                        <div>
                                            <label class="block text-sm font-semibold mb-2">
                                                OTP Length (digits)
                                            </label>
                                            <input type="number" id="otp-length"
                                                class="w-full p-3 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                                                placeholder="6" value="6" min="4" max="8">
                                        </div>

                                        <div class="flex items-center gap-3">
                                            <input type="checkbox" id="otp-numeric-only" class="w-4 h-4" checked>
                                            <label for="otp-numeric-only" class="text-sm">Use numeric-only OTP codes</label>
                                        </div>
                                    </div>
                                </div>
                            </form>
                        </div>

                        <!-- SMS Statistics -->
                        <div class="card p-6 mb-6">
                            <h3 class="text-xl font-bold mb-4">SMS Statistics</h3>
                            <div class="grid grid-cols-1 md:grid-cols-4 gap-6">
                                <div class="text-center p-4 bg-blue-50 rounded-lg">
                                    <div class="text-3xl font-bold text-blue-600" id="stat-sms-sent">0</div>
                                    <div class="text-sm text-gray-600 mt-1">SMS Sent Today</div>
                                </div>
                                <div class="text-center p-4 bg-green-50 rounded-lg">
                                    <div class="text-3xl font-bold text-green-600" id="stat-sms-delivered">0</div>
                                    <div class="text-sm text-gray-600 mt-1">Successfully Delivered</div>
                                </div>
                                <div class="text-center p-4 bg-yellow-50 rounded-lg">
                                    <div class="text-3xl font-bold text-yellow-600" id="stat-sms-pending">0</div>
                                    <div class="text-sm text-gray-600 mt-1">Pending</div>
                                </div>
                                <div class="text-center p-4 bg-red-50 rounded-lg">
                                    <div class="text-3xl font-bold text-red-600" id="stat-sms-failed">0</div>
                                    <div class="text-sm text-gray-600 mt-1">Failed to Send</div>
                                </div>
                            </div>
                            <div class="mt-4 pt-4 border-t">
                                <div class="flex items-center justify-between">
                                    <div class="text-sm text-gray-600">
                                        <i class="fas fa-info-circle mr-1"></i>
                                        Daily limit: <span id="sms-daily-limit-display">1000</span> messages
                                        | Used: <span id="sms-daily-used-display">0</span>
                                        | Remaining: <span id="sms-daily-remaining-display">1000</span>
                                    </div>
                                    <button onclick="viewSMSLogs()" class="px-4 py-2 border rounded-lg hover:bg-gray-50 text-sm">
                                        <i class="fas fa-list mr-2"></i>View SMS Logs
                                    </button>
                                </div>
                            </div>
                        </div>

                        <!-- SMS Templates -->
                        <div class="card p-6 mb-6">
                            <h3 class="text-xl font-bold mb-4">SMS Templates</h3>
                            <div class="space-y-4">
                                <!-- OTP Template -->
                                <div class="border rounded-lg p-4">
                                    <div class="flex items-center justify-between mb-3">
                                        <div>
                                            <h4 class="font-semibold">OTP Verification</h4>
                                            <p class="text-xs text-gray-500">Used for user authentication</p>
                                        </div>
                                        <button onclick="editSMSTemplate('otp')" class="px-4 py-2 border rounded-lg hover:bg-gray-50 text-sm">
                                            <i class="fas fa-edit mr-1"></i>Edit
                                        </button>
                                    </div>
                                    <div class="bg-gray-50 p-3 rounded text-sm">
                                        <span class="text-gray-600">Your Astegni OTP code is: <strong class="text-blue-600">[OTP_CODE]</strong></span>
                                        <br>
                                        <span class="text-gray-600">Valid for <strong>[EXPIRY_TIME]</strong> minutes.</span>
                                    </div>
                                    <div class="mt-2 text-xs text-gray-500">
                                        Character count: <span class="font-semibold">67</span> / 160
                                    </div>
                                </div>

                                <!-- Welcome Template -->
                                <div class="border rounded-lg p-4">
                                    <div class="flex items-center justify-between mb-3">
                                        <div>
                                            <h4 class="font-semibold">Welcome Message</h4>
                                            <p class="text-xs text-gray-500">Sent to new users</p>
                                        </div>
                                        <button onclick="editSMSTemplate('welcome')" class="px-4 py-2 border rounded-lg hover:bg-gray-50 text-sm">
                                            <i class="fas fa-edit mr-1"></i>Edit
                                        </button>
                                    </div>
                                    <div class="bg-gray-50 p-3 rounded text-sm">
                                        <span class="text-gray-600">Welcome to Astegni, <strong class="text-blue-600">[USER_NAME]</strong>! Start exploring educational content now.</span>
                                    </div>
                                    <div class="mt-2 text-xs text-gray-500">
                                        Character count: <span class="font-semibold">82</span> / 160
                                    </div>
                                </div>

                                <!-- Notification Template -->
                                <div class="border rounded-lg p-4">
                                    <div class="flex items-center justify-between mb-3">
                                        <div>
                                            <h4 class="font-semibold">Notification Alert</h4>
                                            <p class="text-xs text-gray-500">General notifications</p>
                                        </div>
                                        <button onclick="editSMSTemplate('notification')" class="px-4 py-2 border rounded-lg hover:bg-gray-50 text-sm">
                                            <i class="fas fa-edit mr-1"></i>Edit
                                        </button>
                                    </div>
                                    <div class="bg-gray-50 p-3 rounded text-sm">
                                        <span class="text-gray-600">Astegni Alert: <strong class="text-blue-600">[MESSAGE]</strong></span>
                                    </div>
                                    <div class="mt-2 text-xs text-gray-500">
                                        Character count: Variable / 160
                                    </div>
                                </div>
                            </div>

                            <div class="mt-6 p-4 bg-blue-50 border border-blue-200 rounded-lg">
                                <div class="flex items-start gap-3">
                                    <i class="fas fa-info-circle text-blue-600 mt-1"></i>
                                    <div class="text-sm text-blue-800">
                                        <strong>Template Variables:</strong>
                                        <ul class="mt-2 list-disc list-inside space-y-1">
                                            <li><code>[OTP_CODE]</code> - OTP verification code</li>
                                            <li><code>[EXPIRY_TIME]</code> - OTP expiry time in minutes</li>
                                            <li><code>[USER_NAME]</code> - User's display name</li>
                                            <li><code>[MESSAGE]</code> - Custom message content</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Test SMS Section -->
                        <div class="card p-6">
                            <h3 class="text-xl font-bold mb-4">Send Test SMS</h3>
                            <div class="space-y-4">
                                <div>
                                    <label class="block text-sm font-semibold mb-2">
                                        Test Phone Number
                                    </label>
                                    <input type="tel" id="test-phone-number"
                                        class="w-full p-3 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                                        placeholder="+251912345678">
                                </div>
                                <div>
                                    <label class="block text-sm font-semibold mb-2">
                                        Test Message
                                    </label>
                                    <textarea id="test-message" rows="3"
                                        class="w-full p-3 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                                        placeholder="Enter your test message...">This is a test SMS from Astegni platform.</textarea>
                                    <p class="text-xs text-gray-500 mt-1">
                                        Character count: <span id="test-message-count">42</span> / 160
                                    </p>
                                </div>
                                <div class="flex justify-end">
                                    <button onclick="sendTestSMS()" class="px-6 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors">
                                        <i class="fas fa-paper-plane mr-2"></i>Send Test SMS
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- API Panel -->
                    <div id="api-panel" class="panel-content hidden">
                        <div class="mb-8">
                            <h1 class="text-3xl font-bold mb-2">API & Integrations</h1>
                            <p class="text-gray-600">Manage API keys and third-party integrations</p>
                        </div>
                        <div class="card p-6 mb-6">
                            <h3 class="text-xl font-bold mb-4">API Keys</h3>
                            <div class="mb-4">
                                <button class="px-4 py-2 bg-blue-500 text-white rounded-lg">Generate New API
                                    Key</button>
                            </div>
                            <div class="space-y-4">
                                <div class="border rounded-lg p-4">
                                    <div class="flex justify-between items-start mb-2">
                                        <div>
                                            <div class="font-semibold">Production API Key</div>
                                            <div class="text-sm text-gray-500">Created: Jan 15, 2025</div>
                                        </div>
                                        <button class="text-red-600 hover:underline">Revoke</button>
                                    </div>
                                    <div class="flex items-center gap-2">
                                        <code
                                            class="bg-gray-100 px-3 py-1 rounded text-sm">sk_live_************************</code>
                                        <button class="text-blue-600 hover:underline">Show</button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="card p-6">
                            <div class="flex justify-between items-center mb-4">
                                <h3 class="text-xl font-bold">Third-Party Integrations</h3>
                                <button onclick="openAddIntegrationModal()"
                                    class="px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600">
                                    <i class="fas fa-plus mr-2"></i>Add Integration
                                </button>
                            </div>
                            <div class="space-y-4">
                                <div class="flex items-center justify-between p-3 border rounded-lg">
                                    <div class="flex items-center gap-3">
                                        <svg class="w-10 h-10 rounded" viewBox="0 0 40 40" xmlns="http://www.w3.org/2000/svg">
                                            <rect width="40" height="40" fill="#4285F4"/>
                                            <text x="20" y="25" font-family="Arial" font-size="24" fill="white" text-anchor="middle">G</text>
                                        </svg>
                                        <div>
                                            <div class="font-semibold">Google OAuth</div>
                                            <div class="text-sm text-gray-500">Social login integration</div>
                                        </div>
                                    </div>
                                    <div class="flex gap-2">
                                        <span
                                            class="px-3 py-1 bg-green-100 text-green-700 rounded-full text-xs font-semibold">Active</span>
                                        <button onclick="configureIntegration('google')"
                                            class="px-4 py-2 bg-blue-500 text-white rounded-lg text-sm">Configure</button>
                                    </div>
                                </div>
                                <div class="flex items-center justify-between p-3 border rounded-lg">
                                    <div class="flex items-center gap-3">
                                        <svg class="w-10 h-10 rounded" viewBox="0 0 40 40" xmlns="http://www.w3.org/2000/svg">
                                            <rect width="40" height="40" fill="#1877F2"/>
                                            <text x="20" y="25" font-family="Arial" font-size="24" fill="white" text-anchor="middle">f</text>
                                        </svg>
                                        <div>
                                            <div class="font-semibold">Facebook Login</div>
                                            <div class="text-sm text-gray-500">Social login integration</div>
                                        </div>
                                    </div>
                                    <div class="flex gap-2">
                                        <span
                                            class="px-3 py-1 bg-green-100 text-green-700 rounded-full text-xs font-semibold">Active</span>
                                        <button onclick="configureIntegration('facebook')"
                                            class="px-4 py-2 bg-blue-500 text-white rounded-lg text-sm">Configure</button>
                                    </div>
                                </div>
                                <div class="flex items-center justify-between p-3 border rounded-lg">
                                    <div class="flex items-center gap-3">
                                        <svg class="w-10 h-10 rounded" viewBox="0 0 40 40" xmlns="http://www.w3.org/2000/svg">
                                            <rect width="40" height="40" fill="#25D366"/>
                                            <text x="20" y="26" font-family="Arial" font-size="20" fill="white" text-anchor="middle">üì±</text>
                                        </svg>
                                        <div>
                                            <div class="font-semibold">SMS Gateway</div>
                                            <div class="text-sm text-gray-500">SMS notifications</div>
                                        </div>
                                    </div>
                                    <div class="flex gap-2">
                                        <span
                                            class="px-3 py-1 bg-gray-100 text-gray-700 rounded-full text-xs font-semibold">Inactive</span>
                                        <button onclick="configureIntegration('sms')"
                                            class="px-4 py-2 bg-blue-500 text-white rounded-lg text-sm">Configure</button>
                                    </div>
                                </div>
                            </div>

                            <!-- Available Integrations Info -->
                            <div class="mt-6 p-4 bg-blue-50 dark:bg-blue-900 dark:bg-opacity-20 rounded-lg">
                                <h4 class="font-semibold mb-2 flex items-center gap-2">
                                    <i class="fas fa-info-circle text-blue-600"></i>
                                    Available Integration Types
                                </h4>
                                <ul class="text-sm text-gray-600 dark:text-gray-400 space-y-1 ml-6">
                                    <li>‚Ä¢ Social Login (Google, Facebook, Twitter, GitHub, LinkedIn)</li>
                                    <li>‚Ä¢ Communication (Email, SMS, Push Notifications)</li>
                                    <li>‚Ä¢ Analytics (Google Analytics, Mixpanel, Amplitude)</li>
                                    <li>‚Ä¢ Payment Gateways (Stripe, PayPal, Telebirr)</li>
                                    <li>‚Ä¢ Cloud Storage (AWS S3, Google Cloud, Azure)</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <!-- Maintenance Panel -->
                    <div id="maintenance-panel" class="panel-content hidden">
                        <div class="mb-8">
                            <h1 class="text-3xl font-bold mb-2">Maintenance Mode</h1>
                            <p class="text-gray-600">Control maintenance mode and perform system tasks</p>
                        </div>
                        <div class="card p-6 mb-6">
                            <h3 class="text-xl font-bold mb-4">Maintenance Mode</h3>
                            <div class="mb-6">
                                <label class="flex items-center gap-3">
                                    <input type="checkbox" class="w-6 h-6" id="maintenance-toggle">
                                    <span class="text-lg font-semibold">Enable Maintenance Mode</span>
                                </label>
                                <p class="text-sm text-gray-500 mt-2">When enabled, only administrators can access the
                                    platform</p>
                            </div>

                            <div class="space-y-4">
                                <div>
                                    <label class="block mb-2 font-semibold">Maintenance Message</label>
                                    <textarea class="w-full p-2 border rounded-lg"
                                        rows="3">We're currently performing scheduled maintenance. We'll be back soon!</textarea>
                                </div>
                                <div>
                                    <label class="block mb-2 font-semibold">Expected End Time</label>
                                    <input type="datetime-local" class="w-full p-2 border rounded-lg">
                                </div>
                                <div>
                                    <label class="block mb-2 font-semibold">Allow IP Addresses (one per line)</label>
                                    <textarea class="w-full p-2 border rounded-lg" rows="3" placeholder="127.0.0.1
192.168.1.1"></textarea>
                                </div>
                            </div>
                        </div>

                        <div class="card p-6">
                            <h3 class="text-xl font-bold mb-4">System Maintenance Tasks</h3>
                            <div class="space-y-4">
                                <div class="flex items-center justify-between p-3 border rounded-lg">
                                    <div>
                                        <div class="font-semibold">Clear Cache</div>
                                        <div class="text-sm text-gray-500">Remove all cached data</div>
                                    </div>
                                    <button onclick="clearCache()"
                                        class="px-4 py-2 bg-red-500 text-white rounded-lg text-sm">Clear Now</button>
                                </div>
                                <div class="flex items-center justify-between p-3 border rounded-lg">
                                    <div>
                                        <div class="font-semibold">Optimize Database</div>
                                        <div class="text-sm text-gray-500">Improve database performance</div>
                                    </div>
                                    <button
                                        class="px-4 py-2 bg-blue-500 text-white rounded-lg text-sm">Optimize</button>
                                </div>
                                <div class="flex items-center justify-between p-3 border rounded-lg">
                                    <div>
                                        <div class="font-semibold">Clean Temporary Files</div>
                                        <div class="text-sm text-gray-500">Remove temporary uploads and logs</div>
                                    </div>
                                    <button class="px-4 py-2 bg-yellow-500 text-white rounded-lg text-sm">Clean</button>
                                </div>
                                <div class="flex items-center justify-between p-3 border rounded-lg">
                                    <div>
                                        <div class="font-semibold">Rebuild Search Index</div>
                                        <div class="text-sm text-gray-500">Update search database</div>
                                    </div>
                                    <button
                                        class="px-4 py-2 bg-green-500 text-white rounded-lg text-sm">Rebuild</button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- System Logs Panel -->
                    <div id="logs-panel" class="panel-content hidden">
                        <div class="mb-8">
                            <h1 class="text-3xl font-bold mb-2">System Logs</h1>
                            <p class="text-gray-600">View and analyze system activity logs</p>
                        </div>
                        <div class="card p-6">
                            <div class="mb-4">
                                <div class="flex gap-4 mb-4">
                                    <select class="p-2 border rounded-lg">
                                        <option>All Logs</option>
                                        <option>Error Logs</option>
                                        <option>Warning Logs</option>
                                        <option>Info Logs</option>
                                        <option>Debug Logs</option>
                                    </select>
                                    <input type="date" class="p-2 border rounded-lg" />
                                    <button class="px-4 py-2 bg-blue-500 text-white rounded-lg">Filter</button>
                                </div>
                            </div>
                            <div class="overflow-x-auto">
                                <table class="w-full">
                                    <thead>
                                        <tr class="border-b">
                                            <th class="p-3 text-left">Time</th>
                                            <th class="p-3 text-left">Level</th>
                                            <th class="p-3 text-left">Component</th>
                                            <th class="p-3 text-left">Message</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr class="border-b">
                                            <td class="p-3">2025-01-28 14:32:15</td>
                                            <td class="p-3"><span
                                                    class="px-2 py-1 bg-green-100 text-green-800 rounded text-sm">INFO</span>
                                            </td>
                                            <td class="p-3">Auth</td>
                                            <td class="p-3">User login successful: admin@astegni.com</td>
                                        </tr>
                                        <tr class="border-b">
                                            <td class="p-3">2025-01-28 14:30:45</td>
                                            <td class="p-3"><span
                                                    class="px-2 py-1 bg-yellow-100 text-yellow-800 rounded text-sm">WARN</span>
                                            </td>
                                            <td class="p-3">Database</td>
                                            <td class="p-3">Query execution time exceeded threshold: 1.2s</td>
                                        </tr>
                                        <tr class="border-b">
                                            <td class="p-3">2025-01-28 14:28:10</td>
                                            <td class="p-3"><span
                                                    class="px-2 py-1 bg-red-100 text-red-800 rounded text-sm">ERROR</span>
                                            </td>
                                            <td class="p-3">Upload</td>
                                            <td class="p-3">File upload failed: Size exceeds limit</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>

                    <!-- Performance Monitor Panel -->
                    <div id="performance-panel" class="panel-content hidden">
                        <div class="mb-8">
                            <h1 class="text-3xl font-bold mb-2">Performance Monitor</h1>
                            <p class="text-gray-600">Real-time system performance metrics</p>
                        </div>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div class="card p-6">
                                <h3 class="text-xl font-bold mb-4">Server Resources</h3>
                                <div class="space-y-4">
                                    <div>
                                        <div class="flex justify-between mb-1">
                                            <span>CPU Usage</span>
                                            <span class="text-sm font-bold">35%</span>
                                        </div>
                                        <div class="w-full bg-gray-200 rounded-full h-2">
                                            <div class="bg-green-600 h-2 rounded-full" style="width: 35%"></div>
                                        </div>
                                    </div>
                                    <div>
                                        <div class="flex justify-between mb-1">
                                            <span>Memory Usage</span>
                                            <span class="text-sm font-bold">62%</span>
                                        </div>
                                        <div class="w-full bg-gray-200 rounded-full h-2">
                                            <div class="bg-yellow-600 h-2 rounded-full" style="width: 62%"></div>
                                        </div>
                                    </div>
                                    <div>
                                        <div class="flex justify-between mb-1">
                                            <span>Disk Usage</span>
                                            <span class="text-sm font-bold">25%</span>
                                        </div>
                                        <div class="w-full bg-gray-200 rounded-full h-2">
                                            <div class="bg-blue-600 h-2 rounded-full" style="width: 25%"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="card p-6">
                                <h3 class="text-xl font-bold mb-4">Network Stats</h3>
                                <div class="space-y-3">
                                    <div class="flex justify-between">
                                        <span>Bandwidth In</span>
                                        <span class="font-bold">125 Mbps</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span>Bandwidth Out</span>
                                        <span class="font-bold">89 Mbps</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span>Active Sessions</span>
                                        <span class="font-bold">3,842</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span>Request Rate</span>
                                        <span class="font-bold">1,250 req/s</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Manage Reviews Panel -->
                    <div id="manage-reviews-panel" class="panel-content hidden">
                        <div class="mb-8">
                            <div class="flex justify-between items-center">
                                <div>
                                    <h1 class="text-3xl font-bold mb-2 flex items-center gap-3">
                                        <i class="fas fa-star text-yellow-500"></i>
                                        Manage Platform Reviews
                                    </h1>
                                    <p class="text-gray-600">View and manage reviews given to Astegni by users</p>
                                </div>
                            </div>
                        </div>

                        <!-- Role Filter Stats Cards -->
                        <div id="review-stats-container"></div>

                        <!-- Rating Filter Buttons -->
                        <div id="rating-filters-container"></div>

                        <!-- Reviews List -->
                        <div id="reviews-list-container"></div>
                    </div>

                    <!-- Reports Panel -->
                    <div id="reports-panel" class="panel-content hidden">
                        <div class="mb-8">
                            <div class="flex justify-between items-center">
                                <div>
                                    <h1 class="text-3xl font-bold mb-2 flex items-center gap-3">
                                        <i class="fas fa-chart-line text-blue-600"></i>
                                        Platform Analytics & Reports
                                    </h1>
                                    <p class="text-gray-600">Comprehensive insights into platform performance and user
                                        engagement</p>
                                </div>

                                <!-- Time Period Selector -->
                                <div class="flex gap-2">
                                    <button onclick="switchReportPeriod('month')" id="period-month"
                                        class="report-period-btn active px-4 py-2 rounded-lg bg-blue-600 text-white hover:bg-blue-700 transition-all text-sm">
                                        <i class="fas fa-calendar-day mr-2"></i>This Month
                                    </button>
                                    <button onclick="switchReportPeriod('year')" id="period-year"
                                        class="report-period-btn px-4 py-2 rounded-lg bg-gray-200 hover:bg-gray-300 transition-all text-sm">
                                        <i class="fas fa-calendar-alt mr-2"></i>This Year
                                    </button>
                                    <button onclick="switchReportPeriod('lastMonth')" id="period-lastMonth"
                                        class="report-period-btn px-4 py-2 rounded-lg bg-gray-200 hover:bg-gray-300 transition-all text-sm">
                                        <i class="fas fa-history mr-2"></i>Last Month
                                    </button>
                                </div>
                            </div>
                        </div>

                        <!-- Quick Stats Cards -->
                        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6">
                            <!-- Total Users -->
                            <div
                                class="bg-gradient-to-br from-blue-500 to-blue-600 text-white p-6 rounded-xl shadow-lg">
                                <div class="flex justify-between items-start">
                                    <div>
                                        <p class="text-blue-100 text-sm font-medium">Total Registered Users</p>
                                        <h3 class="text-4xl font-bold mt-2" id="total-users">0</h3>
                                        <p class="text-blue-100 text-xs mt-2">
                                            <i class="fas fa-arrow-up mr-1"></i>
                                            <span id="stat-total-users-change">+0%</span> from last period
                                        </p>
                                    </div>
                                    <div class="bg-white bg-opacity-20 p-3 rounded-lg">
                                        <i class="fas fa-users text-2xl"></i>
                                    </div>
                                </div>
                            </div>

                            <!-- Premium Subscribers -->
                            <div
                                class="bg-gradient-to-br from-purple-500 to-purple-600 text-white p-6 rounded-xl shadow-lg">
                                <div class="flex justify-between items-start">
                                    <div>
                                        <p class="text-purple-100 text-sm font-medium">Premium Subscribers</p>
                                        <h3 class="text-4xl font-bold mt-2" id="stat-premium-users">0</h3>
                                        <p class="text-purple-100 text-xs mt-2">
                                            <i class="fas fa-arrow-up mr-1"></i>
                                            <span id="stat-premium-users-change">+0%</span> from last period
                                        </p>
                                    </div>
                                    <div class="bg-white bg-opacity-20 p-3 rounded-lg">
                                        <i class="fas fa-crown text-2xl"></i>
                                    </div>
                                </div>
                            </div>

                            <!-- Total Revenue -->
                            <div
                                class="bg-gradient-to-br from-green-500 to-green-600 text-white p-6 rounded-xl shadow-lg">
                                <div class="flex justify-between items-start">
                                    <div>
                                        <p class="text-green-100 text-sm font-medium">Total Revenue</p>
                                        <h3 class="text-4xl font-bold mt-2" id="stat-revenue">0 ETB</h3>
                                        <p class="text-green-100 text-xs mt-2">
                                            <i class="fas fa-arrow-up mr-1"></i>
                                            <span id="stat-revenue-change">+0%</span> from last period
                                        </p>
                                    </div>
                                    <div class="bg-white bg-opacity-20 p-3 rounded-lg">
                                        <i class="fas fa-money-bill-wave text-2xl"></i>
                                    </div>
                                </div>
                            </div>

                            <!-- User Satisfaction -->
                            <div
                                class="bg-gradient-to-br from-orange-500 to-orange-600 text-white p-6 rounded-xl shadow-lg">
                                <div class="flex justify-between items-start">
                                    <div>
                                        <p class="text-orange-100 text-sm font-medium">Satisfaction Score</p>
                                        <h3 class="text-4xl font-bold mt-2" id="stat-satisfaction">0%</h3>
                                        <p class="text-orange-100 text-xs mt-2">
                                            <i class="fas fa-star mr-1"></i>
                                            <span id="stat-satisfaction-rating">0.0/5.0</span> average rating
                                        </p>
                                    </div>
                                    <div class="bg-white bg-opacity-20 p-3 rounded-lg">
                                        <i class="fas fa-smile text-2xl"></i>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Main Analytics Section -->
                        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-6">
                            <!-- User Breakdown by Role -->
                            <div class="lg:col-span-2 card p-6">
                                <div class="flex justify-between items-center mb-4">
                                    <h3 class="text-xl font-bold">
                                        <i class="fas fa-user-tag mr-2 text-blue-600"></i>
                                        User Registration by Role
                                    </h3>
                                    <div class="flex gap-2">
                                        <button onclick="switchChartType('userChart', 'bar')"
                                            class="px-3 py-1 text-sm bg-blue-100 dark:bg-blue-900 text-blue-600 dark:text-blue-300 rounded hover:bg-blue-200 dark:hover:bg-blue-800">
                                            <i class="fas fa-chart-bar"></i>
                                        </button>
                                        <button onclick="switchChartType('userChart', 'line')"
                                            class="px-3 py-1 text-sm bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-300 rounded hover:bg-gray-200 dark:hover:bg-gray-600">
                                            <i class="fas fa-chart-line"></i>
                                        </button>
                                    </div>
                                </div>
                                <canvas id="userChart" height="300"></canvas>
                            </div>

                            <!-- Role Distribution -->
                            <div class="card p-6">
                                <h3 class="text-xl font-bold mb-4">
                                    <i class="fas fa-pie-chart mr-2 text-purple-600"></i>
                                    User Distribution
                                </h3>
                                <div class="space-y-3">
                                    <div
                                        class="flex items-center justify-between p-3 bg-blue-50 dark:bg-blue-900 dark:bg-opacity-20 rounded-lg">
                                        <div class="flex items-center gap-2">
                                            <i class="fas fa-graduation-cap text-blue-600"></i>
                                            <span class="font-medium">Students</span>
                                        </div>
                                        <span class="font-bold text-blue-600" id="count-students">0</span>
                                    </div>
                                    <div
                                        class="flex items-center justify-between p-3 bg-purple-50 dark:bg-purple-900 dark:bg-opacity-20 rounded-lg">
                                        <div class="flex items-center gap-2">
                                            <i class="fas fa-chalkboard-teacher text-purple-600"></i>
                                            <span class="font-medium">Tutors</span>
                                        </div>
                                        <span class="font-bold text-purple-600" id="count-tutors">0</span>
                                    </div>
                                    <div
                                        class="flex items-center justify-between p-3 bg-green-50 dark:bg-green-900 dark:bg-opacity-20 rounded-lg">
                                        <div class="flex items-center gap-2">
                                            <i class="fas fa-user-friends text-green-600"></i>
                                            <span class="font-medium">Parents</span>
                                        </div>
                                        <span class="font-bold text-green-600" id="count-parents">0</span>
                                    </div>
                                    <div
                                        class="flex items-center justify-between p-3 bg-orange-50 dark:bg-orange-900 dark:bg-opacity-20 rounded-lg">
                                        <div class="flex items-center gap-2">
                                            <i class="fas fa-bullhorn text-orange-600"></i>
                                            <span class="font-medium">Advertisers</span>
                                        </div>
                                        <span class="font-bold text-orange-600" id="count-advertisers">0</span>
                                    </div>
                                    <div
                                        class="flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-700 rounded-lg">
                                        <div class="flex items-center gap-2">
                                            <i class="fas fa-user text-gray-600"></i>
                                            <span class="font-medium">Basic Users</span>
                                        </div>
                                        <span class="font-bold text-gray-600 dark:text-gray-300"
                                            id="count-basic">0</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Revenue Analytics -->
                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6">
                            <!-- Revenue Breakdown -->
                            <div class="card p-6">
                                <div class="flex justify-between items-center mb-4">
                                    <h3 class="text-xl font-bold">
                                        <i class="fas fa-dollar-sign mr-2 text-green-600"></i>
                                        Revenue Breakdown
                                    </h3>
                                    <div class="flex gap-2">
                                        <button onclick="switchChartType('revenueChart', 'bar')"
                                            class="px-3 py-1 text-sm bg-green-100 dark:bg-green-900 text-green-600 dark:text-green-300 rounded hover:bg-green-200 dark:hover:bg-green-800">
                                            <i class="fas fa-chart-bar"></i>
                                        </button>
                                        <button onclick="switchChartType('revenueChart', 'line')"
                                            class="px-3 py-1 text-sm bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-300 rounded hover:bg-gray-200 dark:hover:bg-gray-600">
                                            <i class="fas fa-chart-line"></i>
                                        </button>
                                    </div>
                                </div>
                                <canvas id="revenueChart" height="300"></canvas>
                            </div>

                            <!-- Subscription Tiers -->
                            <div class="card p-6">
                                <h3 class="text-xl font-bold mb-4">
                                    <i class="fas fa-layer-group mr-2 text-indigo-600"></i>
                                    Subscription Tiers
                                </h3>
                                <div class="space-y-4">
                                    <div class="p-4 bg-gray-50 dark:bg-gray-700 rounded-lg">
                                        <div class="flex justify-between items-center mb-2">
                                            <span class="font-semibold">Free Tier</span>
                                            <span class="font-bold" id="count-free">0</span>
                                        </div>
                                        <div class="w-full bg-gray-200 dark:bg-gray-600 rounded-full h-2">
                                            <div id="bar-free" class="bg-gray-400 dark:bg-gray-500 h-2 rounded-full"
                                                style="width: 0%"></div>
                                        </div>
                                    </div>
                                    <div class="p-4 bg-blue-50 dark:bg-blue-900 dark:bg-opacity-20 rounded-lg">
                                        <div class="flex justify-between items-center mb-2">
                                            <span class="font-semibold">Basic (Paid)</span>
                                            <span class="font-bold text-blue-600" id="count-basic-paid">0</span>
                                        </div>
                                        <div class="w-full bg-gray-200 dark:bg-gray-600 rounded-full h-2">
                                            <div id="bar-basic" class="bg-blue-500 h-2 rounded-full" style="width: 0%">
                                            </div>
                                        </div>
                                        <p class="text-sm text-gray-600 dark:text-gray-400 mt-2">
                                            Revenue: <span class="font-semibold" id="revenue-basic">0 ETB</span>
                                        </p>
                                    </div>
                                    <div class="p-4 bg-purple-50 dark:bg-purple-900 dark:bg-opacity-20 rounded-lg">
                                        <div class="flex justify-between items-center mb-2">
                                            <span class="font-semibold">Premium (Paid)</span>
                                            <span class="font-bold text-purple-600" id="count-premium-paid">0</span>
                                        </div>
                                        <div class="w-full bg-gray-200 dark:bg-gray-600 rounded-full h-2">
                                            <div id="bar-premium" class="bg-purple-500 h-2 rounded-full"
                                                style="width: 0%"></div>
                                        </div>
                                        <p class="text-sm text-gray-600 dark:text-gray-400 mt-2">
                                            Revenue: <span class="font-semibold" id="revenue-premium">0 ETB</span>
                                        </p>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Satisfaction & Churn Analysis -->
                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6">
                            <!-- Satisfaction Metrics -->
                            <div class="card p-6">
                                <h3 class="text-xl font-bold mb-4">
                                    <i class="fas fa-heart mr-2 text-pink-600"></i>
                                    User Satisfaction
                                </h3>
                                <div class="space-y-4">
                                    <div class="p-4 bg-green-50 dark:bg-green-900 dark:bg-opacity-20 rounded-lg">
                                        <div class="flex justify-between items-center mb-2">
                                            <span class="font-medium">Platform Experience</span>
                                            <div class="flex items-center gap-2">
                                                <span class="text-yellow-500">
                                                    <i class="fas fa-star"></i>
                                                    <i class="fas fa-star"></i>
                                                    <i class="fas fa-star"></i>
                                                    <i class="fas fa-star"></i>
                                                    <i class="fas fa-star-half-alt"></i>
                                                </span>
                                                <span class="font-bold text-green-600" id="rating-platform">4.5</span>
                                            </div>
                                        </div>
                                        <div class="w-full bg-gray-200 dark:bg-gray-600 rounded-full h-2">
                                            <div class="bg-green-500 h-2 rounded-full" style="width: 90%"></div>
                                        </div>
                                        <p class="text-sm text-gray-600 dark:text-gray-400 mt-2">
                                            <span class="font-semibold" id="count-happy-platform">0</span> users
                                            satisfied
                                        </p>
                                    </div>
                                    <div class="p-4 bg-blue-50 dark:bg-blue-900 dark:bg-opacity-20 rounded-lg">
                                        <div class="flex justify-between items-center mb-2">
                                            <span class="font-medium">Admin Services</span>
                                            <div class="flex items-center gap-2">
                                                <span class="text-yellow-500">
                                                    <i class="fas fa-star"></i>
                                                    <i class="fas fa-star"></i>
                                                    <i class="fas fa-star"></i>
                                                    <i class="fas fa-star"></i>
                                                    <i class="far fa-star"></i>
                                                </span>
                                                <span class="font-bold text-blue-600" id="rating-admin">4.2</span>
                                            </div>
                                        </div>
                                        <div class="w-full bg-gray-200 dark:bg-gray-600 rounded-full h-2">
                                            <div class="bg-blue-500 h-2 rounded-full" style="width: 84%"></div>
                                        </div>
                                        <p class="text-sm text-gray-600 dark:text-gray-400 mt-2">
                                            <span class="font-semibold" id="count-happy-admin">0</span> users satisfied
                                        </p>
                                    </div>
                                </div>
                            </div>

                            <!-- Churn Analysis -->
                            <div class="card p-6">
                                <h3 class="text-xl font-bold mb-4">
                                    <i class="fas fa-user-minus mr-2 text-red-600"></i>
                                    User Churn Analysis
                                </h3>
                                <div class="space-y-4">
                                    <div class="p-4 bg-red-50 dark:bg-red-900 dark:bg-opacity-20 rounded-lg">
                                        <div class="flex justify-between items-center mb-2">
                                            <span class="font-medium">Advertiser Churn</span>
                                            <span class="font-bold text-red-600" id="churn-advertisers">0%</span>
                                        </div>
                                        <div class="w-full bg-gray-200 dark:bg-gray-600 rounded-full h-2 mb-2">
                                            <div id="bar-churn-advertisers" class="bg-red-500 h-2 rounded-full"
                                                style="width: 0%"></div>
                                        </div>
                                        <p class="text-sm text-gray-600 dark:text-gray-400">
                                            <span class="font-semibold" id="count-churn-advertisers">0</span>
                                            advertisers left this period
                                        </p>
                                    </div>
                                    <div class="p-4 bg-orange-50 dark:bg-orange-900 dark:bg-opacity-20 rounded-lg">
                                        <div class="flex justify-between items-center mb-2">
                                            <span class="font-medium">User Churn</span>
                                            <span class="font-bold text-orange-600" id="churn-users">0%</span>
                                        </div>
                                        <div class="w-full bg-gray-200 dark:bg-gray-600 rounded-full h-2 mb-2">
                                            <div id="bar-churn-users" class="bg-orange-500 h-2 rounded-full"
                                                style="width: 0%"></div>
                                        </div>
                                        <p class="text-sm text-gray-600 dark:text-gray-400">
                                            <span class="font-semibold" id="count-churn-users">0</span> users left this
                                            period
                                        </p>
                                    </div>
                                    <div class="p-4 bg-yellow-50 dark:bg-yellow-900 dark:bg-opacity-20 rounded-lg">
                                        <p class="text-sm font-semibold mb-2">
                                            <i class="fas fa-lightbulb text-yellow-600 mr-2"></i>
                                            Top Reasons for Leaving:
                                        </p>
                                        <ul class="text-sm text-gray-600 dark:text-gray-400 space-y-1 ml-6">
                                            <li>‚Ä¢ Pricing concerns (35%)</li>
                                            <li>‚Ä¢ Limited features (28%)</li>
                                            <li>‚Ä¢ Technical issues (22%)</li>
                                            <li class="flex items-center justify-between">
                                                <span>‚Ä¢ Other (15%)</span>
                                                <button onclick="openChurnOthersModal()"
                                                    class="text-blue-600 dark:text-blue-400 hover:underline text-xs font-semibold ml-2">
                                                    View Details ‚Üí
                                                </button>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Campaign Analytics -->
                        <div class="card p-6 mb-6">
                            <div class="flex justify-between items-center mb-4">
                                <h3 class="text-xl font-bold">
                                    <i class="fas fa-ad mr-2 text-indigo-600"></i>
                                    Campaign Revenue & Performance
                                </h3>
                                <div class="flex gap-2">
                                    <button onclick="switchChartType('campaignChart', 'bar')"
                                        class="px-3 py-1 text-sm bg-indigo-100 dark:bg-indigo-900 text-indigo-600 dark:text-indigo-300 rounded hover:bg-indigo-200 dark:hover:bg-indigo-800">
                                        <i class="fas fa-chart-bar"></i>
                                    </button>
                                    <button onclick="switchChartType('campaignChart', 'line')"
                                        class="px-3 py-1 text-sm bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-300 rounded hover:bg-gray-200 dark:hover:bg-gray-600">
                                        <i class="fas fa-chart-line"></i>
                                    </button>
                                </div>
                            </div>
                            <canvas id="campaignChart" height="250"></canvas>
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mt-4">
                                <div
                                    class="text-center p-4 bg-indigo-50 dark:bg-indigo-900 dark:bg-opacity-20 rounded-lg">
                                    <p class="text-sm text-gray-600 dark:text-gray-400">Total Campaigns</p>
                                    <p class="text-2xl font-bold text-indigo-600" id="count-campaigns">0</p>
                                </div>
                                <div
                                    class="text-center p-4 bg-green-50 dark:bg-green-900 dark:bg-opacity-20 rounded-lg">
                                    <p class="text-sm text-gray-600 dark:text-gray-400">Active Campaigns</p>
                                    <p class="text-2xl font-bold text-green-600" id="count-campaigns-active">0</p>
                                </div>
                                <div
                                    class="text-center p-4 bg-purple-50 dark:bg-purple-900 dark:bg-opacity-20 rounded-lg">
                                    <p class="text-sm text-gray-600 dark:text-gray-400">Campaign Revenue</p>
                                    <p class="text-2xl font-bold text-purple-600" id="revenue-campaigns">0 ETB</p>
                                </div>
                            </div>
                        </div>

                        <!-- AI Analysis & Insights -->
                        <div
                            class="bg-gradient-to-r from-indigo-500 to-purple-600 text-white rounded-xl shadow-lg p-6 mb-6">
                            <h3 class="text-2xl font-bold mb-4 flex items-center gap-2">
                                <i class="fas fa-brain"></i>
                                AI-Powered Insights & Analysis
                            </h3>

                            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                                <!-- This Month Analysis -->
                                <div class="bg-white bg-opacity-10 backdrop-blur-sm rounded-lg p-4">
                                    <h4 class="font-bold mb-2 flex items-center gap-2">
                                        <i class="fas fa-calendar-check"></i>
                                        This Month's Performance
                                    </h4>
                                    <ul class="space-y-2 text-sm">
                                        <li class="flex items-start gap-2">
                                            <i class="fas fa-arrow-up text-green-300 mt-1"></i>
                                            <span id="ai-month-growth">15% increase in user registrations compared to
                                                last month</span>
                                        </li>
                                        <li class="flex items-start gap-2">
                                            <i class="fas fa-trophy text-yellow-300 mt-1"></i>
                                            <span id="ai-month-achievement">Highest premium conversion rate (12.5%)
                                                achieved this quarter</span>
                                        </li>
                                        <li class="flex items-start gap-2">
                                            <i class="fas fa-star text-yellow-300 mt-1"></i>
                                            <span id="ai-month-highlight">Tutor engagement increased by 23%</span>
                                        </li>
                                    </ul>
                                </div>

                                <!-- Last Year Overview -->
                                <div class="bg-white bg-opacity-10 backdrop-blur-sm rounded-lg p-4">
                                    <h4 class="font-bold mb-2 flex items-center gap-2">
                                        <i class="fas fa-chart-line"></i>
                                        Last Year's Trends
                                    </h4>
                                    <ul class="space-y-2 text-sm">
                                        <li class="flex items-start gap-2">
                                            <i class="fas fa-users text-blue-300 mt-1"></i>
                                            <span id="ai-year-users">Total user base grew by 145% year-over-year</span>
                                        </li>
                                        <li class="flex items-start gap-2">
                                            <i class="fas fa-money-bill-wave text-green-300 mt-1"></i>
                                            <span id="ai-year-revenue">Revenue increased by 180% with strong Q4
                                                performance</span>
                                        </li>
                                        <li class="flex items-start gap-2">
                                            <i class="fas fa-smile text-yellow-300 mt-1"></i>
                                            <span id="ai-year-satisfaction">User satisfaction maintained above 4.3/5.0
                                                throughout the year</span>
                                        </li>
                                    </ul>
                                </div>

                                <!-- Future Recommendations -->
                                <div class="bg-white bg-opacity-10 backdrop-blur-sm rounded-lg p-4">
                                    <h4 class="font-bold mb-2 flex items-center gap-2">
                                        <i class="fas fa-lightbulb"></i>
                                        Recommendations
                                    </h4>
                                    <ul class="space-y-2 text-sm">
                                        <li class="flex items-start gap-2">
                                            <i class="fas fa-target text-orange-300 mt-1"></i>
                                            <span id="ai-future-focus">Focus on reducing advertiser churn by improving
                                                analytics dashboard</span>
                                        </li>
                                        <li class="flex items-start gap-2">
                                            <i class="fas fa-rocket text-blue-300 mt-1"></i>
                                            <span id="ai-future-growth">Launch referral program to capitalize on high
                                                satisfaction rates</span>
                                        </li>
                                        <li class="flex items-start gap-2">
                                            <i class="fas fa-gift text-pink-300 mt-1"></i>
                                            <span id="ai-future-retention">Introduce loyalty rewards for users
                                                completing 6+ months</span>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </div>

                        <!-- Export Buttons -->
                        <div class="flex justify-end gap-3">
                            <button onclick="exportReportPDF()"
                                class="px-6 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-all font-medium flex items-center gap-2">
                                <i class="fas fa-file-pdf"></i>
                                Export PDF
                            </button>
                            <button onclick="exportReportExcel()"
                                class="px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-all font-medium flex items-center gap-2">
                                <i class="fas fa-file-excel"></i>
                                Export Excel
                            </button>
                        </div>
                    </div>

                    <!-- Credentials Panel -->
                    <div id="credentials-panel" class="panel-content hidden">
                        <div class="mb-8">
                            <div class="flex justify-between items-start">
                                <div>
                                    <h1 class="text-3xl font-bold mb-2 flex items-center gap-3">
                                        <i class="fas fa-certificate text-purple-600"></i>
                                        Credentials & Qualifications
                                    </h1>
                                    <p class="text-gray-600">Your professional achievements and experience in system administration</p>
                                </div>
                                <button onclick="openAddCredentialModal()" class="px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-all font-medium flex items-center gap-2">
                                    <i class="fas fa-plus"></i>
                                    Add Credential
                                </button>
                            </div>
                        </div>

                        <!-- Tab Navigation -->
                        <div class="flex gap-2 mb-6">
                            <button id="achievements-tab" onclick="switchCredentialsSection('achievements')"
                                class="px-6 py-3 rounded-lg font-medium transition-all bg-blue-500 text-white">
                                <i class="fas fa-trophy mr-2"></i>Achievements
                            </button>
                            <button id="experience-tab" onclick="switchCredentialsSection('experience')"
                                class="px-6 py-3 rounded-lg font-medium transition-all bg-gray-100 hover:bg-gray-200">
                                <i class="fas fa-briefcase mr-2"></i>Experience
                            </button>
                        </div>

                        <!-- Achievements Section -->
                        <div id="credentials-achievements-section">
                            <!-- Achievement Badges -->
                            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8">
                                <div class="card p-6 text-center">
                                    <div class="w-20 h-20 mx-auto mb-4 rounded-full bg-gradient-to-br from-purple-500 to-indigo-600 flex items-center justify-center">
                                        <i class="fas fa-cog text-white text-3xl"></i>
                                    </div>
                                    <h3 class="font-bold text-lg mb-2">System Architect</h3>
                                    <p class="text-gray-600 text-sm">Expert in system configuration and architecture</p>
                                    <span class="inline-block mt-3 px-3 py-1 bg-purple-100 text-purple-600 rounded-full text-xs font-medium">Elite Badge</span>
                                </div>

                                <div class="card p-6 text-center">
                                    <div class="w-20 h-20 mx-auto mb-4 rounded-full bg-gradient-to-br from-green-500 to-teal-600 flex items-center justify-center">
                                        <i class="fas fa-shield-alt text-white text-3xl"></i>
                                    </div>
                                    <h3 class="font-bold text-lg mb-2">Security Guardian</h3>
                                    <p class="text-gray-600 text-sm">Maintained 99.9% system security uptime</p>
                                    <span class="inline-block mt-3 px-3 py-1 bg-green-100 text-green-600 rounded-full text-xs font-medium">Expert Badge</span>
                                </div>

                                <div class="card p-6 text-center">
                                    <div class="w-20 h-20 mx-auto mb-4 rounded-full bg-gradient-to-br from-blue-500 to-cyan-600 flex items-center justify-center">
                                        <i class="fas fa-database text-white text-3xl"></i>
                                    </div>
                                    <h3 class="font-bold text-lg mb-2">Database Master</h3>
                                    <p class="text-gray-600 text-sm">Managed 500+ database migrations successfully</p>
                                    <span class="inline-block mt-3 px-3 py-1 bg-blue-100 text-blue-600 rounded-full text-xs font-medium">Senior Badge</span>
                                </div>
                            </div>

                            <!-- Certifications -->
                            <div class="card p-6 mb-6">
                                <h3 class="text-xl font-bold mb-4 flex items-center gap-2">
                                    <i class="fas fa-award text-yellow-500"></i>
                                    Certifications & Training
                                </h3>
                                <div class="space-y-4">
                                    <div class="flex items-center justify-between p-4 bg-gray-50 dark:bg-gray-800 rounded-lg">
                                        <div class="flex items-center gap-4">
                                            <div class="w-12 h-12 bg-purple-100 rounded-lg flex items-center justify-center">
                                                <i class="fas fa-certificate text-purple-600 text-xl"></i>
                                            </div>
                                            <div>
                                                <h4 class="font-semibold">AWS Certified Solutions Architect</h4>
                                                <p class="text-sm text-gray-500">Amazon Web Services</p>
                                            </div>
                                        </div>
                                        <span class="text-sm text-green-600 font-medium">Valid until 2026</span>
                                    </div>
                                    <div class="flex items-center justify-between p-4 bg-gray-50 dark:bg-gray-800 rounded-lg">
                                        <div class="flex items-center gap-4">
                                            <div class="w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center">
                                                <i class="fas fa-shield-alt text-blue-600 text-xl"></i>
                                            </div>
                                            <div>
                                                <h4 class="font-semibold">Certified Information Security Manager (CISM)</h4>
                                                <p class="text-sm text-gray-500">ISACA</p>
                                            </div>
                                        </div>
                                        <span class="text-sm text-green-600 font-medium">Valid until 2025</span>
                                    </div>
                                    <div class="flex items-center justify-between p-4 bg-gray-50 dark:bg-gray-800 rounded-lg">
                                        <div class="flex items-center gap-4">
                                            <div class="w-12 h-12 bg-orange-100 rounded-lg flex items-center justify-center">
                                                <i class="fas fa-database text-orange-600 text-xl"></i>
                                            </div>
                                            <div>
                                                <h4 class="font-semibold">PostgreSQL Professional Certification</h4>
                                                <p class="text-sm text-gray-500">PostgreSQL Global Development Group</p>
                                            </div>
                                        </div>
                                        <span class="text-sm text-green-600 font-medium">Valid until 2026</span>
                                    </div>
                                </div>
                            </div>

                            <!-- Stats Summary -->
                            <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                                <div class="card p-4 text-center">
                                    <i class="fas fa-server text-3xl text-blue-500 mb-2"></i>
                                    <div class="text-2xl font-bold">50+</div>
                                    <div class="text-sm text-gray-500">Systems Managed</div>
                                </div>
                                <div class="card p-4 text-center">
                                    <i class="fas fa-bug text-3xl text-red-500 mb-2"></i>
                                    <div class="text-2xl font-bold">1,200+</div>
                                    <div class="text-sm text-gray-500">Issues Resolved</div>
                                </div>
                                <div class="card p-4 text-center">
                                    <i class="fas fa-clock text-3xl text-green-500 mb-2"></i>
                                    <div class="text-2xl font-bold">99.99%</div>
                                    <div class="text-sm text-gray-500">Uptime Achieved</div>
                                </div>
                                <div class="card p-4 text-center">
                                    <i class="fas fa-users-cog text-3xl text-purple-500 mb-2"></i>
                                    <div class="text-2xl font-bold">25+</div>
                                    <div class="text-sm text-gray-500">Admins Trained</div>
                                </div>
                            </div>
                        </div>

                        <!-- Experience Section (Hidden by default) -->
                        <div id="credentials-experience-section" class="hidden">
                            <!-- Work Experience Timeline -->
                            <div class="card p-6 mb-6">
                                <h3 class="text-xl font-bold mb-6 flex items-center gap-2">
                                    <i class="fas fa-history text-blue-500"></i>
                                    Work Experience
                                </h3>
                                <div class="space-y-6">
                                    <div class="relative pl-8 border-l-2 border-purple-500">
                                        <div class="absolute -left-2 top-0 w-4 h-4 bg-purple-500 rounded-full"></div>
                                        <div class="mb-1">
                                            <span class="text-sm text-purple-600 font-medium">2022 - Present</span>
                                        </div>
                                        <h4 class="font-bold text-lg">Senior System Administrator</h4>
                                        <p class="text-gray-600">Astegni Platform</p>
                                        <ul class="mt-2 text-sm text-gray-500 space-y-1">
                                            <li>‚Ä¢ Lead system architecture and infrastructure decisions</li>
                                            <li>‚Ä¢ Manage all platform settings and configurations</li>
                                            <li>‚Ä¢ Oversee security policies and compliance</li>
                                            <li>‚Ä¢ Coordinate with development teams on deployments</li>
                                        </ul>
                                    </div>

                                    <div class="relative pl-8 border-l-2 border-blue-500">
                                        <div class="absolute -left-2 top-0 w-4 h-4 bg-blue-500 rounded-full"></div>
                                        <div class="mb-1">
                                            <span class="text-sm text-blue-600 font-medium">2019 - 2022</span>
                                        </div>
                                        <h4 class="font-bold text-lg">System Administrator</h4>
                                        <p class="text-gray-600">Ethiopian Technology Solutions</p>
                                        <ul class="mt-2 text-sm text-gray-500 space-y-1">
                                            <li>‚Ä¢ Managed enterprise server infrastructure</li>
                                            <li>‚Ä¢ Implemented backup and disaster recovery solutions</li>
                                            <li>‚Ä¢ Maintained 99.9% uptime across all systems</li>
                                        </ul>
                                    </div>

                                    <div class="relative pl-8 border-l-2 border-green-500">
                                        <div class="absolute -left-2 top-0 w-4 h-4 bg-green-500 rounded-full"></div>
                                        <div class="mb-1">
                                            <span class="text-sm text-green-600 font-medium">2017 - 2019</span>
                                        </div>
                                        <h4 class="font-bold text-lg">IT Support Specialist</h4>
                                        <p class="text-gray-600">Addis Ababa University - IT Department</p>
                                        <ul class="mt-2 text-sm text-gray-500 space-y-1">
                                            <li>‚Ä¢ Provided technical support for university systems</li>
                                            <li>‚Ä¢ Assisted in database management and maintenance</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>

                            <!-- Skills Matrix -->
                            <div class="card p-6">
                                <h3 class="text-xl font-bold mb-4 flex items-center gap-2">
                                    <i class="fas fa-code text-green-500"></i>
                                    Technical Skills
                                </h3>
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                    <div>
                                        <div class="flex justify-between mb-1">
                                            <span class="text-sm font-medium">Linux Administration</span>
                                            <span class="text-sm text-gray-500">98%</span>
                                        </div>
                                        <div class="w-full bg-gray-200 rounded-full h-2">
                                            <div class="bg-blue-600 h-2 rounded-full" style="width: 98%"></div>
                                        </div>
                                    </div>
                                    <div>
                                        <div class="flex justify-between mb-1">
                                            <span class="text-sm font-medium">Database Management</span>
                                            <span class="text-sm text-gray-500">95%</span>
                                        </div>
                                        <div class="w-full bg-gray-200 rounded-full h-2">
                                            <div class="bg-green-600 h-2 rounded-full" style="width: 95%"></div>
                                        </div>
                                    </div>
                                    <div>
                                        <div class="flex justify-between mb-1">
                                            <span class="text-sm font-medium">Cloud Infrastructure (AWS/Azure)</span>
                                            <span class="text-sm text-gray-500">92%</span>
                                        </div>
                                        <div class="w-full bg-gray-200 rounded-full h-2">
                                            <div class="bg-purple-600 h-2 rounded-full" style="width: 92%"></div>
                                        </div>
                                    </div>
                                    <div>
                                        <div class="flex justify-between mb-1">
                                            <span class="text-sm font-medium">Network Security</span>
                                            <span class="text-sm text-gray-500">90%</span>
                                        </div>
                                        <div class="w-full bg-gray-200 rounded-full h-2">
                                            <div class="bg-red-600 h-2 rounded-full" style="width: 90%"></div>
                                        </div>
                                    </div>
                                    <div>
                                        <div class="flex justify-between mb-1">
                                            <span class="text-sm font-medium">Docker & Kubernetes</span>
                                            <span class="text-sm text-gray-500">88%</span>
                                        </div>
                                        <div class="w-full bg-gray-200 rounded-full h-2">
                                            <div class="bg-cyan-600 h-2 rounded-full" style="width: 88%"></div>
                                        </div>
                                    </div>
                                    <div>
                                        <div class="flex justify-between mb-1">
                                            <span class="text-sm font-medium">API Management</span>
                                            <span class="text-sm text-gray-500">85%</span>
                                        </div>
                                        <div class="w-full bg-gray-200 rounded-full h-2">
                                            <div class="bg-orange-600 h-2 rounded-full" style="width: 85%"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Portfolio Panel -->
                    <div id="portfolio-panel" class="panel-content hidden">
                        <div class="mb-8">
                            <h1 class="text-3xl font-bold mb-2">My Portfolio</h1>
                            <p class="text-gray-600">Showcase your work, achievements, and professional accomplishments</p>
                        </div>
                        <!-- Coming Soon -->
                        <div class="flex flex-col items-center justify-center py-20">
                            <div class="w-32 h-32 bg-gradient-to-br from-blue-500 to-purple-600 rounded-full flex items-center justify-center mb-6">
                                <i class="fas fa-folder-open text-white text-5xl"></i>
                            </div>
                            <h2 class="text-2xl font-bold text-gray-700 mb-2">Coming Soon</h2>
                            <p class="text-gray-500 text-center max-w-md">
                                We're working on an amazing portfolio feature where you can showcase your work, achievements, and professional accomplishments. Stay tuned!
                            </p>
                            <div class="mt-6 flex items-center gap-2 text-blue-600">
                                <i class="fas fa-clock"></i>
                                <span class="text-sm">Expected: Q2 2025</span>
                            </div>
                        </div>
                    </div>

                    <!-- Settings Panel -->
                    <div id="settings-panel" class="panel-content hidden">
                        <div class="mb-8">
                            <h1 class="text-3xl font-bold mb-2">Settings</h1>
                            <p class="text-gray-600">Manage your account preferences and configurations</p>
                        </div>
                        <!-- Settings Cards Grid -->
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <!-- Verify Personal Information Card -->
                            <div class="card p-6 hover:shadow-lg transition-shadow cursor-pointer" onclick="openVerifyPersonalInfoModal()">
                                <div class="flex items-start gap-4">
                                    <div class="w-14 h-14 bg-blue-100 rounded-xl flex items-center justify-center flex-shrink-0">
                                        <i class="fas fa-user-check text-blue-600 text-2xl"></i>
                                    </div>
                                    <div>
                                        <h3 class="text-lg font-semibold mb-1">Verify Personal Information</h3>
                                        <p class="text-gray-500 text-sm">Update and verify your personal details for account security</p>
                                    </div>
                                </div>
                            </div>
                            <!-- Add Payment Method Card -->
                            <div class="card p-6 hover:shadow-lg transition-shadow cursor-pointer" onclick="openAddPaymentMethodModal()">
                                <div class="flex items-start gap-4">
                                    <div class="w-14 h-14 bg-green-100 rounded-xl flex items-center justify-center flex-shrink-0">
                                        <i class="fas fa-credit-card text-green-600 text-2xl"></i>
                                    </div>
                                    <div>
                                        <h3 class="text-lg font-semibold mb-1">Add Payment Method</h3>
                                        <p class="text-gray-500 text-sm">Set up your preferred payment methods for transactions</p>
                                    </div>
                                </div>
                            </div>
                            <!-- File a Leave Request Card -->
                            <div class="card p-6 hover:shadow-lg transition-shadow cursor-pointer" onclick="openLeaveRequestModal()">
                                <div class="flex items-start gap-4">
                                    <div class="w-14 h-14 bg-purple-100 rounded-xl flex items-center justify-center flex-shrink-0">
                                        <i class="fas fa-calendar-minus text-purple-600 text-2xl"></i>
                                    </div>
                                    <div>
                                        <h3 class="text-lg font-semibold mb-1">File a Leave Request</h3>
                                        <p class="text-gray-500 text-sm">Submit time-off requests and manage your leave balance</p>
                                    </div>
                                </div>
                            </div>
                            <!-- Resign Card -->
                            <div class="card p-6 hover:shadow-lg transition-shadow cursor-pointer border-red-100" onclick="openResignModal()">
                                <div class="flex items-start gap-4">
                                    <div class="w-14 h-14 bg-red-100 rounded-xl flex items-center justify-center flex-shrink-0">
                                        <i class="fas fa-sign-out-alt text-red-600 text-2xl"></i>
                                    </div>
                                    <div>
                                        <h3 class="text-lg font-semibold text-red-600 mb-1">Resign</h3>
                                        <p class="text-gray-500 text-sm">Submit your resignation and begin the offboarding process</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Right Sidebar Widgets (Persistent across all panels) -->
                <div class="admin-right-widgets"
                    style="width: 320px !important; flex-shrink: 0 !important; position: sticky !important; top: 5rem !important; height: fit-content !important;">
                    <!-- System Monitoring Widget -->
                    <div class="admin-widget-card system-monitoring-widget">
                        <h3 class="text-lg font-semibold mb-4">
                            üíª System Monitoring
                            <span class="live-indicator ml-2 text-xs text-green-500">
                                <span class="inline-block w-2 h-2 bg-green-500 rounded-full animate-pulse"></span>
                                Live
                            </span>
                        </h3>
                        <div class="space-y-3">
                            <div class="metric-item">
                                <div class="flex justify-between items-center mb-1">
                                    <span class="text-sm">CPU Usage</span>
                                    <span class="text-sm font-semibold">28%</span>
                                </div>
                                <div class="w-full bg-gray-200 rounded-full h-2">
                                    <div class="bg-green-500 h-2 rounded-full" style="width: 28%"></div>
                                </div>
                            </div>

                            <div class="metric-item">
                                <div class="flex justify-between items-center mb-1">
                                    <span class="text-sm">Memory</span>
                                    <span class="text-sm font-semibold">4.2/16 GB</span>
                                </div>
                                <div class="w-full bg-gray-200 rounded-full h-2">
                                    <div class="bg-blue-500 h-2 rounded-full" style="width: 26%"></div>
                                </div>
                            </div>

                            <div class="metric-item">
                                <div class="flex justify-between items-center mb-1">
                                    <span class="text-sm">Disk Space</span>
                                    <span class="text-sm font-semibold">245/500 GB</span>
                                </div>
                                <div class="w-full bg-gray-200 rounded-full h-2">
                                    <div class="bg-yellow-500 h-2 rounded-full" style="width: 49%"></div>
                                </div>
                            </div>

                            <div class="metric-item">
                                <div class="flex justify-between items-center mb-1">
                                    <span class="text-sm">Network I/O</span>
                                    <span class="text-sm font-semibold">125 Mbps</span>
                                </div>
                                <div class="w-full bg-gray-200 rounded-full h-2">
                                    <div class="bg-purple-500 h-2 rounded-full" style="width: 62%"></div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Recent Alerts Widget -->
                    <div class="admin-widget-card">
                        <h3 class="text-lg font-semibold mb-4">üîî Recent Alerts</h3>
                        <div class="space-y-3">
                            <div class="alert-item p-3 bg-yellow-50 rounded-lg border-l-4 border-yellow-500">
                                <div class="flex items-start">
                                    <span class="text-yellow-600 mr-2">‚ö†Ô∏è</span>
                                    <div>
                                        <div class="font-medium text-sm">High API Usage</div>
                                        <div class="text-xs text-gray-600">80% of daily limit reached</div>
                                        <div class="text-xs text-gray-500 mt-1">10 minutes ago</div>
                                    </div>
                                </div>
                            </div>

                            <div class="alert-item p-3 bg-green-50 rounded-lg border-l-4 border-green-500">
                                <div class="flex items-start">
                                    <span class="text-green-600 mr-2">‚úÖ</span>
                                    <div>
                                        <div class="font-medium text-sm">Backup Complete</div>
                                        <div class="text-xs text-gray-600">Daily backup successful</div>
                                        <div class="text-xs text-gray-500 mt-1">2 hours ago</div>
                                    </div>
                                </div>
                            </div>

                            <div class="alert-item p-3 bg-blue-50 rounded-lg border-l-4 border-blue-500">
                                <div class="flex items-start">
                                    <span class="text-blue-600 mr-2">‚ÑπÔ∏è</span>
                                    <div>
                                        <div class="font-medium text-sm">System Update</div>
                                        <div class="text-xs text-gray-600">New version available</div>
                                        <div class="text-xs text-gray-500 mt-1">5 hours ago</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- System Info Widget -->
                    <div class="admin-widget-card">
                        <h3 class="text-lg font-semibold mb-4">‚ÑπÔ∏è System Info</h3>
                        <div class="space-y-2 text-sm">
                            <div class="flex justify-between">
                                <span class="text-gray-600">Version:</span>
                                <span class="font-medium">v2.4.1</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-600">Environment:</span>
                                <span class="font-medium">Production</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-600">Server:</span>
                                <span class="font-medium">AWS EC2</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-600">Database:</span>
                                <span class="font-medium">PostgreSQL 14</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-600">Uptime:</span>
                                <span class="font-medium">45 days</span>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- End of admin-right-widgets -->

            </div>
            <!-- End of flex gap-6 container -->

        </div>
        <!-- End of container mx-auto px-4 -->
    </section>

    <!-- Footer -->
    <footer class="footer-section mt-16">
        <div class="container mx-auto px-4 py-8">
            <div class="text-center">
                <p>&copy; 2025 Astegni. All rights reserved. | System Settings</p>
            </div>
        </div>
    </footer>

    <!-- Chart.js Library -->
    <!-- Chart.js Library -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>

    <!-- Scripts -->
    <script src="./js/api-config.js"></script>
    <script src="./js/admin-pages/shared/auth-helpers.js"></script>
    <script src="./js/auth.js"></script>

    <!-- Admin DB Service - reads from astegni_admin_db -->
    <script src="./js/admin-pages/shared/admin-api-service.js"></script>
    <script src="./js/admin-pages/shared/array-field-utils.js"></script>
    <script src="./js/admin-pages/shared/geolocation-utils.js"></script>

    <!-- Standalone Script - All Navigation & Panel Management (includes PanelManager) -->
    <script src="./js/admin-pages/manage-system-settings-standalone.js"></script>

    <!-- System Settings Database Integration - MUST load before manage-system-settings.js -->
    <script src="./js/admin-pages/system-settings-data.js?v=3"></script>

    <!-- Page-specific data loading - Uses SystemSettingsDataManager from system-settings-data.js -->
    <script src="./js/admin-pages/manage-system-settings.js"></script>

    <!-- Ethiopian SMS Providers Extension (SAFE VERSION) -->
    <script src="./js/admin-pages/sms-ethiopian-providers-safe.js"></script>

    <!-- Pricing & Features Manager (Campaign Packages, Subscription Pricing, Affiliate Settings) -->
    <script src="./js/admin-pages/pricing-features-manager.js?v=6"></script>

    <!-- Fix theme background -->
    <script>
        // Ensure dark theme background is applied correctly
        document.addEventListener('DOMContentLoaded', function () {
            // Force background color application
            function applyThemeBackground() {
                const theme = document.documentElement.getAttribute('data-theme');
                if (theme === 'dark') {
                    document.body.style.backgroundColor = '#1E1E1E';
                    document.documentElement.style.backgroundColor = '#1E1E1E';
                } else {
                    document.body.style.backgroundColor = '#ffffff';
                    document.documentElement.style.backgroundColor = '#ffffff';
                }
            }

            // Apply immediately
            applyThemeBackground();

            // Watch for theme changes
            const observer = new MutationObserver(function (mutations) {
                mutations.forEach(function (mutation) {
                    if (mutation.attributeName === 'data-theme') {
                        applyThemeBackground();
                    }
                });
            });

            observer.observe(document.documentElement, {
                attributes: true,
                attributeFilter: ['data-theme']
            });
        });
    </script>

    <!-- ==================== SMS PROVIDER MODALS ==================== -->

    <!-- Add SMS Provider Selection Modal -->
    <div id="add-sms-provider-modal" class="modal hidden">
        <div class="modal-overlay" onclick="closeAddSMSProviderModal()"></div>
        <div class="modal-content" style="max-width: 900px;">
            <div class="modal-header">
                <h2 class="text-2xl font-bold">Choose SMS Provider</h2>
                <button class="modal-close" onclick="closeAddSMSProviderModal()">√ó</button>
            </div>
            <div class="modal-body">
                <p class="text-gray-600 mb-6">Select an SMS provider to configure for your platform</p>

                <!-- Provider Cards Grid -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">

                    <!-- Africa's Talking Card -->
                    <div onclick="selectSMSProvider('africas_talking')" class="provider-card cursor-pointer border-2 rounded-lg p-6 hover:border-green-500 hover:shadow-lg transition-all group">
                        <div class="flex items-start gap-4">
                            <div class="w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center group-hover:bg-green-500 transition-colors">
                                <i class="fas fa-globe-africa text-2xl text-green-600 group-hover:text-white"></i>
                            </div>
                            <div class="flex-1">
                                <h3 class="text-lg font-bold mb-1">Africa's Talking</h3>
                                <div class="flex items-center gap-2 mb-2">
                                    <span class="px-2 py-1 bg-green-100 text-green-700 text-xs font-semibold rounded">Recommended for Ethiopia</span>
                                </div>
                                <p class="text-sm text-gray-600 mb-3">Best coverage and pricing for Ethiopian SMS. 50-75% cheaper than alternatives.</p>
                                <div class="text-sm space-y-1">
                                    <div class="flex items-center gap-2 text-gray-700">
                                        <i class="fas fa-check-circle text-green-500"></i>
                                        <span><strong>$0.02-0.04</strong> per SMS</span>
                                    </div>
                                    <div class="flex items-center gap-2 text-gray-700">
                                        <i class="fas fa-check-circle text-green-500"></i>
                                        <span>Excellent Ethiopia coverage</span>
                                    </div>
                                    <div class="flex items-center gap-2 text-gray-700">
                                        <i class="fas fa-check-circle text-green-500"></i>
                                        <span>Free sandbox testing</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Twilio Card -->
                    <div onclick="selectSMSProvider('twilio')" class="provider-card cursor-pointer border-2 rounded-lg p-6 hover:border-blue-500 hover:shadow-lg transition-all group">
                        <div class="flex items-start gap-4">
                            <div class="w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center group-hover:bg-blue-500 transition-colors">
                                <i class="fas fa-comments text-2xl text-blue-600 group-hover:text-white"></i>
                            </div>
                            <div class="flex-1">
                                <h3 class="text-lg font-bold mb-1">Twilio</h3>
                                <div class="flex items-center gap-2 mb-2">
                                    <span class="px-2 py-1 bg-blue-100 text-blue-700 text-xs font-semibold rounded">Most Popular</span>
                                </div>
                                <p class="text-sm text-gray-600 mb-3">Industry-leading SMS provider with global coverage and excellent reliability.</p>
                                <div class="text-sm space-y-1">
                                    <div class="flex items-center gap-2 text-gray-700">
                                        <i class="fas fa-check-circle text-blue-500"></i>
                                        <span><strong>$0.08</strong> per SMS</span>
                                    </div>
                                    <div class="flex items-center gap-2 text-gray-700">
                                        <i class="fas fa-check-circle text-blue-500"></i>
                                        <span>Global coverage</span>
                                    </div>
                                    <div class="flex items-center gap-2 text-gray-700">
                                        <i class="fas fa-check-circle text-blue-500"></i>
                                        <span>Trial credits available</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Vonage Card -->
                    <div onclick="selectSMSProvider('vonage')" class="provider-card cursor-pointer border-2 rounded-lg p-6 hover:border-purple-500 hover:shadow-lg transition-all group">
                        <div class="flex items-start gap-4">
                            <div class="w-12 h-12 bg-purple-100 rounded-lg flex items-center justify-center group-hover:bg-purple-500 transition-colors">
                                <i class="fas fa-sms text-2xl text-purple-600 group-hover:text-white"></i>
                            </div>
                            <div class="flex-1">
                                <h3 class="text-lg font-bold mb-1">Vonage (Nexmo)</h3>
                                <div class="flex items-center gap-2 mb-2">
                                    <span class="px-2 py-1 bg-purple-100 text-purple-700 text-xs font-semibold rounded">Alternative</span>
                                </div>
                                <p class="text-sm text-gray-600 mb-3">Reliable alternative to Twilio with competitive pricing and good coverage.</p>
                                <div class="text-sm space-y-1">
                                    <div class="flex items-center gap-2 text-gray-700">
                                        <i class="fas fa-check-circle text-purple-500"></i>
                                        <span><strong>$0.06</strong> per SMS</span>
                                    </div>
                                    <div class="flex items-center gap-2 text-gray-700">
                                        <i class="fas fa-check-circle text-purple-500"></i>
                                        <span>Good Ethiopia coverage</span>
                                    </div>
                                    <div class="flex items-center gap-2 text-gray-700">
                                        <i class="fas fa-check-circle text-purple-500"></i>
                                        <span>‚Ç¨2 free credit</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- AWS SNS Card -->
                    <div onclick="selectSMSProvider('aws_sns')" class="provider-card cursor-pointer border-2 rounded-lg p-6 hover:border-orange-500 hover:shadow-lg transition-all group">
                        <div class="flex items-start gap-4">
                            <div class="w-12 h-12 bg-orange-100 rounded-lg flex items-center justify-center group-hover:bg-orange-500 transition-colors">
                                <i class="fab fa-aws text-2xl text-orange-600 group-hover:text-white"></i>
                            </div>
                            <div class="flex-1">
                                <h3 class="text-lg font-bold mb-1">AWS SNS</h3>
                                <div class="flex items-center gap-2 mb-2">
                                    <span class="px-2 py-1 bg-orange-100 text-orange-700 text-xs font-semibold rounded">For AWS Users</span>
                                </div>
                                <p class="text-sm text-gray-600 mb-3">Amazon's SMS service, ideal if you're already using AWS infrastructure.</p>
                                <div class="text-sm space-y-1">
                                    <div class="flex items-center gap-2 text-gray-700">
                                        <i class="fas fa-check-circle text-orange-500"></i>
                                        <span><strong>$0.06</strong> per SMS</span>
                                    </div>
                                    <div class="flex items-center gap-2 text-gray-700">
                                        <i class="fas fa-check-circle text-orange-500"></i>
                                        <span>AWS integration</span>
                                    </div>
                                    <div class="flex items-center gap-2 text-gray-700">
                                        <i class="fas fa-check-circle text-orange-500"></i>
                                        <span>Scalable infrastructure</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Ethiopian SMS Gateway Card -->
                    <div onclick="selectSMSProvider('ethiopian_gateway')" class="provider-card cursor-pointer border-2 rounded-lg p-6 hover:border-yellow-500 hover:shadow-lg transition-all group">
                        <div class="flex items-start gap-4">
                            <div class="w-12 h-12 bg-yellow-100 rounded-lg flex items-center justify-center group-hover:bg-yellow-500 transition-colors">
                                <i class="fas fa-flag text-2xl text-yellow-600 group-hover:text-white"></i>
                            </div>
                            <div class="flex-1">
                                <h3 class="text-lg font-bold mb-1">Ethiopian SMS Gateway</h3>
                                <div class="flex items-center gap-2 mb-2">
                                    <span class="px-2 py-1 bg-yellow-100 text-yellow-700 text-xs font-semibold rounded">Cheapest Option</span>
                                </div>
                                <p class="text-sm text-gray-600 mb-3">Local Ethiopian SMS providers. Best delivery rates and lowest costs for Ethiopia-only SMS.</p>
                                <div class="text-sm space-y-1">
                                    <div class="flex items-center gap-2 text-gray-700">
                                        <i class="fas fa-check-circle text-yellow-500"></i>
                                        <span><strong>$0.01-0.02</strong> per SMS</span>
                                    </div>
                                    <div class="flex items-center gap-2 text-gray-700">
                                        <i class="fas fa-check-circle text-yellow-500"></i>
                                        <span>Best local delivery</span>
                                    </div>
                                    <div class="flex items-center gap-2 text-gray-700">
                                        <i class="fas fa-check-circle text-yellow-500"></i>
                                        <span>Lowest cost</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Ethio Telecom Card -->
                    <div onclick="selectSMSProvider('ethio_telecom')" class="provider-card cursor-pointer border-2 rounded-lg p-6 hover:border-teal-500 hover:shadow-lg transition-all group">
                        <div class="flex items-start gap-4">
                            <div class="w-12 h-12 bg-teal-100 rounded-lg flex items-center justify-center group-hover:bg-teal-500 transition-colors">
                                <i class="fas fa-mobile-alt text-2xl text-teal-600 group-hover:text-white"></i>
                            </div>
                            <div class="flex-1">
                                <h3 class="text-lg font-bold mb-1">Ethio Telecom</h3>
                                <div class="flex items-center gap-2 mb-2">
                                    <span class="px-2 py-1 bg-teal-100 text-teal-700 text-xs font-semibold rounded">Official Telecom</span>
                                </div>
                                <p class="text-sm text-gray-600 mb-3">Ethiopia's national telecommunications provider. Direct integration with local network.</p>
                                <div class="text-sm space-y-1">
                                    <div class="flex items-center gap-2 text-gray-700">
                                        <i class="fas fa-check-circle text-teal-500"></i>
                                        <span><strong>Contact for pricing</strong></span>
                                    </div>
                                    <div class="flex items-center gap-2 text-gray-700">
                                        <i class="fas fa-check-circle text-teal-500"></i>
                                        <span>100% local coverage</span>
                                    </div>
                                    <div class="flex items-center gap-2 text-gray-700">
                                        <i class="fas fa-check-circle text-teal-500"></i>
                                        <span>Government backed</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>

                <!-- Cost Comparison -->
                <div class="mt-6 p-4 bg-blue-50 border border-blue-200 rounded-lg">
                    <div class="flex items-start gap-3">
                        <i class="fas fa-info-circle text-blue-600 mt-1"></i>
                        <div class="text-sm text-blue-800">
                            <strong>Cost for 1,000 SMS to Ethiopia:</strong>
                            <div class="grid grid-cols-2 md:grid-cols-3 gap-4 mt-2">
                                <div><strong>Ethiopian Gateway:</strong> $10-20 ‚≠ê</div>
                                <div><strong>Africa's Talking:</strong> $20-40</div>
                                <div><strong>Vonage:</strong> $60</div>
                                <div><strong>AWS SNS:</strong> $60</div>
                                <div><strong>Twilio:</strong> $80</div>
                                <div><strong>Ethio Telecom:</strong> Contact</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Configure Africa's Talking Modal -->
    <div id="configure-africas-talking-modal" class="modal hidden">
        <div class="modal-overlay" onclick="closeSMSConfigModal()"></div>
        <div class="modal-content" style="max-width: 600px;">
            <div class="modal-header">
                <div class="flex items-center gap-3">
                    <div class="w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center">
                        <i class="fas fa-globe-africa text-xl text-green-600"></i>
                    </div>
                    <h2 class="text-xl font-bold">Configure Africa's Talking</h2>
                </div>
                <button class="modal-close" onclick="closeSMSConfigModal()">√ó</button>
            </div>
            <div class="modal-body">
                <form id="africas-talking-form" onsubmit="saveSMSProviderConfig(event, 'africas_talking')">
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-semibold mb-2">
                                Username <span class="text-red-500">*</span>
                            </label>
                            <input type="text" name="at_username" required
                                class="w-full p-3 border rounded-lg focus:ring-2 focus:ring-green-500"
                                placeholder="sandbox or your production username">
                            <p class="text-xs text-gray-500 mt-1">Use 'sandbox' for testing</p>
                        </div>

                        <div>
                            <label class="block text-sm font-semibold mb-2">
                                API Key <span class="text-red-500">*</span>
                            </label>
                            <input type="password" name="at_api_key" required
                                class="w-full p-3 border rounded-lg focus:ring-2 focus:ring-green-500"
                                placeholder="Your Africa's Talking API key">
                            <p class="text-xs text-gray-500 mt-1">Get from Africa's Talking dashboard</p>
                        </div>

                        <div>
                            <label class="block text-sm font-semibold mb-2">
                                Sender ID / Short Code (Optional)
                            </label>
                            <input type="text" name="at_from_number"
                                class="w-full p-3 border rounded-lg focus:ring-2 focus:ring-green-500"
                                placeholder="ASTEGNI">
                            <p class="text-xs text-gray-500 mt-1">Your approved sender ID (e.g., ASTEGNI)</p>
                        </div>

                        <div class="p-4 bg-green-50 border border-green-200 rounded-lg">
                            <p class="text-sm text-green-800">
                                <i class="fas fa-lightbulb mr-2"></i>
                                <strong>Getting Started:</strong> Sign up at <a href="https://africastalking.com" target="_blank" class="underline">africastalking.com</a> to get your credentials.
                            </p>
                        </div>
                    </div>

                    <div class="flex gap-3 mt-6">
                        <button type="button" onclick="closeSMSConfigModal()" class="flex-1 px-4 py-2 border rounded-lg hover:bg-gray-50">
                            Cancel
                        </button>
                        <button type="submit" class="flex-1 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700">
                            Save & Configure
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Configure Twilio Modal -->
    <div id="configure-twilio-modal" class="modal hidden">
        <div class="modal-overlay" onclick="closeSMSConfigModal()"></div>
        <div class="modal-content" style="max-width: 600px;">
            <div class="modal-header">
                <div class="flex items-center gap-3">
                    <div class="w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center">
                        <i class="fas fa-comments text-xl text-blue-600"></i>
                    </div>
                    <h2 class="text-xl font-bold">Configure Twilio</h2>
                </div>
                <button class="modal-close" onclick="closeSMSConfigModal()">√ó</button>
            </div>
            <div class="modal-body">
                <form id="twilio-form" onsubmit="saveSMSProviderConfig(event, 'twilio')">
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-semibold mb-2">
                                Account SID <span class="text-red-500">*</span>
                            </label>
                            <input type="text" name="twilio_account_sid" required
                                class="w-full p-3 border rounded-lg focus:ring-2 focus:ring-blue-500"
                                placeholder="ACxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx">
                            <p class="text-xs text-gray-500 mt-1">Starts with "AC" - find in Twilio console</p>
                        </div>

                        <div>
                            <label class="block text-sm font-semibold mb-2">
                                Auth Token <span class="text-red-500">*</span>
                            </label>
                            <input type="password" name="twilio_auth_token" required
                                class="w-full p-3 border rounded-lg focus:ring-2 focus:ring-blue-500"
                                placeholder="Your 32-character auth token">
                            <p class="text-xs text-gray-500 mt-1">Keep this secure - never share publicly</p>
                        </div>

                        <div>
                            <label class="block text-sm font-semibold mb-2">
                                Phone Number <span class="text-red-500">*</span>
                            </label>
                            <input type="tel" name="twilio_from_number" required
                                class="w-full p-3 border rounded-lg focus:ring-2 focus:ring-blue-500"
                                placeholder="+15551234567">
                            <p class="text-xs text-gray-500 mt-1">Your Twilio phone number with country code</p>
                        </div>

                        <div class="p-4 bg-blue-50 border border-blue-200 rounded-lg">
                            <p class="text-sm text-blue-800">
                                <i class="fas fa-lightbulb mr-2"></i>
                                <strong>Getting Started:</strong> Sign up at <a href="https://www.twilio.com/try-twilio" target="_blank" class="underline">twilio.com/try-twilio</a> for free trial credits.
                            </p>
                        </div>
                    </div>

                    <div class="flex gap-3 mt-6">
                        <button type="button" onclick="closeSMSConfigModal()" class="flex-1 px-4 py-2 border rounded-lg hover:bg-gray-50">
                            Cancel
                        </button>
                        <button type="submit" class="flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700">
                            Save & Configure
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Configure Vonage Modal -->
    <div id="configure-vonage-modal" class="modal hidden">
        <div class="modal-overlay" onclick="closeSMSConfigModal()"></div>
        <div class="modal-content" style="max-width: 600px;">
            <div class="modal-header">
                <div class="flex items-center gap-3">
                    <div class="w-10 h-10 bg-purple-100 rounded-lg flex items-center justify-center">
                        <i class="fas fa-sms text-xl text-purple-600"></i>
                    </div>
                    <h2 class="text-xl font-bold">Configure Vonage</h2>
                </div>
                <button class="modal-close" onclick="closeSMSConfigModal()">√ó</button>
            </div>
            <div class="modal-body">
                <form id="vonage-form" onsubmit="saveSMSProviderConfig(event, 'vonage')">
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-semibold mb-2">
                                API Key <span class="text-red-500">*</span>
                            </label>
                            <input type="text" name="vonage_api_key" required
                                class="w-full p-3 border rounded-lg focus:ring-2 focus:ring-purple-500"
                                placeholder="Your Vonage API key">
                            <p class="text-xs text-gray-500 mt-1">Find in Vonage dashboard</p>
                        </div>

                        <div>
                            <label class="block text-sm font-semibold mb-2">
                                API Secret <span class="text-red-500">*</span>
                            </label>
                            <input type="password" name="vonage_api_secret" required
                                class="w-full p-3 border rounded-lg focus:ring-2 focus:ring-purple-500"
                                placeholder="Your Vonage API secret">
                            <p class="text-xs text-gray-500 mt-1">Keep this secure</p>
                        </div>

                        <div>
                            <label class="block text-sm font-semibold mb-2">
                                From Number / Brand Name
                            </label>
                            <input type="text" name="vonage_from_number"
                                class="w-full p-3 border rounded-lg focus:ring-2 focus:ring-purple-500"
                                placeholder="Astegni or +15551234567">
                            <p class="text-xs text-gray-500 mt-1">Brand name or phone number</p>
                        </div>

                        <div class="p-4 bg-purple-50 border border-purple-200 rounded-lg">
                            <p class="text-sm text-purple-800">
                                <i class="fas fa-lightbulb mr-2"></i>
                                <strong>Getting Started:</strong> Sign up at <a href="https://dashboard.nexmo.com/sign-up" target="_blank" class="underline">vonage.com</a> for ‚Ç¨2 free credit.
                            </p>
                        </div>
                    </div>

                    <div class="flex gap-3 mt-6">
                        <button type="button" onclick="closeSMSConfigModal()" class="flex-1 px-4 py-2 border rounded-lg hover:bg-gray-50">
                            Cancel
                        </button>
                        <button type="submit" class="flex-1 px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700">
                            Save & Configure
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Configure AWS SNS Modal -->
    <div id="configure-aws-sns-modal" class="modal hidden">
        <div class="modal-overlay" onclick="closeSMSConfigModal()"></div>
        <div class="modal-content" style="max-width: 600px;">
            <div class="modal-header">
                <div class="flex items-center gap-3">
                    <div class="w-10 h-10 bg-orange-100 rounded-lg flex items-center justify-center">
                        <i class="fab fa-aws text-xl text-orange-600"></i>
                    </div>
                    <h2 class="text-xl font-bold">Configure AWS SNS</h2>
                </div>
                <button class="modal-close" onclick="closeSMSConfigModal()">√ó</button>
            </div>
            <div class="modal-body">
                <form id="aws-sns-form" onsubmit="saveSMSProviderConfig(event, 'aws_sns')">
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-semibold mb-2">
                                AWS Access Key ID <span class="text-red-500">*</span>
                            </label>
                            <input type="text" name="aws_access_key_id" required
                                class="w-full p-3 border rounded-lg focus:ring-2 focus:ring-orange-500"
                                placeholder="AKIAxxxxxxxxxxxxxxxx">
                            <p class="text-xs text-gray-500 mt-1">From AWS IAM console</p>
                        </div>

                        <div>
                            <label class="block text-sm font-semibold mb-2">
                                AWS Secret Access Key <span class="text-red-500">*</span>
                            </label>
                            <input type="password" name="aws_secret_access_key" required
                                class="w-full p-3 border rounded-lg focus:ring-2 focus:ring-orange-500"
                                placeholder="Your AWS secret access key">
                            <p class="text-xs text-gray-500 mt-1">Keep this highly secure</p>
                        </div>

                        <div>
                            <label class="block text-sm font-semibold mb-2">
                                AWS Region
                            </label>
                            <select name="aws_region"
                                class="w-full p-3 border rounded-lg focus:ring-2 focus:ring-orange-500">
                                <option value="us-east-1">US East (N. Virginia)</option>
                                <option value="us-west-2">US West (Oregon)</option>
                                <option value="eu-west-1">EU (Ireland)</option>
                                <option value="eu-central-1">EU (Frankfurt)</option>
                                <option value="ap-southeast-1">Asia Pacific (Singapore)</option>
                            </select>
                        </div>

                        <div>
                            <label class="block text-sm font-semibold mb-2">
                                Sender ID
                            </label>
                            <input type="text" name="aws_sns_sender_id"
                                class="w-full p-3 border rounded-lg focus:ring-2 focus:ring-orange-500"
                                placeholder="Astegni">
                            <p class="text-xs text-gray-500 mt-1">Brand name to display as sender</p>
                        </div>

                        <div class="p-4 bg-orange-50 border border-orange-200 rounded-lg">
                            <p class="text-sm text-orange-800">
                                <i class="fas fa-lightbulb mr-2"></i>
                                <strong>Note:</strong> Requires AWS account with SNS enabled. Request production access for higher limits.
                            </p>
                        </div>
                    </div>

                    <div class="flex gap-3 mt-6">
                        <button type="button" onclick="closeSMSConfigModal()" class="flex-1 px-4 py-2 border rounded-lg hover:bg-gray-50">
                            Cancel
                        </button>
                        <button type="submit" class="flex-1 px-4 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700">
                            Save & Configure
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Configure Ethiopian SMS Gateway Modal -->
    <div id="configure-ethiopian-gateway-modal" class="modal hidden">
        <div class="modal-overlay" onclick="closeSMSConfigModal()"></div>
        <div class="modal-content" style="max-width: 600px;">
            <div class="modal-header">
                <div class="flex items-center gap-3">
                    <div class="w-10 h-10 bg-yellow-100 rounded-lg flex items-center justify-center">
                        <i class="fas fa-flag text-xl text-yellow-600"></i>
                    </div>
                    <h2 class="text-xl font-bold">Configure Ethiopian SMS Gateway</h2>
                </div>
                <button class="modal-close" onclick="closeSMSConfigModal()">√ó</button>
            </div>
            <div class="modal-body">
                <form id="ethiopian-gateway-form" onsubmit="saveSMSProviderConfig(event, 'ethiopian_gateway')">
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-semibold mb-2">
                                Gateway Provider Name <span class="text-red-500">*</span>
                            </label>
                            <input type="text" name="eth_provider_name" required
                                class="w-full p-3 border rounded-lg focus:ring-2 focus:ring-yellow-500"
                                placeholder="e.g., SMS Gateway Ethiopia, Yanet SMS">
                            <p class="text-xs text-gray-500 mt-1">Name of your local SMS gateway provider</p>
                        </div>

                        <div>
                            <label class="block text-sm font-semibold mb-2">
                                API Endpoint URL <span class="text-red-500">*</span>
                            </label>
                            <input type="url" name="eth_api_url" required
                                class="w-full p-3 border rounded-lg focus:ring-2 focus:ring-yellow-500"
                                placeholder="https://api.provider.com/send">
                            <p class="text-xs text-gray-500 mt-1">API endpoint provided by your gateway</p>
                        </div>

                        <div>
                            <label class="block text-sm font-semibold mb-2">
                                API Key / Access Token <span class="text-red-500">*</span>
                            </label>
                            <input type="password" name="eth_api_key" required
                                class="w-full p-3 border rounded-lg focus:ring-2 focus:ring-yellow-500"
                                placeholder="Your API key or access token">
                            <p class="text-xs text-gray-500 mt-1">Authentication credential from your provider</p>
                        </div>

                        <div>
                            <label class="block text-sm font-semibold mb-2">
                                Username (Optional)
                            </label>
                            <input type="text" name="eth_username"
                                class="w-full p-3 border rounded-lg focus:ring-2 focus:ring-yellow-500"
                                placeholder="API username if required">
                            <p class="text-xs text-gray-500 mt-1">Some gateways require a username</p>
                        </div>

                        <div>
                            <label class="block text-sm font-semibold mb-2">
                                Sender ID / Short Code
                            </label>
                            <input type="text" name="eth_sender_id"
                                class="w-full p-3 border rounded-lg focus:ring-2 focus:ring-yellow-500"
                                placeholder="ASTEGNI or 9999">
                            <p class="text-xs text-gray-500 mt-1">Your registered sender ID or short code</p>
                        </div>

                        <div>
                            <label class="block text-sm font-semibold mb-2">
                                HTTP Method
                            </label>
                            <select name="eth_http_method"
                                class="w-full p-3 border rounded-lg focus:ring-2 focus:ring-yellow-500">
                                <option value="POST">POST</option>
                                <option value="GET">GET</option>
                            </select>
                            <p class="text-xs text-gray-500 mt-1">HTTP method used by your gateway's API</p>
                        </div>

                        <div class="p-4 bg-yellow-50 border border-yellow-200 rounded-lg">
                            <p class="text-sm text-yellow-800">
                                <i class="fas fa-lightbulb mr-2"></i>
                                <strong>Note:</strong> Contact your local SMS gateway provider for API credentials. Common Ethiopian providers include SMS Gateway Ethiopia, Yanet SMS, and custom enterprise solutions.
                            </p>
                        </div>
                    </div>

                    <div class="flex gap-3 mt-6">
                        <button type="button" onclick="closeSMSConfigModal()" class="flex-1 px-4 py-2 border rounded-lg hover:bg-gray-50">
                            Cancel
                        </button>
                        <button type="submit" class="flex-1 px-4 py-2 bg-yellow-600 text-white rounded-lg hover:bg-yellow-700">
                            Save & Configure
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Configure Ethio Telecom Modal -->
    <div id="configure-ethio-telecom-modal" class="modal hidden">
        <div class="modal-overlay" onclick="closeSMSConfigModal()"></div>
        <div class="modal-content" style="max-width: 600px;">
            <div class="modal-header">
                <div class="flex items-center gap-3">
                    <div class="w-10 h-10 bg-teal-100 rounded-lg flex items-center justify-center">
                        <i class="fas fa-mobile-alt text-xl text-teal-600"></i>
                    </div>
                    <h2 class="text-xl font-bold">Configure Ethio Telecom SMS</h2>
                </div>
                <button class="modal-close" onclick="closeSMSConfigModal()">√ó</button>
            </div>
            <div class="modal-body">
                <form id="ethio-telecom-form" onsubmit="saveSMSProviderConfig(event, 'ethio_telecom')">
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-semibold mb-2">
                                Enterprise Account ID <span class="text-red-500">*</span>
                            </label>
                            <input type="text" name="et_account_id" required
                                class="w-full p-3 border rounded-lg focus:ring-2 focus:ring-teal-500"
                                placeholder="Your Ethio Telecom enterprise account ID">
                            <p class="text-xs text-gray-500 mt-1">Provided by Ethio Telecom for business accounts</p>
                        </div>

                        <div>
                            <label class="block text-sm font-semibold mb-2">
                                API Key <span class="text-red-500">*</span>
                            </label>
                            <input type="password" name="et_api_key" required
                                class="w-full p-3 border rounded-lg focus:ring-2 focus:ring-teal-500"
                                placeholder="Your Ethio Telecom API key">
                            <p class="text-xs text-gray-500 mt-1">API key from your enterprise dashboard</p>
                        </div>

                        <div>
                            <label class="block text-sm font-semibold mb-2">
                                API Secret <span class="text-red-500">*</span>
                            </label>
                            <input type="password" name="et_api_secret" required
                                class="w-full p-3 border rounded-lg focus:ring-2 focus:ring-teal-500"
                                placeholder="Your API secret key">
                            <p class="text-xs text-gray-500 mt-1">Keep this highly secure</p>
                        </div>

                        <div>
                            <label class="block text-sm font-semibold mb-2">
                                Short Code / Sender ID <span class="text-red-500">*</span>
                            </label>
                            <input type="text" name="et_short_code" required
                                class="w-full p-3 border rounded-lg focus:ring-2 focus:ring-teal-500"
                                placeholder="e.g., 9999 or ASTEGNI">
                            <p class="text-xs text-gray-500 mt-1">Your registered short code or sender ID</p>
                        </div>

                        <div>
                            <label class="block text-sm font-semibold mb-2">
                                API Endpoint
                            </label>
                            <input type="url" name="et_api_endpoint"
                                class="w-full p-3 border rounded-lg focus:ring-2 focus:ring-teal-500"
                                placeholder="https://api.ethiotelecom.et/sms/send">
                            <p class="text-xs text-gray-500 mt-1">API endpoint (usually provided by Ethio Telecom)</p>
                        </div>

                        <div class="p-4 bg-teal-50 border border-teal-200 rounded-lg">
                            <p class="text-sm text-teal-800 mb-2">
                                <i class="fas fa-info-circle mr-2"></i>
                                <strong>Getting Started with Ethio Telecom SMS:</strong>
                            </p>
                            <ul class="text-xs text-teal-800 space-y-1 ml-5 list-disc">
                                <li>Contact Ethio Telecom Enterprise Services</li>
                                <li>Apply for SMS Gateway business account</li>
                                <li>Register your short code or sender ID</li>
                                <li>Receive API credentials and documentation</li>
                            </ul>
                        </div>
                    </div>

                    <div class="flex gap-3 mt-6">
                        <button type="button" onclick="closeSMSConfigModal()" class="flex-1 px-4 py-2 border rounded-lg hover:bg-gray-50">
                            Cancel
                        </button>
                        <button type="submit" class="flex-1 px-4 py-2 bg-teal-600 text-white rounded-lg hover:bg-teal-700">
                            Save & Configure
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

        <!-- Edit Profile Modal -->
    <!-- This modal edits manage_system_settings_profile table fields only -->
    <div id="edit-profile-modal" class="modal hidden">
        <div class="modal-overlay" onclick="closeEditProfileModal()"></div>
        <div class="modal-content" style="max-width: 600px;">
            <div class="modal-header">
                <h2 class="text-xl font-bold">Edit Profile</h2>
                <button class="modal-close" onclick="closeEditProfileModal()">&times;</button>
            </div>
            <div class="modal-body">
                <form id="editProfileForm" onsubmit="handleProfileUpdate(event)">
                    <!-- Username (Display Name) -->
                    <div class="form-group mb-4">
                        <label class="block text-sm font-medium mb-1">Username (Display Name) <span class="text-red-500">*</span></label>
                        <input type="text" id="editUsername"
                            class="w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
                            placeholder="e.g., abebe_kebede" required>
                        <p class="text-xs text-gray-500 mt-1">This will be displayed as your admin username</p>
                    </div>

                    <!-- Hero Titles (Array) -->
                    <div class="form-group mb-4">
                        <label class="block text-sm font-medium mb-1">Hero Titles</label>
                        <div id="heroTitleContainer" class="space-y-2">
                            <!-- Dynamic hero title inputs will be added here -->
                        </div>
                        <button type="button" onclick="addHeroTitleField()"
                            class="mt-2 text-sm text-blue-600 hover:text-blue-800 flex items-center gap-1">
                            <i class="fas fa-plus"></i> Add Hero Title
                        </button>
                        <p class="text-xs text-gray-500 mt-1">Add multiple titles (e.g., System Administrator, DevOps Lead)</p>
                    </div>

                    <!-- Hero Subtitle -->
                    <div class="form-group mb-4">
                        <label class="block text-sm font-medium mb-1">Hero Subtitle</label>
                        <input type="text" id="editHeroSubtitle"
                            class="w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
                            placeholder="e.g., Astegni Admin Panel">
                    </div>

                    <!-- Bio -->
                    <div class="form-group mb-4">
                        <label class="block text-sm font-medium mb-1">Bio</label>
                        <textarea id="editBio" rows="3"
                            class="w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
                            placeholder="Tell us about yourself..."></textarea>
                    </div>

                    <!-- Quote -->
                    <div class="form-group mb-4">
                        <label class="block text-sm font-medium mb-1">Quote</label>
                        <input type="text" id="editQuote"
                            class="w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
                            placeholder="Your personal quote or motto">
                    </div>

                    <!-- Locations (Array) -->
                    <div class="form-group mb-4">
                        <label class="block text-sm font-medium mb-1">Locations</label>
                        <div id="locationContainer" class="space-y-2">
                            <!-- Dynamic location inputs will be added here -->
                        </div>
                        <button type="button" onclick="addLocationField()"
                            class="mt-2 text-sm text-blue-600 hover:text-blue-800 flex items-center gap-1">
                            <i class="fas fa-plus"></i> Add Location
                        </button>
                        <p class="text-xs text-gray-500 mt-1">Add multiple locations (e.g., Addis Ababa, Bahir Dar)</p>

                        <!-- Allow Location Checkbox (GPS Detection Permission) -->
                        <div class="flex items-center mt-3">
                            <input type="checkbox" id="editAllowLocation"
                                class="w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 focus:ring-2"
                                onchange="handleAllowLocationChange(this)">
                            <label for="editAllowLocation" class="ml-2 text-sm font-medium text-gray-700">
                                Allow system to detect my location (GPS)
                            </label>
                        </div>

                        <!-- Detect Location Button (appears when GPS allowed) -->
                        <button type="button" id="detectLocationBtn" onclick="detectCurrentLocation()"
                            class="hidden mt-2 text-sm bg-green-500 text-white px-3 py-1.5 rounded-lg hover:bg-green-600 flex items-center gap-1">
                            <i class="fas fa-location-arrow mr-1"></i> Detect Location
                        </button>
                        <p id="locationStatus" class="hidden text-xs mt-1"></p>

                        <!-- Display Location Checkbox (Public Visibility) -->
                        <div class="flex items-center mt-3">
                            <input type="checkbox" id="editDisplayLocation"
                                class="w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 focus:ring-2">
                            <label for="editDisplayLocation" class="ml-2 text-sm font-medium text-gray-700">
                                Display location on my public profile
                            </label>
                        </div>
                        <p class="text-xs text-gray-500 mt-1">When enabled, your location will be visible on your public profile</p>
                    </div>

                    <!-- Languages -->
                    <div class="form-group mb-6">
                        <label class="block text-sm font-medium mb-1">Languages</label>
                        <input type="text" id="editLanguages"
                            class="w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
                            placeholder="e.g., English, Amharic, Oromo">
                        <p class="text-xs text-gray-500 mt-1">Separate multiple languages with commas</p>
                    </div>

                    <div class="modal-footer">
                        <button type="button" class="btn-secondary px-4 py-2 border rounded-lg hover:bg-gray-100"
                            onclick="closeEditProfileModal()">Cancel</button>
                        <button type="submit" id="editProfileSubmitBtn"
                            class="btn-primary px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600">Update
                            Profile</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Upload Profile Picture Modal -->
    <div id="upload-profile-modal" class="modal hidden">
        <div class="modal-overlay" onclick="closeUploadProfileModal()"></div>
        <div class="modal-content" style="max-width: 500px;">
            <div class="modal-header">
                <h2 class="text-xl font-bold">Upload Profile Picture</h2>
                <button class="modal-close" onclick="closeUploadProfileModal()">√ó</button>
            </div>
            <div class="modal-body">
                <div class="upload-area border-2 border-dashed border-gray-300 rounded-lg p-8 text-center mb-4">
                    <svg class="mx-auto h-12 w-12 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12" />
                    </svg>
                    <input type="file" id="profilePictureInput" accept="image/*" class="hidden"
                        onchange="previewProfilePicture(event)">
                    <label for="profilePictureInput" class="cursor-pointer">
                        <p class="mt-2 text-sm text-gray-600">
                            <span class="font-medium text-blue-500 hover:text-blue-600">Click to upload</span> or drag
                            and drop
                        </p>
                        <p class="text-xs text-gray-500">PNG, JPG, GIF up to 5MB</p>
                    </label>
                </div>
                <div id="profilePreview" class="hidden mb-4">
                    <img id="profilePreviewImg" class="w-32 h-32 mx-auto rounded-full object-cover" alt="Preview">
                </div>
                <div class="modal-footer">
                    <button class="btn-secondary px-4 py-2 border rounded-lg hover:bg-gray-100"
                        onclick="closeUploadProfileModal()">Cancel</button>
                    <button id="uploadProfileBtn"
                        class="btn-primary px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600"
                        onclick="handleProfilePictureUpload()">Upload</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Upload Cover Image Modal -->
    <div id="upload-cover-modal" class="modal hidden">
        <div class="modal-overlay" onclick="closeUploadCoverModal()"></div>
        <div class="modal-content" style="max-width: 600px;">
            <div class="modal-header">
                <h2 class="text-xl font-bold">Upload Cover Image</h2>
                <button class="modal-close" onclick="closeUploadCoverModal()">√ó</button>
            </div>
            <div class="modal-body">
                <div class="upload-area border-2 border-dashed border-gray-300 rounded-lg p-8 text-center mb-4">
                    <svg class="mx-auto h-12 w-12 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z" />
                    </svg>
                    <input type="file" id="coverImageInput" accept="image/*" class="hidden"
                        onchange="previewCoverImage(event)">
                    <label for="coverImageInput" class="cursor-pointer">
                        <p class="mt-2 text-sm text-gray-600">
                            <span class="font-medium text-blue-500 hover:text-blue-600">Click to upload</span> or drag
                            and drop
                        </p>
                        <p class="text-xs text-gray-500">Recommended: 1200x300px (PNG, JPG up to 10MB)</p>
                    </label>
                </div>
                <div id="coverPreview" class="hidden mb-4">
                    <img id="coverPreviewImg" class="w-full h-32 object-cover rounded-lg" alt="Preview">
                </div>
                <div class="modal-footer">
                    <button class="btn-secondary px-4 py-2 border rounded-lg hover:bg-gray-100"
                        onclick="closeUploadCoverModal()">Cancel</button>
                    <button id="uploadCoverBtn"
                        class="btn-primary px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600"
                        onclick="handleCoverImageUpload()">Upload</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Unified Image Upload Modal -->
    <div id="image-upload-modal" class="modal hidden">
        <div class="modal-overlay" onclick="closeImageUploadModal()"></div>
        <div class="modal-content" style="max-width: 700px;">
            <div class="modal-header">
                <h2 class="text-xl font-bold">üì∑ Upload Image</h2>
                <button class="modal-close" onclick="closeImageUploadModal()">√ó</button>
            </div>
            <div class="modal-body">
                <!-- Image Type Selection -->
                <div class="mb-4">
                    <label class="block text-sm font-medium mb-2">What is this image for? *</label>
                    <select id="imageTypeSelect"
                        class="w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
                        onchange="updateImageTargetOptions()">
                        <option value="">Select image type...</option>
                        <option value="profile">Profile Picture</option>
                        <option value="cover">Cover Image</option>
                        <option value="logo">Logo</option>
                        <option value="favicon">Favicon</option>
                        <option value="system">System Image</option>
                    </select>
                </div>

                <!-- Target User/Entity Selection -->
                <div id="imageTargetSection" class="mb-4 hidden">
                    <label class="block text-sm font-medium mb-2">For which profile/entity? *</label>
                    <select id="imageTargetSelect"
                        class="w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                        <option value="">Select target...</option>
                        <!-- Options will be populated dynamically -->
                    </select>
                </div>

                <!-- File Upload Area -->
                <div class="upload-area border-2 border-dashed border-gray-300 rounded-lg p-8 text-center mb-4">
                    <svg class="mx-auto h-12 w-12 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12" />
                    </svg>
                    <input type="file" id="systemImageInput" accept="image/*" class="hidden"
                        onchange="previewSystemImage(event)">
                    <label for="systemImageInput" class="cursor-pointer">
                        <p class="mt-2 text-sm text-gray-600">
                            <span class="font-medium text-blue-500 hover:text-blue-600">Click to upload</span> or drag
                            and drop
                        </p>
                        <p class="text-xs text-gray-500">PNG, JPG, GIF, SVG, ICO up to 10MB</p>
                    </label>
                </div>

                <!-- Image Preview -->
                <div id="systemImagePreview" class="hidden mb-4">
                    <img id="systemImagePreviewImg" class="max-w-full h-48 mx-auto object-contain rounded-lg"
                        alt="Preview">
                </div>

                <!-- Additional Options -->
                <div class="mb-4">
                    <label class="block text-sm font-medium mb-2">Image Title (Optional)</label>
                    <input type="text" id="imageTitle"
                        class="w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
                        placeholder="e.g., Main Logo, Default Avatar">
                </div>

                <div class="modal-footer">
                    <button class="btn-secondary px-4 py-2 border rounded-lg hover:bg-gray-100"
                        onclick="closeImageUploadModal()">Cancel</button>
                    <button id="uploadSystemImageBtn"
                        class="btn-primary px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600"
                        onclick="handleSystemImageUpload()">Upload Image</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Video Upload Modal -->
    <div id="video-upload-modal" class="modal hidden">
        <div class="modal-overlay" onclick="closeVideoUploadModal()"></div>
        <div class="modal-content" style="max-width: 700px;">
            <div class="modal-header">
                <h2 class="text-xl font-bold">üé• Upload Video</h2>
                <button class="modal-close" onclick="closeVideoUploadModal()">√ó</button>
            </div>
            <div class="modal-body">
                <!-- Video Type Selection -->
                <div class="mb-4">
                    <label class="block text-sm font-medium mb-2">What is this video for? *</label>
                    <select id="videoTypeSelect"
                        class="w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
                        onchange="updateVideoClassificationOptions()">
                        <option value="">Select video type...</option>
                        <option value="ad">Advertisement</option>
                        <option value="alert">Alert/System Notification</option>
                    </select>
                </div>

                <!-- Ad Classification (shown when video type is 'ad') -->
                <div id="adClassificationSection" class="mb-4 hidden">
                    <label class="block text-sm font-medium mb-2">Ad Classification *</label>
                    <select id="adClassificationSelect"
                        class="w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                        <option value="">Select ad type...</option>
                        <option value="ad">Ad</option>
                        <option value="tutorial">Tutorial</option>
                        <option value="course">Course</option>
                        <option value="success-story">Success Story</option>
                        <option value="tips-tricks">Tips & Tricks</option>
                        <option value="entertainment">Entertainment</option>
                        <option value="news">News</option>
                    </select>
                </div>

                <!-- Target Entity Selection with Checkboxes -->
                <div id="videoTargetSection" class="mb-4 hidden">
                    <label class="block text-sm font-medium mb-2">Target Pages/Profiles * (Select all that
                        apply)</label>
                    <div class="border rounded-lg p-4 max-h-64 overflow-y-auto">
                        <!-- Homepage -->
                        <div class="mb-3 pb-3 border-b">
                            <label class="flex items-center gap-2 cursor-pointer hover:bg-gray-50 p-2 rounded">
                                <input type="checkbox" name="videoTarget" value="homepage"
                                    class="w-4 h-4 text-blue-600">
                                <span class="font-medium">üè† Homepage</span>
                            </label>
                        </div>

                        <!-- User Side Profiles -->
                        <div class="mb-3">
                            <div class="text-xs font-semibold text-gray-500 uppercase mb-2 px-2">User Profiles</div>
                            <div class="space-y-1">
                                <label class="flex items-center gap-2 cursor-pointer hover:bg-gray-50 p-2 rounded">
                                    <input type="checkbox" name="videoTarget" value="tutor"
                                        class="w-4 h-4 text-blue-600">
                                    <span>üë®‚Äçüè´ Tutors</span>
                                </label>
                                <label class="flex items-center gap-2 cursor-pointer hover:bg-gray-50 p-2 rounded">
                                    <input type="checkbox" name="videoTarget" value="student"
                                        class="w-4 h-4 text-blue-600">
                                    <span>üë®‚Äçüéì Students</span>
                                </label>
                                <label class="flex items-center gap-2 cursor-pointer hover:bg-gray-50 p-2 rounded">
                                    <input type="checkbox" name="videoTarget" value="parent"
                                        class="w-4 h-4 text-blue-600">
                                    <span>üë™ Parents</span>
                                </label>
                                <label class="flex items-center gap-2 cursor-pointer hover:bg-gray-50 p-2 rounded">
                                    <input type="checkbox" name="videoTarget" value="user"
                                        class="w-4 h-4 text-blue-600">
                                    <span>üë§ Users</span>
                                </label>
                                <label class="flex items-center gap-2 cursor-pointer hover:bg-gray-50 p-2 rounded">
                                    <input type="checkbox" name="videoTarget" value="advertiser"
                                        class="w-4 h-4 text-blue-600">
                                    <span>üì¢ Advertisers</span>
                                </label>
                            </div>
                        </div>
                    </div>
                    <p class="text-xs text-gray-500 mt-2">Select one or more pages where this video should appear</p>
                </div>

                <!-- File Upload Area -->
                <div class="upload-area border-2 border-dashed border-gray-300 rounded-lg p-8 text-center mb-4">
                    <svg class="mx-auto h-12 w-12 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M7 4v16M17 4v16M3 8h18M3 12h18M3 16h18" />
                    </svg>
                    <input type="file" id="systemVideoInput" accept="video/*" class="hidden"
                        onchange="previewSystemVideo(event)">
                    <label for="systemVideoInput" class="cursor-pointer">
                        <p class="mt-2 text-sm text-gray-600">
                            <span class="font-medium text-green-500 hover:text-green-600">Click to upload</span> or drag
                            and drop
                        </p>
                        <p class="text-xs text-gray-500">MP4, AVI, MOV, WMV up to 200MB</p>
                    </label>
                </div>

                <!-- Video Preview -->
                <div id="systemVideoPreview" class="hidden mb-4">
                    <video id="systemVideoPreviewPlayer" class="w-full h-48 rounded-lg" controls>
                        <source id="systemVideoPreviewSource" src="" type="video/mp4">
                    </video>
                    <p id="videoFileName" class="text-sm text-gray-600 mt-2"></p>
                </div>

                <!-- Video Details -->
                <div class="mb-4">
                    <label class="block text-sm font-medium mb-2">Video Title *</label>
                    <input type="text" id="videoTitle"
                        class="w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
                        placeholder="e.g., Introduction to Mathematics" required>
                </div>

                <div class="mb-4">
                    <label class="block text-sm font-medium mb-2">Description (Optional)</label>
                    <textarea id="videoDescription" rows="3"
                        class="w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
                        placeholder="Brief description of the video content..."></textarea>
                </div>

                <!-- Thumbnail Upload -->
                <div class="mb-4">
                    <label class="block text-sm font-medium mb-2">Video Thumbnail *</label>
                    <div class="border-2 border-dashed border-gray-300 rounded-lg p-4">
                        <div class="flex items-center gap-4">
                            <div id="thumbnailPreview" class="hidden">
                                <img id="thumbnailPreviewImg" class="w-32 h-20 object-cover rounded" alt="Thumbnail">
                            </div>
                            <div class="flex-1">
                                <input type="file" id="videoThumbnail" accept="image/*" class="hidden"
                                    onchange="previewThumbnail(event)">
                                <label for="videoThumbnail"
                                    class="cursor-pointer inline-block px-4 py-2 bg-gray-100 hover:bg-gray-200 rounded-lg text-sm">
                                    Choose Thumbnail
                                </label>
                                <p class="text-xs text-gray-500 mt-2">Recommended: 1280x720px (16:9 ratio), PNG or JPG
                                </p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Upload Progress -->
                <div id="videoUploadProgress" class="hidden mb-4">
                    <div class="flex justify-between text-sm mb-1">
                        <span>Uploading...</span>
                        <span id="videoUploadPercent">0%</span>
                    </div>
                    <div class="w-full bg-gray-200 rounded-full h-2">
                        <div id="videoUploadProgressBar" class="bg-green-500 h-2 rounded-full transition-all"
                            style="width: 0%"></div>
                    </div>
                </div>

                <div class="modal-footer">
                    <button class="btn-secondary px-4 py-2 border rounded-lg hover:bg-gray-100"
                        onclick="closeVideoUploadModal()">Cancel</button>
                    <button id="uploadSystemVideoBtn"
                        class="btn-primary px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600"
                        onclick="handleSystemVideoUpload()">Upload Video</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Edit Email Template Modal - Enhanced -->
    <div id="edit-email-template-modal" class="modal hidden">
        <div class="modal-overlay" onclick="closeEditEmailTemplateModal()"></div>
        <div class="modal-content" style="max-width: 900px; max-height: 90vh; overflow-y: auto;">
            <div class="flex justify-between items-center mb-6">
                <div>
                    <h2 class="text-2xl font-bold">Edit Email Template</h2>
                    <p class="text-sm text-gray-500 mt-1">Customize email content with HTML or plain text</p>
                </div>
                <button onclick="closeEditEmailTemplateModal()" class="text-gray-500 hover:text-gray-700">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>

            <div class="space-y-4">
                <!-- Template Info -->
                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label class="block mb-2 font-semibold">Template Name</label>
                        <input type="text" id="template-name" class="w-full p-2 border rounded-lg bg-gray-50" readonly>
                    </div>
                    <div>
                        <label class="block mb-2 font-semibold">Status</label>
                        <label class="flex items-center gap-2 p-2 border rounded-lg cursor-pointer hover:bg-gray-50">
                            <input type="checkbox" id="template-enabled" class="w-4 h-4">
                            <span class="font-medium">Enable this template</span>
                        </label>
                    </div>
                </div>

                <!-- Subject Line -->
                <div>
                    <label class="block mb-2 font-semibold">Subject Line</label>
                    <input type="text" id="template-subject" class="w-full p-2 border rounded-lg"
                        placeholder="Email subject...">
                    <p class="text-xs text-gray-500 mt-1">Tip: Use {{name}} to personalize the subject</p>
                </div>

                <!-- Format Switcher -->
                <div>
                    <label class="block mb-2 font-semibold">Email Format</label>
                    <div class="flex gap-2 mb-3">
                        <button type="button" onclick="switchEmailFormat('html')"
                            id="html-format-btn"
                            class="px-4 py-2 border rounded-lg bg-blue-500 text-white font-medium">
                            <i class="fas fa-code mr-2"></i>HTML
                        </button>
                        <button type="button" onclick="switchEmailFormat('plain')"
                            id="plain-format-btn"
                            class="px-4 py-2 border rounded-lg hover:bg-gray-50">
                            <i class="fas fa-align-left mr-2"></i>Plain Text
                        </button>
                    </div>
                </div>

                <!-- HTML Editor -->
                <div id="html-editor-container">
                    <label class="block mb-2 font-semibold">HTML Content</label>

                    <!-- Toolbar -->
                    <div class="border rounded-t-lg bg-gray-50 p-2 flex gap-2 flex-wrap">
                        <button type="button" onclick="insertEmailTag('{{name}}')"
                            class="px-3 py-1 bg-white border rounded hover:bg-gray-100 text-sm">
                            <i class="fas fa-user mr-1"></i>Name
                        </button>
                        <button type="button" onclick="insertEmailTag('{{email}}')"
                            class="px-3 py-1 bg-white border rounded hover:bg-gray-100 text-sm">
                            <i class="fas fa-envelope mr-1"></i>Email
                        </button>
                        <button type="button" onclick="insertEmailTag('{{link}}')"
                            class="px-3 py-1 bg-white border rounded hover:bg-gray-100 text-sm">
                            <i class="fas fa-link mr-1"></i>Link
                        </button>
                        <button type="button" onclick="insertEmailTag('{{platform_name}}')"
                            class="px-3 py-1 bg-white border rounded hover:bg-gray-100 text-sm">
                            <i class="fas fa-globe mr-1"></i>Platform
                        </button>
                        <button type="button" onclick="insertEmailTag('{{otp_code}}')"
                            class="px-3 py-1 bg-white border rounded hover:bg-gray-100 text-sm">
                            <i class="fas fa-key mr-1"></i>OTP Code
                        </button>
                        <button type="button" onclick="insertEmailTag('{{course_name}}')"
                            class="px-3 py-1 bg-white border rounded hover:bg-gray-100 text-sm">
                            <i class="fas fa-book mr-1"></i>Course
                        </button>
                        <div class="border-l mx-2"></div>
                        <button type="button" onclick="applyEmailTemplate('welcome')"
                            class="px-3 py-1 bg-green-50 border border-green-300 rounded hover:bg-green-100 text-sm">
                            <i class="fas fa-magic mr-1"></i>Load Template
                        </button>
                    </div>

                    <textarea id="template-body" class="w-full p-3 border border-t-0 rounded-b-lg font-mono text-sm"
                        rows="14" placeholder="Enter HTML content..." style="tab-size: 2;"></textarea>

                    <div class="mt-2 p-3 bg-blue-50 border border-blue-200 rounded-lg text-sm">
                        <div class="font-semibold text-blue-900 mb-2">
                            <i class="fas fa-lightbulb mr-1"></i>Available Variables:
                        </div>
                        <div class="grid grid-cols-2 gap-2 text-blue-800">
                            <div><code class="bg-white px-2 py-1 rounded">{{name}}</code> - User's name</div>
                            <div><code class="bg-white px-2 py-1 rounded">{{email}}</code> - User's email</div>
                            <div><code class="bg-white px-2 py-1 rounded">{{link}}</code> - Action link</div>
                            <div><code class="bg-white px-2 py-1 rounded">{{platform_name}}</code> - Astegni</div>
                            <div><code class="bg-white px-2 py-1 rounded">{{otp_code}}</code> - OTP code</div>
                            <div><code class="bg-white px-2 py-1 rounded">{{course_name}}</code> - Course name</div>
                        </div>
                    </div>
                </div>

                <!-- Plain Text Editor (hidden by default) -->
                <div id="plain-editor-container" class="hidden">
                    <label class="block mb-2 font-semibold">Plain Text Content</label>
                    <textarea id="template-body-plain" class="w-full p-3 border rounded-lg"
                        rows="14" placeholder="Enter plain text content..."></textarea>
                    <p class="text-sm text-gray-500 mt-2">
                        <i class="fas fa-info-circle mr-1"></i>
                        Plain text emails work everywhere but don't support formatting
                    </p>
                </div>

                <!-- Preview Variables -->
                <div>
                    <label class="block mb-2 font-semibold">Test Data for Preview</label>
                    <div class="grid grid-cols-3 gap-3">
                        <input type="text" id="preview-name" class="p-2 border rounded-lg text-sm"
                            placeholder="Name" value="Abebe Kebede">
                        <input type="text" id="preview-email" class="p-2 border rounded-lg text-sm"
                            placeholder="Email" value="abebe@example.com">
                        <input type="text" id="preview-link" class="p-2 border rounded-lg text-sm"
                            placeholder="Link" value="https://astegni.com/verify">
                    </div>
                </div>

                <!-- Statistics (if available) -->
                <div id="template-stats" class="hidden p-4 bg-gray-50 border rounded-lg">
                    <div class="font-semibold mb-3">Template Statistics</div>
                    <div class="grid grid-cols-3 gap-4 text-sm">
                        <div>
                            <div class="text-gray-500">Sent</div>
                            <div class="text-2xl font-bold" id="stat-sent">0</div>
                        </div>
                        <div>
                            <div class="text-gray-500">Opened</div>
                            <div class="text-2xl font-bold" id="stat-opened">0</div>
                        </div>
                        <div>
                            <div class="text-gray-500">Clicked</div>
                            <div class="text-2xl font-bold" id="stat-clicked">0</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Actions -->
            <div class="flex justify-between gap-3 mt-6 pt-6 border-t">
                <div class="flex gap-2">
                    <button onclick="previewEmailTemplate()"
                        class="px-6 py-2 border rounded-lg hover:bg-gray-50 font-medium">
                        <i class="fas fa-eye mr-2"></i>Preview
                    </button>
                    <button onclick="sendTestEmailFromModal()"
                        class="px-6 py-2 border rounded-lg hover:bg-gray-50 font-medium">
                        <i class="fas fa-paper-plane mr-2"></i>Send Test
                    </button>
                </div>
                <div class="flex gap-3">
                    <button onclick="closeEditEmailTemplateModal()"
                        class="px-6 py-2 border rounded-lg hover:bg-gray-50 font-medium">Cancel</button>
                    <button onclick="saveEmailTemplate()"
                        class="px-6 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 font-medium">
                        <i class="fas fa-save mr-2"></i>Save Template
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Add New Email Template Modal -->
    <div id="add-email-template-modal" class="modal hidden">
        <div class="modal-overlay" onclick="closeAddEmailTemplateModal()"></div>
        <div class="modal-content" style="max-width: 700px;">
            <div class="flex justify-between items-center mb-6">
                <div>
                    <h2 class="text-2xl font-bold">Create New Email Template</h2>
                    <p class="text-sm text-gray-500 mt-1">Add a new email template to the system</p>
                </div>
                <button onclick="closeAddEmailTemplateModal()" class="text-gray-500 hover:text-gray-700">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>

            <form id="add-template-form" onsubmit="handleAddEmailTemplate(event)">
                <div class="space-y-4">
                    <!-- Template Name/Type -->
                    <div>
                        <label class="block mb-2 font-semibold">Template Name *</label>
                        <input type="text" id="new-template-name" class="w-full p-2 border rounded-lg"
                            placeholder="e.g., Welcome Email" required>
                        <p class="text-xs text-gray-500 mt-1">Internal name for this template (e.g., welcome, password-reset, otp)</p>
                    </div>

                    <!-- Template Key -->
                    <div>
                        <label class="block mb-2 font-semibold">Template Key *</label>
                        <input type="text" id="new-template-key" class="w-full p-2 border rounded-lg font-mono text-sm"
                            placeholder="e.g., welcome_email" required pattern="[a-z_]+">
                        <p class="text-xs text-gray-500 mt-1">Unique identifier (lowercase letters and underscores only)</p>
                    </div>

                    <!-- Subject Line -->
                    <div>
                        <label class="block mb-2 font-semibold">Subject Line *</label>
                        <input type="text" id="new-template-subject" class="w-full p-2 border rounded-lg"
                            placeholder="Welcome to {{platform_name}}!" required>
                        <p class="text-xs text-gray-500 mt-1">Email subject (supports variables like {{name}}, {{platform_name}})</p>
                    </div>

                    <!-- Email Body -->
                    <div>
                        <label class="block mb-2 font-semibold">Email Body *</label>
                        <textarea id="new-template-body" class="w-full p-3 border rounded-lg font-mono text-sm"
                            rows="10" placeholder="Hello {{name}},

Welcome to {{platform_name}}! We're excited to have you here.

Best regards,
The Team" required></textarea>
                        <p class="text-xs text-gray-500 mt-1">Email content (HTML supported)</p>
                    </div>

                    <!-- Available Variables Info -->
                    <div class="p-3 bg-blue-50 border border-blue-200 rounded-lg text-sm">
                        <div class="font-semibold text-blue-900 mb-2">
                            <i class="fas fa-lightbulb mr-1"></i>Available Variables:
                        </div>
                        <div class="grid grid-cols-2 gap-2 text-blue-800">
                            <div><code class="bg-white px-2 py-1 rounded">{{name}}</code> - User's name</div>
                            <div><code class="bg-white px-2 py-1 rounded">{{email}}</code> - User's email</div>
                            <div><code class="bg-white px-2 py-1 rounded">{{link}}</code> - Action link</div>
                            <div><code class="bg-white px-2 py-1 rounded">{{platform_name}}</code> - Astegni</div>
                            <div><code class="bg-white px-2 py-1 rounded">{{otp_code}}</code> - OTP code</div>
                            <div><code class="bg-white px-2 py-1 rounded">{{course_name}}</code> - Course name</div>
                        </div>
                    </div>

                    <!-- Enable Template -->
                    <div>
                        <label class="flex items-center gap-2 p-2 border rounded-lg cursor-pointer hover:bg-gray-50">
                            <input type="checkbox" id="new-template-enabled" class="w-4 h-4" checked>
                            <span class="font-medium">Enable this template immediately</span>
                        </label>
                    </div>
                </div>

                <!-- Actions -->
                <div class="flex justify-end gap-3 mt-6 pt-6 border-t">
                    <button type="button" onclick="closeAddEmailTemplateModal()"
                        class="px-6 py-2 border rounded-lg hover:bg-gray-50 font-medium">Cancel</button>
                    <button type="submit"
                        class="px-6 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 font-medium">
                        <i class="fas fa-plus mr-2"></i>Create Template
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Add Integration Modal - Enhanced -->
    <div id="add-integration-modal" class="modal hidden">
        <div class="modal-overlay" onclick="closeAddIntegrationModal()"></div>
        <div class="modal-content" style="max-width: 700px;">
            <!-- Header with gradient -->
            <div class="bg-gradient-to-r from-indigo-600 to-purple-600 -m-8 mb-6 p-6 rounded-t-xl">
                <div class="flex justify-between items-center">
                    <div class="flex items-center gap-3">
                        <div class="bg-white bg-opacity-20 p-3 rounded-lg">
                            <i class="fas fa-plug text-white text-2xl"></i>
                        </div>
                        <div>
                            <h2 class="text-2xl font-bold text-white">Add New Integration</h2>
                            <p class="text-white text-opacity-90 text-sm mt-1">Connect third-party services to your
                                platform</p>
                        </div>
                    </div>
                    <button onclick="closeAddIntegrationModal()"
                        class="text-white hover:bg-white hover:bg-opacity-20 p-2 rounded-lg transition">
                        <i class="fas fa-times text-xl"></i>
                    </button>
                </div>
            </div>

            <div class="space-y-5">
                <!-- Integration Type Selection -->
                <div>
                    <label class="block mb-2 font-semibold text-lg">Integration Type</label>
                    <select id="integration-type"
                        class="w-full p-3 border-2 rounded-lg text-base focus:border-indigo-500 focus:ring-2 focus:ring-indigo-200 transition"
                        onchange="updateIntegrationFields()">
                        <option value="">Select integration type...</option>
                        <option value="social">üîê Social Login</option>
                        <option value="email">üìß Email Service</option>
                        <option value="sms">üì± SMS Gateway</option>
                        <option value="analytics">üìä Analytics</option>
                        <option value="payment">üí≥ Payment Gateway</option>
                        <option value="storage">‚òÅÔ∏è Cloud Storage</option>
                    </select>
                </div>

                <!-- Provider Search (for social integrations) -->
                <div id="social-integrations" class="hidden">
                    <label class="block mb-2 font-semibold text-lg">Search Provider</label>
                    <div class="relative">
                        <input type="text" id="provider-search"
                            class="w-full p-3 pl-10 border-2 rounded-lg focus:border-indigo-500 focus:ring-2 focus:ring-indigo-200 transition"
                            placeholder="Search for social login provider (e.g., Twitter, Instagram, TikTok)..."
                            oninput="filterProviders(this.value)">
                        <i class="fas fa-search absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"></i>
                    </div>

                    <!-- Provider List -->
                    <div id="provider-list" class="mt-3 max-h-64 overflow-y-auto border-2 rounded-lg bg-white">
                        <div class="divide-y">
                            <!-- Popular Providers -->
                            <div class="provider-item p-3 hover:bg-indigo-50 cursor-pointer transition flex items-center gap-3"
                                onclick="selectProvider('twitter', 'Twitter / X', 'fab fa-twitter')">
                                <div class="w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center">
                                    <i class="fab fa-twitter text-blue-500 text-xl"></i>
                                </div>
                                <div class="flex-1">
                                    <div class="font-semibold">Twitter / X</div>
                                    <div class="text-xs text-gray-500">Social login via Twitter</div>
                                </div>
                            </div>
                            <div class="provider-item p-3 hover:bg-indigo-50 cursor-pointer transition flex items-center gap-3"
                                onclick="selectProvider('instagram', 'Instagram', 'fab fa-instagram')">
                                <div class="w-10 h-10 bg-pink-100 rounded-full flex items-center justify-center">
                                    <i class="fab fa-instagram text-pink-500 text-xl"></i>
                                </div>
                                <div class="flex-1">
                                    <div class="font-semibold">Instagram</div>
                                    <div class="text-xs text-gray-500">Social login via Instagram</div>
                                </div>
                            </div>
                            <div class="provider-item p-3 hover:bg-indigo-50 cursor-pointer transition flex items-center gap-3"
                                onclick="selectProvider('tiktok', 'TikTok', 'fab fa-tiktok')">
                                <div class="w-10 h-10 bg-black rounded-full flex items-center justify-center">
                                    <i class="fab fa-tiktok text-white text-xl"></i>
                                </div>
                                <div class="flex-1">
                                    <div class="font-semibold">TikTok</div>
                                    <div class="text-xs text-gray-500">Social login via TikTok</div>
                                </div>
                            </div>
                            <div class="provider-item p-3 hover:bg-indigo-50 cursor-pointer transition flex items-center gap-3"
                                onclick="selectProvider('github', 'GitHub', 'fab fa-github')">
                                <div class="w-10 h-10 bg-gray-800 rounded-full flex items-center justify-center">
                                    <i class="fab fa-github text-white text-xl"></i>
                                </div>
                                <div class="flex-1">
                                    <div class="font-semibold">GitHub</div>
                                    <div class="text-xs text-gray-500">Developer login via GitHub</div>
                                </div>
                            </div>
                            <div class="provider-item p-3 hover:bg-indigo-50 cursor-pointer transition flex items-center gap-3"
                                onclick="selectProvider('linkedin', 'LinkedIn', 'fab fa-linkedin')">
                                <div class="w-10 h-10 bg-blue-700 rounded-full flex items-center justify-center">
                                    <i class="fab fa-linkedin text-white text-xl"></i>
                                </div>
                                <div class="flex-1">
                                    <div class="font-semibold">LinkedIn</div>
                                    <div class="text-xs text-gray-500">Professional login via LinkedIn</div>
                                </div>
                            </div>
                            <div class="provider-item p-3 hover:bg-indigo-50 cursor-pointer transition flex items-center gap-3"
                                onclick="selectProvider('microsoft', 'Microsoft', 'fab fa-microsoft')">
                                <div class="w-10 h-10 bg-blue-600 rounded-full flex items-center justify-center">
                                    <i class="fab fa-microsoft text-white text-xl"></i>
                                </div>
                                <div class="flex-1">
                                    <div class="font-semibold">Microsoft</div>
                                    <div class="text-xs text-gray-500">Microsoft account login</div>
                                </div>
                            </div>
                            <div class="provider-item p-3 hover:bg-indigo-50 cursor-pointer transition flex items-center gap-3"
                                onclick="selectProvider('apple', 'Apple', 'fab fa-apple')">
                                <div class="w-10 h-10 bg-black rounded-full flex items-center justify-center">
                                    <i class="fab fa-apple text-white text-xl"></i>
                                </div>
                                <div class="flex-1">
                                    <div class="font-semibold">Apple</div>
                                    <div class="text-xs text-gray-500">Sign in with Apple</div>
                                </div>
                            </div>
                            <div class="provider-item p-3 hover:bg-indigo-50 cursor-pointer transition flex items-center gap-3"
                                onclick="selectProvider('discord', 'Discord', 'fab fa-discord')">
                                <div class="w-10 h-10 bg-indigo-600 rounded-full flex items-center justify-center">
                                    <i class="fab fa-discord text-white text-xl"></i>
                                </div>
                                <div class="flex-1">
                                    <div class="font-semibold">Discord</div>
                                    <div class="text-xs text-gray-500">Discord community login</div>
                                </div>
                            </div>
                            <div class="provider-item p-3 hover:bg-indigo-50 cursor-pointer transition flex items-center gap-3"
                                onclick="selectProvider('reddit', 'Reddit', 'fab fa-reddit')">
                                <div class="w-10 h-10 bg-orange-600 rounded-full flex items-center justify-center">
                                    <i class="fab fa-reddit text-white text-xl"></i>
                                </div>
                                <div class="flex-1">
                                    <div class="font-semibold">Reddit</div>
                                    <div class="text-xs text-gray-500">Reddit account login</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Selected Provider Display -->
                <div id="selected-provider"
                    class="hidden bg-gradient-to-r from-indigo-50 to-purple-50 p-4 rounded-lg border-2 border-indigo-200">
                    <div class="flex items-center justify-between">
                        <div class="flex items-center gap-3">
                            <i id="selected-provider-icon" class="text-3xl"></i>
                            <div>
                                <div class="text-sm text-gray-600">Selected Provider:</div>
                                <div id="selected-provider-name" class="font-bold text-lg"></div>
                            </div>
                        </div>
                        <button onclick="clearProviderSelection()"
                            class="text-red-500 hover:bg-red-100 p-2 rounded-lg transition">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                </div>

                <!-- Integration Configuration Fields -->
                <div id="integration-fields" class="space-y-4 hidden">
                    <div class="bg-gray-50 p-4 rounded-lg border">
                        <h3 class="font-semibold mb-3 flex items-center gap-2">
                            <i class="fas fa-cog text-indigo-600"></i>
                            Configuration Details
                        </h3>
                        <div class="space-y-3">
                            <div>
                                <label class="block mb-2 font-semibold text-sm">Integration Name</label>
                                <input type="text" id="integration-name" class="w-full p-2 border rounded-lg"
                                    placeholder="e.g., Twitter Login">
                            </div>
                            <div>
                                <label class="block mb-2 font-semibold text-sm">Client ID / API Key</label>
                                <input type="text" id="integration-client-id" class="w-full p-2 border rounded-lg"
                                    placeholder="Enter client ID or API key">
                            </div>
                            <div>
                                <label class="block mb-2 font-semibold text-sm">Client Secret / API Secret</label>
                                <div class="relative">
                                    <input type="password" id="integration-client-secret"
                                        class="w-full p-2 pr-10 border rounded-lg" placeholder="Enter client secret">
                                    <button type="button" onclick="toggleSecretVisibility()"
                                        class="absolute right-2 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-gray-700">
                                        <i class="fas fa-eye" id="secret-eye-icon"></i>
                                    </button>
                                </div>
                            </div>
                            <div>
                                <label class="block mb-2 font-semibold text-sm">Callback URL</label>
                                <input type="text" id="integration-callback" class="w-full p-2 border rounded-lg"
                                    placeholder="https://astegni.com/auth/callback">
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Info Banner -->
                <div class="bg-blue-50 p-4 rounded-lg border border-blue-200">
                    <div class="flex items-start gap-2">
                        <i class="fas fa-info-circle text-blue-600 mt-1"></i>
                        <div class="flex-1 text-sm text-gray-700">
                            <p class="font-semibold mb-1">Setup Instructions:</p>
                            <ul class="list-disc list-inside space-y-1">
                                <li>Configure the integration in your provider's developer dashboard first</li>
                                <li>Obtain the necessary API credentials (Client ID and Secret)</li>
                                <li>Add the callback URL to your provider's allowed redirect URIs</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Action Buttons -->
            <div class="flex justify-end gap-3 mt-6 pt-6 border-t">
                <button onclick="closeAddIntegrationModal()"
                    class="px-6 py-2 border-2 rounded-lg hover:bg-gray-50 transition">
                    Cancel
                </button>
                <button onclick="saveIntegration()"
                    class="px-6 py-2 bg-gradient-to-r from-indigo-600 to-purple-600 text-white rounded-lg hover:from-indigo-700 hover:to-purple-700 transition shadow-lg">
                    <i class="fas fa-plug mr-2"></i>Add Integration
                </button>
            </div>
        </div>
    </div>

    <!-- CPI Settings Modal -->
    <div id="cpi-settings-modal" class="modal hidden">
        <div class="modal-overlay" onclick="closeCpiSettingsModal()"></div>
        <div class="modal-content" style="max-width: 900px;">
            <div class="modal-header">
                <h2 class="text-xl font-bold">
                    <i class="fas fa-cog mr-2 text-orange-600"></i>CPI Pricing Settings
                </h2>
                <button class="modal-close" onclick="closeCpiSettingsModal()">&times;</button>
            </div>
            <div class="modal-body">
                <form id="cpi-settings-form" onsubmit="saveCpiSettings(event)">
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        <!-- Left Column: CPI Rate Settings -->
                        <div class="space-y-6">
                            <!-- Base CPI Rate -->
                            <div class="p-4 bg-gray-50 rounded-lg border">
                                <h4 class="font-bold text-lg mb-3 flex items-center gap-2">
                                    <i class="fas fa-coins text-orange-600"></i>
                                    Base CPI Rate
                                </h4>

                                <!-- Country/Location -->
                                <div class="mb-4">
                                    <label class="block text-sm font-semibold mb-2">
                                        Country/Location *
                                        <span class="text-xs font-normal text-blue-600 ml-2">
                                            <i class="fas fa-location-arrow"></i> Auto-detected from GPS
                                        </span>
                                    </label>

                                    <!-- Hidden field to store country code -->
                                    <input type="hidden" id="cpi-country" required>

                                    <!-- Read-only display field -->
                                    <div id="cpi-country-display"
                                         class="w-full px-3 py-2 border rounded-lg bg-gray-50 text-gray-700 font-medium">
                                        <i class="fas fa-spinner fa-spin mr-2 text-blue-500"></i>Detecting location...
                                    </div>

                                    <!-- GPS Detection Status -->
                                    <div id="cpi-country-status" class="text-xs mt-1">
                                        <span class="text-gray-500">
                                            <i class="fas fa-map-marker-alt mr-1"></i>
                                            Automatically detected from your physical location via GPS.
                                        </span>
                                    </div>
                                </div>

                                <div class="mb-3">
                                    <label class="block text-sm font-semibold mb-2">Cost Per Impression (ETB) *</label>
                                    <input type="number" id="cpi-base-rate" class="w-full px-3 py-2 border rounded-lg"
                                        placeholder="e.g., 0.05" min="0" step="0.001" required oninput="calculateCpiPreview()">
                                    <p class="text-xs text-gray-500 mt-1">Base rate charged per ad impression (no targeting)</p>
                                </div>
                            </div>

                            <!-- Audience Exclusion Premiums -->
                            <div class="p-4 bg-blue-50 rounded-lg border border-blue-200">
                                <h4 class="font-bold text-lg mb-3 flex items-center gap-2">
                                    <i class="fas fa-users text-blue-600"></i>
                                    Audience Exclusion Premiums
                                </h4>
                                <p class="text-xs text-gray-600 mb-4">Charged when advertisers EXCLUDE (uncheck) audience types. More exclusions = higher CPI.</p>
                                <div class="mb-3 p-2 bg-blue-100 border border-blue-300 rounded-lg flex items-center gap-2">
                                    <i class="fas fa-info-circle text-blue-600"></i>
                                    <span class="text-xs text-blue-700"><strong>How it works:</strong> All audiences checked = Base CPI. Unchecking an audience adds its exclusion premium.</span>
                                </div>

                                <!-- Tutor Exclusion Premium -->
                                <div class="mb-3 p-3 bg-white rounded-lg border">
                                    <div class="flex items-center justify-between mb-2">
                                        <label class="flex items-center gap-2">
                                            <i class="fas fa-chalkboard-teacher text-blue-600"></i>
                                            <span class="font-semibold">Tutor</span>
                                        </label>
                                        <span class="text-xs text-gray-500">Exclusion premium</span>
                                    </div>
                                    <input type="number" id="cpi-tutor-premium" class="w-full px-3 py-2 border rounded-lg"
                                        placeholder="e.g., 0.02" min="0" step="0.001" oninput="calculateCpiPreview()">
                                    <p class="text-xs text-gray-400 mt-1">Added when Tutor audience is excluded</p>
                                </div>

                                <!-- Student Exclusion Premium -->
                                <div class="mb-3 p-3 bg-white rounded-lg border">
                                    <div class="flex items-center justify-between mb-2">
                                        <label class="flex items-center gap-2">
                                            <i class="fas fa-user-graduate text-green-600"></i>
                                            <span class="font-semibold">Student</span>
                                        </label>
                                        <span class="text-xs text-gray-500">Exclusion premium</span>
                                    </div>
                                    <input type="number" id="cpi-student-premium" class="w-full px-3 py-2 border rounded-lg"
                                        placeholder="e.g., 0.015" min="0" step="0.001" oninput="calculateCpiPreview()">
                                    <p class="text-xs text-gray-400 mt-1">Added when Student audience is excluded</p>
                                </div>

                                <!-- Parent Exclusion Premium -->
                                <div class="mb-3 p-3 bg-white rounded-lg border">
                                    <div class="flex items-center justify-between mb-2">
                                        <label class="flex items-center gap-2">
                                            <i class="fas fa-user-friends text-yellow-600"></i>
                                            <span class="font-semibold">Parent</span>
                                        </label>
                                        <span class="text-xs text-gray-500">Exclusion premium</span>
                                    </div>
                                    <input type="number" id="cpi-parent-premium" class="w-full px-3 py-2 border rounded-lg"
                                        placeholder="e.g., 0.025" min="0" step="0.001" oninput="calculateCpiPreview()">
                                    <p class="text-xs text-gray-400 mt-1">Added when Parent audience is excluded</p>
                                </div>

                                <!-- Advertiser Exclusion Premium -->
                                <div class="mb-3 p-3 bg-white rounded-lg border">
                                    <div class="flex items-center justify-between mb-2">
                                        <label class="flex items-center gap-2">
                                            <i class="fas fa-bullhorn text-purple-600"></i>
                                            <span class="font-semibold">Advertiser</span>
                                        </label>
                                        <span class="text-xs text-gray-500">Exclusion premium</span>
                                    </div>
                                    <input type="number" id="cpi-advertiser-premium" class="w-full px-3 py-2 border rounded-lg"
                                        placeholder="e.g., 0.03" min="0" step="0.001" oninput="calculateCpiPreview()">
                                    <p class="text-xs text-gray-400 mt-1">Added when Advertiser audience is excluded</p>
                                </div>

                                <!-- User Exclusion Premium -->
                                <div class="p-3 bg-white rounded-lg border">
                                    <div class="flex items-center justify-between mb-2">
                                        <label class="flex items-center gap-2">
                                            <i class="fas fa-user text-gray-600"></i>
                                            <span class="font-semibold">User</span>
                                        </label>
                                        <span class="text-xs text-gray-500">Exclusion premium</span>
                                    </div>
                                    <input type="number" id="cpi-user-premium" class="w-full px-3 py-2 border rounded-lg"
                                        placeholder="e.g., 0.01" min="0" step="0.001" oninput="calculateCpiPreview()">
                                    <p class="text-xs text-gray-400 mt-1">Added when User audience is excluded</p>
                                </div>
                            </div>

                            <!-- Location Targeting Premiums -->
                            <div class="p-4 bg-green-50 rounded-lg border border-green-200">
                                <h4 class="font-bold text-lg mb-3 flex items-center gap-2">
                                    <i class="fas fa-map-marker-alt text-green-600"></i>
                                    Location Targeting Premiums
                                </h4>
                                <p class="text-xs text-gray-600 mb-4">Configure premiums based on geographic targeting level</p>

                                <!-- Location Type Selector -->
                                <div class="mb-4">
                                    <label class="block text-sm font-semibold mb-2">
                                        <i class="fas fa-globe-americas text-green-500 mr-1"></i>
                                        Configure Location Level
                                    </label>
                                    <select id="cpi-location-type" class="w-full px-3 py-2 border rounded-lg"
                                        onchange="onCpiLocationTypeChange()">
                                        <option value="global">Global (International) - Base CPI only</option>
                                        <option value="national">National - Add national premium</option>
                                        <option value="regional">Regional - Configure region exclusion premiums</option>
                                    </select>
                                </div>

                                <!-- Global Info (shown when Global selected) -->
                                <div id="cpi-global-info" class="p-3 bg-white rounded-lg border">
                                    <div class="flex items-center gap-2 text-green-700">
                                        <i class="fas fa-globe text-green-500"></i>
                                        <span class="font-semibold">Global (International)</span>
                                    </div>
                                    <p class="text-xs text-gray-500 mt-2">No location premium applied. Advertisers pay only the base CPI rate.</p>
                                </div>

                                <!-- National Premium (shown when National selected) -->
                                <div id="cpi-national-section" class="p-3 bg-white rounded-lg border hidden">
                                    <div class="flex items-center justify-between mb-2">
                                        <label class="flex items-center gap-2">
                                            <i class="fas fa-flag text-blue-500"></i>
                                            <span class="font-semibold">National Premium</span>
                                        </label>
                                        <span class="text-xs text-gray-500">Premium per impression</span>
                                    </div>
                                    <input type="number" id="cpi-national-premium" class="w-full px-3 py-2 border rounded-lg"
                                        placeholder="e.g., 0.02" min="0" step="0.001" oninput="calculateCpiPreview()">
                                    <p class="text-xs text-gray-500 mt-1">Added when advertiser targets a specific country</p>
                                </div>
                            </div>

                            <!-- Region Exclusion Premiums (shown only when Regional selected) -->
                            <div id="cpi-regional-section" class="p-4 bg-orange-50 rounded-lg border border-orange-200 hidden">
                                <h4 class="font-bold text-lg mb-3 flex items-center gap-2">
                                    <i class="fas fa-map-marked-alt text-orange-600"></i>
                                    Region Exclusion Premiums
                                </h4>
                                <p class="text-xs text-gray-600 mb-4">Charged when advertisers EXCLUDE (uncheck) regions. More exclusions = higher CPI.</p>
                                <div class="mb-3 p-2 bg-amber-100 border border-amber-300 rounded-lg flex items-center gap-2">
                                    <i class="fas fa-info-circle text-amber-600"></i>
                                    <span class="text-xs text-amber-700"><strong>How it works:</strong> All regions checked = Base CPI. Unchecking a region adds its exclusion premium.</span>
                                </div>

                                <!-- Country Selector -->
                                <div class="mb-4">
                                    <label class="block text-sm font-semibold mb-2">
                                        <i class="fas fa-globe text-orange-500 mr-1"></i>
                                        Select Country
                                    </label>
                                    <select id="cpi-region-country-selector" class="w-full px-3 py-2 border rounded-lg"
                                        onchange="onCpiCountryChange()">
                                        <option value="ET">Ethiopia (ET)</option>
                                        <option value="KE">Kenya (KE)</option>
                                        <option value="NG">Nigeria (NG)</option>
                                        <option value="GH">Ghana (GH)</option>
                                        <option value="ZA">South Africa (ZA)</option>
                                    </select>
                                </div>

                                <!-- Dynamic Regions Container - 2 column grid -->
                                <div id="cpi-regions-container" class="grid grid-cols-2 gap-3">
                                    <!-- Regions will be dynamically rendered based on selected country -->
                                    <div class="col-span-2 text-center py-4 text-gray-500">
                                        <i class="fas fa-spinner fa-spin mr-2"></i>
                                        Loading regions...
                                    </div>
                                </div>
                            </div>

                            <!-- Ad Placement Exclusion Premiums -->
                            <div class="p-4 bg-purple-50 rounded-lg border border-purple-200">
                                <h4 class="font-bold text-lg mb-3 flex items-center gap-2">
                                    <i class="fas fa-ad text-purple-600"></i>
                                    Placement Exclusion Premiums
                                </h4>
                                <p class="text-xs text-gray-600 mb-4">Charged when advertisers EXCLUDE (uncheck) placements. More exclusions = higher CPI.</p>
                                <div class="mb-3 p-2 bg-amber-100 border border-amber-300 rounded-lg flex items-center gap-2">
                                    <i class="fas fa-info-circle text-amber-600"></i>
                                    <span class="text-xs text-amber-700"><strong>How it works:</strong> All placements checked = Base CPI. Unchecking a placement adds its exclusion premium.</span>
                                </div>

                                <!-- Ad Placeholder Exclusion -->
                                <div class="mb-3 p-3 bg-white rounded-lg border">
                                    <div class="flex items-center justify-between mb-2">
                                        <label class="flex items-center gap-2">
                                            <i class="fas fa-rectangle-ad text-gray-500"></i>
                                            <span class="font-semibold">Exclude Ad Placeholder</span>
                                        </label>
                                    </div>
                                    <input type="number" id="cpi-placeholder-premium" class="w-full px-3 py-2 border rounded-lg"
                                        placeholder="e.g., 0.01" min="0" step="0.001" oninput="calculateCpiPreview()">
                                    <p class="text-xs text-gray-500 mt-1">Added to CPI when advertiser unchecks Ad Placeholder</p>
                                </div>

                                <!-- Ad Widget Exclusion -->
                                <div class="mb-3 p-3 bg-white rounded-lg border">
                                    <div class="flex items-center justify-between mb-2">
                                        <label class="flex items-center gap-2">
                                            <i class="fas fa-window-maximize text-blue-500"></i>
                                            <span class="font-semibold">Exclude Ad Widget</span>
                                        </label>
                                    </div>
                                    <input type="number" id="cpi-widget-premium" class="w-full px-3 py-2 border rounded-lg"
                                        placeholder="e.g., 0.02" min="0" step="0.001" oninput="calculateCpiPreview()">
                                    <p class="text-xs text-gray-500 mt-1">Added to CPI when advertiser unchecks Ad Widget</p>
                                </div>

                                <!-- Whiteboard Pop-up Exclusion -->
                                <div class="mb-3 p-3 bg-white rounded-lg border">
                                    <div class="flex items-center justify-between mb-2">
                                        <label class="flex items-center gap-2">
                                            <i class="fas fa-window-restore text-orange-500"></i>
                                            <span class="font-semibold">Exclude WB Pop-up</span>
                                        </label>
                                    </div>
                                    <input type="number" id="cpi-popup-premium" class="w-full px-3 py-2 border rounded-lg"
                                        placeholder="e.g., 0.05" min="0" step="0.001" oninput="calculateCpiPreview()">
                                    <p class="text-xs text-gray-500 mt-1">Added to CPI when advertiser unchecks Whiteboard Pop-up</p>
                                </div>

                                <!-- Whiteboard In-Session Exclusion -->
                                <div class="p-3 bg-white rounded-lg border">
                                    <div class="flex items-center justify-between mb-2">
                                        <label class="flex items-center gap-2">
                                            <i class="fas fa-chalkboard text-red-500"></i>
                                            <span class="font-semibold">Exclude WB In-Session</span>
                                        </label>
                                    </div>
                                    <input type="number" id="cpi-insession-premium" class="w-full px-3 py-2 border rounded-lg"
                                        placeholder="e.g., 0.10" min="0" step="0.001" oninput="calculateCpiPreview()">
                                    <p class="text-xs text-gray-500 mt-1">Added to CPI when advertiser unchecks Whiteboard In-Session</p>
                                </div>
                            </div>
                        </div>

                        <!-- Right Column: Live Preview Calculator -->
                        <div class="bg-gradient-to-br from-orange-50 to-yellow-50 rounded-xl p-5 border border-orange-200">
                            <h4 class="font-bold text-lg mb-4 text-orange-700">
                                <i class="fas fa-calculator mr-2"></i>CPI Calculator Preview
                            </h4>

                            <!-- Scenario Selector -->
                            <div class="mb-4 p-3 bg-white rounded-lg border">
                                <label class="block text-sm font-semibold mb-2">Preview Scenario</label>
                                <div class="grid grid-cols-3 gap-2 mb-3">
                                    <div>
                                        <label class="block text-xs text-gray-500 mb-1">Exclude Audience</label>
                                        <select id="cpi-preview-audience" class="w-full px-2 py-1.5 border rounded text-sm" onchange="calculateCpiPreview()">
                                            <option value="none">All Audiences (Base)</option>
                                            <option value="tutor">Exclude Tutor</option>
                                            <option value="student">Exclude Student</option>
                                            <option value="parent">Exclude Parent</option>
                                            <option value="advertiser">Exclude Advertiser</option>
                                            <option value="user">Exclude User</option>
                                        </select>
                                    </div>
                                    <div>
                                        <label class="block text-xs text-gray-500 mb-1">Target Location</label>
                                        <select id="cpi-preview-location" class="w-full px-2 py-1.5 border rounded text-sm" onchange="calculateCpiPreview()">
                                            <option value="none">No targeting</option>
                                            <option value="national">National</option>
                                            <option value="regional">Regional</option>
                                        </select>
                                    </div>
                                    <div>
                                        <label class="block text-xs text-gray-500 mb-1">Exclude Placement</label>
                                        <select id="cpi-preview-placement" class="w-full px-2 py-1.5 border rounded text-sm" onchange="calculateCpiPreview()">
                                            <option value="none">All Placements (Base)</option>
                                            <option value="placeholder">Exclude Placeholder</option>
                                            <option value="widget">Exclude Widget</option>
                                            <option value="popup">Exclude WB Pop-up</option>
                                            <option value="insession">Exclude WB In-Session</option>
                                        </select>
                                    </div>
                                </div>
                            </div>

                            <!-- CPI Breakdown -->
                            <div class="space-y-3">
                                <!-- Base Rate -->
                                <div class="bg-white rounded-lg p-3 shadow-sm border">
                                    <div class="flex justify-between items-center">
                                        <span class="text-sm text-gray-600">Base CPI</span>
                                        <span id="cpi-preview-base" class="font-semibold text-gray-800">0.00 ETB</span>
                                    </div>
                                </div>

                                <!-- Audience Premium -->
                                <div id="cpi-preview-audience-row" class="bg-blue-50 rounded-lg p-3 border border-blue-200 hidden">
                                    <div class="flex justify-between items-center">
                                        <span class="text-sm text-blue-700">
                                            <i class="fas fa-users mr-1"></i>
                                            <span id="cpi-preview-audience-label">Audience Premium</span>
                                        </span>
                                        <span id="cpi-preview-audience-value" class="font-semibold text-blue-700">+0.00 ETB</span>
                                    </div>
                                </div>

                                <!-- Location Premium (National) -->
                                <div id="cpi-preview-location-row" class="bg-green-50 rounded-lg p-3 border border-green-200 hidden">
                                    <div class="flex justify-between items-center">
                                        <span class="text-sm text-green-700">
                                            <i class="fas fa-map-marker-alt mr-1"></i>
                                            <span id="cpi-preview-location-label">Location Premium</span>
                                        </span>
                                        <span id="cpi-preview-location-value" class="font-semibold text-green-700">+0.00 ETB</span>
                                    </div>
                                </div>

                                <!-- Region Exclusion Premium (only for regional - shown with sample region) -->
                                <div id="cpi-preview-region-row" class="bg-orange-50 rounded-lg p-3 border border-orange-200 hidden">
                                    <div class="flex justify-between items-center">
                                        <span class="text-sm text-orange-700">
                                            <i class="fas fa-map-marked-alt mr-1"></i>
                                            <span id="cpi-preview-region-label">Region Exclusion (sample)</span>
                                        </span>
                                        <span id="cpi-preview-region-value" class="font-semibold text-orange-700">+0.00 ETB</span>
                                    </div>
                                    <p class="text-xs text-orange-500 mt-1">Actual varies by excluded regions</p>
                                </div>

                                <!-- Placement Exclusion Premium -->
                                <div id="cpi-preview-placement-row" class="bg-purple-50 rounded-lg p-3 border border-purple-200 hidden">
                                    <div class="flex justify-between items-center">
                                        <span class="text-sm text-purple-700">
                                            <i class="fas fa-minus-circle mr-1"></i>
                                            <span id="cpi-preview-placement-label">Exclusion Premium</span>
                                        </span>
                                        <span id="cpi-preview-placement-value" class="font-semibold text-purple-700">+0.00 ETB</span>
                                    </div>
                                </div>

                                <!-- Total CPI -->
                                <div class="bg-gradient-to-r from-orange-500 to-orange-600 rounded-lg p-4 text-white">
                                    <div class="flex justify-between items-center">
                                        <span class="font-semibold">Total CPI</span>
                                        <span id="cpi-preview-total" class="text-2xl font-bold">0.00 ETB</span>
                                    </div>
                                    <p class="text-xs text-orange-100 mt-1">Cost per impression with selected targeting</p>
                                </div>

                                <!-- Example Calculations -->
                                <div class="bg-white rounded-lg p-4 border mt-4">
                                    <h5 class="font-semibold text-sm mb-3 text-gray-700">
                                        <i class="fas fa-chart-bar mr-1"></i>Example Costs
                                    </h5>
                                    <div class="space-y-2 text-sm">
                                        <div class="flex justify-between">
                                            <span class="text-gray-600">1,000 impressions:</span>
                                            <span id="cpi-example-1k" class="font-semibold">0.00 ETB</span>
                                        </div>
                                        <div class="flex justify-between">
                                            <span class="text-gray-600">10,000 impressions:</span>
                                            <span id="cpi-example-10k" class="font-semibold">0.00 ETB</span>
                                        </div>
                                        <div class="flex justify-between">
                                            <span class="text-gray-600">100,000 impressions:</span>
                                            <span id="cpi-example-100k" class="font-semibold">0.00 ETB</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Submit Buttons -->
                    <div class="flex justify-end gap-3 mt-6 pt-4 border-t">
                        <button type="button" onclick="closeCpiSettingsModal()"
                            class="px-6 py-2 border rounded-lg hover:bg-gray-50">
                            Cancel
                        </button>
                        <button type="submit" class="px-6 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700">
                            <i class="fas fa-save mr-2"></i>Save CPI Settings
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Verification Fee Modal (Add/Edit) -->
    <div id="verification-fee-modal" class="modal hidden">
        <div class="modal-overlay" onclick="closeVerificationFeeModal()"></div>
        <div class="modal-content" style="max-width: 600px;">
            <div class="modal-header">
                <h2 class="text-xl font-bold" id="verification-modal-title">
                    <i class="fas fa-certificate mr-2"></i>Add Verification Fee
                </h2>
                <button class="modal-close" onclick="closeVerificationFeeModal()">√ó</button>
            </div>
            <div class="modal-body">
                <form id="verification-fee-form" onsubmit="saveVerificationFee(event)">
                    <!-- Hidden ID for editing -->
                    <input type="hidden" id="verification-fee-id" placeholder="">

                    <!-- Fee Type -->
                    <div class="mb-4">
                        <label class="block text-sm font-semibold mb-2">Fee Type *</label>
                        <input type="text" id="verification-fee-type" class="w-full px-3 py-2 border rounded-lg"
                            placeholder="e.g., individual, organization, enterprise" required>
                        <p class="text-xs text-gray-500 mt-1">Unique identifier for this fee type (lowercase, no spaces)</p>
                    </div>

                    <!-- Display Name -->
                    <div class="mb-4">
                        <label class="block text-sm font-semibold mb-2">Display Name *</label>
                        <input type="text" id="verification-fee-name" class="w-full px-3 py-2 border rounded-lg"
                            placeholder="e.g., Individual Verification, Organization Verification" required>
                        <p class="text-xs text-gray-500 mt-1">Name shown to users</p>
                    </div>

                    <!-- Country/Location -->
                    <div class="mb-4">
                        <label class="block text-sm font-semibold mb-2">
                            Country/Location *
                            <span class="text-xs font-normal text-blue-600 ml-2">
                                <i class="fas fa-location-arrow"></i> Auto-detected from GPS
                            </span>
                        </label>

                        <!-- Hidden field to store country code -->
                        <input type="hidden" id="verification-fee-country" required>

                        <!-- Read-only display field -->
                        <div id="verification-fee-country-display"
                             class="w-full px-3 py-2 border rounded-lg bg-gray-50 text-gray-700 font-medium">
                            <i class="fas fa-spinner fa-spin mr-2 text-blue-500"></i>Detecting location...
                        </div>

                        <!-- GPS Detection Status -->
                        <div id="verification-fee-country-status" class="text-xs mt-1">
                            <span class="text-gray-500">
                                <i class="fas fa-map-marker-alt mr-1"></i>
                                Automatically detected from your physical location via GPS.
                            </span>
                        </div>
                    </div>

                    <!-- Price -->
                    <div class="mb-4">
                        <label class="block text-sm font-semibold mb-2">Price (ETB) *</label>
                        <input type="number" id="verification-fee-price" class="w-full px-3 py-2 border rounded-lg"
                            placeholder="e.g., 99" min="0" step="1" required>
                        <p class="text-xs text-gray-500 mt-1">One-time verification fee</p>
                    </div>

                    <!-- Features -->
                    <div class="mb-4">
                        <div class="flex items-center justify-between mb-2">
                            <label class="block text-sm font-semibold">Features Included</label>
                            <button type="button" onclick="addVerificationFeeFeature()"
                                class="flex items-center gap-1 px-3 py-1.5 bg-indigo-600 text-white text-sm rounded-lg hover:bg-indigo-700 transition">
                                <i class="fas fa-plus"></i>
                                <span>Add Feature</span>
                            </button>
                        </div>
                        <p class="text-xs text-gray-500 mb-3">What benefits are included with this verification</p>

                        <!-- Container for dynamic feature items -->
                        <div id="verification-features-container" class="space-y-2">
                            <!-- Dynamic feature items will be added here -->
                        </div>

                        <!-- Empty state message -->
                        <div id="verification-features-empty-state" class="text-center py-4 text-gray-400 text-sm border-2 border-dashed rounded-lg">
                            <i class="fas fa-list-ul mb-2"></i>
                            <p>No features added yet. Click "Add Feature" to start.</p>
                        </div>
                    </div>

                    <!-- Submit Buttons -->
                    <div class="flex justify-end gap-3 mt-6 pt-4 border-t">
                        <button type="button" onclick="closeVerificationFeeModal()"
                            class="px-6 py-2 border rounded-lg hover:bg-gray-50">
                            Cancel
                        </button>
                        <button type="submit" class="px-6 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700">
                            <i class="fas fa-save mr-2"></i>Save Fee
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Subscription Plan Modal (Add/Edit) -->
    <div id="subscription-plan-modal" class="modal hidden">
        <div class="modal-overlay" onclick="closeSubscriptionPlanModal()"></div>
        <div class="modal-content" style="max-width: 800px;">
            <div class="modal-header">
                <h2 class="text-xl font-bold" id="subscription-modal-title">
                    <i class="fas fa-crown mr-2"></i>Add Subscription Plan
                </h2>
                <button class="modal-close" onclick="closeSubscriptionPlanModal()">√ó</button>
            </div>
            <div class="modal-body">
                <form id="subscription-plan-form" onsubmit="saveSubscriptionPlan(event)">
                    <!-- Hidden ID for editing -->
                    <input type="hidden" id="subscription-plan-id" placeholder="">

                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <!-- Left Column: Plan Details -->
                        <div>
                            <!-- Plan Name -->
                            <div class="mb-4">
                                <label class="block text-sm font-semibold mb-2">Plan Name *</label>
                                <input type="text" id="subscription-plan-name" class="w-full px-3 py-2 border rounded-lg"
                                    placeholder="e.g., Monthly, 3 Months, 6 Months, Yearly" required>
                                <p class="text-xs text-gray-500 mt-1">Display name for this plan (e.g., Monthly Plan, Yearly Plan)</p>
                            </div>

                            <!-- Subscription Type -->
                            <div class="mb-4">
                                <label class="block text-sm font-semibold mb-2">Subscription Type *</label>
                                <select id="subscription-plan-type" class="w-full px-3 py-2 border rounded-lg" required>
                                    <option value="tutor">Tutor Subscription</option>
                                    <option value="student">Student Subscription</option>
                                    <option value="parent">Parent Subscription</option>
                                    <option value="institute">Institute Subscription</option>
                                    <option value="advertiser">Advertiser Subscription</option>
                                </select>
                                <p class="text-xs text-gray-500 mt-1">Select who this subscription plan is for</p>
                            </div>

                            <!-- Country/Location -->
                            <div class="mb-4">
                                <label class="block text-sm font-semibold mb-2">
                                    Country/Location *
                                    <span class="text-xs font-normal text-blue-600 ml-2">
                                        <i class="fas fa-location-arrow"></i> Auto-detected from GPS
                                    </span>
                                </label>

                                <!-- Hidden field to store country code -->
                                <input type="hidden" id="subscription-plan-country" required>

                                <!-- Read-only display field -->
                                <div id="subscription-plan-country-display"
                                     class="w-full px-3 py-2 border rounded-lg bg-gray-50 text-gray-700 font-medium">
                                    <i class="fas fa-spinner fa-spin mr-2 text-blue-500"></i>Detecting location...
                                </div>

                                <!-- GPS Detection Status -->
                                <div id="subscription-plan-country-status" class="text-xs mt-1">
                                    <span class="text-gray-500">
                                        <i class="fas fa-map-marker-alt mr-1"></i>
                                        Automatically detected from your physical location via GPS.
                                    </span>
                                </div>
                            </div>

                            <!-- Monthly Price -->
                            <div class="mb-4">
                                <label class="block text-sm font-semibold mb-2">Monthly Price (ETB) *</label>
                                <input type="number" id="subscription-plan-price" class="w-full px-3 py-2 border rounded-lg"
                                    placeholder="e.g., 99" min="0" step="1" required oninput="calculateSubscriptionPreview()">
                                <p class="text-xs text-gray-500 mt-1">Monthly subscription price for this plan</p>
                            </div>

                            <!-- Upfront Payment Discounts Section -->
                            <div class="mb-4 p-4 border-2 border-purple-200 rounded-lg bg-purple-50" id="subscription-discount-tiers-section">
                                <h4 class="font-semibold text-sm text-purple-700 mb-3">
                                    <i class="fas fa-percentage mr-1"></i>Upfront Payment Discounts
                                </h4>
                                <p class="text-xs text-gray-500 mb-4">Discount for subscribers who pay multiple months upfront at once</p>

                                <!-- Pay 3 Months Upfront -->
                                <div class="flex items-center gap-3 mb-3">
                                    <div class="flex-1">
                                        <label class="block text-xs font-medium text-gray-600 mb-1">Pay 3 Months Upfront</label>
                                        <div class="flex items-center gap-2">
                                            <input type="number" id="subscription-discount-3-months" class="flex-1 px-3 py-2 border rounded-lg text-sm"
                                                placeholder="5" min="0" max="100" step="1" value="5" oninput="calculateSubscriptionPreview()">
                                            <span class="text-gray-500 font-medium">% off</span>
                                        </div>
                                    </div>
                                </div>

                                <!-- Pay 6 Months Upfront -->
                                <div class="flex items-center gap-3 mb-3">
                                    <div class="flex-1">
                                        <label class="block text-xs font-medium text-gray-600 mb-1">Pay 6 Months Upfront</label>
                                        <div class="flex items-center gap-2">
                                            <input type="number" id="subscription-discount-6-months" class="flex-1 px-3 py-2 border rounded-lg text-sm"
                                                placeholder="10" min="0" max="100" step="1" value="10" oninput="calculateSubscriptionPreview()">
                                            <span class="text-gray-500 font-medium">% off</span>
                                        </div>
                                    </div>
                                </div>

                                <!-- Pay Yearly Upfront -->
                                <div class="flex items-center gap-3">
                                    <div class="flex-1">
                                        <label class="block text-xs font-medium text-gray-600 mb-1">Pay Yearly Upfront</label>
                                        <div class="flex items-center gap-2">
                                            <input type="number" id="subscription-discount-yearly" class="flex-1 px-3 py-2 border rounded-lg text-sm"
                                                placeholder="20" min="0" max="100" step="1" value="20" oninput="calculateSubscriptionPreview()">
                                            <span class="text-gray-500 font-medium">% off</span>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Plan Labels -->
                            <div class="mb-4">
                                <label class="block text-sm font-semibold mb-2">Plan Label</label>
                                <div class="space-y-2">
                                    <label class="flex items-center gap-2 cursor-pointer">
                                        <input type="radio" name="subscription-plan-label" value="none" class="w-4 h-4" checked>
                                        <span class="text-sm">No Label</span>
                                    </label>
                                    <label class="flex items-center gap-2 cursor-pointer p-2 border rounded-lg hover:bg-purple-50 transition">
                                        <input type="radio" name="subscription-plan-label" value="popular" class="w-4 h-4">
                                        <span class="flex items-center gap-2">
                                            <span class="px-2 py-0.5 bg-purple-500 text-white text-xs font-bold rounded">POPULAR</span>
                                            <span class="text-sm">Mark as Popular</span>
                                        </span>
                                    </label>
                                </div>
                            </div>

                        </div>

                        <!-- Right Column: Price Preview & Tier Calculation -->
                        <div class="bg-gradient-to-br from-purple-50 to-blue-50 rounded-xl p-5 border border-purple-200">
                            <h4 class="font-bold text-lg mb-4 text-purple-700">
                                <i class="fas fa-calculator mr-2"></i>Price Preview
                            </h4>

                            <div class="space-y-4">
                                <!-- Monthly Price -->
                                <div class="bg-white rounded-lg p-4 shadow-sm border border-purple-300">
                                    <div class="flex justify-between items-center">
                                        <div>
                                            <div class="font-semibold text-gray-700">Monthly Price</div>
                                            <div class="text-xs text-gray-500">Base monthly rate</div>
                                        </div>
                                        <div class="text-right">
                                            <div id="preview-monthly-price" class="text-2xl font-bold text-purple-600">-- ETB</div>
                                            <div class="text-xs text-gray-500">/month</div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Upfront Payment Pricing Preview -->
                                <div id="subscription-tier-preview-section" class="bg-gradient-to-r from-green-50 to-emerald-50 rounded-lg p-4 border border-green-200">
                                    <h5 class="font-semibold text-green-800 mb-3">
                                        <i class="fas fa-credit-card mr-1"></i>Upfront Payment Pricing
                                    </h5>
                                    <div class="space-y-2">
                                        <!-- Pay 3 Months Upfront -->
                                        <div class="flex justify-between items-center">
                                            <span class="text-sm text-gray-600">Pay 3 Months:</span>
                                            <div class="text-right">
                                                <span id="preview-3-month-price" class="font-semibold text-gray-800">-- ETB</span>
                                                <span id="preview-3-month-discount" class="ml-2 text-xs text-green-600 font-medium">(--%)</span>
                                            </div>
                                        </div>
                                        <!-- Pay 6 Months Upfront -->
                                        <div class="flex justify-between items-center">
                                            <span class="text-sm text-gray-600">Pay 6 Months:</span>
                                            <div class="text-right">
                                                <span id="preview-6-month-price" class="font-semibold text-gray-800">-- ETB</span>
                                                <span id="preview-6-month-discount" class="ml-2 text-xs text-green-600 font-medium">(--%)</span>
                                            </div>
                                        </div>
                                        <!-- Pay Yearly Upfront -->
                                        <div class="flex justify-between items-center border-t border-green-300 pt-2 mt-2">
                                            <span class="text-sm font-semibold text-green-700">Pay Yearly:</span>
                                            <div class="text-right">
                                                <span id="preview-yearly-price" class="text-lg font-bold text-green-700">-- ETB</span>
                                                <span id="preview-yearly-discount" class="ml-2 text-xs text-green-600 font-medium">(--%)</span>
                                            </div>
                                        </div>
                                    </div>
                                    <p class="text-xs text-gray-500 mt-3">
                                        <i class="fas fa-info-circle mr-1"></i>
                                        Total price when paying upfront for multiple months
                                    </p>
                                </div>

                                <!-- Discount Info Notice -->
                                <div class="bg-blue-100 rounded-lg p-4 border border-blue-300">
                                    <div class="text-center">
                                        <i class="fas fa-info-circle text-blue-600 text-2xl mb-2"></i>
                                        <p class="font-semibold text-blue-800">Upfront Payment Discounts</p>
                                        <p class="text-xs text-blue-600">Offer discounts for customers who pay multiple months upfront</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Submit Buttons -->
                    <div class="flex justify-end gap-3 mt-6 pt-4 border-t">
                        <button type="button" onclick="closeSubscriptionPlanModal()"
                            class="px-6 py-2 border rounded-lg hover:bg-gray-50">
                            Cancel
                        </button>
                        <button type="submit" class="px-6 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700">
                            <i class="fas fa-save mr-2"></i>Save Plan
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Assign Features Modal -->
    <div id="assign-features-modal" class="modal hidden">
        <div class="modal-overlay" onclick="closeAssignFeaturesModal()"></div>
        <div class="modal-content" style="max-width: 900px;">
            <div class="modal-header">
                <h2 class="text-xl font-bold">
                    <i class="fas fa-check-square mr-2 text-indigo-600"></i>Assign Features to Subscription Plan
                </h2>
                <button class="modal-close" onclick="closeAssignFeaturesModal()">√ó</button>
            </div>
            <div class="modal-body">
                <form id="assign-features-form" onsubmit="saveAssignedFeatures(event)">

                    <!-- Left-Right Split Layout -->
                    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">

                        <!-- LEFT SIDE: Plan Selection & Filter -->
                        <div class="lg:col-span-1">
                            <div class="sticky top-0">
                                <h3 class="font-semibold text-gray-900 mb-3">
                                    <i class="fas fa-crown mr-2 text-indigo-600"></i>Select Plan
                                </h3>

                                <!-- Search and Filter (always visible) -->
                                <div id="plan-selection-controls">
                                    <div class="mb-3">
                                        <label class="block text-sm font-medium mb-2">Search by Name</label>
                                        <input type="text" id="feature-plan-search"
                                            class="w-full px-3 py-2 border rounded-lg text-sm"
                                            placeholder="Type to search..."
                                            oninput="searchSubscriptionPlansForFeatures()">
                                    </div>

                                    <!-- Selected Plan Display (shown after selection) -->
                                    <div id="selected-plan-display" class="hidden mb-3 p-3 bg-indigo-50 rounded-lg border-2 border-indigo-300">
                                        <div class="flex items-start justify-between gap-2">
                                            <div class="flex-1">
                                                <span class="text-xs text-indigo-600 font-medium">Selected:</span>
                                                <h4 id="selected-plan-name" class="font-bold text-base text-indigo-900 mt-1"></h4>
                                                <p id="selected-plan-price" class="text-sm text-gray-600 mt-1"></p>
                                            </div>
                                            <button type="button" onclick="clearFeatureAssignmentSelectedPlan()"
                                                class="px-3 py-1.5 text-xs bg-white hover:bg-gray-50 border rounded-lg transition-colors flex-shrink-0">
                                                <i class="fas fa-times mr-1"></i>Change
                                            </button>
                                        </div>
                                    </div>

                                    <!-- Plans List -->
                                    <div id="feature-plans-list-container" class="mb-3">
                                        <label class="block text-sm font-medium mb-2">Available Plans</label>
                                        <div id="feature-plans-list" class="max-h-96 overflow-y-auto space-y-2 border rounded-lg p-2 bg-gray-50">
                                            <!-- Plans will be dynamically loaded here -->
                                            <div class="text-center py-8 text-gray-400">
                                                <i class="fas fa-spinner fa-spin text-2xl mb-2"></i>
                                                <p class="text-sm">Loading plans...</p>
                                            </div>
                                        </div>
                                    </div>

                                    <div>
                                        <label class="block text-sm font-medium mb-2">Filter by Role</label>
                                        <select id="feature-role-filter"
                                            class="w-full px-3 py-2 border rounded-lg text-sm"
                                            onchange="filterSubscriptionPlansByRole()">
                                            <option value="">All Roles</option>
                                            <option value="tutor">Tutor Plans</option>
                                            <option value="student">Student Plans</option>
                                            <option value="parent">Parent Plans</option>
                                            <option value="institute">Institute Plans</option>
                                            <option value="advertiser">Advertiser Plans</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- RIGHT SIDE: Feature Assignment -->
                        <div class="lg:col-span-2">
                            <div id="feature-assignment-section" class="hidden">
                                <h3 class="font-semibold text-gray-900 mb-4">
                                    <i class="fas fa-tasks mr-2 text-indigo-600"></i>Assign Features by Role
                                </h3>

                                <!-- Role Tabs -->
                                <div class="flex flex-wrap gap-2 mb-4 border-b border-gray-200 pb-2">
                                    <button type="button" onclick="switchFeatureRoleTab('tutor')"
                                        class="feature-role-tab px-4 py-2 rounded-t-lg font-medium transition-all text-sm"
                                        data-role="tutor">
                                        <i class="fas fa-chalkboard-teacher mr-1"></i>Tutor
                                    </button>
                                    <button type="button" onclick="switchFeatureRoleTab('student')"
                                        class="feature-role-tab px-4 py-2 rounded-t-lg font-medium transition-all text-sm"
                                        data-role="student">
                                        <i class="fas fa-user-graduate mr-1"></i>Student
                                    </button>
                                    <button type="button" onclick="switchFeatureRoleTab('parent')"
                                        class="feature-role-tab px-4 py-2 rounded-t-lg font-medium transition-all text-sm"
                                        data-role="parent">
                                        <i class="fas fa-users mr-1"></i>Parent
                                    </button>
                                    <button type="button" onclick="switchFeatureRoleTab('advertiser')"
                                        class="feature-role-tab px-4 py-2 rounded-t-lg font-medium transition-all text-sm"
                                        data-role="advertiser">
                                        <i class="fas fa-bullhorn mr-1"></i>Advertiser
                                    </button>
                                    <button type="button" onclick="switchFeatureRoleTab('institute')"
                                        class="feature-role-tab px-4 py-2 rounded-t-lg font-medium transition-all text-sm"
                                        data-role="institute">
                                        <i class="fas fa-university mr-1"></i>Institute
                                    </button>
                                </div>

                                <!-- Feature Panels for each Role -->
                                <div class="max-h-96 overflow-y-auto pr-2">
                                    <div id="tutor-features-panel" class="feature-role-panel hidden">
                                        <div class="flex items-center justify-between mb-3">
                                            <h4 class="font-semibold text-gray-700">Tutor Features</h4>
                                            <button type="button" onclick="addRoleFeature('tutor')"
                                                class="px-3 py-1.5 bg-indigo-600 text-white text-sm rounded-lg hover:bg-indigo-700">
                                                <i class="fas fa-plus mr-1"></i>Add Feature
                                            </button>
                                        </div>
                                        <div id="tutor-features-container" class="space-y-2"></div>
                                    </div>

                                    <div id="student-features-panel" class="feature-role-panel hidden">
                                        <div class="flex items-center justify-between mb-3">
                                            <h4 class="font-semibold text-gray-700">Student Features</h4>
                                            <button type="button" onclick="addRoleFeature('student')"
                                                class="px-3 py-1.5 bg-indigo-600 text-white text-sm rounded-lg hover:bg-indigo-700">
                                                <i class="fas fa-plus mr-1"></i>Add Feature
                                            </button>
                                        </div>
                                        <div id="student-features-container" class="space-y-2"></div>
                                    </div>

                                    <div id="parent-features-panel" class="feature-role-panel hidden">
                                        <div class="flex items-center justify-between mb-3">
                                            <h4 class="font-semibold text-gray-700">Parent Features</h4>
                                            <button type="button" onclick="addRoleFeature('parent')"
                                                class="px-3 py-1.5 bg-indigo-600 text-white text-sm rounded-lg hover:bg-indigo-700">
                                                <i class="fas fa-plus mr-1"></i>Add Feature
                                            </button>
                                        </div>
                                        <div id="parent-features-container" class="space-y-2"></div>
                                    </div>

                                    <div id="advertiser-features-panel" class="feature-role-panel hidden">
                                        <div class="flex items-center justify-between mb-3">
                                            <h4 class="font-semibold text-gray-700">Advertiser Features</h4>
                                            <button type="button" onclick="addRoleFeature('advertiser')"
                                                class="px-3 py-1.5 bg-indigo-600 text-white text-sm rounded-lg hover:bg-indigo-700">
                                                <i class="fas fa-plus mr-1"></i>Add Feature
                                            </button>
                                        </div>
                                        <div id="advertiser-features-container" class="space-y-2"></div>
                                    </div>

                                    <div id="institute-features-panel" class="feature-role-panel hidden">
                                        <div class="flex items-center justify-between mb-3">
                                            <h4 class="font-semibold text-gray-700">Institute Features</h4>
                                            <button type="button" onclick="addRoleFeature('institute')"
                                                class="px-3 py-1.5 bg-indigo-600 text-white text-sm rounded-lg hover:bg-indigo-700">
                                                <i class="fas fa-plus mr-1"></i>Add Feature
                                            </button>
                                        </div>
                                        <div id="institute-features-container" class="space-y-2"></div>
                                    </div>
                                </div>
                            </div>

                            <!-- Empty State (when no plan selected) -->
                            <div id="feature-assignment-empty-state" class="text-center py-12 text-gray-400">
                                <i class="fas fa-hand-pointer text-4xl mb-4 opacity-50"></i>
                                <h4 class="text-lg font-semibold mb-2">Select a Plan</h4>
                                <p class="text-sm">Choose a subscription plan from the left to assign features</p>
                            </div>
                        </div>
                    </div>

                    <!-- Submit Buttons -->
                    <div class="flex justify-end gap-3 mt-6 pt-4 border-t">
                        <button type="button" onclick="closeAssignFeaturesModal()"
                            class="px-6 py-2 border rounded-lg hover:bg-gray-50">
                            Cancel
                        </button>
                        <button type="submit" id="save-features-btn" class="hidden px-6 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700">
                            <i class="fas fa-save mr-2"></i>Save Features
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Base Price Rule Modal (Add/Edit) -->
    <div id="base-price-modal" class="modal hidden">
        <div class="modal-overlay" onclick="closeBasePriceModal()"></div>
        <div class="modal-content" style="max-width: 700px;">
            <div class="modal-header">
                <h2 class="text-xl font-bold" id="base-price-modal-title">
                    <i class="fas fa-tag mr-2"></i>Add Starting Price Rule
                </h2>
                <button class="modal-close" onclick="closeBasePriceModal()">√ó</button>
            </div>
            <div class="modal-body">
                <form id="base-price-form" onsubmit="saveBasePriceRule(event)">
                    <!-- Hidden ID for editing -->
                    <input type="hidden" id="base-price-rule-id" placeholder="">

                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <!-- Left Column: Rule Configuration -->
                        <div>
                            <!-- Rule Name -->
                            <div class="mb-4">
                                <label class="block text-sm font-semibold mb-2">Rule Name *</label>
                                <input type="text" id="base-price-rule-name" class="w-full px-3 py-2 border rounded-lg"
                                    placeholder="e.g., Math Online Base Price" required>
                                <p class="text-xs text-gray-500 mt-1">Descriptive name for this pricing rule</p>
                            </div>

                            <!-- Country/Location -->
                            <div class="mb-4">
                                <label class="block text-sm font-semibold mb-2">
                                    Country/Location *
                                    <span class="text-xs font-normal text-blue-600 ml-2">
                                        <i class="fas fa-location-arrow"></i> Auto-detected from GPS
                                    </span>
                                </label>
                                <!-- Hidden field to store country code -->
                                <input type="hidden" id="base-price-country" required>

                                <!-- Read-only display field -->
                                <div id="base-price-country-display" class="w-full px-3 py-2 border rounded-lg bg-gray-50 text-gray-700 font-medium">
                                    <i class="fas fa-spinner fa-spin mr-2 text-blue-500"></i>Detecting location...
                                </div>

                                <!-- GPS Detection Status -->
                                <div id="country-detection-status" class="text-xs mt-1">
                                    <span class="text-gray-500"><i class="fas fa-map-marker-alt mr-1"></i>Automatically detected from your physical location via GPS.</span>
                                </div>
                            </div>

                            <!-- Subject Category -->
                            <div class="mb-4">
                                <label class="block text-sm font-semibold mb-2">Subject Category *</label>
                                <select id="base-price-subject" class="w-full px-3 py-2 border rounded-lg" required onchange="updateBasePricePreview()">
                                    <option value="">Select Subject</option>
                                    <option value="all">All Subjects (Default)</option>
                                    <option value="mathematics">Mathematics</option>
                                    <option value="science">Science (Physics, Chemistry, Biology)</option>
                                    <option value="languages">Languages (English, Amharic, etc.)</option>
                                    <option value="social_studies">Social Studies (History, Geography)</option>
                                    <option value="computer_science">Computer Science & IT</option>
                                    <option value="arts">Arts & Music</option>
                                    <option value="business">Business & Economics</option>
                                    <option value="other">Other Subjects</option>
                                </select>
                                <p class="text-xs text-gray-500 mt-1">Which subject(s) this price applies to</p>
                            </div>

                            <!-- Session Format -->
                            <div class="mb-4">
                                <label class="block text-sm font-semibold mb-2">Session Format *</label>
                                <select id="base-price-format" class="w-full px-3 py-2 border rounded-lg" required onchange="updateBasePricePreview()">
                                    <option value="">Select Format</option>
                                    <option value="all">All Formats (Default)</option>
                                    <option value="Online">Online Only</option>
                                    <option value="In-Person">In-Person Only</option>
                                    <option value="Hybrid">Hybrid (Online + In-Person)</option>
                                </select>
                                <p class="text-xs text-gray-500 mt-1">Session delivery format</p>
                            </div>

                            <!-- Grade Level Range -->
                            <div class="mb-4">
                                <label class="block text-sm font-semibold mb-2">Education Level Range *</label>
                                <div class="grid grid-cols-2 gap-3">
                                    <div>
                                        <select id="base-price-min-grade" class="w-full px-3 py-2 border rounded-lg" required>
                                            <option value="1">Grade 1</option>
                                            <option value="2">Grade 2</option>
                                            <option value="3">Grade 3</option>
                                            <option value="4">Grade 4</option>
                                            <option value="5">Grade 5</option>
                                            <option value="6">Grade 6</option>
                                            <option value="7">Grade 7</option>
                                            <option value="8">Grade 8</option>
                                            <option value="9">Grade 9</option>
                                            <option value="10">Grade 10</option>
                                            <option value="11">Grade 11</option>
                                            <option value="12">Grade 12</option>
                                            <option value="13">University</option>
                                            <option value="14">Certification</option>
                                        </select>
                                        <p class="text-xs text-gray-500 mt-1">Minimum</p>
                                    </div>
                                    <div>
                                        <select id="base-price-max-grade" class="w-full px-3 py-2 border rounded-lg" required>
                                            <option value="1">Grade 1</option>
                                            <option value="2">Grade 2</option>
                                            <option value="3">Grade 3</option>
                                            <option value="4">Grade 4</option>
                                            <option value="5">Grade 5</option>
                                            <option value="6">Grade 6</option>
                                            <option value="7">Grade 7</option>
                                            <option value="8">Grade 8</option>
                                            <option value="9">Grade 9</option>
                                            <option value="10">Grade 10</option>
                                            <option value="11">Grade 11</option>
                                            <option value="12">Grade 12</option>
                                            <option value="13">University</option>
                                            <option value="14" selected>Certification</option>
                                        </select>
                                        <p class="text-xs text-gray-500 mt-1">Maximum</p>
                                    </div>
                                </div>
                                <p class="text-xs text-gray-500 mt-1">
                                    <i class="fas fa-info-circle mr-1"></i>
                                    Set to Grade 1-Certification for all levels (default). University = College/Bachelor's/Master's/PhD. Certification = Professional certifications, test prep
                                </p>
                            </div>

                            <!-- Base Price -->
                            <div class="mb-4">
                                <label class="block text-sm font-semibold mb-2">Starting Price (ETB/hour) *</label>
                                <input type="number" id="base-price-amount" class="w-full px-3 py-2 border rounded-lg"
                                    placeholder="e.g., 50" min="1" step="1" required oninput="updateBasePricePreview()">
                                <p class="text-xs text-gray-500 mt-1">Base hourly rate for new tutors</p>
                            </div>

                            <!-- Credential Bonus -->
                            <div class="mb-4">
                                <label class="block text-sm font-semibold mb-2">Credential Bonus (ETB/hour)</label>
                                <input type="number" id="base-price-credential-bonus" class="w-full px-3 py-2 border rounded-lg"
                                    placeholder="e.g., 10" min="0" step="1" value="0" oninput="updateBasePricePreview()">
                                <p class="text-xs text-gray-500 mt-1">Additional price per verified credential (degree, certificate)</p>
                            </div>

                            <!-- Experience Bonus -->
                            <div class="mb-4">
                                <label class="block text-sm font-semibold mb-2">Experience Bonus (ETB/year)</label>
                                <input type="number" id="base-price-experience-bonus" class="w-full px-3 py-2 border rounded-lg"
                                    placeholder="e.g., 5" min="0" step="1" value="0" oninput="updateBasePricePreview()">
                                <p class="text-xs text-gray-500 mt-1">Additional price per year of experience (e.g., 5 years √ó bonus = 5√ó bonus)</p>
                            </div>

                            <!-- Priority -->
                            <div class="mb-4">
                                <label class="block text-sm font-semibold mb-2">Rule Priority</label>
                                <select id="base-price-priority" class="w-full px-3 py-2 border rounded-lg">
                                    <option value="1">High (applies first)</option>
                                    <option value="2" selected>Medium (normal)</option>
                                    <option value="3">Low (fallback)</option>
                                </select>
                                <p class="text-xs text-gray-500 mt-1">Higher priority rules are matched first</p>
                            </div>

                            <!-- Active Status -->
                            <div class="mb-4">
                                <label class="flex items-center gap-2 cursor-pointer">
                                    <input type="checkbox" id="base-price-active" class="w-4 h-4" checked>
                                    <span class="text-sm font-semibold">Active Rule</span>
                                </label>
                                <p class="text-xs text-gray-500 mt-1">Inactive rules won't be applied to new tutors</p>
                            </div>
                        </div>

                        <!-- Right Column: Preview & Examples -->
                        <div class="bg-gradient-to-br from-teal-50 to-cyan-50 rounded-xl p-5 border border-teal-200">
                            <h4 class="font-bold text-lg mb-4 text-teal-700">
                                <i class="fas fa-eye mr-2"></i>Price Preview
                            </h4>

                            <div class="space-y-4">
                                <!-- Base Price Display -->
                                <div class="bg-white rounded-lg p-4 shadow-sm border border-teal-300">
                                    <div class="flex justify-between items-center mb-3">
                                        <div>
                                            <div class="font-semibold text-gray-700">Base Starting Price</div>
                                            <div class="text-xs text-gray-500">Per hour rate</div>
                                        </div>
                                        <div class="text-right">
                                            <div id="preview-base-price" class="text-2xl font-bold text-teal-600">-- ETB</div>
                                            <div class="text-xs text-gray-500">/hour</div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Bonus Previews -->
                                <div class="bg-gradient-to-r from-cyan-50 to-teal-50 rounded-lg p-4 border border-cyan-200">
                                    <h5 class="font-semibold text-cyan-800 mb-3">
                                        <i class="fas fa-certificate mr-1"></i>With Credentials
                                    </h5>
                                    <div class="space-y-2">
                                        <div class="flex justify-between items-center">
                                            <span class="text-sm text-gray-600">1 Credential:</span>
                                            <span id="preview-1-credential" class="font-semibold text-gray-800">-- ETB/hr</span>
                                        </div>
                                        <div class="flex justify-between items-center">
                                            <span class="text-sm text-gray-600">2 Credentials:</span>
                                            <span id="preview-2-credentials" class="font-semibold text-gray-800">-- ETB/hr</span>
                                        </div>
                                        <div class="flex justify-between items-center">
                                            <span class="text-sm text-gray-600">3 Credentials:</span>
                                            <span id="preview-3-credentials" class="font-semibold text-gray-800">-- ETB/hr</span>
                                        </div>
                                    </div>
                                </div>

                                <!-- Experience Bonus Preview -->
                                <div class="bg-gradient-to-r from-purple-50 to-pink-50 rounded-lg p-4 border border-purple-200">
                                    <h5 class="font-semibold text-purple-800 mb-3">
                                        <i class="fas fa-briefcase mr-1"></i>With Experience
                                    </h5>
                                    <div class="space-y-2">
                                        <div class="flex justify-between items-center">
                                            <span class="text-sm text-gray-600">1 Year:</span>
                                            <span id="preview-1-year" class="font-semibold text-gray-800">-- ETB/hr</span>
                                        </div>
                                        <div class="flex justify-between items-center">
                                            <span class="text-sm text-gray-600">3 Years:</span>
                                            <span id="preview-3-years" class="font-semibold text-gray-800">-- ETB/hr</span>
                                        </div>
                                        <div class="flex justify-between items-center border-t border-purple-300 pt-2 mt-2">
                                            <span class="text-sm font-semibold text-purple-700">5 Years:</span>
                                            <span id="preview-5-years" class="text-lg font-bold text-purple-700">-- ETB/hr</span>
                                        </div>
                                    </div>
                                    <p class="text-xs text-gray-500 mt-3">
                                        <i class="fas fa-info-circle mr-1"></i>
                                        Bonus multiplies by years of experience
                                    </p>
                                </div>

                                <!-- Example Notice -->
                                <div class="bg-blue-100 rounded-lg p-4 border border-blue-300">
                                    <div class="text-center">
                                        <i class="fas fa-lightbulb text-blue-600 text-2xl mb-2"></i>
                                        <p class="font-semibold text-blue-800">Smart Pricing</p>
                                        <p class="text-xs text-blue-600">System switches to market-based pricing once tutor has enrollment history</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Submit Buttons -->
                    <div class="flex justify-end gap-3 mt-6 pt-4 border-t">
                        <button type="button" onclick="closeBasePriceModal()"
                            class="px-6 py-2 border rounded-lg hover:bg-gray-50">
                            Cancel
                        </button>
                        <button type="submit" class="px-6 py-2 bg-teal-600 text-white rounded-lg hover:bg-teal-700">
                            <i class="fas fa-save mr-2"></i>Save Rule
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Affiliate Tier Modal (Add/Edit) -->
    <div id="affiliate-tier-modal" class="modal hidden">
        <div class="modal-overlay" onclick="closeAffiliateTierModal()"></div>
        <div class="modal-content" style="max-width: 500px;">
            <div class="modal-header">
                <h2 class="text-xl font-bold" id="affiliate-tier-modal-title">
                    <i class="fas fa-layer-group mr-2"></i>Add Affiliate Tier
                </h2>
                <button class="modal-close" onclick="closeAffiliateTierModal()">√ó</button>
            </div>
            <div class="modal-body">
                <form id="affiliate-tier-form" onsubmit="saveAffiliateTier(event)">
                    <!-- Hidden fields -->
                    <input type="hidden" id="affiliate-tier-original-level">
                    <input type="hidden" id="affiliate-tier-original-business-type">

                    <!-- Business Type -->
                    <div class="mb-4">
                        <label class="block text-sm font-semibold mb-2">Business Type *</label>
                        <select id="affiliate-tier-business-type" class="w-full px-3 py-2 border rounded-lg" required>
                            <option value="tutoring">Tutoring Sessions</option>
                            <option value="subscription">Subscriptions</option>
                            <option value="advertisement">Advertisements</option>
                        </select>
                        <p class="text-xs text-gray-500 mt-1">Select the type of transaction this tier applies to</p>
                    </div>

                    <!-- Tier Level -->
                    <div class="mb-4">
                        <label class="block text-sm font-semibold mb-2">Tier Level *</label>
                        <input type="number" id="affiliate-tier-level" class="w-full px-3 py-2 border rounded-lg"
                            placeholder="1" min="1" required>
                        <p class="text-xs text-gray-500 mt-1">Level 1 = direct referral, Level 2 = referral's referral, etc.</p>
                    </div>

                    <!-- Tier Name -->
                    <div class="mb-4">
                        <label class="block text-sm font-semibold mb-2">Tier Name *</label>
                        <input type="text" id="affiliate-tier-name" class="w-full px-3 py-2 border rounded-lg"
                            placeholder="e.g., Direct Referral, 2nd Level" required>
                        <p class="text-xs text-gray-500 mt-1">Display name for this tier</p>
                    </div>

                    <!-- Commission Rate -->
                    <div class="mb-4">
                        <label class="block text-sm font-semibold mb-2">Commission Rate (%) *</label>
                        <div class="flex items-center gap-2">
                            <input type="number" id="affiliate-tier-commission" class="flex-1 px-3 py-2 border rounded-lg"
                                placeholder="10" min="0" max="100" step="0.1" required>
                            <span class="text-gray-500 font-medium">%</span>
                        </div>
                        <p class="text-xs text-gray-500 mt-1">Percentage of subscription value earned as commission</p>
                    </div>

                    <!-- Max Duration Months -->
                    <div class="mb-4">
                        <label class="block text-sm font-semibold mb-2">Max Duration (Months) *</label>
                        <input type="number" id="affiliate-tier-duration" class="w-full px-3 py-2 border rounded-lg"
                            placeholder="12" min="1" max="60" required>
                        <p class="text-xs text-gray-500 mt-1">Maximum time the affiliate earns commission (ends early if user unsubscribes or leaves Astegni)</p>
                    </div>

                    <!-- Active Toggle -->
                    <div class="mb-6">
                        <label class="flex items-center gap-3 cursor-pointer">
                            <input type="checkbox" id="affiliate-tier-active" class="w-5 h-5" checked>
                            <div>
                                <span class="font-semibold">Active</span>
                                <p class="text-xs text-gray-500">Enable this tier for affiliate earnings</p>
                            </div>
                        </label>
                    </div>

                    <!-- Example Calculation -->
                    <div class="mb-6 p-4 bg-purple-50 rounded-lg border border-purple-200">
                        <h4 class="font-semibold text-purple-700 mb-2 text-sm">
                            <i class="fas fa-calculator mr-1"></i>Example Calculations
                        </h4>
                        <div class="text-xs text-gray-600 space-y-2">
                            <p><strong>Tutoring:</strong> 1000 ETB session √ó 10% commission = 100 ETB per session</p>
                            <p><strong>Subscription:</strong> 100 ETB/month √ó 10% commission = 10 ETB/month</p>
                            <p><strong>Advertisement:</strong> 1000 impressions √ó 0.50 ETB/impression √ó 10% = 50 ETB</p>
                        </div>
                        <p class="text-xs text-gray-500 mt-2">Commission earned for up to the max duration or until user leaves platform</p>
                    </div>

                    <!-- Submit Buttons -->
                    <div class="flex justify-end gap-3 pt-4 border-t">
                        <button type="button" onclick="closeAffiliateTierModal()"
                            class="px-6 py-2 border rounded-lg hover:bg-gray-50">
                            Cancel
                        </button>
                        <button type="submit" class="px-6 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700">
                            <i class="fas fa-save mr-2"></i>Save Tier
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Affiliate Program Settings Modal -->
    <div id="affiliate-program-settings-modal" class="modal hidden">
        <div class="modal-overlay" onclick="closeAffiliateProgramSettingsModal()"></div>
        <div class="modal-content" style="max-width: 500px;">
            <div class="modal-header">
                <h2 class="text-xl font-bold">
                    <i class="fas fa-cog mr-2"></i>Affiliate Program Settings
                </h2>
                <button class="modal-close" onclick="closeAffiliateProgramSettingsModal()">√ó</button>
            </div>
            <div class="modal-body">
                <form id="affiliate-program-settings-form" onsubmit="saveAffiliateProgramSettings(event)">
                    <!-- Program Enabled -->
                    <div class="mb-6 p-4 bg-purple-50 rounded-lg border border-purple-200">
                        <label class="flex items-center gap-3 cursor-pointer">
                            <input type="checkbox" id="affiliate-program-enabled" class="w-6 h-6" checked>
                            <div>
                                <span class="font-bold text-lg">Enable Affiliate Program</span>
                                <p class="text-sm text-gray-600">Allow users to earn referral commissions</p>
                            </div>
                        </label>
                    </div>

                    <!-- Payout Threshold -->
                    <div class="mb-4">
                        <label class="block text-sm font-semibold mb-2">Payout Threshold (ETB) *</label>
                        <input type="number" id="payout-threshold" class="w-full px-3 py-2 border rounded-lg"
                            placeholder="1000" min="0" step="100" required>
                        <p class="text-xs text-gray-500 mt-1">Minimum balance required before an affiliate can request withdrawal</p>
                    </div>

                    <!-- Payout Schedule -->
                    <div class="mb-6">
                        <label class="block text-sm font-semibold mb-2">Payout Schedule *</label>
                        <select id="payout-schedule" class="w-full px-3 py-2 border rounded-lg" required>
                            <option value="weekly">Weekly</option>
                            <option value="bi-weekly">Bi-weekly</option>
                            <option value="monthly" selected>Monthly</option>
                        </select>
                        <p class="text-xs text-gray-500 mt-1">How often affiliate commissions are paid out</p>
                    </div>

                    <!-- Info Box -->
                    <div class="mb-6 p-4 bg-blue-50 rounded-lg border border-blue-200">
                        <h4 class="font-semibold text-blue-700 mb-2 text-sm">
                            <i class="fas fa-info-circle mr-1"></i>How It Works
                        </h4>
                        <ul class="text-xs text-gray-600 space-y-1">
                            <li>‚Ä¢ Affiliates earn commission when their referrals subscribe</li>
                            <li>‚Ä¢ Commission is calculated per subscription payment</li>
                            <li>‚Ä¢ Payouts are processed according to the schedule above</li>
                            <li>‚Ä¢ Affiliates must reach the threshold to request payout</li>
                        </ul>
                    </div>

                    <!-- Submit Buttons -->
                    <div class="flex justify-end gap-3 pt-4 border-t">
                        <button type="button" onclick="closeAffiliateProgramSettingsModal()"
                            class="px-6 py-2 border rounded-lg hover:bg-gray-50">
                            Cancel
                        </button>
                        <button type="submit" class="px-6 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700">
                            <i class="fas fa-save mr-2"></i>Save Settings
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Add/Edit Payment Gateway Modal -->
    <div id="payment-gateway-modal" class="modal hidden">
        <div class="modal-overlay" onclick="closePaymentGatewayModal()"></div>
        <div class="modal-content" style="max-width: 500px;">
            <div class="modal-header">
                <h2 class="text-xl font-bold">
                    <i class="fas fa-credit-card mr-2"></i>Add Payment Gateway
                </h2>
                <button class="modal-close" onclick="closePaymentGatewayModal()">√ó</button>
            </div>
            <div class="modal-body">
                <form id="payment-gateway-form" onsubmit="savePaymentGateway(event)">
                    <!-- Hidden ID field -->
                    <input type="hidden" id="gateway-id">

                    <!-- Gateway Name -->
                    <div class="mb-4">
                        <label class="block text-sm font-semibold mb-2">Gateway Name *</label>
                        <input type="text" id="gateway-name" class="w-full px-3 py-2 border rounded-lg"
                            placeholder="e.g., TeleBirr, CBE, Awash Bank" required>
                        <p class="text-xs text-gray-500 mt-1">Name of the payment gateway or bank</p>
                    </div>

                    <!-- Account/Merchant ID -->
                    <div class="mb-4">
                        <label class="block text-sm font-semibold mb-2">Account/Merchant ID</label>
                        <input type="text" id="gateway-merchant-id" class="w-full px-3 py-2 border rounded-lg"
                            placeholder="Enter merchant or account ID">
                        <p class="text-xs text-gray-500 mt-1">Your merchant or account identifier</p>
                    </div>

                    <!-- API Key/Secret -->
                    <div class="mb-4">
                        <label class="block text-sm font-semibold mb-2">API Key/Secret</label>
                        <input type="password" id="gateway-api-key" class="w-full px-3 py-2 border rounded-lg"
                            placeholder="Enter API key or secret">
                        <p class="text-xs text-gray-500 mt-1">API key or secret key for authentication</p>
                    </div>

                    <!-- Webhook URL (Optional) -->
                    <div class="mb-4">
                        <label class="block text-sm font-semibold mb-2">Webhook URL</label>
                        <input type="text" id="gateway-additional-info" class="w-full px-3 py-2 border rounded-lg"
                            placeholder="https://api.astegni.com/webhooks/payment">
                        <p class="text-xs text-gray-500 mt-1">URL for payment notifications (optional)</p>
                    </div>

                    <!-- Enable Gateway -->
                    <div class="mb-6 p-4 bg-blue-50 rounded-lg border border-blue-200">
                        <label class="flex items-center gap-3 cursor-pointer">
                            <input type="checkbox" id="gateway-enabled" class="w-5 h-5" checked>
                            <div>
                                <span class="font-semibold">Enable this gateway</span>
                                <p class="text-xs text-gray-500">Allow payments through this gateway</p>
                            </div>
                        </label>
                    </div>

                    <!-- Submit Buttons -->
                    <div class="flex justify-end gap-3 pt-4 border-t">
                        <button type="button" onclick="closePaymentGatewayModal()"
                            class="px-6 py-2 border rounded-lg hover:bg-gray-50">
                            Cancel
                        </button>
                        <button type="submit" class="px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700">
                            <i class="fas fa-save mr-2"></i>Save Gateway
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- System Media Upload Modal -->
    <div id="system-media-upload-modal" class="modal hidden">
        <div class="modal-overlay" onclick="closeSystemMediaUploadModal()"></div>
        <div class="modal-content" style="max-width: 550px;">
            <div class="modal-header">
                <h2 class="text-xl font-bold">
                    <i class="fas fa-cloud-upload-alt mr-2 text-blue-600"></i>Upload System Media
                </h2>
                <button class="modal-close" onclick="closeSystemMediaUploadModal()">√ó</button>
            </div>
            <div class="modal-body">
                <form id="system-media-upload-form" onsubmit="saveSystemMedia(event)">
                    <!-- Media Type Selector -->
                    <div class="mb-4">
                        <label class="block text-sm font-semibold mb-2">Media Type *</label>
                        <select id="media-type-select" class="w-full px-3 py-2 border rounded-lg"
                            onchange="updateMediaUploadFields()" required>
                            <option value="image">Image</option>
                            <option value="video">Video</option>
                        </select>
                    </div>

                    <!-- Media Name -->
                    <div class="mb-4">
                        <label class="block text-sm font-semibold mb-2">Media Name</label>
                        <input type="text" id="media-name" class="w-full px-3 py-2 border rounded-lg"
                            placeholder="Leave empty to use file name">
                    </div>

                    <!-- Media Category -->
                    <div class="mb-4">
                        <label class="block text-sm font-semibold mb-2">Category *</label>
                        <select id="media-category" class="w-full px-3 py-2 border rounded-lg" required>
                            <option value="logo">Logo</option>
                            <option value="favicon">Favicon</option>
                            <option value="background">Background</option>
                            <option value="banner">Banner</option>
                            <option value="icon">Icon</option>
                            <option value="intro">Intro Video</option>
                            <option value="tutorial">Tutorial Video</option>
                            <option value="promo">Promotional</option>
                            <option value="other">Other</option>
                        </select>
                    </div>

                    <!-- File Upload -->
                    <div class="mb-4">
                        <label class="block text-sm font-semibold mb-2">Select File *</label>
                        <div class="border-2 border-dashed border-gray-300 rounded-lg p-6 text-center hover:border-blue-400 transition-colors cursor-pointer"
                            onclick="document.getElementById('media-file-input').click()">
                            <i class="fas fa-cloud-upload-alt text-4xl text-gray-400 mb-3"></i>
                            <p class="text-gray-600 mb-1">Click to select or drag & drop</p>
                            <p class="text-xs text-gray-500" id="selected-file-name">No file selected</p>
                            <input type="file" id="media-file-input" class="hidden" accept="image/*"
                                onchange="handleMediaFileSelect(event)" required>
                        </div>
                    </div>

                    <!-- Image-specific fields -->
                    <div id="image-upload-fields">
                        <div class="mb-4 p-3 bg-blue-50 rounded-lg">
                            <p class="text-sm text-gray-600">
                                <i class="fas fa-info-circle text-blue-500 mr-1"></i>
                                Supported: PNG, JPG, GIF, SVG, WebP, ICO (Max 5MB)
                            </p>
                        </div>
                    </div>

                    <!-- Video-specific fields -->
                    <div id="video-upload-fields" class="hidden">
                        <div class="mb-4 p-3 bg-green-50 rounded-lg">
                            <p class="text-sm text-gray-600">
                                <i class="fas fa-info-circle text-green-500 mr-1"></i>
                                Supported: MP4, AVI, MOV, WMV, WebM (Max 200MB)
                            </p>
                        </div>
                    </div>

                    <!-- Preview -->
                    <div id="media-preview-container" class="mb-4 hidden">
                        <label class="block text-sm font-semibold mb-2">Preview</label>
                        <div class="border rounded-lg p-2 bg-gray-50">
                            <img id="media-preview-image" class="max-h-48 mx-auto rounded hidden" alt="Preview">
                            <video id="media-preview-video" class="max-h-48 mx-auto rounded hidden" controls></video>
                        </div>
                    </div>

                    <!-- Submit Buttons -->
                    <div class="flex justify-end gap-3 pt-4 border-t">
                        <button type="button" onclick="closeSystemMediaUploadModal()"
                            class="px-6 py-2 border rounded-lg hover:bg-gray-50">
                            Cancel
                        </button>
                        <button type="submit" class="px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700">
                            <i class="fas fa-upload mr-2"></i>Upload
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Image Gallery Modal with Category Sidebar -->
    <div id="image-gallery-modal" class="modal hidden">
        <div class="modal-overlay" onclick="closeImageGalleryModal()"></div>
        <div class="modal-content" style="max-width: 1100px; height: 85vh; padding: 0;">
            <div class="flex h-full">
                <!-- Category Sidebar -->
                <div id="image-gallery-sidebar" class="w-56 border-r bg-gray-50 flex-shrink-0 overflow-y-auto">
                    <div class="p-4 border-b bg-white sticky top-0">
                        <h3 class="font-bold text-lg flex items-center gap-2">
                            <i class="fas fa-images text-blue-600"></i>
                            Images
                        </h3>
                        <p id="image-gallery-count" class="text-sm text-gray-500">0 images</p>
                    </div>
                    <div class="p-2">
                        <p class="text-xs font-semibold text-gray-400 uppercase px-3 mb-2">Categories</p>
                        <div id="image-category-filters">
                            <!-- Category filters will be rendered by JS -->
                        </div>
                    </div>
                </div>

                <!-- Main Content Area -->
                <div class="flex-1 flex flex-col bg-white">
                    <!-- Header -->
                    <div class="flex items-center justify-between p-4 border-b sticky top-0 bg-white z-10">
                        <div class="flex items-center gap-4">
                            <h2 id="image-gallery-title" class="text-xl font-bold">All Images</h2>
                            <button onclick="openSystemMediaUploadModal('image'); closeImageGalleryModal();"
                                class="px-3 py-1.5 bg-blue-600 text-white rounded-lg text-sm hover:bg-blue-700">
                                <i class="fas fa-plus mr-1"></i>Upload
                            </button>
                        </div>
                        <button class="modal-close text-2xl text-gray-400 hover:text-gray-600" onclick="closeImageGalleryModal()">√ó</button>
                    </div>

                    <!-- Gallery Grid -->
                    <div id="image-gallery-content" class="flex-1 p-4 overflow-y-auto">
                        <!-- Image grid will be rendered by JS -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Video Gallery Modal with Category Sidebar -->
    <div id="video-gallery-modal" class="modal hidden">
        <div class="modal-overlay" onclick="closeVideoGalleryModal()"></div>
        <div class="modal-content" style="max-width: 1100px; height: 85vh; padding: 0;">
            <div class="flex h-full">
                <!-- Category Sidebar -->
                <div id="video-gallery-sidebar" class="w-56 border-r bg-gray-50 flex-shrink-0 overflow-y-auto">
                    <div class="p-4 border-b bg-white sticky top-0">
                        <h3 class="font-bold text-lg flex items-center gap-2">
                            <i class="fas fa-video text-green-600"></i>
                            Videos
                        </h3>
                        <p id="video-gallery-count" class="text-sm text-gray-500">0 videos</p>
                    </div>
                    <div class="p-2">
                        <p class="text-xs font-semibold text-gray-400 uppercase px-3 mb-2">Categories</p>
                        <div id="video-category-filters">
                            <!-- Category filters will be rendered by JS -->
                        </div>
                    </div>
                </div>

                <!-- Main Content Area -->
                <div class="flex-1 flex flex-col bg-white">
                    <!-- Header -->
                    <div class="flex items-center justify-between p-4 border-b sticky top-0 bg-white z-10">
                        <div class="flex items-center gap-4">
                            <h2 id="video-gallery-title" class="text-xl font-bold">All Videos</h2>
                            <button onclick="openSystemMediaUploadModal('video'); closeVideoGalleryModal();"
                                class="px-3 py-1.5 bg-green-600 text-white rounded-lg text-sm hover:bg-green-700">
                                <i class="fas fa-plus mr-1"></i>Upload
                            </button>
                        </div>
                        <button class="modal-close text-2xl text-gray-400 hover:text-gray-600" onclick="closeVideoGalleryModal()">√ó</button>
                    </div>

                    <!-- Gallery Grid -->
                    <div id="video-gallery-content" class="flex-1 p-4 overflow-y-auto">
                        <!-- Video grid will be rendered by JS -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Media Viewer Modal (for viewing single image/video) -->
    <div id="media-viewer-modal" class="modal hidden">
        <div class="modal-overlay" onclick="closeMediaViewer()"></div>
        <div class="modal-content" style="max-width: 900px; max-height: 90vh; padding: 0; background: transparent;">
            <div class="bg-white rounded-xl overflow-hidden">
                <!-- Header -->
                <div class="flex items-center justify-between p-4 border-b bg-gray-50">
                    <div>
                        <h3 id="media-viewer-title" class="font-bold text-lg">Media</h3>
                        <p id="media-viewer-category" class="text-sm text-gray-500"></p>
                    </div>
                    <div class="flex items-center gap-2">
                        <button onclick="copyCurrentMediaUrl()" class="px-3 py-1.5 bg-gray-100 text-gray-700 rounded-lg text-sm hover:bg-gray-200">
                            <i class="fas fa-link mr-1"></i>Copy URL
                        </button>
                        <button onclick="deleteCurrentMedia()" class="px-3 py-1.5 bg-red-100 text-red-600 rounded-lg text-sm hover:bg-red-200">
                            <i class="fas fa-trash mr-1"></i>Delete
                        </button>
                        <button class="modal-close text-2xl text-gray-400 hover:text-gray-600 ml-2" onclick="closeMediaViewer()">√ó</button>
                    </div>
                </div>
                <!-- Media Content -->
                <div id="media-viewer-content" class="flex items-center justify-center bg-gray-900 min-h-[400px]">
                    <!-- Image or Video will be rendered here -->
                </div>
                <!-- Footer Info -->
                <div class="p-4 border-t bg-gray-50">
                    <div class="flex items-center justify-between text-sm text-gray-600">
                        <span id="media-viewer-size"></span>
                        <span id="media-viewer-date"></span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Storage Settings Modal (Upload Limits by Subscription Plan) -->
    <div id="upload-limit-modal" class="modal hidden">
        <div class="modal-overlay" onclick="closeUploadLimitModal()"></div>
        <div class="modal-content" style="max-width: 550px;">
            <div class="modal-header">
                <h2 class="text-xl font-bold" id="upload-limit-modal-title">
                    <i class="fas fa-hdd mr-2 text-purple-600"></i>Configure Storage Settings
                </h2>
                <button class="modal-close" onclick="closeUploadLimitModal()">√ó</button>
            </div>
            <div class="modal-body">
                <form id="upload-limit-form" onsubmit="saveStorageSettings(event)">
                    <!-- Hidden IDs -->
                    <input type="hidden" id="storage-setting-id">
                    <input type="hidden" id="storage-subscription-plan-id">

                    <!-- Subscription Plan Search (only shown when adding new) -->
                    <div class="mb-4" id="plan-search-container">
                        <label class="block text-sm font-semibold mb-2">Subscription Plan *</label>
                        <div class="relative">
                            <input type="text" id="plan-search-input"
                                class="w-full px-3 py-2 border rounded-lg pr-10"
                                placeholder="Search subscription plans..."
                                autocomplete="off">
                            <i class="fas fa-search absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400"></i>
                        </div>
                        <!-- Search Results Dropdown -->
                        <div id="plan-search-results" class="hidden absolute z-50 mt-1 bg-white border rounded-lg shadow-lg max-h-48 overflow-y-auto" style="width: calc(100% - 48px);">
                            <!-- Results will be populated dynamically -->
                        </div>
                        <!-- Selected Plan Display -->
                        <div id="upload-limit-selected-plan-display" class="hidden mt-2 p-3 bg-purple-50 rounded-lg border border-purple-200">
                            <div class="flex items-center justify-between">
                                <div>
                                    <span class="font-semibold text-purple-700" id="upload-limit-selected-plan-name">-</span>
                                    <span class="text-sm text-gray-500 ml-2" id="upload-limit-selected-plan-price">-</span>
                                </div>
                                <button type="button" onclick="clearUploadLimitSelectedPlan()" class="text-red-500 hover:text-red-700">
                                    <i class="fas fa-times"></i>
                                </button>
                            </div>
                        </div>
                        <p class="text-xs text-gray-500 mt-1">Select a subscription plan to configure its storage limits</p>
                    </div>

                    <!-- Plan Name Display (shown when editing) -->
                    <div class="mb-4 hidden" id="plan-name-display-container">
                        <label class="block text-sm font-semibold mb-2">Subscription Plan</label>
                        <div class="p-3 bg-gray-100 rounded-lg">
                            <span class="font-semibold" id="edit-plan-name">-</span>
                        </div>
                    </div>

                    <!-- Max File Size Limits -->
                    <div class="mb-4 p-4 bg-gray-50 rounded-lg">
                        <h4 class="font-semibold text-sm mb-3">
                            <i class="fas fa-file-upload mr-1 text-purple-500"></i>Max File Size Per Upload
                        </h4>
                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <label class="block text-xs font-medium mb-1">
                                    <i class="fas fa-image text-blue-500 mr-1"></i>Images (MB)
                                </label>
                                <input type="number" id="storage-max-image-size"
                                    class="w-full px-3 py-2 border rounded-lg text-sm"
                                    placeholder="5" min="1" value="5">
                            </div>
                            <div>
                                <label class="block text-xs font-medium mb-1">
                                    <i class="fas fa-video text-green-500 mr-1"></i>Videos (MB)
                                </label>
                                <input type="number" id="storage-max-video-size"
                                    class="w-full px-3 py-2 border rounded-lg text-sm"
                                    placeholder="50" min="1" value="50">
                            </div>
                            <div>
                                <label class="block text-xs font-medium mb-1">
                                    <i class="fas fa-file-alt text-orange-500 mr-1"></i>Documents (MB)
                                </label>
                                <input type="number" id="storage-max-document-size"
                                    class="w-full px-3 py-2 border rounded-lg text-sm"
                                    placeholder="10" min="1" value="10">
                            </div>
                            <div>
                                <label class="block text-xs font-medium mb-1">
                                    <i class="fas fa-music text-pink-500 mr-1"></i>Audio (MB)
                                </label>
                                <input type="number" id="storage-max-audio-size"
                                    class="w-full px-3 py-2 border rounded-lg text-sm"
                                    placeholder="10" min="1" value="10">
                            </div>
                        </div>
                    </div>

                    <!-- Total Storage Limit -->
                    <div class="mb-6 p-4 bg-purple-50 rounded-lg border border-purple-200">
                        <h4 class="font-semibold text-sm mb-3">
                            <i class="fas fa-database mr-1 text-purple-500"></i>Total Storage Quota
                        </h4>
                        <div>
                            <label class="block text-xs font-medium mb-1">Storage Limit (GB)</label>
                            <input type="number" id="storage-limit-gb"
                                class="w-full px-3 py-2 border rounded-lg text-sm"
                                placeholder="5" min="1" value="5">
                            <p class="text-xs text-gray-500 mt-1">Total storage space available for users on this plan</p>
                        </div>
                    </div>

                    <!-- Submit Buttons -->
                    <div class="flex justify-end gap-3 pt-4 border-t">
                        <button type="button" onclick="closeUploadLimitModal()"
                            class="px-6 py-2 border rounded-lg hover:bg-gray-50">
                            Cancel
                        </button>
                        <button type="submit" class="px-6 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700">
                            <i class="fas fa-save mr-2"></i>Save Settings
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Add/Edit Email Account Modal -->
    <div id="email-form-modal" class="modal hidden">
        <div class="modal-overlay" onclick="closeEmailForm()"></div>
        <div class="modal-content" style="max-width: 800px; max-height: 90vh; overflow-y: auto;">
            <div class="modal-header">
                <h2 class="text-xl font-bold" id="email-form-title">
                    <i class="fas fa-envelope mr-2 text-blue-600"></i>Add Email Account
                </h2>
                <button class="modal-close" onclick="closeEmailForm()">√ó</button>
            </div>
            <div class="modal-body">
                <form id="emailConfigForm" onsubmit="handleEmailConfigSubmit(event)">
                    <!-- Account Information -->
                    <div class="mb-4">
                        <h3 class="text-sm font-semibold text-gray-700 mb-3 flex items-center gap-2">
                            <i class="fas fa-user-circle text-blue-500"></i>
                            Account Information
                        </h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label class="block mb-2 font-semibold text-sm">Account Name</label>
                                <input type="text" id="email-account-name" class="w-full p-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
                                    placeholder="Primary Email Account">
                                <p class="text-xs text-gray-500 mt-1">Friendly name for this email account</p>
                            </div>
                            <div>
                                <label class="block mb-2 font-semibold text-sm">Provider</label>
                                <select id="email-provider" onchange="autoFillProviderSettings()" class="w-full p-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                                    <option value="custom">Custom SMTP</option>
                                    <option value="gmail">Gmail / Google Workspace</option>
                                    <option value="outlook">Outlook / Office365</option>
                                    <option value="sendgrid">SendGrid</option>
                                    <option value="mailgun">Mailgun</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- SMTP Configuration -->
                    <div class="mb-4">
                        <h3 class="text-sm font-semibold text-gray-700 mb-3 flex items-center gap-2">
                            <i class="fas fa-server text-blue-500"></i>
                            SMTP Configuration
                        </h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label class="block mb-2 font-semibold text-sm">SMTP Host *</label>
                                <input type="text" id="smtp-host" class="w-full p-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
                                    placeholder="smtp.gmail.com" required>
                            </div>
                            <div>
                                <label class="block mb-2 font-semibold text-sm">SMTP Port *</label>
                                <input type="number" id="smtp-port" class="w-full p-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
                                    placeholder="587" value="587" required>
                            </div>
                            <div>
                                <label class="block mb-2 font-semibold text-sm">SMTP Username *</label>
                                <input type="text" id="smtp-username" class="w-full p-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
                                    placeholder="your-email@gmail.com" required>
                            </div>
                            <div>
                                <label class="block mb-2 font-semibold text-sm">SMTP Password *</label>
                                <input type="password" id="smtp-password" class="w-full p-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
                                    placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢">
                                <p class="text-xs text-gray-500 mt-1">App Password for Gmail/Google Workspace</p>
                            </div>
                            <div>
                                <label class="block mb-2 font-semibold text-sm">SMTP Encryption</label>
                                <select id="smtp-encryption" class="w-full p-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                                    <option value="TLS">TLS (Port 587)</option>
                                    <option value="SSL">SSL (Port 465)</option>
                                    <option value="NONE">None</option>
                                </select>
                            </div>
                            <div>
                                <label class="block mb-2 font-semibold text-sm">Daily Email Limit</label>
                                <input type="number" id="daily-limit" class="w-full p-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
                                    placeholder="2000" value="1000">
                            </div>
                        </div>
                    </div>

                    <!-- Sender Information -->
                    <div class="mb-4">
                        <h3 class="text-sm font-semibold text-gray-700 mb-3 flex items-center gap-2">
                            <i class="fas fa-paper-plane text-blue-500"></i>
                            Sender Information
                        </h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label class="block mb-2 font-semibold text-sm">From Email *</label>
                                <input type="email" id="from-email" class="w-full p-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
                                    placeholder="noreplay@astegni.com" required>
                            </div>
                            <div>
                                <label class="block mb-2 font-semibold text-sm">From Name</label>
                                <input type="text" id="from-name" class="w-full p-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
                                    placeholder="Astegni Educational Platform">
                            </div>
                        </div>
                    </div>

                    <!-- Info Banner -->
                    <div class="bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4">
                        <div class="flex items-start gap-3">
                            <i class="fas fa-info-circle text-blue-500 text-lg mt-0.5"></i>
                            <div>
                                <h4 class="font-semibold text-sm text-gray-800 mb-2">Configuration Tips</h4>
                                <ul class="text-xs text-gray-600 space-y-1">
                                    <li>‚Ä¢ For Gmail, use an App Password instead of your regular password</li>
                                    <li>‚Ä¢ Default ports: TLS uses 587, SSL uses 465</li>
                                    <li>‚Ä¢ Test your configuration after saving to ensure it works</li>
                                    <li>‚Ä¢ Keep your daily limit reasonable to avoid being flagged as spam</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <div class="modal-footer">
                        <button type="button" class="btn-secondary px-4 py-2 border rounded-lg hover:bg-gray-100"
                            onclick="closeEmailForm()">Cancel</button>
                        <button type="button" onclick="testEmailConfig(event)" class="px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors">
                            <i class="fas fa-paper-plane mr-2"></i>Test Configuration
                        </button>
                        <button type="submit"
                            class="btn-primary px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600">
                            <i class="fas fa-save mr-2"></i>Save Email Account
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Churn Others Details Modal -->
    <div id="churn-others-modal" class="modal hidden">
        <div class="modal-overlay" onclick="closeChurnOthersModal()"></div>
        <div class="modal-content" style="max-width: 700px;">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-2xl font-bold">User Churn - Other Reasons</h2>
                <button onclick="closeChurnOthersModal()" class="text-gray-500 hover:text-gray-700">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>

            <div class="mb-6">
                <div class="bg-gradient-to-r from-yellow-50 to-orange-50 p-4 rounded-lg border border-yellow-200">
                    <div class="flex items-center gap-3">
                        <i class="fas fa-chart-pie text-yellow-600 text-2xl"></i>
                        <div>
                            <p class="font-bold text-lg">15% of users</p>
                            <p class="text-sm text-gray-600">Left for other reasons (78 users this period)</p>
                        </div>
                    </div>
                </div>
            </div>

            <div class="space-y-4">
                <h3 class="font-bold text-lg mb-3">Detailed Breakdown</h3>

                <div class="border rounded-lg p-4 hover:bg-gray-50">
                    <div class="flex justify-between items-center mb-2">
                        <div class="font-semibold">Found better alternative</div>
                        <span class="px-3 py-1 bg-red-100 text-red-700 rounded-full text-sm font-semibold">28 users
                            (5.4%)</span>
                    </div>
                    <p class="text-sm text-gray-600">Users mentioned switching to competitor platforms</p>
                </div>

                <div class="border rounded-lg p-4 hover:bg-gray-50">
                    <div class="flex justify-between items-center mb-2">
                        <div class="font-semibold">Not using platform enough</div>
                        <span class="px-3 py-1 bg-orange-100 text-orange-700 rounded-full text-sm font-semibold">22
                            users (4.2%)</span>
                    </div>
                    <p class="text-sm text-gray-600">Low engagement, subscription not worth the cost</p>
                </div>

                <div class="border rounded-lg p-4 hover:bg-gray-50">
                    <div class="flex justify-between items-center mb-2">
                        <div class="font-semibold">Life circumstances changed</div>
                        <span class="px-3 py-1 bg-yellow-100 text-yellow-700 rounded-full text-sm font-semibold">15
                            users (2.9%)</span>
                    </div>
                    <p class="text-sm text-gray-600">Job changes, relocation, education completed</p>
                </div>

                <div class="border rounded-lg p-4 hover:bg-gray-50">
                    <div class="flex justify-between items-center mb-2">
                        <div class="font-semibold">Privacy concerns</div>
                        <span class="px-3 py-1 bg-purple-100 text-purple-700 rounded-full text-sm font-semibold">8 users
                            (1.5%)</span>
                    </div>
                    <p class="text-sm text-gray-600">Data handling and privacy policy concerns</p>
                </div>

                <div class="border rounded-lg p-4 hover:bg-gray-50">
                    <div class="flex justify-between items-center mb-2">
                        <div class="font-semibold">No reason provided</div>
                        <span class="px-3 py-1 bg-gray-100 text-gray-700 rounded-full text-sm font-semibold">5 users
                            (1.0%)</span>
                    </div>
                    <p class="text-sm text-gray-600">Users canceled without providing feedback</p>
                </div>
            </div>

            <div class="bg-blue-50 p-4 rounded-lg mt-6">
                <h4 class="font-semibold mb-2 flex items-center gap-2">
                    <i class="fas fa-lightbulb text-blue-600"></i>
                    Recommended Actions
                </h4>
                <ul class="text-sm text-gray-600 space-y-1 ml-6">
                    <li>‚Ä¢ Implement exit survey to gather more specific feedback</li>
                    <li>‚Ä¢ Create win-back campaigns for users who left for competitors</li>
                    <li>‚Ä¢ Offer flexible subscription options for low-engagement users</li>
                    <li>‚Ä¢ Enhance privacy documentation and transparency</li>
                </ul>
            </div>

            <div class="flex justify-end gap-3 mt-6 pt-6 border-t">
                <button onclick="exportChurnData()" class="px-6 py-2 border rounded-lg hover:bg-gray-50">
                    <i class="fas fa-download mr-2"></i>Export Data
                </button>
                <button onclick="closeChurnOthersModal()"
                    class="px-6 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600">Close</button>
            </div>
        </div>
    </div>

    <!-- FAB (Floating Action Button) -->
    <div class="fab-container" id="fabContainer">
        <button class="fab" id="fabButton" aria-label="Quick Actions Menu">
            <span class="fab-icon">‚ö°</span>
        </button>
        <div class="fab-menu" id="fabMenu">
            <button class="fab-option" onclick="restartServices()" aria-label="Restart Services">
                <span>üîÑ</span>
                <span>Restart Services</span>
            </button>
            <button class="fab-option" onclick="clearCache()" aria-label="Clear Cache">
                <span>üßπ</span>
                <span>Clear Cache</span>
            </button>
            <button class="fab-option" onclick="generateReport()" aria-label="Generate Report">
                <span>üìä</span>
                <span>Generate Report</span>
            </button>
            <button class="fab-option" onclick="securityScan()" aria-label="Security Scan">
                <span>üõ°Ô∏è</span>
                <span>Security Scan</span>
            </button>
        </div>
    </div>

    <!-- FAB JavaScript -->
    <script>
        // FAB Toggle Functionality
        const fabContainer = document.getElementById('fabContainer');
        const fabButton = document.getElementById('fabButton');
        const fabMenu = document.getElementById('fabMenu');

        fabButton.addEventListener('click', (e) => {
            e.stopPropagation();
            fabContainer.classList.toggle('active');
            fabButton.classList.toggle('active');
        });

        // Close FAB menu when clicking outside
        document.addEventListener('click', (e) => {
            if (!fabContainer.contains(e.target)) {
                fabContainer.classList.remove('active');
                fabButton.classList.remove('active');
            }
        });

        // Close FAB menu after selecting an option
        document.querySelectorAll('.fab-option').forEach(option => {
            option.addEventListener('click', () => {
                fabContainer.classList.remove('active');
                fabButton.classList.remove('active');
            });
        });

        // FAB Action Functions
        function restartServices() {
            alert('Restarting services... This may take a few moments.');
            // Add actual restart service logic here
            console.log('Restart Services clicked');
        }

        function clearCache() {
            if (confirm('Are you sure you want to clear all cache?')) {
                alert('Cache cleared successfully!');
                // Add actual cache clearing logic here
                console.log('Clear Cache clicked');
            }
        }

        function generateReport() {
            alert('Generating system report...');
            // Add actual report generation logic here
            console.log('Generate Report clicked');
        }

        function securityScan() {
            alert('Starting security scan... You will be notified when complete.');
            // Add actual security scan logic here
            console.log('Security Scan clicked');
        }

        // Credentials Section Switching
        function switchCredentialsSection(section) {
            const achievementsTab = document.getElementById('achievements-tab');
            const experienceTab = document.getElementById('experience-tab');
            const achievementsSection = document.getElementById('credentials-achievements-section');
            const experienceSection = document.getElementById('credentials-experience-section');

            if (section === 'achievements') {
                achievementsSection.classList.remove('hidden');
                experienceSection.classList.add('hidden');
                achievementsTab.classList.remove('bg-gray-100', 'hover:bg-gray-200');
                achievementsTab.classList.add('bg-blue-500', 'text-white');
                experienceTab.classList.remove('bg-blue-500', 'text-white');
                experienceTab.classList.add('bg-gray-100', 'hover:bg-gray-200');
            } else if (section === 'experience') {
                experienceSection.classList.remove('hidden');
                achievementsSection.classList.add('hidden');
                experienceTab.classList.remove('bg-gray-100', 'hover:bg-gray-200');
                experienceTab.classList.add('bg-blue-500', 'text-white');
                achievementsTab.classList.remove('bg-blue-500', 'text-white');
                achievementsTab.classList.add('bg-gray-100', 'hover:bg-gray-200');
            }
        }
    </script>

    <!-- Reports Modal JavaScript -->
    <script src="./js/admin-pages/system-modals.js"></script>
    <script src="./js/admin-pages/pricing-functions.js"></script>
    <script src="./js/admin-pages/payment-gateway-manager.js"></script>
    <script src="./js/admin-pages/verification-fee-manager.js"></script>
    <script src="./js/admin-pages/subscription-plan-manager.js"></script>
    <script src="./js/admin-pages/feature-assignment-manager.js"></script>
    <script src="./js/admin-pages/base-price-manager.js"></script>
    <script src="./js/admin-pages/affiliate-tier-manager.js"></script>
    <!-- Media Panel Managers -->
    <script src="./js/admin-pages/system-media-manager.js"></script>
    <script src="./js/admin-pages/upload-limits-manager.js"></script>
    <!-- Brand packages handled by pricing-features-manager.js (uses /api/admin/brand-packages endpoint) -->
    <script src="./js/admin-pages/manage-reviews.js"></script>
    <script src="./js/admin-pages/system-settings-enhancements.js?v=3"></script>
    <script src="./js/admin-pages/system-settings-fixes.js"></script>
    <script src="./js/admin-pages/shared/admin-credentials-manager.js"></script>

    <!-- Add Credential Modal -->
    <div id="add-credential-modal" class="modal hidden fixed inset-0 z-50 items-center justify-center bg-black bg-opacity-50">
        <div class="modal-overlay absolute inset-0" onclick="closeAddCredentialModal()"></div>
        <div class="modal-content relative bg-white rounded-xl shadow-2xl w-full max-w-2xl mx-4 max-h-[90vh] overflow-y-auto">
            <div class="modal-header flex justify-between items-center p-6 border-b sticky top-0 bg-white rounded-t-xl">
                <div>
                    <h2 class="text-2xl font-bold text-gray-800">Add New Credential</h2>
                    <p class="text-sm text-gray-500 mt-1">Add your achievements, certifications, or work experience</p>
                </div>
                <button class="modal-close text-3xl text-gray-400 hover:text-gray-600 transition-colors" onclick="closeAddCredentialModal()">&times;</button>
            </div>
            <div class="modal-body p-6">
                <form id="addCredentialForm" onsubmit="handleCredentialSubmit(event)">
                    <div class="form-group mb-5">
                        <label class="block text-sm font-semibold text-gray-700 mb-2">Credential Type *</label>
                        <select id="credentialType" required class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white">
                            <option value="">Select type...</option>
                            <optgroup label="Achievements">
                                <option value="certification">Certification</option>
                                <option value="degree">Degree / Diploma</option>
                                <option value="award">Award / Recognition</option>
                                <option value="license">Professional License</option>
                                <option value="course">Course Completion</option>
                            </optgroup>
                            <optgroup label="Experience">
                                <option value="work_experience">Work Experience</option>
                                <option value="project">Project</option>
                                <option value="volunteer">Volunteer Work</option>
                                <option value="teaching">Teaching Experience</option>
                            </optgroup>
                        </select>
                    </div>
                    <div class="form-group mb-5">
                        <label class="block text-sm font-semibold text-gray-700 mb-2">Title *</label>
                        <input type="text" id="credentialTitle" required class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="e.g., AWS Certified Solutions Architect">
                    </div>
                    <div class="form-group mb-5">
                        <label class="block text-sm font-semibold text-gray-700 mb-2">Issued By / Organization</label>
                        <input type="text" id="credentialIssuedBy" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="e.g., Amazon Web Services, Addis Ababa University">
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-5">
                        <div class="form-group">
                            <label class="block text-sm font-semibold text-gray-700 mb-2">Date of Issue</label>
                            <input type="date" id="credentialDateOfIssue" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                        </div>
                        <div class="form-group">
                            <label class="block text-sm font-semibold text-gray-700 mb-2">Expiry Date (if applicable)</label>
                            <input type="date" id="credentialExpiryDate" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                        </div>
                    </div>
                    <div class="form-group mb-5">
                        <label class="block text-sm font-semibold text-gray-700 mb-2">Description</label>
                        <textarea id="credentialDescription" rows="4" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none" placeholder="Describe your achievement, responsibilities, or what you learned..."></textarea>
                    </div>
                    <div class="form-group mb-6">
                        <label class="block text-sm font-semibold text-gray-700 mb-2">Upload Document (Optional)</label>
                        <div class="border-2 border-dashed border-gray-300 rounded-lg p-6 text-center hover:border-blue-400 transition-colors">
                            <input type="file" id="credentialDocument" class="hidden" accept=".pdf,.jpg,.jpeg,.png,.doc,.docx" onchange="previewCredentialDocument(event)">
                            <label for="credentialDocument" class="cursor-pointer">
                                <div class="flex flex-col items-center">
                                    <i class="fas fa-cloud-upload-alt text-4xl text-gray-400 mb-3"></i>
                                    <p class="text-gray-600 font-medium">Click to upload or drag and drop</p>
                                    <p class="text-gray-400 text-sm mt-1">PDF, JPG, PNG, DOC up to 10MB</p>
                                </div>
                            </label>
                            <div id="credentialDocumentPreview" class="hidden mt-4 p-3 bg-gray-50 rounded-lg">
                                <div class="flex items-center justify-between">
                                    <div class="flex items-center gap-3">
                                        <i class="fas fa-file-alt text-2xl text-blue-500"></i>
                                        <div class="text-left">
                                            <p id="credentialDocumentName" class="text-sm font-medium text-gray-700"></p>
                                            <p id="credentialDocumentSize" class="text-xs text-gray-500"></p>
                                        </div>
                                    </div>
                                    <button type="button" onclick="removeCredentialDocument()" class="text-red-500 hover:text-red-700"><i class="fas fa-times"></i></button>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="flex justify-end gap-3 pt-4 border-t">
                        <button type="button" onclick="closeAddCredentialModal()" class="px-6 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors font-medium">Cancel</button>
                        <button type="submit" class="px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium flex items-center gap-2"><i class="fas fa-save"></i> Save Credential</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Add Department Role Modal (loaded from common-modals) -->
    <div id="add-department-modal-container"></div>

    <!-- Load Add Department Modal from common-modals -->
    <script>
        // Define placeholder functions immediately (before component loads)
        window._addDeptModalLoaded = false;
        window._addDeptModalQueue = [];

        if (typeof window.openAddDepartmentModal !== 'function') {
            window.openAddDepartmentModal = function() {
                if (window._addDeptModalLoaded) {
                    const modal = document.getElementById('add-department-modal');
                    if (modal) modal.classList.add('active');
                } else {
                    console.log('Add Department Modal not loaded yet, queuing request...');
                    window._addDeptModalQueue.push('open');
                }
            };
        }

        if (typeof window.closeAddDepartmentModal !== 'function') {
            window.closeAddDepartmentModal = function() {
                const modal = document.getElementById('add-department-modal');
                if (modal) modal.classList.remove('active');
            };
        }

        // Load add department modal component
        fetch('common-modals/add-department-modal.html')
            .then(response => response.text())
            .then(html => {
                document.getElementById('add-department-modal-container').innerHTML = html;
                // Execute any script tags in the loaded HTML
                const scripts = document.getElementById('add-department-modal-container').querySelectorAll('script');
                scripts.forEach(script => {
                    const newScript = document.createElement('script');
                    newScript.textContent = script.textContent;
                    document.body.appendChild(newScript);
                });

                // Mark as loaded and process any queued requests
                window._addDeptModalLoaded = true;
                if (window._addDeptModalQueue.length > 0) {
                    window._addDeptModalQueue.forEach(action => {
                        if (action === 'open') {
                            // Directly open the modal instead of calling the function
                            const modal = document.getElementById('add-department-modal');
                            if (modal) modal.classList.add('active');
                        }
                    });
                    window._addDeptModalQueue = [];
                }

                console.log('Add Department Modal loaded from common-modals');
            })
            .catch(error => console.error('Error loading add department modal:', error));
    </script>

    <!-- Notification Modal Container -->
    <div id="notification-modal-container"></div>
    <script>
        fetch('common-modals/notification-modal.html')
            .then(response => response.text())
            .then(html => {
                document.getElementById('notification-modal-container').innerHTML = html;
                const scripts = document.getElementById('notification-modal-container').querySelectorAll('script');
                scripts.forEach(script => {
                    const newScript = document.createElement('script');
                    newScript.textContent = script.textContent;
                    document.body.appendChild(newScript);
                });
                console.log('Notification Modal loaded from common-modals');
            })
            .catch(error => console.error('Error loading notification modal:', error));
    </script>

    <!-- Logout Modal Container -->
    <div id="logout-modal-container"></div>
    <script>
        fetch('common-modals/logout-modal.html')
            .then(response => response.text())
            .then(html => {
                document.getElementById('logout-modal-container').innerHTML = html;
                const scripts = document.getElementById('logout-modal-container').querySelectorAll('script');
                scripts.forEach(script => {
                    const newScript = document.createElement('script');
                    newScript.textContent = script.textContent;
                    document.body.appendChild(newScript);
                });
                console.log('Logout Modal loaded from common-modals');
            })
            .catch(error => console.error('Error loading logout modal:', error));
    </script>

    <!-- Verify Personal Info Modal Container -->
    <div id="verify-personal-info-modal-container"></div>
    <script>
        fetch('common-modals/verify-personal-info-modal.html')
            .then(response => response.text())
            .then(html => {
                document.getElementById('verify-personal-info-modal-container').innerHTML = html;
                const scripts = document.getElementById('verify-personal-info-modal-container').querySelectorAll('script');
                scripts.forEach(script => {
                    const newScript = document.createElement('script');
                    newScript.textContent = script.textContent;
                    document.body.appendChild(newScript);
                });
                console.log('Verify Personal Info Modal loaded from common-modals');
            })
            .catch(error => console.error('Error loading verify personal info modal:', error));
    </script>

    <!-- Add Payment Method Modal Container -->
    <div id="add-payment-method-modal-container"></div>
    <script>
        fetch('common-modals/add-payment-method-modal.html')
            .then(response => response.text())
            .then(html => {
                document.getElementById('add-payment-method-modal-container').innerHTML = html;
                const scripts = document.getElementById('add-payment-method-modal-container').querySelectorAll('script');
                scripts.forEach(script => {
                    const newScript = document.createElement('script');
                    newScript.textContent = script.textContent;
                    document.body.appendChild(newScript);
                });
                console.log('Add Payment Method Modal loaded from common-modals');
            })
            .catch(error => console.error('Error loading add payment method modal:', error));
    </script>

    <!-- File Leave Request Modal Container -->
    <div id="file-leave-request-modal-container"></div>
    <script>
        fetch('common-modals/file-leave-request-modal.html')
            .then(response => response.text())
            .then(html => {
                document.getElementById('file-leave-request-modal-container').innerHTML = html;
                const scripts = document.getElementById('file-leave-request-modal-container').querySelectorAll('script');
                scripts.forEach(script => {
                    const newScript = document.createElement('script');
                    newScript.textContent = script.textContent;
                    document.body.appendChild(newScript);
                });
                console.log('File Leave Request Modal loaded from common-modals');
            })
            .catch(error => console.error('Error loading file leave request modal:', error));
    </script>

    <!-- Resign Modal Container -->
    <div id="resign-modal-container"></div>
    <script>
        fetch('common-modals/resign-modal.html')
            .then(response => response.text())
            .then(html => {
                document.getElementById('resign-modal-container').innerHTML = html;
                const scripts = document.getElementById('resign-modal-container').querySelectorAll('script');
                scripts.forEach(script => {
                    const newScript = document.createElement('script');
                    newScript.textContent = script.textContent;
                    document.body.appendChild(newScript);
                });
                console.log('Resign Modal loaded from common-modals');
            })
            .catch(error => console.error('Error loading resign modal:', error));
    </script>

</body>

</html>

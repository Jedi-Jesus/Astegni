<!DOCTYPE html>
<html lang="en" data-theme="light">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ASTEGNI - Manage Courses</title>
    <!-- TailwindCSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Custom Styles -->
    <link rel="stylesheet" href="./css/root.css">
    <link rel="stylesheet" href="./css/admin-profile/admin.css">
    <link rel="stylesheet" href="./css/admin-pages/shared/admin-layout-fix.css">
    <link rel="stylesheet" href="./css/admin-pages/manage-courses.css">
    <link rel="stylesheet" href="./css/portfolio-settings-panels.css">
    <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">

    <!-- Inline styles to ensure right-side widget positioning -->
    <style>
        .admin-main-layout {
            display: flex !important;
            gap: 1.5rem !important;
        }

        .admin-content-area {
            flex: 1 !important;
        }

        .admin-right-widgets {
            width: 320px !important;
            flex-shrink: 0 !important;
        }
    </style>
</head>

<body class="font-sans">

    <!-- Early-load critical functions (must be available before other scripts) -->
    <script>
        // ===== SIDEBAR TOGGLE =====
        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            const hamburger = document.getElementById('hamburger');
            if (sidebar) {
                sidebar.classList.toggle('active');
                if (hamburger) hamburger.classList.toggle('active');
                document.body.style.overflow = sidebar.classList.contains('active') ? 'hidden' : '';
            }
        }
        window.toggleSidebar = toggleSidebar;

        // ===== PANEL SWITCHING =====
        function switchPanel(panelName) {
            console.log('Switching to panel:', panelName);

            // Panel ID mapping - includes all panels
            const panels = {
                'dashboard': 'dashboard-panel',
                'verified': 'verified-panel',
                'requested': 'requested-panel',
                'rejected': 'rejected-panel',
                'suspended': 'suspended-panel',
                'reviews': 'reviews-panel',
                'credentials': 'credentials-panel',
                'portfolio': 'portfolio-panel',
                'settings': 'settings-panel'
            };

            // Hide all panels
            Object.values(panels).forEach(function(panelId) {
                const panel = document.getElementById(panelId);
                if (panel) {
                    panel.classList.add('hidden');
                    panel.classList.remove('active');
                }
            });

            // Show target panel
            const targetPanelId = panels[panelName];
            if (targetPanelId) {
                const targetPanel = document.getElementById(targetPanelId);
                if (targetPanel) {
                    targetPanel.classList.remove('hidden');
                    targetPanel.classList.add('active');
                    console.log('Panel shown:', panelName);
                } else {
                    console.error('Panel element not found:', targetPanelId);
                }
            } else {
                console.error('Unknown panel name:', panelName);
            }

            // Update sidebar link active state
            document.querySelectorAll('.sidebar-link').forEach(function(link) {
                link.classList.remove('active');
                const onclick = link.getAttribute('onclick') || '';
                if (onclick.includes("'" + panelName + "'") || onclick.includes('"' + panelName + '"')) {
                    link.classList.add('active');
                }
            });

            // Update URL
            const newUrl = new URL(window.location);
            newUrl.searchParams.set('panel', panelName);
            window.history.pushState({ panel: panelName }, '', newUrl);

            // Close sidebar after selection
            const sidebar = document.getElementById('sidebar');
            const hamburger = document.getElementById('hamburger');
            if (sidebar) {
                sidebar.classList.remove('active');
                if (hamburger) hamburger.classList.remove('active');
                document.body.style.overflow = '';
            }

            // Scroll to top
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }
        window.switchPanel = switchPanel;

        // ===== API CONFIG =====
        // Use global API_BASE_URL set by api-config.js
        const API_BASE_URL = window.API_BASE_URL || 'http://localhost:8000';
        function getAuthToken() {
            return localStorage.getItem('token') || localStorage.getItem('access_token');
        }
        function extractNumericId(requestId) {
            if (typeof requestId === 'number') return requestId;
            const match = requestId.match(/\d+/);
            return match ? parseInt(match[0], 10) : requestId;
        }

        // ===== VIEW COURSE REQUEST =====
        function viewCourseRequest(requestId, status) {
            const modal = document.getElementById('view-course-modal');
            if (modal) {
                modal.classList.remove('hidden');
                modal.classList.add('active');
            }

            const titleEl = document.getElementById('view-course-title');
            const idEl = document.getElementById('view-course-id');
            const statusEl = document.getElementById('view-course-status');
            const actionsEl = document.getElementById('view-course-actions');

            if (titleEl) titleEl.textContent = 'Course Request ' + requestId;
            if (idEl) idEl.textContent = 'ID: ' + requestId;

            // Determine status
            if (!status) {
                if (requestId.startsWith('REJ-')) status = 'rejected';
                else if (requestId.startsWith('SUS-')) status = 'suspended';
                else if (requestId.startsWith('VER-') || requestId.startsWith('CRS-')) status = 'verified';
                else status = 'pending';
            }

            // Load data from table row
            const row = document.querySelector(`[data-request-id="${requestId}"]`) ||
                        document.querySelector(`button[onclick*="${requestId}"]`)?.closest('tr');
            if (row) {
                const cells = row.querySelectorAll('td');
                if (cells.length > 0) {
                    const courseName = cells[1]?.textContent?.trim() || 'Unknown Course';
                    const category = cells[2]?.textContent?.trim() || 'N/A';
                    const level = cells[3]?.textContent?.trim() || 'N/A';
                    const requester = cells[4]?.textContent?.trim() || 'Unknown';

                    if (titleEl) titleEl.textContent = courseName;
                    const categoryEl = document.getElementById('view-course-category');
                    const levelEl = document.getElementById('view-course-level');
                    const requesterEl = document.getElementById('view-course-requester');
                    if (categoryEl) categoryEl.textContent = category;
                    if (levelEl) levelEl.textContent = level;
                    if (requesterEl) requesterEl.textContent = requester;
                }
            }

            // Status badge
            if (statusEl) {
                const badges = {
                    'pending': '<span class="px-3 py-1 rounded-full text-xs font-semibold bg-yellow-100 text-yellow-800">Pending Review</span>',
                    'verified': '<span class="px-3 py-1 rounded-full text-xs font-semibold bg-green-100 text-green-800">Verified</span>',
                    'rejected': '<span class="px-3 py-1 rounded-full text-xs font-semibold bg-red-100 text-red-800">Rejected</span>',
                    'suspended': '<span class="px-3 py-1 rounded-full text-xs font-semibold bg-orange-100 text-orange-800">Suspended</span>'
                };
                statusEl.innerHTML = badges[status] || badges['pending'];
            }

            // Action buttons
            if (actionsEl) {
                let html = '';
                if (status === 'pending') {
                    html = `
                        <button onclick="approveCourseRequest('${requestId}')" class="px-6 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600">Approve</button>
                        <button onclick="openRejectModal('${requestId}')" class="px-6 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600">Reject</button>
                    `;
                } else if (status === 'verified') {
                    html = `
                        <button onclick="openSuspendModal('${requestId}')" class="px-6 py-2 bg-orange-500 text-white rounded-lg hover:bg-orange-600">Suspend</button>
                        <button onclick="openRejectModal('${requestId}')" class="px-6 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600">Reject</button>
                    `;
                } else if (status === 'rejected') {
                    html = `<button onclick="restoreCourseRequest('${requestId}')" class="px-6 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600">Restore to Pending</button>`;
                } else if (status === 'suspended') {
                    html = `
                        <button onclick="reactivateCourse('${requestId}')" class="px-6 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600">Reactivate</button>
                        <button onclick="openRejectModal('${requestId}')" class="px-6 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600">Reject</button>
                    `;
                }
                actionsEl.innerHTML = html;
            }
        }
        window.viewCourseRequest = viewCourseRequest;

        // ===== VIEW COURSE (for verified/suspended courses) =====
        function viewCourse(courseId, status) {
            // Reuse viewCourseRequest with appropriate status
            if (!status) {
                if (String(courseId).startsWith('SUS-')) status = 'suspended';
                else status = 'verified';
            }
            viewCourseRequest(courseId, status);
        }
        window.viewCourse = viewCourse;

        // ===== CLOSE VIEW MODAL =====
        function closeViewCourseModal() {
            const modal = document.getElementById('view-course-modal');
            if (modal) {
                modal.classList.add('hidden');
                modal.classList.remove('active');
            }
        }
        window.closeViewCourseModal = closeViewCourseModal;

        // ===== APPROVE COURSE =====
        async function approveCourseRequest(requestId) {
            if (!confirm('Are you sure you want to verify this course?')) return;
            const courseId = extractNumericId(requestId);
            try {
                const response = await fetch(`${API_BASE_URL}/api/admin/courses/${courseId}/verify`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json', 'Authorization': `Bearer ${getAuthToken()}` }
                });
                const data = await response.json();
                if (response.ok) {
                    alert('Course verified! Status changed to "verified".');
                    closeViewCourseModal();
                    location.reload();
                } else {
                    alert('Error: ' + (data.detail || 'Failed to verify course'));
                }
            } catch (error) {
                alert('Network error. Please try again.');
            }
        }
        window.approveCourseRequest = approveCourseRequest;

        // ===== REJECT COURSE =====
        async function openRejectModal(requestId) {
            const reason = prompt('Please enter the rejection reason:');
            if (!reason || !reason.trim()) return;
            const courseId = extractNumericId(requestId);
            try {
                const response = await fetch(`${API_BASE_URL}/api/admin/courses/${courseId}/reject`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json', 'Authorization': `Bearer ${getAuthToken()}` },
                    body: JSON.stringify({ reason: reason.trim() })
                });
                const data = await response.json();
                if (response.ok) {
                    alert('Course rejected! Status changed to "rejected".');
                    closeViewCourseModal();
                    location.reload();
                } else {
                    alert('Error: ' + (data.detail || 'Failed to reject course'));
                }
            } catch (error) {
                alert('Network error. Please try again.');
            }
        }
        window.openRejectModal = openRejectModal;

        // ===== SUSPEND COURSE =====
        async function openSuspendModal(requestId) {
            const reason = prompt('Please enter the suspension reason:');
            if (!reason || !reason.trim()) return;
            const courseId = extractNumericId(requestId);
            try {
                const response = await fetch(`${API_BASE_URL}/api/admin/courses/${courseId}/suspend`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json', 'Authorization': `Bearer ${getAuthToken()}` },
                    body: JSON.stringify({ reason: reason.trim() })
                });
                const data = await response.json();
                if (response.ok) {
                    alert('Course suspended! Status changed to "suspended".');
                    closeViewCourseModal();
                    location.reload();
                } else {
                    alert('Error: ' + (data.detail || 'Failed to suspend course'));
                }
            } catch (error) {
                alert('Network error. Please try again.');
            }
        }
        window.openSuspendModal = openSuspendModal;

        // ===== RESTORE COURSE =====
        async function restoreCourseRequest(requestId) {
            if (!confirm('Are you sure you want to restore this course to pending?')) return;
            const courseId = extractNumericId(requestId);
            try {
                const response = await fetch(`${API_BASE_URL}/api/admin/courses/${courseId}/reconsider`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json', 'Authorization': `Bearer ${getAuthToken()}` }
                });
                const data = await response.json();
                if (response.ok) {
                    alert('Course restored to pending!');
                    closeViewCourseModal();
                    location.reload();
                } else {
                    alert('Error: ' + (data.detail || 'Failed to restore course'));
                }
            } catch (error) {
                alert('Network error. Please try again.');
            }
        }
        window.restoreCourseRequest = restoreCourseRequest;

        // ===== REACTIVATE COURSE =====
        async function reactivateCourse(requestId) {
            if (!confirm('Are you sure you want to reactivate this course?')) return;
            const courseId = extractNumericId(requestId);
            try {
                const response = await fetch(`${API_BASE_URL}/api/admin/courses/${courseId}/reinstate`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json', 'Authorization': `Bearer ${getAuthToken()}` }
                });
                const data = await response.json();
                if (response.ok) {
                    alert('Course reactivated! Status changed to "verified".');
                    closeViewCourseModal();
                    location.reload();
                } else {
                    alert('Error: ' + (data.detail || 'Failed to reactivate course'));
                }
            } catch (error) {
                alert('Network error. Please try again.');
            }
        }
        window.reactivateCourse = reactivateCourse;
    </script>

    <!-- Navigation -->
    <nav class="admin-nav p-4 sticky top-0 z-50" role="navigation" aria-label="Main navigation">
        <div class="container mx-auto flex justify-between items-center">
            <!-- Left: Hamburger + Logo -->
            <div class="nav-left flex items-center gap-4">
                <span class="hamburger" id="hamburger" onclick="toggleSidebar()">
                    <span></span>
                    <span></span>
                    <span></span>
                </span>
                <a href="manage-courses.html" class="logo-container">
                    <div class="logo-text">
                        <span class="logo-main">Astegni</span>
                        <span class="logo-sub">Manage Courses</span>
                    </div>
                    <span class="logo-badge">Beta</span>
                </a>
            </div>

            <!-- Center: Live Clock -->
            <div class="nav-center">
                <div class="live-clock">
                    <span id="current-time" class="time">--:--:--</span>
                    <span id="current-date" class="date">Loading...</span>
                </div>
            </div>

            <!-- Right: Home, Notification, Theme, Profile -->
            <div class="header-right">
                <!-- Home Icon Link -->
                <a href="index.html" class="icon-button" title="Go to Admin Home">
                    <i class="fas fa-home"></i>
                </a>

                <!-- Theme Toggle (always visible) -->
                <button id="theme-toggle" class="icon-button" onclick="toggleTheme()">
                    <span class="theme-icon">
                        <i class="fas fa-moon" id="moon-icon"></i>
                        <i class="fas fa-sun" id="sun-icon" style="display: none;"></i>
                    </span>
                </button>

                <!-- User Controls (hidden by default, shown when logged in) -->
                <div class="user-controls" id="user-controls" style="display: none;">
                    <!-- Notification Icon -->
                    <button class="icon-button notification-button" onclick="openNotificationModal()">
                        <i class="fas fa-bell"></i>
                        <span class="badge notification-count-badge">3</span>
                    </button>

                    <!-- Profile container -->
                    <div id="profile-container" class="profile-dropdown-container">
                    <button id="profile-dropdown-toggle" class="profile-dropdown-toggle"
                        onclick="toggleProfileDropdown()">
                        <img id="profile-pic" class="profile-pic"
                             src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='100' height='100' viewBox='0 0 100 100'%3E%3Ccircle cx='50' cy='50' r='50' fill='%234F46E5'/%3E%3Ctext x='50' y='50' text-anchor='middle' dy='.3em' fill='white' font-size='40' font-family='Arial'%3EA%3C/text%3E%3C/svg%3E"
                             alt="Profile">
                        <span id="profile-name" class="profile-name">Guest</span>
                        <svg class="dropdown-arrow" width="12" height="12" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd"
                                d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z"
                                clip-rule="evenodd"></path>
                        </svg>
                    </button>

                    <div id="profile-dropdown-menu" class="profile-dropdown-menu hidden">
                        <!-- User info header - CLICKABLE to go to department page -->
                        <a href="javascript:void(0)" id="dropdown-profile-link" class="dropdown-header-link">
                            <div class="dropdown-header">
                                <img id="dropdown-profile-pic" class="profile-pic"
                                     src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='100' height='100' viewBox='0 0 100 100'%3E%3Ccircle cx='50' cy='50' r='50' fill='%234F46E5'/%3E%3Ctext x='50' y='50' text-anchor='middle' dy='.3em' fill='white' font-size='40' font-family='Arial'%3EA%3C/text%3E%3C/svg%3E"
                                     alt="Profile">
                                <div class="dropdown-user-info">
                                    <span id="dropdown-user-name" class="dropdown-user-name"></span>
                                    <span id="dropdown-user-email" class="dropdown-user-email"></span>
                                    <span id="dropdown-user-role" class="dropdown-user-role"></span>
                                </div>
                                <svg class="dropdown-header-arrow" width="16" height="16" fill="currentColor" viewBox="0 0 20 20">
                                    <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                                </svg>
                            </div>
                        </a>

                        <div class="dropdown-divider"></div>

                        <!-- Department switcher (shown if user has multiple departments) -->
                        <div id="department-switcher-section" class="department-switcher-section hidden">
                            <div class="dropdown-item-header">Your Departments</div>
                            <div id="department-options" class="department-options">
                                <!-- Department options will be dynamically added here -->
                            </div>
                            <div class="dropdown-divider"></div>
                        </div>

                        <!-- Add Department button -->
                        <button class="dropdown-item" onclick="openAddDepartmentModal()">
                            <i class="fas fa-plus-circle"></i>
                            <span>Add Department Role</span>
                        </button>

                        <div class="dropdown-divider"></div>

                        <button class="dropdown-item logout-item" onclick="openLogoutModal()">
                            <i class="fas fa-sign-out-alt dropdown-icon"></i>
                            Logout
                        </button>
                    </div>
                </div>
                </div><!-- /user-controls -->
            </div>
        </div>
    </nav>

    <!-- Sidebar -->
    <aside id="sidebar" class="sidebar-container">
        <div class="sidebar-content">
            <div class="sidebar-nav">
                <h3>Course Management</h3>
                <span class="sidebar-close" id="sidebar-close" onclick="toggleSidebar()">&times;</span>

                <a href="#" onclick="switchPanel('dashboard'); return false;" class="sidebar-link active">
                    <span class="sidebar-icon">üìä</span>
                    <span>Dashboard</span>
                </a>
                <a href="#" onclick="switchPanel('requested'); return false;" class="sidebar-link">
                    <span class="sidebar-icon">üìù</span>
                    <span>Course Requests</span>
                </a>
                <a href="#" onclick="switchPanel('verified'); return false;" class="sidebar-link">
                    <span class="sidebar-icon">üìö</span>
                    <span>Verified Courses</span>
                </a>
                <a href="#" onclick="switchPanel('rejected'); return false;" class="sidebar-link">
                    <span class="sidebar-icon">‚ùå</span>
                    <span>Rejected Courses</span>
                </a>
                <a href="#" onclick="switchPanel('suspended'); return false;" class="sidebar-link">
                    <span class="sidebar-icon">‚ö†Ô∏è</span>
                    <span>Suspended Courses</span>
                </a>
                <button onclick="window.switchPanel ? switchPanel('reviews') : null" class="sidebar-link"
                    data-panel="reviews">
                    <i class="fas fa-star"></i>
                    <span>Reviews & Ratings</span>
                </button>
                <a href="#" onclick="switchPanel('credentials'); return false;" class="sidebar-link">
                    <span class="sidebar-icon">üéì</span>
                    <span>Credentials</span>
                </a>
                <hr class="my-4 border-gray-300">
                <a href="#" onclick="openCourseReports(); return false;" class="sidebar-link">
                    <span class="sidebar-icon">üìä</span>
                    <span>Course Analytics</span>
                </a>
                <a href="#" onclick="openCurriculumGuidelines(); return false;" class="sidebar-link">
                    <span class="sidebar-icon">üìã</span>
                    <span>Curriculum Guidelines</span>
                </a>
                <a href="#" onclick="openCourseSettings(); return false;" class="sidebar-link">
                    <span class="sidebar-icon">‚öôÔ∏è</span>
                    <span>Course Settings</span>
                </a>
                <hr class="my-4 border-gray-300">
                <a href="#" onclick="switchPanel('portfolio'); return false;" class="sidebar-link">
                    <span class="sidebar-icon">üìÅ</span>
                    <span>Portfolio</span>
                </a>
                <a href="#" onclick="switchPanel('settings'); return false;" class="sidebar-link">
                    <span class="sidebar-icon">‚öôÔ∏è</span>
                    <span>Settings</span>
                </a>
                <!-- Logout Button at Bottom -->
                <div class="mt-auto pt-4 border-t border-gray-300">
                    <a href="#" onclick="logout(); return false;" class="sidebar-link text-red-500 hover:bg-red-50">
                        <span class="sidebar-icon">üö™</span>
                        <span>Logout</span>
                    </a>
                </div>
            </div>
        </div>
    </aside>

    <!-- Main Content -->
    <section class="py-8">
        <div class="container mx-auto px-4">
            <!-- Main Content with Widgets -->
            <div class="flex gap-6">
                <!-- Left Content Area -->
                <div class="flex-1">
                    <!-- Panels Section -->
                    <div class="panels-container">
                        <!-- Dashboard Panel (Default) -->
                        <div id="dashboard-panel" class="panel-content active">

                            <!-- Profile Header Section (Only visible in Dashboard) -->
                            <section class="profile-header-section mb-8">
                                <div class="cover-image-container relative">
                                    <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='1200' height='300'%3E%3Crect width='1200' height='300' fill='%23e5e7eb'/%3E%3Ctext x='50%25' y='50%25' text-anchor='middle' dy='.3em' fill='%239ca3af' font-family='sans-serif' font-size='20'%3E1200x300%3C/text%3E%3C/svg%3E"
                                        alt="Cover" class="cover-img">
                                    <div class="cover-overlay"></div>
                                    <!-- Cover Upload Button -->
                                    <button onclick="openUploadCoverModal()" class="cover-upload-btn">
                                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                d="M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z">
                                            </path>
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                d="M15 13a3 3 0 11-6 0 3 3 0 016 0z"></path>
                                        </svg>
                                    </button>
                                </div>

                                <div class="profile-main-info">
                                    <div class="profile-info-wrapper">
                                        <div class="profile-avatar-container">
                                            <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='150' height='150'%3E%3Crect width='150' height='150' fill='%23e5e7eb'/%3E%3Ctext x='50%25' y='50%25' text-anchor='middle' dy='.3em' fill='%239ca3af' font-family='sans-serif' font-size='16'%3E150x150%3C/text%3E%3C/svg%3E"
                                                alt="Admin Profile" class="profile-avatar">
                                            <span class="online-indicator"></span>
                                            <!-- Profile Picture Upload Button -->
                                            <button onclick="openUploadProfileModal()" class="avatar-upload-btn">
                                                <svg class="w-4 h-4" fill="none" stroke="currentColor"
                                                    viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round"
                                                        stroke-width="2"
                                                        d="M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z">
                                                    </path>
                                                    <path stroke-linecap="round" stroke-linejoin="round"
                                                        stroke-width="2" d="M15 13a3 3 0 11-6 0 3 3 0 016 0z"></path>
                                                </svg>
                                            </button>
                                        </div>

                                        <div class="profile-details-section">
                                            <div class="profile-name-row">
                                                <h1 class="profile-name" id="adminUsername">admin_username</h1>
                                                <div class="badges-row">
                                                    <!-- Badges loaded from database by manage-courses-dashboard-loader.js -->
                                                </div>
                                            </div>

                                            <div class="rating-section">
                                                <div class="rating-wrapper">
                                                    <span class="rating-value">...</span>
                                                    <div class="rating-stars">‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ</div>
                                                    <span class="rating-count">(...)</span>
                                                    <div class="rating-label">Performance Rating</div>
                                                </div>
                                            </div>

                                            <div class="profile-location">
                                                <span class="location-icon">üìç</span>
                                                <span>Loading...</span>
                                            </div>

                                            <div class="profile-quote">
                                                <span>"..."</span>
                                            </div>

                                            <div class="profile-actions">
                                                <button onclick="openEditProfileModal()" class="btn-primary">
                                                    <span class="mr-2">‚úèÔ∏è</span>
                                                    Edit Profile
                                                </button>
                                            </div>

                                            <!-- About Me Info -->
                                            <div class="profile-info-grid">
                                                <div class="info-item">
                                                    <span class="info-label">Email:</span>
                                                    <span class="info-value" id="profile-email">...</span>
                                                </div>
                                                <div class="info-item">
                                                    <span class="info-label">Phone:</span>
                                                    <span class="info-value" id="profile-phone">...</span>
                                                </div>
                                                <div class="info-item">
                                                    <span class="info-label">Department:</span>
                                                    <span class="info-value">...</span>
                                                </div>
                                                <div class="info-item">
                                                    <span class="info-label">Employee ID:</span>
                                                    <span class="info-value">...</span>
                                                </div>
                                                <div class="info-item">
                                                    <span class="info-label">Joined:</span>
                                                    <span class="info-value">...</span>
                                                </div>
                                                <div class="info-description">
                                                    <p>Loading profile information...</p>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </section>

                            <!-- Page Header -->
                            <div class="mb-8 animate-fadeIn">
                                <h1 class="text-3xl font-bold mb-2">Course Management Dashboard</h1>
                                <p class="text-gray-600">Overview of all course management activities and statistics</p>
                            </div>
                            <!-- All Statistics Cards -->
                            <div class="dashboard-grid mb-8">
                                <!-- Dashboard stats loaded from database by manage-courses-dashboard-loader.js -->
                                <div class="card p-4">
                                    <h3 class="text-lg font-semibold">Pending Courses</h3>
                                    <p class="text-2xl font-bold text-yellow-600">...</p>
                                    <span class="text-sm text-gray-500">Awaiting review</span>
                                </div>
                                <div class="card p-4">
                                    <h3 class="text-lg font-semibold">Approval Rate</h3>
                                    <p class="text-2xl font-bold text-green-600">...</p>
                                    <span class="text-sm text-gray-500">This month</span>
                                </div>
                                <div class="card p-4">
                                    <h3 class="text-lg font-semibold">Avg Processing</h3>
                                    <p class="text-2xl font-bold">...</p>
                                    <span class="text-sm text-gray-500">Per application</span>
                                </div>
                                <div class="card p-4">
                                    <h3 class="text-lg font-semibold">Client Satisfaction</h3>
                                    <p class="text-2xl font-bold">...</p>
                                    <span class="text-sm text-gray-500">Happy clients</span>
                                </div>
                            </div>



                            <!-- Reviews Section -->
                            <div class="card p-6 mb-8">
                                <div class="flex justify-between items-center mb-4">
                                    <h3 class="text-xl font-semibold">Your Recent Performance Reviews</h3>
                                    <button onclick="window.switchPanel ? switchPanel('reviews') : null"
                                        class="text-blue-500 hover:text-blue-700 text-sm font-semibold">
                                        View All Your Reviews ‚Üí
                                    </button>
                                </div>
                                <div class="space-y-4" id="dashboard-reviews-container">
                                    <!-- Reviews loaded from database by manage-courses-reviews.js -->
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Verified Courses Panel -->
                    <div id="verified-panel" class="panel-content hidden">
                        <div class="mb-8">
                            <h1 class="text-3xl font-bold mb-2">Verified Courses</h1>
                            <p class="text-gray-600">Manage all verified and running courses</p>
                        </div>

                        <!-- Statistics Card for this panel only -->
                        <div class="dashboard-grid mb-8">
                            <div class="card p-4">
                                <h3 class="text-lg font-semibold">Total Verified</h3>
                                <p class="text-2xl font-bold">...</p>
                            </div>
                            <div class="card p-4">
                                <h3 class="text-lg font-semibold">Academic Courses</h3>
                                <p class="text-2xl font-bold">...</p>
                            </div>
                            <div class="card p-4">
                                <h3 class="text-lg font-semibold">Professional Courses</h3>
                                <p class="text-2xl font-bold">...</p>
                            </div>
                            <div class="card p-4">
                                <h3 class="text-lg font-semibold">Average Rating</h3>
                                <p class="text-2xl font-bold">...</p>
                            </div>
                        </div>

                        <!-- Search and Filters -->
                        <div class="card p-6 mb-6">
                            <div class="flex flex-wrap gap-4 items-center">
                                <div class="flex-1 min-w-[300px]">
                                    <input type="text" class="w-full p-3 border-2 rounded-lg"
                                        placeholder="Search courses by name, category, or instructor...">
                                </div>
                                <select class="p-3 border-2 rounded-lg">
                                    <option value="">All Categories</option>
                                    <option value="mathematics">Mathematics</option>
                                    <option value="science">Science</option>
                                    <option value="languages">Languages</option>
                                    <option value="technology">Technology</option>
                                </select>
                                <select class="p-3 border-2 rounded-lg">
                                    <option value="">All Levels</option>
                                    <option value="elementary">Elementary</option>
                                    <option value="high-school">High School</option>
                                    <option value="university">University</option>
                                </select>
                            </div>
                        </div>

                        <!-- Courses Table -->
                        <div class="card overflow-hidden">
                            <table class="w-full">
                                <thead>
                                    <tr>
                                        <th class="p-4 text-left">Course</th>
                                        <th class="p-4 text-left">Category</th>
                                        <th class="p-4 text-left">Level</th>
                                        <th class="p-4 text-left">Students</th>
                                        <th class="p-4 text-left">Rating</th>
                                        <th class="p-4 text-left">Notification</th>
                                        <th class="p-4 text-left">Actions</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- Active courses loaded from database by manage-courses-db-loader.js -->
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <!-- Course Requests Panel -->
                    <div id="requested-panel" class="panel-content hidden">
                        <div class="mb-8">
                            <h1 class="text-3xl font-bold mb-2">Course Requests</h1>
                            <p class="text-gray-600">Review new course requests from instructors and institutions</p>
                        </div>

                        <!-- Statistics Card for this panel only -->
                        <div class="dashboard-grid mb-8">
                            <div class="card p-4">
                                <h3 class="text-lg font-semibold">New Requests</h3>
                                <p class="text-2xl font-bold text-yellow-600">...</p>
                                <span class="text-sm text-gray-500">Not yet reviewed</span>
                            </div>
                            <div class="card p-4 cursor-pointer hover:shadow-lg transition-shadow" onclick="switchPanel('verified')">
                                <h3 class="text-lg font-semibold">Approved Today</h3>
                                <p class="text-2xl font-bold text-green-600">...</p>
                                <span class="text-sm text-gray-500">Click to view verified courses</span>
                            </div>
                            <div class="card p-4 cursor-pointer hover:shadow-lg transition-shadow" onclick="switchPanel('rejected')">
                                <h3 class="text-lg font-semibold">Rejected</h3>
                                <p class="text-2xl font-bold text-red-600">...</p>
                                <span class="text-sm text-gray-500">Click to view rejected courses</span>
                            </div>
                        </div>

                        <!-- Search and Filters -->
                        <div class="card p-6 mb-6">
                            <div class="flex flex-wrap gap-4 items-center">
                                <div class="flex-1 min-w-[300px]">
                                    <input type="text" class="w-full p-3 border-2 rounded-lg"
                                        placeholder="Search courses by name, category, or instructor...">
                                </div>
                                <select class="p-3 border-2 rounded-lg">
                                    <option value="">All Categories</option>
                                    <option value="mathematics">Mathematics</option>
                                    <option value="science">Science</option>
                                    <option value="languages">Languages</option>
                                    <option value="technology">Technology</option>
                                </select>
                                <select class="p-3 border-2 rounded-lg">
                                    <option value="">All Levels</option>
                                    <option value="elementary">Elementary</option>
                                    <option value="high-school">High School</option>
                                    <option value="university">University</option>
                                </select>
                                <button onclick="openAddCourseModal()" class="cta-button">
                                    <i class="fas fa-plus"></i> Add Course
                                </button>
                            </div>
                        </div>


                        <div class="card overflow-hidden">
                            <div class="p-4 border-b">
                                <h3 class="text-xl font-semibold">Pending Course Requests</h3>
                            </div>
                            <table class="w-full">
                                <thead>
                                    <tr>
                                        <th class="p-4 text-left">Course Title</th>
                                        <th class="p-4 text-left">Requested By</th>
                                        <th class="p-4 text-left">Category</th>
                                        <th class="p-4 text-left">Level</th>
                                        <th class="p-4 text-left">Submitted</th>
                                        <th class="p-4 text-left">Actions</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- Course requests loaded from database by manage-courses-db-loader.js -->
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <!-- Rejected Courses Panel -->
                    <div id="rejected-panel" class="panel-content hidden">
                        <div class="mb-8">
                            <h1 class="text-3xl font-bold mb-2">Rejected Courses</h1>
                            <p class="text-gray-600">Review rejected course applications and reconsider if needed</p>
                        </div>

                        <!-- Statistics Card for this panel only -->
                        <div class="dashboard-grid mb-8">
                            <div class="card p-4">
                                <h3 class="text-lg font-semibold">Total Rejected</h3>
                                <p class="text-2xl font-bold text-red-600">...</p>
                            </div>
                            <div class="card p-4">
                                <h3 class="text-lg font-semibold">This Month</h3>
                                <p class="text-2xl font-bold">...</p>
                            </div>
                            <div class="card p-4">
                                <h3 class="text-lg font-semibold">Reconsidered</h3>
                                <p class="text-2xl font-bold text-green-600">...</p>
                            </div>
                            <div class="card p-4">
                                <h3 class="text-lg font-semibold">Main Reason</h3>
                                <p class="text-lg font-bold">...</p>
                            </div>
                        </div>

                        <!-- Search and Filters -->
                        <div class="card p-6 mb-6">
                            <div class="flex flex-wrap gap-4 items-center">
                                <div class="flex-1 min-w-[300px]">
                                    <input type="text" class="w-full p-3 border-2 rounded-lg"
                                        placeholder="Search courses by name, category, or instructor...">
                                </div>
                                <select class="p-3 border-2 rounded-lg">
                                    <option value="">All Categories</option>
                                    <option value="mathematics">Mathematics</option>
                                    <option value="science">Science</option>
                                    <option value="languages">Languages</option>
                                    <option value="technology">Technology</option>
                                </select>
                                <select class="p-3 border-2 rounded-lg">
                                    <option value="">All Levels</option>
                                    <option value="elementary">Elementary</option>
                                    <option value="high-school">High School</option>
                                    <option value="university">University</option>
                                </select>
                            </div>
                        </div>
                        <div class="card overflow-hidden">
                            <div class="p-4 border-b">
                                <h3 class="text-xl font-semibold">Rejected Course Applications</h3>
                            </div>
                            <table class="w-full">
                                <thead>
                                    <tr>
                                        <th class="p-4 text-left">Course Title</th>
                                        <th class="p-4 text-left">Category</th>
                                        <th class="p-4 text-left">Rejected Date</th>
                                        <th class="p-4 text-left">Reason</th>
                                        <th class="p-4 text-left">Actions</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- Rejected courses loaded from database by manage-courses-db-loader.js -->
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <!-- Suspended Courses Panel -->
                    <div id="suspended-panel" class="panel-content hidden">
                        <div class="mb-8">
                            <h1 class="text-3xl font-bold mb-2">Suspended Courses</h1>
                            <p class="text-gray-600">Manage courses under temporary suspension</p>
                        </div>

                        <!-- Statistics Card for this panel only -->
                        <div class="dashboard-grid mb-8">
                            <div class="card p-4">
                                <h3 class="text-lg font-semibold">Currently Suspended</h3>
                                <p class="text-2xl font-bold text-orange-600">...</p>
                            </div>
                            <div class="card p-4">
                                <h3 class="text-lg font-semibold">Quality Issues</h3>
                                <p class="text-2xl font-bold">...</p>
                            </div>
                            <div class="card p-4">
                                <h3 class="text-lg font-semibold">Under Investigation</h3>
                                <p class="text-2xl font-bold">...</p>
                            </div>
                            <div class="card p-4">
                                <h3 class="text-lg font-semibold">Reinstated This Year</h3>
                                <p class="text-2xl font-bold text-green-600">...</p>
                            </div>
                        </div>

                        <!-- Search and Filters -->
                        <div class="card p-6 mb-6">
                            <div class="flex flex-wrap gap-4 items-center">
                                <div class="flex-1 min-w-[300px]">
                                    <input type="text" class="w-full p-3 border-2 rounded-lg"
                                        placeholder="Search courses by name, category, or instructor...">
                                </div>
                                <select class="p-3 border-2 rounded-lg">
                                    <option value="">All Categories</option>
                                    <option value="mathematics">Mathematics</option>
                                    <option value="science">Science</option>
                                    <option value="languages">Languages</option>
                                    <option value="technology">Technology</option>
                                </select>
                                <select class="p-3 border-2 rounded-lg">
                                    <option value="">All Levels</option>
                                    <option value="elementary">Elementary</option>
                                    <option value="high-school">High School</option>
                                    <option value="university">University</option>
                                </select>
                                <button onclick="openAddCourseModal()" class="cta-button">
                                    <i class="fas fa-plus"></i> Add Course
                                </button>
                            </div>
                        </div>

                        <div class="card overflow-hidden">
                            <div class="p-4 border-b">
                                <h3 class="text-xl font-semibold">Suspended Courses</h3>
                            </div>
                            <table class="w-full">
                                <thead>
                                    <tr>
                                        <th class="p-4 text-left">Course Title</th>
                                        <th class="p-4 text-left">Category</th>
                                        <th class="p-4 text-left">Suspended Date</th>
                                        <th class="p-4 text-left">Reason</th>
                                        <th class="p-4 text-left">Actions</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- Suspended courses loaded from database by manage-courses-db-loader.js -->
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <!-- Reviews & Ratings Panel -->
                    <div id="reviews-panel" class="panel-content hidden">
                        <div class="mb-8">
                            <h1 class="text-3xl font-bold mb-2">Your Performance Reviews</h1>
                            <p class="text-gray-600">View feedback and ratings from instructors, colleagues, and supervisors about your course management performance</p>
                        </div>

                        <!-- Performance Summary Cards -->
                        <div class="dashboard-grid mb-8">
                            <div class="card p-4">
                                <h3 class="text-gray-600 text-sm font-semibold">Your Overall Rating</h3>
                                <p class="text-3xl font-bold mt-2" id="review-avg-rating">0.0</p>
                                <div class="mt-2 text-yellow-500 text-xl" id="review-stars">‚òÜ‚òÜ‚òÜ‚òÜ‚òÜ</div>
                            </div>
                            <div class="card p-4">
                                <h3 class="text-gray-600 text-sm font-semibold">Your Response Time</h3>
                                <p class="text-3xl font-bold mt-2" id="review-response-time">0.0</p>
                                <p class="text-sm text-gray-500 mt-1">How fast you respond</p>
                            </div>
                            <div class="card p-4">
                                <h3 class="text-gray-600 text-sm font-semibold">Your Accuracy Score</h3>
                                <p class="text-3xl font-bold mt-2" id="review-accuracy">0.0</p>
                                <p class="text-sm text-gray-500 mt-1">Decision quality</p>
                            </div>
                            <div class="card p-4">
                                <h3 class="text-gray-600 text-sm font-semibold">Your Total Reviews</h3>
                                <p class="text-3xl font-bold mt-2" id="review-total">0</p>
                                <p class="text-sm text-gray-500 mt-1" id="review-trend">Stable</p>
                            </div>
                        </div>

                        <!-- Filters -->
                        <div class="card p-6 mb-6">
                            <div class="flex flex-wrap gap-4 items-center">
                                <div class="flex-1 min-w-[300px]">
                                    <input type="text" id="review-search" class="w-full p-3 border-2 rounded-lg"
                                        placeholder="Search reviews by reviewer name or comment...">
                                </div>
                                <select id="review-filter-type" class="p-3 border-2 rounded-lg">
                                    <option value="">All Types</option>
                                    <option value="performance">Performance</option>
                                    <option value="efficiency">Efficiency</option>
                                    <option value="instructor_feedback">Instructor Feedback</option>
                                    <option value="quality">Quality</option>
                                    <option value="financial">Financial</option>
                                    <option value="student_impact">Student Impact</option>
                                </select>
                                <select id="review-filter-rating" class="p-3 border-2 rounded-lg">
                                    <option value="">All Ratings</option>
                                    <option value="5">5 Stars</option>
                                    <option value="4">4+ Stars</option>
                                    <option value="3">3+ Stars</option>
                                </select>
                            </div>
                        </div>

                        <!-- All Reviews List -->
                        <div class="card p-6">
                            <div class="flex justify-between items-center mb-6">
                                <h3 class="text-xl font-semibold">All Your Performance Reviews</h3>
                                <button onclick="window.ReviewsManager && window.ReviewsManager.loadAll()"
                                    class="px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition">
                                    üîÑ Refresh My Reviews
                                </button>
                            </div>
                            <div class="space-y-4" id="reviews-list-container">
                                <!-- Reviews loaded from database by manage-courses-reviews.js -->
                                <div class="text-center text-gray-400 py-8">
                                    <p>Click "Refresh My Reviews" button above to load your performance reviews</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Credentials Panel -->
                    <div id="credentials-panel" class="panel-content hidden">
                        <div class="mb-8">
                            <div class="flex justify-between items-start">
                                <div>
                                    <h1 class="text-3xl font-bold mb-2">My Credentials</h1>
                                    <p class="text-gray-600">View and manage your professional achievements and work experience</p>
                                </div>
                                <button onclick="openAddCredentialModal()" class="px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-all font-medium flex items-center gap-2">
                                    <i class="fas fa-plus"></i>
                                    Add Credential
                                </button>
                            </div>
                        </div>

                        <!-- Section Toggle Tabs -->
                        <div class="card p-4 mb-6">
                            <div class="flex gap-4">
                                <button onclick="switchCredentialsSection('achievements')"
                                    class="credentials-tab active px-6 py-3 rounded-lg font-semibold transition-all bg-blue-500 text-white"
                                    id="achievements-tab">
                                    <span class="mr-2">üèÜ</span> Achievements
                                </button>
                                <button onclick="switchCredentialsSection('experience')"
                                    class="credentials-tab px-6 py-3 rounded-lg font-semibold transition-all bg-gray-100 hover:bg-gray-200"
                                    id="experience-tab">
                                    <span class="mr-2">üíº</span> Experience
                                </button>
                            </div>
                        </div>

                        <!-- Achievements Section -->
                        <div id="credentials-achievements-section" class="credentials-section">
                            <!-- Achievements Stats -->
                            <div class="dashboard-grid mb-8">
                                <div class="card p-4">
                                    <h3 class="text-gray-600 text-sm font-semibold">Total Achievements</h3>
                                    <p class="text-3xl font-bold mt-2 text-yellow-500" id="total-achievements">12</p>
                                    <p class="text-sm text-gray-500 mt-1">Badges & Awards</p>
                                </div>
                                <div class="card p-4">
                                    <h3 class="text-gray-600 text-sm font-semibold">Certifications</h3>
                                    <p class="text-3xl font-bold mt-2 text-blue-500" id="total-certifications">5</p>
                                    <p class="text-sm text-gray-500 mt-1">Verified credentials</p>
                                </div>
                                <div class="card p-4">
                                    <h3 class="text-gray-600 text-sm font-semibold">Recognition Awards</h3>
                                    <p class="text-3xl font-bold mt-2 text-purple-500" id="total-awards">7</p>
                                    <p class="text-sm text-gray-500 mt-1">Company honors</p>
                                </div>
                                <div class="card p-4">
                                    <h3 class="text-gray-600 text-sm font-semibold">Current Level</h3>
                                    <p class="text-3xl font-bold mt-2 text-green-500" id="admin-level">Level 8</p>
                                    <p class="text-sm text-gray-500 mt-1">Senior Admin</p>
                                </div>
                            </div>

                            <!-- Achievement Badges Grid -->
                            <div class="card p-6 mb-6">
                                <h3 class="text-xl font-semibold mb-4">Achievement Badges</h3>
                                <div class="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4" id="achievements-grid">
                                    <div class="achievement-badge text-center p-4 rounded-lg bg-gradient-to-br from-yellow-50 to-yellow-100 border-2 border-yellow-200">
                                        <div class="text-4xl mb-2">üèÜ</div>
                                        <div class="font-semibold text-sm">Top Performer</div>
                                        <div class="text-xs text-gray-500">Q4 2024</div>
                                    </div>
                                    <div class="achievement-badge text-center p-4 rounded-lg bg-gradient-to-br from-blue-50 to-blue-100 border-2 border-blue-200">
                                        <div class="text-4xl mb-2">ü•á</div>
                                        <div class="font-semibold text-sm">Excellence Award</div>
                                        <div class="text-xs text-gray-500">Annual 2024</div>
                                    </div>
                                    <div class="achievement-badge text-center p-4 rounded-lg bg-gradient-to-br from-purple-50 to-purple-100 border-2 border-purple-200">
                                        <div class="text-4xl mb-2">‚≠ê</div>
                                        <div class="font-semibold text-sm">5-Star Admin</div>
                                        <div class="text-xs text-gray-500">200+ Reviews</div>
                                    </div>
                                    <div class="achievement-badge text-center p-4 rounded-lg bg-gradient-to-br from-green-50 to-green-100 border-2 border-green-200">
                                        <div class="text-4xl mb-2">üìö</div>
                                        <div class="font-semibold text-sm">Course Expert</div>
                                        <div class="text-xs text-gray-500">1000+ Courses</div>
                                    </div>
                                    <div class="achievement-badge text-center p-4 rounded-lg bg-gradient-to-br from-red-50 to-red-100 border-2 border-red-200">
                                        <div class="text-4xl mb-2">üéØ</div>
                                        <div class="font-semibold text-sm">Goal Achiever</div>
                                        <div class="text-xs text-gray-500">100% Targets</div>
                                    </div>
                                    <div class="achievement-badge text-center p-4 rounded-lg bg-gradient-to-br from-indigo-50 to-indigo-100 border-2 border-indigo-200">
                                        <div class="text-4xl mb-2">üíé</div>
                                        <div class="font-semibold text-sm">Premium Admin</div>
                                        <div class="text-xs text-gray-500">Level 10</div>
                                    </div>
                                    <div class="achievement-badge text-center p-4 rounded-lg bg-gradient-to-br from-orange-50 to-orange-100 border-2 border-orange-200">
                                        <div class="text-4xl mb-2">üî•</div>
                                        <div class="font-semibold text-sm">Fire Streak</div>
                                        <div class="text-xs text-gray-500">30+ Days</div>
                                    </div>
                                    <div class="achievement-badge text-center p-4 rounded-lg bg-gradient-to-br from-teal-50 to-teal-100 border-2 border-teal-200">
                                        <div class="text-4xl mb-2">üöÄ</div>
                                        <div class="font-semibold text-sm">Fast Processor</div>
                                        <div class="text-xs text-gray-500">&lt; 1hr Avg</div>
                                    </div>
                                    <div class="achievement-badge text-center p-4 rounded-lg bg-gradient-to-br from-pink-50 to-pink-100 border-2 border-pink-200">
                                        <div class="text-4xl mb-2">‚ù§Ô∏è</div>
                                        <div class="font-semibold text-sm">Client Favorite</div>
                                        <div class="text-xs text-gray-500">95% Satisfaction</div>
                                    </div>
                                    <div class="achievement-badge text-center p-4 rounded-lg bg-gradient-to-br from-cyan-50 to-cyan-100 border-2 border-cyan-200">
                                        <div class="text-4xl mb-2">üõ°Ô∏è</div>
                                        <div class="font-semibold text-sm">Quality Guardian</div>
                                        <div class="text-xs text-gray-500">Zero Errors</div>
                                    </div>
                                    <div class="achievement-badge text-center p-4 rounded-lg bg-gradient-to-br from-lime-50 to-lime-100 border-2 border-lime-200">
                                        <div class="text-4xl mb-2">üåü</div>
                                        <div class="font-semibold text-sm">Rising Star</div>
                                        <div class="text-xs text-gray-500">New Talent</div>
                                    </div>
                                    <div class="achievement-badge text-center p-4 rounded-lg bg-gradient-to-br from-gray-50 to-gray-100 border-2 border-gray-200">
                                        <div class="text-4xl mb-2">üìà</div>
                                        <div class="font-semibold text-sm">Growth Driver</div>
                                        <div class="text-xs text-gray-500">20% Increase</div>
                                    </div>
                                </div>
                            </div>

                            <!-- Certifications -->
                            <div class="card p-6">
                                <h3 class="text-xl font-semibold mb-4">Professional Certifications</h3>
                                <div class="space-y-4" id="certifications-list">
                                    <div class="flex items-center justify-between p-4 bg-blue-50 rounded-lg border-l-4 border-blue-500">
                                        <div class="flex items-center gap-4">
                                            <div class="text-3xl">üìú</div>
                                            <div>
                                                <h4 class="font-semibold">Certified Course Administrator</h4>
                                                <p class="text-sm text-gray-600">Astegni Education Platform</p>
                                            </div>
                                        </div>
                                        <div class="text-right">
                                            <span class="px-3 py-1 bg-green-100 text-green-800 rounded-full text-xs font-semibold">Verified</span>
                                            <p class="text-xs text-gray-500 mt-1">Issued: Jan 2024</p>
                                        </div>
                                    </div>
                                    <div class="flex items-center justify-between p-4 bg-purple-50 rounded-lg border-l-4 border-purple-500">
                                        <div class="flex items-center gap-4">
                                            <div class="text-3xl">üéì</div>
                                            <div>
                                                <h4 class="font-semibold">Educational Technology Specialist</h4>
                                                <p class="text-sm text-gray-600">International EdTech Association</p>
                                            </div>
                                        </div>
                                        <div class="text-right">
                                            <span class="px-3 py-1 bg-green-100 text-green-800 rounded-full text-xs font-semibold">Verified</span>
                                            <p class="text-xs text-gray-500 mt-1">Issued: Aug 2023</p>
                                        </div>
                                    </div>
                                    <div class="flex items-center justify-between p-4 bg-yellow-50 rounded-lg border-l-4 border-yellow-500">
                                        <div class="flex items-center gap-4">
                                            <div class="text-3xl">üèÖ</div>
                                            <div>
                                                <h4 class="font-semibold">Quality Assurance Professional</h4>
                                                <p class="text-sm text-gray-600">Ethiopian Quality Standards Institute</p>
                                            </div>
                                        </div>
                                        <div class="text-right">
                                            <span class="px-3 py-1 bg-green-100 text-green-800 rounded-full text-xs font-semibold">Verified</span>
                                            <p class="text-xs text-gray-500 mt-1">Issued: Mar 2023</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Experience Section (Hidden by default) -->
                        <div id="credentials-experience-section" class="credentials-section hidden">
                            <!-- Experience Stats -->
                            <div class="dashboard-grid mb-8">
                                <div class="card p-4">
                                    <h3 class="text-gray-600 text-sm font-semibold">Total Experience</h3>
                                    <p class="text-3xl font-bold mt-2 text-blue-500" id="total-experience">4+ Years</p>
                                    <p class="text-sm text-gray-500 mt-1">In Administration</p>
                                </div>
                                <div class="card p-4">
                                    <h3 class="text-gray-600 text-sm font-semibold">Courses Managed</h3>
                                    <p class="text-3xl font-bold mt-2 text-green-500" id="courses-managed">2,500+</p>
                                    <p class="text-sm text-gray-500 mt-1">Lifetime total</p>
                                </div>
                                <div class="card p-4">
                                    <h3 class="text-gray-600 text-sm font-semibold">Teams Led</h3>
                                    <p class="text-3xl font-bold mt-2 text-purple-500" id="teams-led">3</p>
                                    <p class="text-sm text-gray-500 mt-1">Department teams</p>
                                </div>
                                <div class="card p-4">
                                    <h3 class="text-gray-600 text-sm font-semibold">Projects Completed</h3>
                                    <p class="text-3xl font-bold mt-2 text-orange-500" id="projects-completed">45</p>
                                    <p class="text-sm text-gray-500 mt-1">Major initiatives</p>
                                </div>
                            </div>

                            <!-- Work Experience Timeline -->
                            <div class="card p-6 mb-6">
                                <h3 class="text-xl font-semibold mb-6">Work Experience</h3>
                                <div class="space-y-6" id="experience-timeline">
                                    <!-- Current Position -->
                                    <div class="relative pl-8 border-l-4 border-blue-500">
                                        <div class="absolute -left-3 top-0 w-6 h-6 bg-blue-500 rounded-full flex items-center justify-center">
                                            <span class="text-white text-xs">‚úì</span>
                                        </div>
                                        <div class="bg-blue-50 p-4 rounded-lg">
                                            <div class="flex justify-between items-start mb-2">
                                                <div>
                                                    <h4 class="font-bold text-lg">Senior Course Administrator</h4>
                                                    <p class="text-blue-600 font-semibold">Astegni Education Platform</p>
                                                </div>
                                                <span class="px-3 py-1 bg-blue-500 text-white rounded-full text-xs font-semibold">Current</span>
                                            </div>
                                            <p class="text-sm text-gray-600 mb-2">Jan 2023 - Present</p>
                                            <ul class="text-sm text-gray-700 list-disc list-inside space-y-1">
                                                <li>Lead course verification and quality assurance processes</li>
                                                <li>Manage team of 5 junior administrators</li>
                                                <li>Implemented new course review workflows, improving efficiency by 40%</li>
                                                <li>Maintained 99% accuracy rate in course approvals</li>
                                            </ul>
                                        </div>
                                    </div>

                                    <!-- Previous Position 1 -->
                                    <div class="relative pl-8 border-l-4 border-green-500">
                                        <div class="absolute -left-3 top-0 w-6 h-6 bg-green-500 rounded-full flex items-center justify-center">
                                            <span class="text-white text-xs">‚úì</span>
                                        </div>
                                        <div class="bg-green-50 p-4 rounded-lg">
                                            <div class="flex justify-between items-start mb-2">
                                                <div>
                                                    <h4 class="font-bold text-lg">Course Administrator</h4>
                                                    <p class="text-green-600 font-semibold">Astegni Education Platform</p>
                                                </div>
                                                <span class="px-3 py-1 bg-gray-200 text-gray-700 rounded-full text-xs font-semibold">Completed</span>
                                            </div>
                                            <p class="text-sm text-gray-600 mb-2">Jun 2021 - Dec 2022</p>
                                            <ul class="text-sm text-gray-700 list-disc list-inside space-y-1">
                                                <li>Processed 500+ course applications monthly</li>
                                                <li>Developed quality assessment criteria</li>
                                                <li>Trained new team members on verification procedures</li>
                                            </ul>
                                        </div>
                                    </div>

                                    <!-- Previous Position 2 -->
                                    <div class="relative pl-8 border-l-4 border-purple-500">
                                        <div class="absolute -left-3 top-0 w-6 h-6 bg-purple-500 rounded-full flex items-center justify-center">
                                            <span class="text-white text-xs">‚úì</span>
                                        </div>
                                        <div class="bg-purple-50 p-4 rounded-lg">
                                            <div class="flex justify-between items-start mb-2">
                                                <div>
                                                    <h4 class="font-bold text-lg">Junior Administrator</h4>
                                                    <p class="text-purple-600 font-semibold">Astegni Education Platform</p>
                                                </div>
                                                <span class="px-3 py-1 bg-gray-200 text-gray-700 rounded-full text-xs font-semibold">Completed</span>
                                            </div>
                                            <p class="text-sm text-gray-600 mb-2">Jan 2020 - May 2021</p>
                                            <ul class="text-sm text-gray-700 list-disc list-inside space-y-1">
                                                <li>Assisted senior administrators with course reviews</li>
                                                <li>Managed documentation and record keeping</li>
                                                <li>Learned platform systems and workflows</li>
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Skills & Expertise -->
                            <div class="card p-6">
                                <h3 class="text-xl font-semibold mb-4">Skills & Expertise</h3>
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                    <div>
                                        <h4 class="font-semibold mb-3 text-gray-700">Technical Skills</h4>
                                        <div class="space-y-3">
                                            <div>
                                                <div class="flex justify-between mb-1">
                                                    <span class="text-sm">Course Quality Assessment</span>
                                                    <span class="text-sm font-semibold">95%</span>
                                                </div>
                                                <div class="w-full bg-gray-200 rounded-full h-2">
                                                    <div class="bg-blue-500 h-2 rounded-full" style="width: 95%"></div>
                                                </div>
                                            </div>
                                            <div>
                                                <div class="flex justify-between mb-1">
                                                    <span class="text-sm">Content Verification</span>
                                                    <span class="text-sm font-semibold">90%</span>
                                                </div>
                                                <div class="w-full bg-gray-200 rounded-full h-2">
                                                    <div class="bg-green-500 h-2 rounded-full" style="width: 90%"></div>
                                                </div>
                                            </div>
                                            <div>
                                                <div class="flex justify-between mb-1">
                                                    <span class="text-sm">Data Analysis</span>
                                                    <span class="text-sm font-semibold">85%</span>
                                                </div>
                                                <div class="w-full bg-gray-200 rounded-full h-2">
                                                    <div class="bg-purple-500 h-2 rounded-full" style="width: 85%"></div>
                                                </div>
                                            </div>
                                            <div>
                                                <div class="flex justify-between mb-1">
                                                    <span class="text-sm">Platform Management</span>
                                                    <span class="text-sm font-semibold">88%</span>
                                                </div>
                                                <div class="w-full bg-gray-200 rounded-full h-2">
                                                    <div class="bg-orange-500 h-2 rounded-full" style="width: 88%"></div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div>
                                        <h4 class="font-semibold mb-3 text-gray-700">Soft Skills</h4>
                                        <div class="space-y-3">
                                            <div>
                                                <div class="flex justify-between mb-1">
                                                    <span class="text-sm">Communication</span>
                                                    <span class="text-sm font-semibold">92%</span>
                                                </div>
                                                <div class="w-full bg-gray-200 rounded-full h-2">
                                                    <div class="bg-teal-500 h-2 rounded-full" style="width: 92%"></div>
                                                </div>
                                            </div>
                                            <div>
                                                <div class="flex justify-between mb-1">
                                                    <span class="text-sm">Team Leadership</span>
                                                    <span class="text-sm font-semibold">87%</span>
                                                </div>
                                                <div class="w-full bg-gray-200 rounded-full h-2">
                                                    <div class="bg-pink-500 h-2 rounded-full" style="width: 87%"></div>
                                                </div>
                                            </div>
                                            <div>
                                                <div class="flex justify-between mb-1">
                                                    <span class="text-sm">Problem Solving</span>
                                                    <span class="text-sm font-semibold">90%</span>
                                                </div>
                                                <div class="w-full bg-gray-200 rounded-full h-2">
                                                    <div class="bg-indigo-500 h-2 rounded-full" style="width: 90%"></div>
                                                </div>
                                            </div>
                                            <div>
                                                <div class="flex justify-between mb-1">
                                                    <span class="text-sm">Time Management</span>
                                                    <span class="text-sm font-semibold">94%</span>
                                                </div>
                                                <div class="w-full bg-gray-200 rounded-full h-2">
                                                    <div class="bg-yellow-500 h-2 rounded-full" style="width: 94%"></div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Portfolio Panel -->
                    <div id="portfolio-panel" class="panel-content hidden">
                        <div class="mb-8">
                            <h1 class="text-3xl font-bold mb-2">My Portfolio</h1>
                            <p class="text-gray-600">Showcase your work, achievements, and professional accomplishments</p>
                        </div>
                        <!-- Coming Soon -->
                        <div class="flex flex-col items-center justify-center py-20">
                            <div class="w-32 h-32 bg-gradient-to-br from-blue-500 to-purple-600 rounded-full flex items-center justify-center mb-6">
                                <i class="fas fa-folder-open text-white text-5xl"></i>
                            </div>
                            <h2 class="text-2xl font-bold text-gray-700 mb-2">Coming Soon</h2>
                            <p class="text-gray-500 text-center max-w-md">
                                We're working on an amazing portfolio feature where you can showcase your work, achievements, and professional accomplishments. Stay tuned!
                            </p>
                            <div class="mt-6 flex items-center gap-2 text-blue-600">
                                <i class="fas fa-clock"></i>
                                <span class="text-sm">Expected: Q2 2025</span>
                            </div>
                        </div>
                    </div>

                    <!-- Settings Panel -->
                    <div id="settings-panel" class="panel-content hidden">
                        <div class="mb-8">
                            <h1 class="text-3xl font-bold mb-2">Settings</h1>
                            <p class="text-gray-600">Manage your account preferences and configurations</p>
                        </div>
                        <!-- Settings Cards Grid -->
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <!-- Verify Personal Information Card -->
                            <div class="card p-6 hover:shadow-lg transition-shadow cursor-pointer" onclick="openVerifyPersonalInfoModal()">
                                <div class="flex items-start gap-4">
                                    <div class="w-14 h-14 bg-blue-100 rounded-xl flex items-center justify-center flex-shrink-0">
                                        <i class="fas fa-user-check text-blue-600 text-2xl"></i>
                                    </div>
                                    <div class="flex-1">
                                        <h3 class="font-bold text-lg mb-1">Verify Personal Information</h3>
                                        <p class="text-gray-600 text-sm mb-3">Update and verify your personal details, contact information, and identity documents.</p>
                                        <div class="flex items-center gap-2">
                                            <span class="px-2 py-1 bg-yellow-100 text-yellow-700 text-xs rounded-full">
                                                <i class="fas fa-exclamation-circle mr-1"></i> Action Required
                                            </span>
                                        </div>
                                    </div>
                                    <i class="fas fa-chevron-right text-gray-400"></i>
                                </div>
                            </div>
                            <!-- Add Payment Method Card -->
                            <div class="card p-6 hover:shadow-lg transition-shadow cursor-pointer" onclick="openAddPaymentMethodModal()">
                                <div class="flex items-start gap-4">
                                    <div class="w-14 h-14 bg-green-100 rounded-xl flex items-center justify-center flex-shrink-0">
                                        <i class="fas fa-credit-card text-green-600 text-2xl"></i>
                                    </div>
                                    <div class="flex-1">
                                        <h3 class="font-bold text-lg mb-1">Add Payment Method</h3>
                                        <p class="text-gray-600 text-sm mb-3">Add or manage your payment methods for receiving salary and bonuses.</p>
                                        <div class="flex items-center gap-2">
                                            <span class="px-2 py-1 bg-gray-100 text-gray-600 text-xs rounded-full">
                                                <i class="fas fa-wallet mr-1"></i> 0 Methods Added
                                            </span>
                                        </div>
                                    </div>
                                    <i class="fas fa-chevron-right text-gray-400"></i>
                                </div>
                            </div>
                            <!-- File a Leave Request Card -->
                            <div class="card p-6 hover:shadow-lg transition-shadow cursor-pointer" onclick="openLeaveRequestModal()">
                                <div class="flex items-start gap-4">
                                    <div class="w-14 h-14 bg-purple-100 rounded-xl flex items-center justify-center flex-shrink-0">
                                        <i class="fas fa-calendar-minus text-purple-600 text-2xl"></i>
                                    </div>
                                    <div class="flex-1">
                                        <h3 class="font-bold text-lg mb-1">File a Leave Request</h3>
                                        <p class="text-gray-600 text-sm mb-3">Request time off for vacation, sick leave, or personal matters.</p>
                                        <div class="flex items-center gap-2">
                                            <span class="px-2 py-1 bg-blue-100 text-blue-600 text-xs rounded-full">
                                                <i class="fas fa-info-circle mr-1"></i> 15 Days Available
                                            </span>
                                        </div>
                                    </div>
                                    <i class="fas fa-chevron-right text-gray-400"></i>
                                </div>
                            </div>
                            <!-- Resign Card -->
                            <div class="card p-6 hover:shadow-lg transition-shadow cursor-pointer border-red-100" onclick="openResignModal()">
                                <div class="flex items-start gap-4">
                                    <div class="w-14 h-14 bg-red-100 rounded-xl flex items-center justify-center flex-shrink-0">
                                        <i class="fas fa-sign-out-alt text-red-600 text-2xl"></i>
                                    </div>
                                    <div class="flex-1">
                                        <h3 class="font-bold text-lg mb-1 text-red-700">Resign</h3>
                                        <p class="text-gray-600 text-sm mb-3">Submit your resignation and begin the offboarding process.</p>
                                        <div class="flex items-center gap-2">
                                            <span class="px-2 py-1 bg-red-50 text-red-600 text-xs rounded-full">
                                                <i class="fas fa-exclamation-triangle mr-1"></i> Irreversible Action
                                            </span>
                                        </div>
                                    </div>
                                    <i class="fas fa-chevron-right text-gray-400"></i>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Right Sidebar Widgets (Persistent across all panels) -->
                <div class="admin-right-widgets"
                    style="width: 320px !important; flex-shrink: 0 !important; position: sticky !important; top: 5rem !important; height: fit-content !important;">
                    <!-- Course Requests Widget -->
                    <div class="admin-widget-card course-requests-widget">
                        <h3 class="text-lg font-semibold mb-4">
                            üìö Live Course Requests
                            <span class="live-indicator ml-2 text-xs text-green-500">
                                <span class="inline-block w-2 h-2 bg-green-500 rounded-full animate-pulse"></span>
                                Live
                            </span>
                        </h3>
                        <div class="course-requests-container">
                            <div class="course-requests-scroll">
                                <!-- Live course requests loaded from database by manage-courses-live-widget.js -->
                            </div>
                        </div>
                        <div class="course-requests-fade-top"></div>
                        <div class="course-requests-fade-bottom"></div>
                    </div>

                    <!-- Daily Quota Widget -->
                    <div class="admin-widget-card">
                        <h3 class="text-lg font-semibold mb-4">Daily Quota</h3>
                        <div class="space-y-3">
                            <!-- Daily quotas loaded from database by manage-courses-dashboard-loader.js -->
                        </div>
                    </div>

                    <!-- Fire Streak Widget -->
                    <div class="admin-widget-card">
                        <h3 class="text-lg font-semibold mb-4">üî• Fire Streak</h3>
                        <div class="text-center">
                            <div class="text-4xl font-bold text-orange-500">...</div>
                            <div class="text-sm text-gray-600">Days</div>
                            <div class="mt-4 grid grid-cols-7 gap-1">
                                <!-- Weekly pattern loaded from database by manage-courses-dashboard-loader.js -->
                            </div>
                            <div class="text-xs text-gray-500 mt-2">Keep the streak alive!</div>
                        </div>
                    </div>
                </div>
                <!-- End of admin-right-widgets -->

            </div>
            <!-- End of flex gap-6 container -->

        </div>
        <!-- End of container mx-auto px-4 -->
    </section>

    <!-- Add Course Modal -->
    <div id="add-course-modal"
        class="fixed inset-0 bg-black bg-opacity-50 hidden flex items-center justify-center z-20">
        <div class="modal-content p-6 rounded-lg w-full max-w-2xl max-h-[80vh] overflow-y-auto">
            <h3 class="text-2xl font-bold mb-4">Add New Course</h3>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div>
                    <label class="block mb-2 font-semibold">Course Title *</label>
                    <input type="text" id="courseTitle" class="w-full p-2 border rounded-lg"
                        placeholder="e.g., Advanced Mathematics">
                </div>
                <div>
                    <label class="block mb-2 font-semibold">Category *</label>
                    <select id="courseCategory" class="w-full p-2 border rounded-lg">
                        <option value="">Select Category</option>
                        <option>Mathematics</option>
                        <option>Science</option>
                        <option>Languages</option>
                        <option>Technology</option>
                        <option>Business</option>
                        <option>Arts</option>
                        <option>Social Studies</option>
                        <option>Physical Education</option>
                    </select>
                </div>
                <div>
                    <label class="block mb-2 font-semibold">Level *</label>
                    <select id="courseLevel" class="w-full p-2 border rounded-lg">
                        <option value="">Select Level</option>
                        <option>KG</option>
                        <option>Grade 1-6</option>
                        <option>Grade 7-8</option>
                        <option>Grade 9-10</option>
                        <option>Grade 11-12</option>
                        <option>University</option>
                        <option>Professional</option>
                    </select>
                </div>
                <div>
                    <label class="block mb-2 font-semibold">Requested By</label>
                    <input type="text" id="requestedBy" class="w-full p-2 border rounded-lg"
                        placeholder="Student/User name (optional)">
                </div>
            </div>

            <div class="mt-4">
                <label class="block mb-2 font-semibold">Course Description</label>
                <textarea id="courseDescription" rows="3" class="w-full p-2 border rounded-lg"
                    placeholder="Brief description of the course..."></textarea>
            </div>

            <div class="flex justify-end gap-3 mt-6">
                <button onclick="closeAddCourseModal()"
                    class="px-6 py-2 border rounded-lg hover:bg-gray-50">Cancel</button>
                <button onclick="saveCourse()"
                    class="px-6 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600">Save Course</button>
            </div>
        </div>
    </div>

    <!-- View Course Details Modal -->
    <div id="view-course-modal"
        class="fixed inset-0 bg-black bg-opacity-50 hidden flex items-center justify-center z-20">
        <div class="modal-content p-6 rounded-lg w-full max-w-3xl max-h-[85vh] overflow-y-auto">
            <div class="flex justify-between items-start mb-4">
                <div>
                    <h3 class="text-2xl font-bold" id="view-course-title">Course Title</h3>
                    <p class="text-gray-500 text-sm" id="view-course-id">ID: CRS-001</p>
                </div>
                <button onclick="closeViewCourseModal()"
                    class="text-gray-400 hover:text-gray-600 text-3xl">&times;</button>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                <!-- Course Info -->
                <div class="space-y-4">
                    <div>
                        <label class="block text-sm font-semibold text-gray-600 mb-1">Category</label>
                        <p class="text-lg" id="view-course-category">Mathematics</p>
                    </div>
                    <div>
                        <label class="block text-sm font-semibold text-gray-600 mb-1">Level</label>
                        <p class="text-lg" id="view-course-level">Grade 12</p>
                    </div>
                    <div>
                        <label class="block text-sm font-semibold text-gray-600 mb-1">Requested By</label>
                        <p class="text-lg" id="view-course-requester">Sara Tadesse</p>
                    </div>
                </div>

                <!-- Stats -->
                <div class="space-y-4">
                    <div>
                        <label class="block text-sm font-semibold text-gray-600 mb-1">Status</label>
                        <p class="text-lg" id="view-course-status">
                            <span
                                class="px-3 py-1 rounded-full text-xs font-semibold bg-yellow-100 text-yellow-800">Pending</span>
                        </p>
                    </div>
                    <div>
                        <label class="block text-sm font-semibold text-gray-600 mb-1">Submitted</label>
                        <p class="text-lg" id="view-course-submitted">2 days ago</p>
                    </div>
                    <div id="view-course-rating-section" class="hidden">
                        <label class="block text-sm font-semibold text-gray-600 mb-1">Rating</label>
                        <p class="text-lg" id="view-course-rating">‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ (4.8)</p>
                    </div>
                    <div id="view-course-students-section" class="hidden">
                        <label class="block text-sm font-semibold text-gray-600 mb-1">Enrolled Students</label>
                        <p class="text-lg font-bold text-blue-600" id="view-course-students">1,250</p>
                    </div>
                </div>
            </div>

            <!-- Description -->
            <div class="mb-6">
                <label class="block text-sm font-semibold text-gray-600 mb-2">Description</label>
                <div class="bg-gray-50 p-4 rounded-lg border border-gray-200">
                    <p class="text-gray-700" id="view-course-description">No description available.</p>
                </div>
            </div>

            <!-- Rejection/Suspension Reason (if applicable) -->
            <div id="view-course-reason-section" class="mb-6 hidden">
                <label class="block text-sm font-semibold text-gray-600 mb-2" id="view-course-reason-label">Rejection
                    Reason</label>
                <div class="bg-red-50 p-4 rounded-lg border border-red-200">
                    <p class="text-red-700" id="view-course-reason">Quality issues detected</p>
                </div>
            </div>

            <!-- Notification Status (for verified courses) -->
            <div id="view-course-notification-section" class="mb-6 hidden">
                <label class="block text-sm font-semibold text-gray-600 mb-2">Notification Status</label>
                <p id="view-course-notification">
                    <span class="px-3 py-1 rounded-full text-xs font-semibold bg-gray-100 text-gray-800">
                        <i class="fas fa-times-circle"></i> Not Sent
                    </span>
                </p>
            </div>

            <!-- Action Buttons -->
            <div class="flex justify-end gap-3 border-t pt-4">
                <button onclick="closeViewCourseModal()"
                    class="px-6 py-2 border rounded-lg hover:bg-gray-50">Close</button>
                <div id="view-course-actions"></div>
            </div>
        </div>
    </div>

    <!-- Edit Course Request Modal -->
    <div id="edit-course-modal"
        class="fixed inset-0 bg-black bg-opacity-50 hidden flex items-center justify-center z-20">
        <div class="modal-content p-6 rounded-lg w-full max-w-3xl max-h-[85vh] overflow-y-auto">
            <div class="flex justify-between items-start mb-4">
                <div>
                    <h3 class="text-2xl font-bold">Edit Course Request</h3>
                    <p class="text-gray-500 text-sm" id="edit-course-id">ID: REQ-CRS-001</p>
                </div>
                <button onclick="closeEditCourseModal()"
                    class="text-gray-400 hover:text-gray-600 text-3xl">&times;</button>
            </div>

            <form id="editCourseForm" onsubmit="handleCourseUpdate(event)">
                <input type="hidden" id="editCourseRequestId">

                <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                    <!-- Course Info -->
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-semibold text-gray-600 mb-1">Course Title *</label>
                            <input type="text" id="editCourseTitle" class="w-full p-2 border rounded-lg" required>
                        </div>
                        <div>
                            <label class="block text-sm font-semibold text-gray-600 mb-1">Category *</label>
                            <select id="editCourseCategory" class="w-full p-2 border rounded-lg" required>
                                <option value="">Select Category</option>
                                <option value="Mathematics">Mathematics</option>
                                <option value="Science">Science</option>
                                <option value="Languages">Languages</option>
                                <option value="Technology">Technology</option>
                                <option value="Business">Business</option>
                                <option value="Arts">Arts</option>
                                <option value="Social Studies">Social Studies</option>
                                <option value="Physical Education">Physical Education</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-semibold text-gray-600 mb-1">Level *</label>
                            <select id="editCourseLevel" class="w-full p-2 border rounded-lg" required>
                                <option value="">Select Level</option>
                                <option value="KG">KG</option>
                                <option value="Grade 1-6">Grade 1-6</option>
                                <option value="Grade 7-8">Grade 7-8</option>
                                <option value="Grade 9-10">Grade 9-10</option>
                                <option value="Grade 11-12">Grade 11-12</option>
                                <option value="University">University</option>
                                <option value="Professional">Professional</option>
                            </select>
                        </div>
                    </div>

                    <!-- Additional Info -->
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-semibold text-gray-600 mb-1">Requested By *</label>
                            <input type="text" id="editCourseRequester" class="w-full p-2 border rounded-lg" required>
                        </div>
                        <div>
                            <label class="block text-sm font-semibold text-gray-600 mb-1">Status (Read-only)</label>
                            <input type="text" id="editCourseStatus" class="w-full p-2 border rounded-lg bg-gray-100"
                                disabled>
                        </div>
                    </div>
                </div>

                <!-- Description -->
                <div class="mb-6">
                    <label class="block text-sm font-semibold text-gray-600 mb-2">Description *</label>
                    <textarea id="editCourseDescription" rows="4" class="w-full p-3 border rounded-lg"
                        required></textarea>
                </div>

                <!-- Action Buttons -->
                <div class="flex justify-end gap-3 border-t pt-4">
                    <button type="button" onclick="closeEditCourseModal()"
                        class="px-6 py-2 border rounded-lg hover:bg-gray-50">Cancel</button>
                    <button type="submit"
                        class="px-6 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600">
                        <i class="fas fa-save"></i> Save Changes
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Send Notification Modal -->
    <div id="send-notification-modal"
        class="fixed inset-0 bg-black bg-opacity-50 hidden flex items-center justify-center z-20">
        <div class="modal-content p-6 rounded-lg w-full max-w-2xl max-h-[80vh] overflow-y-auto">
            <h3 class="text-2xl font-bold mb-2">Send Course Notification to Tutors</h3>
            <p class="text-gray-600 mb-6">Notify relevant tutors about this course opportunity</p>

            <div class="bg-blue-50 border-l-4 border-blue-500 p-4 mb-6">
                <div class="flex items-start">
                    <i class="fas fa-info-circle text-blue-500 mr-3 mt-1"></i>
                    <div class="flex-1">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-3 mb-2">
                            <div>
                                <p class="text-xs text-blue-600 font-semibold mb-1">Course Title:</p>
                                <p class="text-sm text-blue-900 font-bold" id="notification-course-title">N/A</p>
                            </div>
                            <div>
                                <p class="text-xs text-blue-600 font-semibold mb-1">Course Level:</p>
                                <p class="text-sm text-blue-900 font-bold" id="notification-course-level">N/A</p>
                            </div>
                        </div>
                        <div class="border-t border-blue-200 pt-2 mt-2">
                            <p class="text-xs text-blue-600 font-semibold mb-1">Course ID:</p>
                            <p class="text-sm text-blue-700 font-mono" id="notification-course-id">N/A</p>
                        </div>
                        <p class="text-xs text-blue-600 mt-3 italic">
                            <i class="fas fa-lightbulb"></i>
                            This notification will alert tutors that there is demand for this course in the market.
                        </p>
                    </div>
                </div>
            </div>

            <div class="space-y-4">
                <div>
                    <label class="block mb-2 font-semibold">Target Audience *</label>
                    <select id="targetAudience" class="w-full p-3 border rounded-lg">
                        <option value="">Select Target Audience</option>
                        <option value="All Tutors">All Tutors</option>
                        <option value="Mathematics Tutors">Mathematics Tutors</option>
                        <option value="Science Tutors">Science Tutors</option>
                        <option value="Language Tutors">Language Tutors</option>
                        <option value="Technology Tutors">Technology Tutors</option>
                        <option value="Business Tutors">Business Tutors</option>
                        <option value="Arts Tutors">Arts Tutors</option>
                        <option value="High-Rated Tutors (4+ stars)">High-Rated Tutors (4+ stars)</option>
                        <option value="Verified Tutors Only">Verified Tutors Only</option>
                    </select>
                </div>

                <div>
                    <label class="block mb-2 font-semibold">Notification Message *</label>
                    <textarea id="notificationMessage" rows="6" class="w-full p-3 border rounded-lg font-mono text-sm">Dear Tutors,

We've identified a market need for this course. Students are actively searching for it. If you have expertise in this area, please consider creating course content to meet this demand.

Best regards,
Astegni Team</textarea>
                    <p class="text-xs text-gray-500 mt-1">
                        <i class="fas fa-info-circle"></i>
                        Tip: Use **text** for bold formatting. The course name will be auto-populated.
                    </p>
                </div>

                <div class="bg-yellow-50 border-l-4 border-yellow-500 p-4">
                    <div class="flex items-start">
                        <i class="fas fa-exclamation-triangle text-yellow-500 mr-3 mt-1"></i>
                        <div class="text-sm text-yellow-700">
                            <strong>Note:</strong> Notifications will be sent via:
                            <ul class="list-disc ml-5 mt-2">
                                <li>In-app notifications</li>
                                <li>Email (if tutor has email notifications enabled)</li>
                                <li>SMS (for premium tutors)</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>

            <div class="flex justify-end gap-3 mt-6">
                <button onclick="closeSendNotificationModal()"
                    class="px-6 py-2 border rounded-lg hover:bg-gray-50">Cancel</button>
                <button onclick="confirmSendNotification()"
                    class="px-6 py-2 bg-purple-500 text-white rounded-lg hover:bg-purple-600 flex items-center gap-2">
                    <i class="fas fa-paper-plane"></i>
                    Send Notification
                </button>
            </div>
        </div>
    </div>

    <!-- Reject Course/Request Modal -->
    <div id="reject-course-modal"
        class="fixed inset-0 bg-black bg-opacity-50 hidden flex items-center justify-center z-20">
        <div class="modal-content p-6 rounded-lg w-full max-w-lg max-h-[80vh] overflow-y-auto">
            <h3 class="text-2xl font-bold mb-2 text-red-600">
                <i class="fas fa-times-circle"></i> Reject Course
            </h3>
            <p class="text-gray-600 mb-6">Please provide a detailed reason for rejecting this course</p>

            <div class="bg-red-50 border-l-4 border-red-500 p-4 mb-6">
                <div class="flex items-start">
                    <i class="fas fa-exclamation-triangle text-red-500 mr-3 mt-1"></i>
                    <div class="text-sm text-red-700">
                        <strong>Important:</strong> The course creator will be notified of this rejection and the reason you provide.
                    </div>
                </div>
            </div>

            <div class="mb-6">
                <label class="block mb-2 font-semibold">Rejection Reason *</label>
                <textarea id="rejectionReason" rows="5" class="w-full p-3 border-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500"
                    placeholder="e.g., Content does not meet quality standards, Insufficient detail, Duplicate course, etc."></textarea>
                <p class="text-xs text-gray-500 mt-1">
                    <i class="fas fa-info-circle"></i>
                    Please be specific to help the course creator understand what needs improvement.
                </p>
            </div>

            <div class="flex justify-end gap-3">
                <button onclick="closeRejectModal()"
                    class="px-6 py-2 border rounded-lg hover:bg-gray-50">Cancel</button>
                <button onclick="confirmReject()"
                    class="px-6 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 flex items-center gap-2">
                    <i class="fas fa-times"></i>
                    Confirm Rejection
                </button>
            </div>
        </div>
    </div>

    <!-- Suspend Course Modal -->
    <div id="suspend-course-modal"
        class="fixed inset-0 bg-black bg-opacity-50 hidden flex items-center justify-center z-20">
        <div class="modal-content p-6 rounded-lg w-full max-w-lg max-h-[80vh] overflow-y-auto">
            <h3 class="text-2xl font-bold mb-2 text-orange-600">
                <i class="fas fa-pause-circle"></i> Suspend Course
            </h3>
            <p class="text-gray-600 mb-6">Please provide a reason for temporarily suspending this course</p>

            <div class="bg-orange-50 border-l-4 border-orange-500 p-4 mb-6">
                <div class="flex items-start">
                    <i class="fas fa-info-circle text-orange-500 mr-3 mt-1"></i>
                    <div class="text-sm text-orange-700">
                        <strong>Note:</strong> Suspension is temporary. The course creator will be notified and the course can be reinstated later.
                    </div>
                </div>
            </div>

            <div class="mb-6">
                <label class="block mb-2 font-semibold">Suspension Reason *</label>
                <textarea id="suspensionReason" rows="5" class="w-full p-3 border-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500"
                    placeholder="e.g., Quality issues reported, Under investigation, Student complaints, etc."></textarea>
                <p class="text-xs text-gray-500 mt-1">
                    <i class="fas fa-info-circle"></i>
                    This reason will be shared with the course creator.
                </p>
            </div>

            <div class="flex justify-end gap-3">
                <button onclick="closeSuspendModal()"
                    class="px-6 py-2 border rounded-lg hover:bg-gray-50">Cancel</button>
                <button onclick="confirmSuspend()"
                    class="px-6 py-2 bg-orange-500 text-white rounded-lg hover:bg-orange-600 flex items-center gap-2">
                    <i class="fas fa-pause"></i>
                    Confirm Suspension
                </button>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="footer-section mt-16">
        <div class="container mx-auto px-4 py-8">
            <div class="text-center">
                <p>&copy; 2025 Astegni. All rights reserved. | Admin Panel</p>
            </div>
        </div>
    </footer>

    <!-- Scripts -->
    <script src="./js/api-config.js"></script>
    <script src="./js/auth.js"></script>

    <!-- Admin DB Service - reads from astegni_admin_db -->
    <script src="./js/admin-pages/shared/admin-api-service.js"></script>
    <script src="./js/admin-pages/shared/array-field-utils.js"></script>
    <script src="./js/admin-pages/shared/geolocation-utils.js"></script>

    <!-- Standalone Script - All Navigation & Panel Management -->
    <script src="./js/admin-pages/manage-courses-standalone.js"></script>

    <!-- Data Loading Scripts (keep for database integration) -->
    <script src="./js/admin-pages/manage-courses-db-loader.js"></script>
    <script src="./js/admin-pages/manage-courses-search-filter.js"></script>
    <script src="./js/admin-pages/manage-courses-live-widget.js"></script>
    <script src="./js/admin-pages/manage-courses-reviews.js"></script>
    <script src="./js/admin-pages/manage-courses-dashboard-loader.js"></script>
    <script src="./js/admin-pages/manage-courses-stat-filters.js"></script>
    <script src="./js/admin-pages/manage-courses-profile-edit.js"></script>
    <script src="./js/admin-pages/admin-email-otp-verification.js"></script>
    <script src="./js/admin-pages/shared/admin-credentials-manager.js"></script>

    <!-- Nav Clock and Profile Dropdown -->
    <script>
        // ===== SIDEBAR TOGGLE (Global Function) =====
        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            const hamburger = document.getElementById('hamburger');
            if (sidebar) {
                sidebar.classList.toggle('active');
                if (hamburger) {
                    hamburger.classList.toggle('active');
                }
                // Prevent background scroll when sidebar is open
                if (sidebar.classList.contains('active')) {
                    document.body.style.overflow = 'hidden';
                } else {
                    document.body.style.overflow = '';
                }
                console.log('Sidebar toggled:', sidebar.classList.contains('active') ? 'OPEN' : 'CLOSED');
            } else {
                console.error('Sidebar element not found!');
            }
        }

        // Close sidebar when clicking outside
        document.addEventListener('click', function(e) {
            const sidebar = document.getElementById('sidebar');
            const hamburger = document.getElementById('hamburger');
            if (sidebar && sidebar.classList.contains('active')) {
                if (!sidebar.contains(e.target) && !hamburger.contains(e.target)) {
                    sidebar.classList.remove('active');
                    hamburger.classList.remove('active');
                    document.body.style.overflow = '';
                }
            }
        });

        // Close sidebar on ESC key
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                const sidebar = document.getElementById('sidebar');
                const hamburger = document.getElementById('hamburger');
                if (sidebar && sidebar.classList.contains('active')) {
                    sidebar.classList.remove('active');
                    if (hamburger) hamburger.classList.remove('active');
                    document.body.style.overflow = '';
                }
            }
        });

        // ===== LIVE CLOCK =====
        function updateClock() {
            const now = new Date();
            const timeEl = document.getElementById('current-time');
            const dateEl = document.getElementById('current-date');

            if (timeEl) {
                timeEl.textContent = now.toLocaleTimeString('en-US', {
                    hour: '2-digit',
                    minute: '2-digit',
                    second: '2-digit',
                    hour12: true
                });
            }

            if (dateEl) {
                dateEl.textContent = now.toLocaleDateString('en-US', {
                    weekday: 'short',
                    month: 'short',
                    day: 'numeric',
                    year: 'numeric'
                });
            }
        }

        // Start clock
        updateClock();
        setInterval(updateClock, 1000);

        // ===== PROFILE DROPDOWN =====
        function toggleProfileDropdown() {
            const menu = document.getElementById('profile-dropdown-menu');
            const toggle = document.getElementById('profile-dropdown-toggle');

            if (menu) {
                menu.classList.toggle('hidden');
                toggle?.setAttribute('aria-expanded', !menu.classList.contains('hidden'));
            }
        }

        // Close dropdown when clicking outside
        document.addEventListener('click', function(event) {
            const container = document.getElementById('profile-container');
            const menu = document.getElementById('profile-dropdown-menu');

            if (container && menu && !container.contains(event.target)) {
                menu.classList.add('hidden');
                document.getElementById('profile-dropdown-toggle')?.setAttribute('aria-expanded', 'false');
            }
        });

        // ===== NAV PROFILE LOADER =====
        async function loadNavProfile() {
            // Use global API_BASE_URL set by api-config.js
            const API_BASE_URL = window.API_BASE_URL || 'http://localhost:8000';

            // Get user email from auth/localStorage
            let userEmail = null;

            // Try authManager
            if (typeof authManager !== 'undefined' && authManager?.getCurrentUser) {
                const user = authManager.getCurrentUser();
                if (user?.email) userEmail = user.email;
            }

            // Try localStorage currentUser
            if (!userEmail) {
                const storedUser = localStorage.getItem('currentUser');
                if (storedUser) {
                    try {
                        const user = JSON.parse(storedUser);
                        if (user.email) userEmail = user.email;
                    } catch (e) {}
                }
            }

            // Try JWT token
            if (!userEmail) {
                const token = localStorage.getItem('access_token') || localStorage.getItem('token');
                if (token) {
                    try {
                        const base64Url = token.split('.')[1];
                        const base64 = base64Url.replace(/-/g, '+').replace(/_/g, '/');
                        const payload = JSON.parse(atob(base64));
                        if (payload.email) userEmail = payload.email;
                    } catch (e) {}
                }
            }

            if (!userEmail) {
                console.log('No user email found for nav profile');
                return;
            }

            try {
                // Fetch profile from admin_profile database via API
                const response = await fetch(`${API_BASE_URL}/api/admin/courses/profile/by-email/${encodeURIComponent(userEmail)}`);

                if (!response.ok) {
                    console.error('Failed to fetch admin profile for nav');
                    return;
                }

                const profileData = await response.json();
                console.log('Nav profile data loaded:', profileData);

                // Update nav profile elements
                const navName = document.getElementById('profile-name');
                const navPic = document.getElementById('profile-pic');
                const dropdownName = document.getElementById('dropdown-user-name');
                const dropdownEmail = document.getElementById('dropdown-user-email');
                const dropdownRole = document.getElementById('dropdown-user-role');
                const dropdownPic = document.getElementById('dropdown-profile-pic');

                // Build display name from admin_profile (Ethiopian naming: first_name + father_name)
                const firstName = profileData.first_name || '';
                const fatherName = profileData.father_name || '';
                const username = profileData.username;
                const displayName = username || `${firstName} ${fatherName}`.trim() ||
                    (profileData.email?.[0] ? profileData.email[0].split('@')[0] : 'Admin');

                // Update nav toggle
                if (navName) navName.textContent = displayName;

                // Update dropdown header
                if (dropdownName) dropdownName.textContent = `${firstName} ${fatherName}`.trim() || displayName;
                if (dropdownEmail) dropdownEmail.textContent = profileData.email?.[0] || '';
                if (dropdownRole) {
                    // Show current department name from localStorage (preserve system-settings)
                    const adminUser = JSON.parse(localStorage.getItem('adminUser') || '{}');
                    const currentDept = adminUser.department || 'manage-courses';
                    dropdownRole.textContent = formatDepartmentName(currentDept);
                }

                // Profile picture from database
                const profileImage = profileData.courses_profile?.profile_image || profileData.profile_image;
                if (profileImage) {
                    if (navPic) navPic.src = profileImage;
                    if (dropdownPic) dropdownPic.src = profileImage;
                } else {
                    // Generate avatar with initials
                    const initials = (firstName?.[0] || 'A').toUpperCase();
                    const avatarSvg = `data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='100' height='100' viewBox='0 0 100 100'%3E%3Ccircle cx='50' cy='50' r='50' fill='%234F46E5'/%3E%3Ctext x='50' y='50' text-anchor='middle' dy='.3em' fill='white' font-size='40' font-family='Arial'%3E${initials}%3C/text%3E%3C/svg%3E`;
                    if (navPic) navPic.src = avatarSvg;
                    if (dropdownPic) dropdownPic.src = avatarSvg;
                }

                // Load departments from admin_profile.departments array
                loadDepartmentSwitcher(profileData);

                // Show user controls (profile container)
                const userControls = document.getElementById('user-controls');
                if (userControls) {
                    userControls.style.display = 'flex';
                }

            } catch (error) {
                console.error('Error loading nav profile:', error);
            }
        }

        // ===== DEPARTMENT SWITCHER =====
        function loadDepartmentSwitcher(profileData) {
            const switcher = document.getElementById('department-switcher-section');
            const options = document.getElementById('department-options');

            if (!switcher || !options) return;

            // Get departments from admin_profile.departments (TEXT[] array from database)
            let departments = profileData?.departments || [];

            // If departments is not an array or empty, hide switcher
            if (!Array.isArray(departments) || departments.length === 0) {
                switcher.classList.add('hidden');
                return;
            }

            // Get current department from localStorage (do NOT modify it)
            const adminUser = JSON.parse(localStorage.getItem('adminUser') || '{}');
            const currentDept = adminUser.department;

            // Check if user is from system-settings department (has access to all departments)
            const isSystemSettings = currentDept === 'manage-system-settings' ||
                                     departments.includes('manage-system-settings');

            // System-settings users have full access - hide the department switcher
            if (isSystemSettings) {
                switcher.classList.add('hidden');
                return;
            }

            // Show department switcher only if user has multiple departments
            if (departments.length > 1) {
                switcher.classList.remove('hidden');

                options.innerHTML = departments.map(dept => {
                    const isActive = dept === currentDept;
                    const icon = getDepartmentIcon(dept);
                    const label = formatDepartmentName(dept);

                    return `
                        <a href="${getDepartmentLink(dept)}" class="department-option ${isActive ? 'active' : ''}">
                            <i class="fas ${icon}"></i>
                            <span>${label}</span>
                            ${isActive ? '<i class="fas fa-check ml-auto text-green-500"></i>' : ''}
                        </a>
                    `;
                }).join('');
            } else {
                // Single department, hide switcher
                switcher.classList.add('hidden');
            }
        }

        function getDepartmentIcon(dept) {
            const icons = {
                'manage-courses': 'fa-graduation-cap',
                'manage-schools': 'fa-school',
                'manage-campaigns': 'fa-bullhorn',
                'manage-credentials': 'fa-certificate',
                'manage-contents': 'fa-photo-video',
                'manage-customers': 'fa-users',
                'manage-system-settings': 'fa-cog'
            };
            return icons[dept] || 'fa-folder';
        }

        function formatDepartmentName(dept) {
            // Format as "Manage Courses", "Manage Schools", etc.
            return dept.split('-').map(
                word => word.charAt(0).toUpperCase() + word.slice(1)
            ).join(' ');
        }

        function getDepartmentLink(dept) {
            return `${dept}.html`;
        }

        // ===== LOGOUT =====
        function handleLogout() {
            if (typeof authManager !== 'undefined' && authManager) {
                authManager.logout();
            } else {
                localStorage.removeItem('token');
                localStorage.removeItem('access_token');
                localStorage.removeItem('refresh_token');
                localStorage.removeItem('currentUser');
            }
            window.location.href = 'admin-index.html';
        }

        // Initialize nav profile on load
        document.addEventListener('DOMContentLoaded', function() {
            setTimeout(loadNavProfile, 500);
        });
    </script>

    <!-- Fix theme background -->
    <script>
        // Switch between Achievements and Experience sections in Credentials panel
        function switchCredentialsSection(section) {
            const achievementsTab = document.getElementById('achievements-tab');
            const experienceTab = document.getElementById('experience-tab');
            const achievementsSection = document.getElementById('credentials-achievements-section');
            const experienceSection = document.getElementById('credentials-experience-section');

            if (section === 'achievements') {
                // Show achievements, hide experience
                achievementsSection.classList.remove('hidden');
                experienceSection.classList.add('hidden');
                // Update tab styles
                achievementsTab.classList.remove('bg-gray-100', 'hover:bg-gray-200');
                achievementsTab.classList.add('bg-blue-500', 'text-white');
                experienceTab.classList.remove('bg-blue-500', 'text-white');
                experienceTab.classList.add('bg-gray-100', 'hover:bg-gray-200');
            } else if (section === 'experience') {
                // Show experience, hide achievements
                experienceSection.classList.remove('hidden');
                achievementsSection.classList.add('hidden');
                // Update tab styles
                experienceTab.classList.remove('bg-gray-100', 'hover:bg-gray-200');
                experienceTab.classList.add('bg-blue-500', 'text-white');
                achievementsTab.classList.remove('bg-blue-500', 'text-white');
                achievementsTab.classList.add('bg-gray-100', 'hover:bg-gray-200');
            }
        }

        // Logout function for admin pages - redirects to admin index
        function logout() {
            // Check if authManager is available
            if (typeof authManager !== 'undefined' && authManager) {
                // Use authManager logout which clears tokens and user data
                authManager.logout();
                // Redirect to admin pages index
                window.location.href = 'index.html';
            } else if (typeof window.logout === 'function') {
                // Fallback to global logout function from app.js
                window.logout();
                window.location.href = 'index.html';
            } else {
                // Manual logout as last resort
                localStorage.removeItem('token');
                localStorage.removeItem('access_token');
                localStorage.removeItem('refresh_token');
                localStorage.removeItem('currentUser');
                localStorage.removeItem('userRole');
                alert('Logged out successfully');
                window.location.href = 'index.html';
            }
        }

        // Ensure dark theme background is applied correctly
        document.addEventListener('DOMContentLoaded', function () {
            // Force background color application
            function applyThemeBackground() {
                const theme = document.documentElement.getAttribute('data-theme');
                if (theme === 'dark') {
                    document.body.style.backgroundColor = '#1E1E1E';
                    document.documentElement.style.backgroundColor = '#1E1E1E';
                } else {
                    document.body.style.backgroundColor = '#ffffff';
                    document.documentElement.style.backgroundColor = '#ffffff';
                }
            }

            // Apply immediately
            applyThemeBackground();

            // Watch for theme changes
            const observer = new MutationObserver(function (mutations) {
                mutations.forEach(function (mutation) {
                    if (mutation.attributeName === 'data-theme') {
                        applyThemeBackground();
                    }
                });
            });

            observer.observe(document.documentElement, {
                attributes: true,
                attributeFilter: ['data-theme']
            });
        });
    </script>

            <!-- Edit Profile Modal -->
    <!-- This modal edits manage_courses_profile table fields only -->
    <div id="edit-profile-modal" class="modal hidden">
        <div class="modal-overlay" onclick="closeEditProfileModal()"></div>
        <div class="modal-content" style="max-width: 600px;">
            <div class="modal-header">
                <h2 class="text-xl font-bold">Edit Profile</h2>
                <button class="modal-close" onclick="closeEditProfileModal()">&times;</button>
            </div>
            <div class="modal-body">
                <form id="editProfileForm" onsubmit="handleProfileUpdate(event)">
                    <!-- Username (Display Name) -->
                    <div class="form-group mb-4">
                        <label class="block text-sm font-medium mb-1">Username (Display Name) <span class="text-red-500">*</span></label>
                        <input type="text" id="editUsername"
                            class="w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
                            placeholder="e.g., abebe_kebede" required>
                        <p class="text-xs text-gray-500 mt-1">This will be displayed as your admin username</p>
                    </div>

                    <!-- Hero Titles (Array) -->
                    <div class="form-group mb-4">
                        <label class="block text-sm font-medium mb-1">Hero Titles</label>
                        <div id="heroTitleContainer" class="space-y-2">
                            <!-- Dynamic hero title inputs will be added here -->
                        </div>
                        <button type="button" onclick="addHeroTitleField()"
                            class="mt-2 text-sm text-blue-600 hover:text-blue-800 flex items-center gap-1">
                            <i class="fas fa-plus"></i> Add Hero Title
                        </button>
                        <p class="text-xs text-gray-500 mt-1">Add multiple titles (e.g., Course Manager, Content Lead)</p>
                    </div>

                    <!-- Hero Subtitle -->
                    <div class="form-group mb-4">
                        <label class="block text-sm font-medium mb-1">Hero Subtitle</label>
                        <input type="text" id="editHeroSubtitle"
                            class="w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
                            placeholder="e.g., Astegni Admin Panel">
                    </div>

                    <!-- Bio -->
                    <div class="form-group mb-4">
                        <label class="block text-sm font-medium mb-1">Bio</label>
                        <textarea id="editBio" rows="3"
                            class="w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
                            placeholder="Tell us about yourself..."></textarea>
                    </div>

                    <!-- Quote -->
                    <div class="form-group mb-4">
                        <label class="block text-sm font-medium mb-1">Quote</label>
                        <input type="text" id="editQuote"
                            class="w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
                            placeholder="Your personal quote or motto">
                    </div>

                    <!-- Locations (Array) -->
                    <div class="form-group mb-4">
                        <label class="block text-sm font-medium mb-1">Locations</label>
                        <div id="locationContainer" class="space-y-2">
                            <!-- Dynamic location inputs will be added here -->
                        </div>
                        <button type="button" onclick="addLocationField()"
                            class="mt-2 text-sm text-blue-600 hover:text-blue-800 flex items-center gap-1">
                            <i class="fas fa-plus"></i> Add Location
                        </button>
                        <p class="text-xs text-gray-500 mt-1">Add multiple locations (e.g., Addis Ababa, Bahir Dar)</p>

                        <!-- Allow Location Checkbox with GPS Detection -->
                        <div class="flex items-center mt-3">
                            <input type="checkbox" id="editAllowLocation"
                                class="w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 focus:ring-2"
                                onchange="handleAllowLocationChange(this)">
                            <label for="editAllowLocation" class="ml-2 text-sm font-medium text-gray-700">
                                Allow system to detect my location (GPS)
                            </label>
                        </div>
                        <p class="text-xs text-gray-500 mt-1">Uses GPS/WiFi positioning to detect your physical location (not affected by VPN)</p>

                        <!-- Detect Location Button (shown when checkbox is checked) -->
                        <button type="button" id="detectLocationBtn" onclick="detectCurrentLocation()"
                            class="hidden mt-2 text-sm bg-green-500 text-white px-3 py-1.5 rounded-lg hover:bg-green-600 flex items-center gap-1">
                            <i class="fas fa-location-arrow mr-1"></i> Detect Location
                        </button>
                        <p id="locationStatus" class="hidden text-xs mt-1"></p>

                        <!-- Display Location Checkbox -->
                        <div class="flex items-center mt-3">
                            <input type="checkbox" id="editDisplayLocation"
                                class="w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 focus:ring-2">
                            <label for="editDisplayLocation" class="ml-2 text-sm font-medium text-gray-700">
                                Display location on my public profile
                            </label>
                        </div>
                        <p class="text-xs text-gray-500 mt-1">When enabled, your location will be visible to others on your profile</p>
                    </div>

                    <!-- Languages -->
                    <div class="form-group mb-6">
                        <label class="block text-sm font-medium mb-1">Languages</label>
                        <input type="text" id="editLanguages"
                            class="w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
                            placeholder="e.g., English, Amharic, Oromo">
                        <p class="text-xs text-gray-500 mt-1">Separate multiple languages with commas</p>
                    </div>

                    <div class="modal-footer">
                        <button type="button" class="btn-secondary px-4 py-2 border rounded-lg hover:bg-gray-100"
                            onclick="closeEditProfileModal()">Cancel</button>
                        <button type="submit" id="editProfileSubmitBtn"
                            class="btn-primary px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600">Update
                            Profile</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Upload Profile Picture Modal -->
    <div id="upload-profile-modal" class="modal hidden">
        <div class="modal-overlay" onclick="closeUploadProfileModal()"></div>
        <div class="modal-content" style="max-width: 500px;">
            <div class="modal-header">
                <h2 class="text-xl font-bold">Upload Profile Picture</h2>
                <button class="modal-close" onclick="closeUploadProfileModal()">√ó</button>
            </div>
            <div class="modal-body">
                <div class="upload-area border-2 border-dashed border-gray-300 rounded-lg p-8 text-center mb-4">
                    <svg class="mx-auto h-12 w-12 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12" />
                    </svg>
                    <input type="file" id="profilePictureInput" accept="image/*" class="hidden"
                        onchange="previewProfilePicture(event)">
                    <label for="profilePictureInput" class="cursor-pointer">
                        <p class="mt-2 text-sm text-gray-600">
                            <span class="font-medium text-blue-500 hover:text-blue-600">Click to upload</span> or drag
                            and drop
                        </p>
                        <p class="text-xs text-gray-500">PNG, JPG, GIF up to 5MB</p>
                    </label>
                </div>
                <div id="profilePreview" class="hidden mb-4">
                    <img id="profilePreviewImg" class="w-32 h-32 mx-auto rounded-full object-cover" alt="Preview">
                </div>
                <div class="modal-footer">
                    <button class="btn-secondary px-4 py-2 border rounded-lg hover:bg-gray-100"
                        onclick="closeUploadProfileModal()">Cancel</button>
                    <button id="uploadProfileBtn"
                        class="btn-primary px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600"
                        onclick="handleProfilePictureUpload()">Upload</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Upload Cover Image Modal -->
    <div id="upload-cover-modal" class="modal hidden">
        <div class="modal-overlay" onclick="closeUploadCoverModal()"></div>
        <div class="modal-content" style="max-width: 600px;">
            <div class="modal-header">
                <h2 class="text-xl font-bold">Upload Cover Image</h2>
                <button class="modal-close" onclick="closeUploadCoverModal()">√ó</button>
            </div>
            <div class="modal-body">
                <div class="upload-area border-2 border-dashed border-gray-300 rounded-lg p-8 text-center mb-4">
                    <svg class="mx-auto h-12 w-12 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z" />
                    </svg>
                    <input type="file" id="coverImageInput" accept="image/*" class="hidden"
                        onchange="previewCoverImage(event)">
                    <label for="coverImageInput" class="cursor-pointer">
                        <p class="mt-2 text-sm text-gray-600">
                            <span class="font-medium text-blue-500 hover:text-blue-600">Click to upload</span> or drag
                            and drop
                        </p>
                        <p class="text-xs text-gray-500">Recommended: 1200x300px (PNG, JPG up to 10MB)</p>
                    </label>
                </div>
                <div id="coverPreview" class="hidden mb-4">
                    <img id="coverPreviewImg" class="w-full h-32 object-cover rounded-lg" alt="Preview">
                </div>
                <div class="modal-footer">
                    <button class="btn-secondary px-4 py-2 border rounded-lg hover:bg-gray-100"
                        onclick="closeUploadCoverModal()">Cancel</button>
                    <button id="uploadCoverBtn"
                        class="btn-primary px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600"
                        onclick="handleCoverImageUpload()">Upload</button>
                </div>
            </div>
        </div>
    </div>

    <!-- OTP Email Verification Modal -->
    <div id="otp-email-verification-modal" class="modal hidden">
        <div class="modal-overlay" onclick="closeOTPEmailModal()"></div>
        <div class="modal-content" style="max-width: 550px;">
            <div class="modal-header">
                <h2 class="text-xl font-bold">Change Email Address</h2>
                <button class="modal-close" onclick="closeOTPEmailModal()">√ó</button>
            </div>
            <div class="modal-body">
                <!-- Step 1: Verify Current Email -->
                <div id="otp-step-1" class="otp-step">
                    <div class="bg-blue-50 border-l-4 border-blue-500 p-4 mb-4">
                        <p class="text-sm text-blue-700">
                            <strong>Step 1 of 2:</strong> Verify your current email address for security
                        </p>
                    </div>

                    <div class="mb-4">
                        <label class="block text-sm font-medium mb-2">Current Email</label>
                        <input type="email" id="currentEmailDisplay" class="w-full px-3 py-2 border rounded-lg bg-gray-100" readonly>
                    </div>

                    <div class="mb-4" id="currentEmailOTPSection" style="display: none;">
                        <label class="block text-sm font-medium mb-2">Enter OTP sent to current email</label>
                        <input type="text" id="currentEmailOTP" maxlength="6"
                            class="w-full px-3 py-2 border-2 rounded-lg text-center text-2xl font-mono tracking-widest"
                            placeholder="000000">
                        <p class="text-xs text-gray-500 mt-1" id="currentEmailTimer">OTP expires in 5:00</p>
                    </div>

                    <div class="flex gap-3">
                        <button id="sendCurrentEmailOTPBtn" onclick="sendCurrentEmailOTP()"
                            class="flex-1 px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600">
                            Send OTP to Current Email
                        </button>
                        <button id="verifyCurrentEmailOTPBtn" onclick="verifyCurrentEmailOTP()"
                            class="flex-1 px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600"
                            style="display: none;">
                            Verify OTP
                        </button>
                    </div>

                    <div id="currentEmailStatus" class="mt-3"></div>
                </div>

                <!-- Step 2: Verify New Email -->
                <div id="otp-step-2" class="otp-step" style="display: none;">
                    <div class="bg-green-50 border-l-4 border-green-500 p-4 mb-4">
                        <p class="text-sm text-green-700">
                            ‚úì Current email verified!<br>
                            <strong>Step 2 of 2:</strong> Verify your new email address
                        </p>
                    </div>

                    <div class="mb-4">
                        <label class="block text-sm font-medium mb-2">New Email Address *</label>
                        <input type="email" id="newEmailInput"
                            class="w-full px-3 py-2 border-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
                            placeholder="newemail@example.com">
                        <p class="text-xs text-gray-500 mt-1">Enter the new email address you want to use</p>
                    </div>

                    <div class="mb-4" id="newEmailOTPSection" style="display: none;">
                        <label class="block text-sm font-medium mb-2">Enter OTP sent to new email</label>
                        <input type="text" id="newEmailOTP" maxlength="6"
                            class="w-full px-3 py-2 border-2 rounded-lg text-center text-2xl font-mono tracking-widest"
                            placeholder="000000">
                        <p class="text-xs text-gray-500 mt-1" id="newEmailTimer">OTP expires in 5:00</p>
                    </div>

                    <div class="flex gap-3">
                        <button id="sendNewEmailOTPBtn" onclick="sendNewEmailOTP()"
                            class="flex-1 px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600">
                            Send OTP to New Email
                        </button>
                        <button id="verifyNewEmailOTPBtn" onclick="verifyNewEmailOTP()"
                            class="flex-1 px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600"
                            style="display: none;">
                            Verify & Update Email
                        </button>
                    </div>

                    <div id="newEmailStatus" class="mt-3"></div>
                </div>

                <!-- Success Message -->
                <div id="otp-success" class="otp-step" style="display: none;">
                    <div class="bg-green-50 border-l-4 border-green-500 p-4 mb-4">
                        <p class="text-sm text-green-700">
                            <strong>‚úì Email Updated Successfully!</strong><br>
                            Your email address has been changed. Please use the new email for future logins.
                        </p>
                    </div>
                    <button onclick="closeOTPEmailModal()"
                        class="w-full px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600">
                        Close
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Add Credential Modal -->
    <div id="add-credential-modal" class="modal hidden fixed inset-0 z-50 items-center justify-center bg-black bg-opacity-50">
        <div class="modal-overlay absolute inset-0" onclick="closeAddCredentialModal()"></div>
        <div class="modal-content relative bg-white rounded-xl shadow-2xl w-full max-w-2xl mx-4 max-h-[90vh] overflow-y-auto">
            <div class="modal-header flex justify-between items-center p-6 border-b sticky top-0 bg-white rounded-t-xl">
                <div>
                    <h2 class="text-2xl font-bold text-gray-800">Add New Credential</h2>
                    <p class="text-sm text-gray-500 mt-1">Add your achievements, certifications, or work experience</p>
                </div>
                <button class="modal-close text-3xl text-gray-400 hover:text-gray-600 transition-colors" onclick="closeAddCredentialModal()">&times;</button>
            </div>
            <div class="modal-body p-6">
                <form id="addCredentialForm" onsubmit="handleCredentialSubmit(event)">
                    <!-- Credential Type -->
                    <div class="form-group mb-5">
                        <label class="block text-sm font-semibold text-gray-700 mb-2">Credential Type *</label>
                        <select id="credentialType" required
                            class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white">
                            <option value="">Select type...</option>
                            <optgroup label="Achievements">
                                <option value="certification">Certification</option>
                                <option value="degree">Degree / Diploma</option>
                                <option value="award">Award / Recognition</option>
                                <option value="license">Professional License</option>
                                <option value="course">Course Completion</option>
                            </optgroup>
                            <optgroup label="Experience">
                                <option value="work_experience">Work Experience</option>
                                <option value="project">Project</option>
                                <option value="volunteer">Volunteer Work</option>
                                <option value="teaching">Teaching Experience</option>
                            </optgroup>
                        </select>
                    </div>

                    <!-- Title -->
                    <div class="form-group mb-5">
                        <label class="block text-sm font-semibold text-gray-700 mb-2">Title *</label>
                        <input type="text" id="credentialTitle" required
                            class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                            placeholder="e.g., AWS Certified Solutions Architect">
                    </div>

                    <!-- Issued By -->
                    <div class="form-group mb-5">
                        <label class="block text-sm font-semibold text-gray-700 mb-2">Issued By / Organization</label>
                        <input type="text" id="credentialIssuedBy"
                            class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                            placeholder="e.g., Amazon Web Services, Addis Ababa University">
                    </div>

                    <!-- Dates Row -->
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-5">
                        <div class="form-group">
                            <label class="block text-sm font-semibold text-gray-700 mb-2">Date of Issue</label>
                            <input type="date" id="credentialDateOfIssue"
                                class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                        </div>
                        <div class="form-group">
                            <label class="block text-sm font-semibold text-gray-700 mb-2">Expiry Date (if applicable)</label>
                            <input type="date" id="credentialExpiryDate"
                                class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                        </div>
                    </div>

                    <!-- Description -->
                    <div class="form-group mb-5">
                        <label class="block text-sm font-semibold text-gray-700 mb-2">Description</label>
                        <textarea id="credentialDescription" rows="4"
                            class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none"
                            placeholder="Describe your achievement, responsibilities, or what you learned..."></textarea>
                    </div>

                    <!-- Document Upload -->
                    <div class="form-group mb-6">
                        <label class="block text-sm font-semibold text-gray-700 mb-2">Upload Document (Optional)</label>
                        <div class="border-2 border-dashed border-gray-300 rounded-lg p-6 text-center hover:border-blue-400 transition-colors">
                            <input type="file" id="credentialDocument" class="hidden" accept=".pdf,.jpg,.jpeg,.png,.doc,.docx"
                                onchange="previewCredentialDocument(event)">
                            <label for="credentialDocument" class="cursor-pointer">
                                <div class="flex flex-col items-center">
                                    <i class="fas fa-cloud-upload-alt text-4xl text-gray-400 mb-3"></i>
                                    <p class="text-gray-600 font-medium">Click to upload or drag and drop</p>
                                    <p class="text-gray-400 text-sm mt-1">PDF, JPG, PNG, DOC up to 10MB</p>
                                </div>
                            </label>
                            <!-- Document Preview -->
                            <div id="credentialDocumentPreview" class="hidden mt-4 p-3 bg-gray-50 rounded-lg">
                                <div class="flex items-center justify-between">
                                    <div class="flex items-center gap-3">
                                        <i class="fas fa-file-alt text-2xl text-blue-500"></i>
                                        <div class="text-left">
                                            <p id="credentialDocumentName" class="text-sm font-medium text-gray-700"></p>
                                            <p id="credentialDocumentSize" class="text-xs text-gray-500"></p>
                                        </div>
                                    </div>
                                    <button type="button" onclick="removeCredentialDocument()" class="text-red-500 hover:text-red-700">
                                        <i class="fas fa-times"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Form Actions -->
                    <div class="flex justify-end gap-3 pt-4 border-t">
                        <button type="button" onclick="closeAddCredentialModal()"
                            class="px-6 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors font-medium">
                            Cancel
                        </button>
                        <button type="submit"
                            class="px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium flex items-center gap-2">
                            <i class="fas fa-save"></i>
                            Save Credential
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Add Department Role Modal (loaded from common-modals) -->
    <div id="add-department-modal-container"></div>

    <!-- Load Add Department Modal from common-modals -->
    <script>
        // Define placeholder functions immediately (before component loads)
        // These will be overwritten when the component loads
        window._addDeptModalLoaded = false;
        window._addDeptModalQueue = [];

        if (typeof window.openAddDepartmentModal !== 'function') {
            window.openAddDepartmentModal = function() {
                if (window._addDeptModalLoaded) {
                    const modal = document.getElementById('add-department-modal');
                    if (modal) modal.classList.add('active');
                } else {
                    console.log('Add Department Modal not loaded yet, queuing request...');
                    window._addDeptModalQueue.push('open');
                }
            };
        }

        if (typeof window.closeAddDepartmentModal !== 'function') {
            window.closeAddDepartmentModal = function() {
                const modal = document.getElementById('add-department-modal');
                if (modal) modal.classList.remove('active');
            };
        }

        // Load add department modal component
        fetch('common-modals/add-department-modal.html')
            .then(response => response.text())
            .then(html => {
                document.getElementById('add-department-modal-container').innerHTML = html;
                // Execute any script tags in the loaded HTML
                const scripts = document.getElementById('add-department-modal-container').querySelectorAll('script');
                scripts.forEach(script => {
                    const newScript = document.createElement('script');
                    newScript.textContent = script.textContent;
                    document.body.appendChild(newScript);
                });

                // Mark as loaded and process any queued requests
                window._addDeptModalLoaded = true;
                if (window._addDeptModalQueue.length > 0) {
                    window._addDeptModalQueue.forEach(action => {
                        if (action === 'open') {
                            // Directly open the modal instead of calling the function
                            const modal = document.getElementById('add-department-modal');
                            if (modal) modal.classList.add('active');
                        }
                    });
                    window._addDeptModalQueue = [];
                }

                console.log('Add Department Modal loaded from common-modals');
            })
            .catch(error => console.error('Error loading add department modal:', error));
    </script>

    <!-- Notification Modal (loaded from common-modals) -->
    <div id="notification-modal-container"></div>
    <script>
        fetch('common-modals/notification-modal.html')
            .then(response => response.text())
            .then(html => {
                document.getElementById('notification-modal-container').innerHTML = html;
                const scripts = document.getElementById('notification-modal-container').querySelectorAll('script');
                scripts.forEach(script => {
                    const newScript = document.createElement('script');
                    newScript.textContent = script.textContent;
                    document.body.appendChild(newScript);
                });
                console.log('Notification Modal loaded from common-modals');
            })
            .catch(error => console.error('Error loading notification modal:', error));
    </script>

    <!-- Logout Modal (loaded from common-modals) -->
    <div id="logout-modal-container"></div>
    <script>
        fetch('common-modals/logout-modal.html')
            .then(response => response.text())
            .then(html => {
                document.getElementById('logout-modal-container').innerHTML = html;
                const scripts = document.getElementById('logout-modal-container').querySelectorAll('script');
                scripts.forEach(script => {
                    const newScript = document.createElement('script');
                    newScript.textContent = script.textContent;
                    document.body.appendChild(newScript);
                });
                console.log('Logout Modal loaded from common-modals');
            })
            .catch(error => console.error('Error loading logout modal:', error));
    </script>

</body>

</html>

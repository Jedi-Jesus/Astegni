/* ============================================================================
   DIGITAL WHITEBOARD MODAL - CONSOLIDATED
   Collaborative teaching whiteboard with real-time sync
   VS Code style sidebars with icon bars
   ============================================================================ */

/* Modal Overlay */
.whiteboard-modal-overlay {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.85);
    z-index: 9999;
    animation: fadeIn 0.3s ease-in-out;
}

.whiteboard-modal-overlay.active {
    display: flex;
    justify-content: center;
    align-items: center;
}

/* Fix transparency issue when minimized */
.whiteboard-modal-overlay.minimized-state {
    background-color: transparent !important;
    pointer-events: none;
}

.whiteboard-modal-overlay.minimized-state .whiteboard-modal {
    pointer-events: all;
}

/* Main Modal Container */
.whiteboard-modal {
    background-color: var(--card-background, #ffffff);
    border-radius: 16px;
    width: 95vw;
    height: 90vh;
    max-width: 1800px;
    display: flex;
    flex-direction: column;
    box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
    overflow: hidden;
    opacity: 1 !important;
}

/* Dark mode fallback */
[data-theme="dark"] .whiteboard-modal,
.dark-mode .whiteboard-modal {
    background-color: var(--card-background, #1e293b);
}

/* Minimized state */
.whiteboard-modal.minimized {
    width: 400px;
    height: 60px;
    position: fixed;
    bottom: 20px;
    right: 20px;
    border-radius: 12px;
    background-color: var(--card-background) !important;
    opacity: 1 !important;
}

.whiteboard-modal.minimized .whiteboard-body,
.whiteboard-modal.minimized .whiteboard-session-info {
    display: none !important;
}

/* Maximized state */
.whiteboard-modal.maximized {
    width: 100vw !important;
    height: 100vh !important;
    border-radius: 0 !important;
    max-width: none !important;
}

/* Modal Header */
.whiteboard-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 16px 24px;
    background-color: #ea580c; /* Solid orange for light mode */
    color: white;
    border-bottom: 2px solid rgba(255, 255, 255, 0.1);
}

/* Dark mode: Solid yellow/amber header */
[data-theme="dark"] .whiteboard-header,
.dark-mode .whiteboard-header {
    background-color: #f59e0b; /* Solid yellow/amber for dark mode */
}

.whiteboard-title {
    display: flex;
    align-items: center;
    gap: 12px;
    font-size: 1.25rem;
    font-weight: 600;
}

.whiteboard-title i {
    font-size: 1.5rem;
}

.whiteboard-session-info {
    display: flex;
    align-items: center;
    gap: 16px;
    font-size: 0.875rem;
}

.session-status {
    display: flex;
    align-items: center;
    gap: 8px;
    padding: 6px 12px;
    background-color: rgba(255, 255, 255, 0.2);
    border-radius: 20px;
}

.status-indicator {
    width: 8px;
    height: 8px;
    border-radius: 50%;
    background-color: #10b981;
    animation: pulse 2s infinite;
}

.session-timer {
    display: flex;
    align-items: center;
    gap: 6px;
}

/* Header Icon Buttons */
.header-icon-btn {
    background: rgba(255, 255, 255, 0.1);
    border: 1px solid rgba(255, 255, 255, 0.2);
    color: white;
    font-size: 1rem;
    cursor: pointer;
    padding: 8px 12px;
    border-radius: 8px;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    justify-content: center;
    user-select: none;
    -webkit-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
}

.header-icon-btn:hover {
    background-color: rgba(255, 255, 255, 0.25);
    border-color: rgba(255, 255, 255, 0.4);
}

.header-icon-btn.close-btn:hover {
    background-color: rgba(239, 68, 68, 0.8);
    border-color: rgba(239, 68, 68, 1);
}

.whiteboard-header-left {
    display: flex;
    align-items: center;
    gap: 12px;
    flex: 1;
}

.whiteboard-header-right {
    display: flex;
    align-items: center;
    gap: 8px;
}

/* Right sidebar toggle - hidden by default */
#rightSidebarToggle {
    display: none;
}

/* Mobile toggle button for left sidebar - hidden by default */
.mobile-toggle-history {
    display: none;
}

/* Modal Body - 3 Column Layout */
.whiteboard-body {
    display: grid;
    grid-template-columns: auto 1fr auto;
    height: calc(100% - 60px);
    gap: 0;
    overflow: hidden;
    transition: grid-template-columns 0.3s ease;
}

/* ============================================================================
   LEFT SIDEBAR - SESSION HISTORY
   ============================================================================ */

.whiteboard-sidebar {
    background-color: var(--sidebar-background, #f8fafc);
    border-right: 1px solid var(--border-color, #e2e8f0);
    display: flex;
    overflow: hidden;
    transition: all 0.3s ease-in-out;
}

[data-theme="dark"] .whiteboard-sidebar,
.dark-mode .whiteboard-sidebar {
    background-color: var(--sidebar-background, #0f172a);
    border-right-color: var(--border-color, #334155);
}

/* Collapsed state (desktop) - only show icon bar */
.whiteboard-sidebar.collapsed {
    width: 50px;
}

.whiteboard-sidebar.collapsed .sidebar-content {
    display: none;
}

.sidebar-header {
    padding: 16px;
    border-bottom: 1px solid var(--border-color);
    display: flex;
    align-items: center;
    justify-content: space-between;
}

.sidebar-header h3 {
    font-size: 1rem;
    font-weight: 600;
    color: var(--text-primary);
    display: flex;
    align-items: center;
    gap: 8px;
}

.new-session-btn {
    background-color: var(--primary-color);
    color: white;
    border: none;
    padding: 6px 12px;
    border-radius: 8px;
    font-size: 0.75rem;
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: 4px;
    transition: background-color 0.3s ease;
}

.new-session-btn:hover {
    background-color: var(--primary-dark);
}

.session-history-list {
    flex: 1;
    overflow-y: auto;
    padding: 12px;
}

/* Session Card */
.session-card {
    background-color: var(--card-background);
    border: 1px solid var(--border-color);
    border-radius: 12px;
    margin-bottom: 12px;
    overflow: hidden;
    transition: all 0.3s ease;
    cursor: pointer;
}

.session-card:hover {
    border-color: var(--primary-color);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
}

.session-card.active {
    border-color: var(--primary-color);
    background-color: var(--primary-light);
}

.session-card-header {
    padding: 12px;
    display: flex;
    align-items: center;
    justify-content: space-between;
    border-bottom: 1px solid var(--border-color);
}

.session-card-title {
    font-size: 0.875rem;
    font-weight: 600;
    color: var(--text-primary);
    margin: 0 0 4px 0;
}

.session-card-date {
    font-size: 0.75rem;
    color: var(--text-secondary);
}

.session-toggle {
    background: none;
    border: none;
    color: var(--text-secondary);
    cursor: pointer;
    font-size: 1.25rem;
    transition: transform 0.3s ease;
}

.session-card.expanded .session-toggle {
    transform: rotate(180deg);
}

.session-card-body {
    display: none;
    padding: 12px;
    background-color: var(--background-color);
}

.session-card.expanded .session-card-body {
    display: block;
}

.session-detail-item {
    display: flex;
    align-items: center;
    gap: 8px;
    margin-bottom: 8px;
    font-size: 0.75rem;
    color: var(--text-secondary);
}

.session-detail-item i {
    color: var(--primary-color);
    width: 16px;
}

.session-actions {
    display: flex;
    gap: 8px;
    margin-top: 12px;
}

.session-action-btn {
    flex: 1;
    padding: 6px 12px;
    border: 1px solid var(--border-color);
    background-color: var(--card-background);
    color: var(--text-primary);
    border-radius: 6px;
    font-size: 0.75rem;
    cursor: pointer;
    transition: all 0.3s ease;
}

.session-action-btn:hover {
    background-color: var(--primary-color);
    color: white;
    border-color: var(--primary-color);
}

.session-action-btn.danger {
    color: #ef4444;
}

.session-action-btn.danger:hover {
    background-color: #ef4444;
    color: white;
    border-color: #ef4444;
}

/* ============================================================================
   CALL HISTORY SECTION - Missed calls and call logs in left sidebar
   ============================================================================ */

.call-history-section {
    padding: 12px;
    border-top: 1px solid var(--border-color);
    margin-top: 8px;
}

.call-history-section .section-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: 12px;
    padding-bottom: 8px;
    border-bottom: 1px solid var(--border-color);
}

.call-history-section .section-header h4 {
    font-size: 0.85rem;
    font-weight: 600;
    color: var(--text-primary);
    display: flex;
    align-items: center;
    gap: 8px;
    margin: 0;
}

.call-history-section .section-header h4 i {
    color: var(--primary-color);
    font-size: 0.9rem;
}

/* Missed Call Badge */
.missed-call-badge {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    min-width: 20px;
    height: 20px;
    padding: 0 6px;
    background-color: #ef4444;
    color: white;
    font-size: 0.7rem;
    font-weight: 700;
    border-radius: 10px;
    animation: pulse-badge 2s infinite;
}

.missed-call-badge:empty {
    display: none;
}

/* Call History List */
.call-history-list {
    display: flex;
    flex-direction: column;
    gap: 8px;
    max-height: 300px;
    overflow-y: auto;
}

/* Individual Call Card */
.call-history-card {
    display: flex;
    align-items: center;
    gap: 10px;
    padding: 10px 12px;
    background-color: var(--card-background);
    border: 1px solid var(--border-color);
    border-radius: 10px;
    cursor: pointer;
    transition: all 0.2s ease;
}

.call-history-card:hover {
    border-color: var(--primary-color);
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
    transform: translateY(-1px);
}

/* Unseen/new call highlight */
.call-history-card.unseen {
    background-color: rgba(239, 68, 68, 0.08);
    border-color: rgba(239, 68, 68, 0.3);
}

.call-history-card.unseen:hover {
    background-color: rgba(239, 68, 68, 0.12);
    border-color: #ef4444;
}

/* Call type variants */
.call-history-card.missed {
    border-left: 3px solid #ef4444;
}

.call-history-card.no-answer {
    border-left: 3px solid #f59e0b;
}

.call-history-card.outgoing {
    border-left: 3px solid #3b82f6;
}

.call-history-card.incoming {
    border-left: 3px solid #10b981;
}

.call-history-card.ended {
    border-left: 3px solid #6b7280;
}

/* Avatar Container */
.call-avatar-container {
    position: relative;
    flex-shrink: 0;
}

.call-avatar {
    width: 42px;
    height: 42px;
    border-radius: 50%;
    object-fit: cover;
    border: 2px solid var(--border-color);
}

.call-avatar-placeholder {
    width: 42px;
    height: 42px;
    border-radius: 50%;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-size: 1rem;
    font-weight: 600;
    border: 2px solid var(--border-color);
}

/* Direction Icon Overlay */
.call-direction-icon {
    position: absolute;
    bottom: -2px;
    right: -2px;
    width: 18px;
    height: 18px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 0.6rem;
    color: white;
    border: 2px solid var(--card-background);
}

.call-direction-icon.outgoing {
    background-color: #3b82f6;
}

.call-direction-icon.incoming {
    background-color: #10b981;
}

.call-direction-icon.missed {
    background-color: #ef4444;
}

/* Call Info */
.call-info {
    flex: 1;
    min-width: 0;
    display: flex;
    flex-direction: column;
    gap: 2px;
}

.call-name {
    font-size: 0.875rem;
    font-weight: 600;
    color: var(--text-primary);
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.call-details {
    display: flex;
    align-items: center;
    gap: 6px;
    font-size: 0.7rem;
    color: var(--text-secondary);
}

.call-status {
    display: inline-flex;
    align-items: center;
    gap: 3px;
    padding: 1px 6px;
    border-radius: 8px;
    font-weight: 500;
    font-size: 0.65rem;
}

.call-status.missed {
    background-color: rgba(239, 68, 68, 0.15);
    color: #dc2626;
}

.call-status.no-answer {
    background-color: rgba(245, 158, 11, 0.15);
    color: #d97706;
}

.call-status.offline {
    background-color: rgba(107, 114, 128, 0.15);
    color: #6b7280;
}

.call-status.ended {
    background-color: rgba(16, 185, 129, 0.15);
    color: #059669;
}

.call-status.declined {
    background-color: rgba(239, 68, 68, 0.15);
    color: #dc2626;
}

.call-package {
    font-size: 0.7rem;
    color: var(--text-tertiary, #9ca3af);
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

/* Call Time Info */
.call-time-info {
    display: flex;
    flex-direction: column;
    align-items: flex-end;
    gap: 2px;
    flex-shrink: 0;
}

.call-time {
    font-size: 0.7rem;
    color: var(--text-secondary);
    white-space: nowrap;
}

.call-duration {
    font-size: 0.65rem;
    color: var(--text-tertiary, #9ca3af);
    display: flex;
    align-items: center;
    gap: 3px;
}

.call-duration i {
    font-size: 0.55rem;
}

/* No Calls Message */
.no-calls-message {
    text-align: center;
    padding: 24px 16px;
    color: var(--text-secondary);
}

.no-calls-message i {
    font-size: 2rem;
    margin-bottom: 8px;
    opacity: 0.4;
    display: block;
}

.no-calls-message p {
    font-size: 0.85rem;
    margin: 0;
}

/* Callback Button on hover */
.call-history-card .callback-btn {
    display: none;
    padding: 6px 10px;
    background-color: var(--primary-color);
    color: white;
    border: none;
    border-radius: 6px;
    font-size: 0.7rem;
    cursor: pointer;
    transition: background-color 0.2s;
    white-space: nowrap;
}

.call-history-card:hover .callback-btn {
    display: flex;
    align-items: center;
    gap: 4px;
}

.call-history-card:hover .call-time-info {
    display: none;
}

.callback-btn:hover {
    background-color: var(--primary-dark);
}

/* Missed Calls Notification Toast */
.missed-calls-notification {
    position: fixed;
    bottom: 80px;
    right: 20px;
    background: linear-gradient(135deg, #ef4444, #dc2626);
    color: white;
    padding: 16px 20px;
    border-radius: 12px;
    box-shadow: 0 8px 24px rgba(239, 68, 68, 0.4);
    z-index: 10003;
    display: flex;
    align-items: center;
    gap: 12px;
    animation: slideInRight 0.3s ease, pulse 2s infinite;
    max-width: 320px;
}

@keyframes slideInRight {
    from {
        opacity: 0;
        transform: translateX(100px);
    }
    to {
        opacity: 1;
        transform: translateX(0);
    }
}

.missed-calls-notification i {
    font-size: 1.5rem;
}

.missed-calls-notification .notification-content {
    flex: 1;
}

.missed-calls-notification .notification-title {
    font-size: 0.9rem;
    font-weight: 600;
    margin-bottom: 2px;
}

.missed-calls-notification .notification-subtitle {
    font-size: 0.75rem;
    opacity: 0.9;
}

.missed-calls-notification .dismiss-btn {
    background: rgba(255, 255, 255, 0.2);
    border: none;
    color: white;
    width: 28px;
    height: 28px;
    border-radius: 50%;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: background-color 0.2s;
}

.missed-calls-notification .dismiss-btn:hover {
    background: rgba(255, 255, 255, 0.3);
}

/* Sidebar Icon Bar (VS Code Activity Bar style) */
.sidebar-icon-bar {
    width: 50px;
    background-color: rgba(0, 0, 0, 0.1);
    border-right: 1px solid var(--border-color);
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 12px 0;
    gap: 8px;
}

/* Sidebar Toggle Button */
.sidebar-toggle-btn {
    width: 36px;
    height: 36px;
    display: none; /* Hidden by default, shown on tablet */
    align-items: center;
    justify-content: center;
    background: var(--primary-color);
    border: none;
    color: white;
    font-size: 0.9rem;
    cursor: pointer;
    border-radius: 8px;
    transition: all 0.3s ease;
    flex-shrink: 0;
}

.sidebar-toggle-btn:hover {
    background: var(--primary-dark);
    transform: scale(1.05);
}

.sidebar-toggle-btn i {
    transition: transform 0.3s ease;
}

/* Rotate icon when sidebar is expanded */
.whiteboard-sidebar.expanded .sidebar-toggle-btn i,
#leftSidebarToggle.active i {
    transform: rotate(180deg);
}

.whiteboard-right-sidebar.expanded .sidebar-toggle-btn i,
#rightSidebarToggle.active i {
    transform: rotate(180deg);
}

/* Divider between toggle and panel buttons */
.sidebar-icon-bar-divider {
    display: none; /* Hidden by default, shown on tablet */
    width: 30px;
    height: 1px;
    background: var(--border-color);
    margin: 4px 0;
}

.sidebar-icon-btn {
    width: 40px;
    height: 40px;
    display: flex;
    align-items: center;
    justify-content: center;
    background: transparent;
    border: none;
    color: var(--text-secondary);
    font-size: 1.25rem;
    cursor: pointer;
    border-radius: 8px;
    transition: all 0.3s ease;
    position: relative;
    user-select: none;
    -webkit-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
}

.sidebar-icon-btn:hover {
    background-color: rgba(0, 0, 0, 0.1);
    color: var(--primary-color);
}

.sidebar-icon-btn.active {
    background-color: var(--primary-color);
    color: white;
}

.sidebar-icon-btn.active::before {
    content: '';
    position: absolute;
    left: -1px;
    top: 50%;
    transform: translateY(-50%);
    width: 3px;
    height: 30px;
    background-color: var(--primary-color);
    border-radius: 0 2px 2px 0;
}

/* Sidebar Content Area */
.sidebar-content {
    width: 280px;
    flex: 1;
    overflow: hidden;
    display: flex;
    flex-direction: column;
}

.sidebar-panel {
    display: none;
    height: 100%;
    flex-direction: column;
}

.sidebar-panel.active {
    display: flex;
}

.sidebar-panel-header {
    padding: 16px;
    border-bottom: 1px solid var(--border-color);
    display: flex;
    align-items: center;
    justify-content: space-between;
}

.sidebar-panel-header h3 {
    font-size: 1rem;
    font-weight: 600;
    color: var(--text-primary);
    display: flex;
    align-items: center;
    gap: 8px;
}

/* Sidebar Search Bar */
.sidebar-search-bar {
    padding: 12px 16px;
    border-bottom: 1px solid var(--border-color);
    display: flex;
    align-items: center;
    gap: 8px;
    background-color: var(--background-color);
}

.sidebar-search-bar i {
    color: var(--text-secondary);
    font-size: 0.875rem;
}

.sidebar-search-bar input {
    flex: 1;
    border: none;
    background: transparent;
    outline: none;
    font-size: 0.875rem;
    color: var(--text-primary);
}

.sidebar-search-bar input::placeholder {
    color: var(--text-secondary);
}

/* Files List */
.files-list {
    padding: 12px;
    overflow-y: auto;
    flex: 1;
}

.file-item {
    padding: 10px;
    background-color: var(--card-background);
    border: 1px solid var(--border-color);
    border-radius: 8px;
    margin-bottom: 8px;
    display: flex;
    align-items: center;
    gap: 10px;
    transition: all 0.3s ease;
}

.file-item:hover {
    border-color: var(--primary-color);
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
}

.file-item-icon {
    flex-shrink: 0;
}

.file-item-icon i {
    font-size: 1.5rem;
    color: var(--primary-color);
}

.file-item-info {
    flex: 1;
    display: flex;
    flex-direction: column;
    gap: 6px;
}

.file-item-name {
    font-size: 0.875rem;
    color: var(--text-primary);
    font-weight: 500;
}

.file-item-actions {
    display: flex;
    gap: 4px;
}

.file-action-btn {
    padding: 4px 8px;
    background: var(--background-color);
    border: 1px solid var(--border-color);
    border-radius: 6px;
    font-size: 0.7rem;
    cursor: pointer;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    justify-content: center;
    color: var(--text-primary);
}

.file-action-btn:hover {
    background-color: var(--primary-color);
    color: white;
    border-color: var(--primary-color);
}

.file-action-btn.danger {
    color: #ef4444;
}

.file-action-btn.danger:hover {
    background-color: #ef4444;
    color: white;
    border-color: #ef4444;
}

.file-action-btn i {
    font-size: 0.7rem;
}

/* Settings List */
.settings-list {
    padding: 12px;
}

.setting-item {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 12px;
    background-color: var(--card-background);
    border: 1px solid var(--border-color);
    border-radius: 8px;
    margin-bottom: 8px;
}

.setting-item label {
    font-size: 0.875rem;
    color: var(--text-primary);
}

/* Students List */
.students-list {
    padding: 12px;
    overflow-y: auto;
    flex: 1;
}

.student-card {
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 12px;
    background-color: var(--card-background);
    border: 1px solid var(--border-color);
    border-radius: 10px;
    margin-bottom: 10px;
    cursor: pointer;
    transition: all 0.3s ease;
    position: relative; /* Required for badge positioning */
}

.student-card:hover {
    border-color: var(--primary-color);
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
    transform: translateY(-2px);
}

.student-card-avatar {
    width: 45px;
    height: 45px;
    border-radius: 50%;
    object-fit: cover;
    border: 2px solid var(--border-color);
}

.student-card-info {
    flex: 1;
}

.student-card-name {
    font-size: 0.875rem;
    font-weight: 600;
    color: var(--text-primary);
    margin: 0 0 4px 0;
}

.student-card-classes {
    font-size: 0.75rem;
    color: var(--text-secondary);
    margin: 0;
}

.student-card-grade {
    display: inline-block;
    font-size: 0.65rem;
    color: var(--primary-color);
    background-color: var(--primary-color-light, rgba(234, 88, 12, 0.1));
    padding: 2px 6px;
    border-radius: 4px;
    margin-top: 4px;
}

/* Selected student state */
.student-card.selected {
    border-color: var(--primary-color);
    background-color: var(--primary-color-light, rgba(234, 88, 12, 0.1));
    box-shadow: 0 2px 12px rgba(234, 88, 12, 0.2);
}

.student-card.selected .student-card-avatar {
    border-color: var(--primary-color);
}

/* Coursework List Styles */
.coursework-list {
    padding: 12px;
    overflow-y: auto;
    flex: 1;
}

.coursework-item {
    padding: 12px;
    background-color: var(--card-background);
    border: 1px solid var(--border-color);
    border-radius: 10px;
    margin-bottom: 10px;
    cursor: pointer;
    transition: all 0.3s ease;
}

.coursework-item:hover {
    border-color: var(--primary-color);
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
}

.coursework-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 8px;
}

.coursework-title {
    font-size: 0.875rem;
    font-weight: 600;
    color: var(--text-primary);
}

.coursework-status {
    font-size: 0.65rem;
    padding: 2px 8px;
    border-radius: 12px;
    font-weight: 500;
    text-transform: capitalize;
}

.coursework-status.bg-gray-100 { background-color: #f3f4f6; }
.coursework-status.text-gray-600 { color: #4b5563; }
.coursework-status.bg-blue-100 { background-color: #dbeafe; }
.coursework-status.text-blue-600 { color: #2563eb; }
.coursework-status.bg-yellow-100 { background-color: #fef3c7; }
.coursework-status.text-yellow-600 { color: #d97706; }
.coursework-status.bg-green-100 { background-color: #d1fae5; }
.coursework-status.text-green-600 { color: #059669; }
.coursework-status.bg-purple-100 { background-color: #ede9fe; }
.coursework-status.text-purple-600 { color: #7c3aed; }

.coursework-meta {
    display: flex;
    flex-wrap: wrap;
    gap: 12px;
    font-size: 0.75rem;
    color: var(--text-secondary);
    margin-bottom: 6px;
}

.coursework-meta span {
    display: flex;
    align-items: center;
    gap: 4px;
}

.coursework-meta i {
    font-size: 0.7rem;
    opacity: 0.7;
}

.coursework-due {
    font-size: 0.7rem;
    color: var(--text-secondary);
    display: flex;
    align-items: center;
    gap: 4px;
}

.coursework-due i {
    color: var(--primary-color);
}

/* Empty state in panels */
.empty-state {
    text-align: center;
    padding: 20px;
    color: var(--text-secondary);
}

.empty-state i {
    font-size: 2rem;
    margin-bottom: 8px;
    opacity: 0.5;
}

.empty-state p {
    margin: 0 0 8px 0;
    font-size: 0.875rem;
}

.empty-state .btn-primary {
    margin-top: 12px;
    font-size: 0.8rem;
    padding: 8px 16px;
}

/* Video Grid Selected State */
.student-video-placeholder.selected {
    border: 2px solid var(--primary-color);
    box-shadow: 0 2px 12px rgba(234, 88, 12, 0.3);
}

/* Tutor Name Subtitle */
.tutor-name-subtitle {
    display: inline;
    font-size: 0.75rem;
    color: rgba(255, 255, 255, 0.85);
    font-weight: 400;
    margin-left: 8px;
}

.mobile-toggle-history {
    display: flex;
    align-items: center;
    gap: 6px;
}


/* Recordings Panel (Records) */
.recordings-list {
    padding: 12px;
    overflow-y: auto;
    flex: 1;
}

.recording-item {
    background-color: var(--card-background);
    border: 1px solid var(--border-color);
    border-radius: 8px;
    padding: 10px;
    margin-bottom: 8px;
    cursor: pointer;
    transition: all 0.3s ease;
}

.recording-item:hover {
    border-color: var(--primary-color);
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
}

.recording-header {
    display: flex;
    align-items: flex-start;
    gap: 10px;
    margin-bottom: 6px;
}

.recording-icon {
    font-size: 1.25rem;
    color: #ef4444;
    margin-top: 2px;
}

.recording-info {
    flex: 1;
}

.recording-info h4 {
    font-size: 0.8rem;
    font-weight: 600;
    margin: 0 0 4px 0;
    color: var(--text-primary);
}

.recording-info p {
    font-size: 0.7rem;
    color: var(--text-secondary);
    margin: 0;
}

.recording-meta {
    display: flex;
    align-items: center;
    gap: 8px;
    margin-top: 4px;
    font-size: 0.65rem;
    color: var(--text-secondary);
}

.recording-meta span {
    display: flex;
    align-items: center;
    gap: 3px;
}

.recording-actions {
    display: flex;
    gap: 4px;
    margin-top: 8px;
}

.recording-action-btn {
    flex: 1;
    padding: 5px 6px;
    background: var(--card-background);
    border: 1px solid var(--border-color);
    border-radius: 6px;
    font-size: 0.7rem;
    cursor: pointer;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 3px;
    color: var(--text-primary);
}

.recording-action-btn:hover {
    background-color: var(--primary-color);
    color: white;
    border-color: var(--primary-color);
}

.recording-action-btn.danger {
    color: #ef4444;
}

.recording-action-btn.danger:hover {
    background-color: #ef4444;
    color: white;
    border-color: #ef4444;
}

.recording-action-btn i {
    font-size: 0.7rem;
}

/* ============================================================================
   CENTER - CANVAS AREA
   ============================================================================ */

.whiteboard-canvas-area {
    display: flex;
    flex-direction: column;
    background-color: #f8fafc;
    transition: margin-right 0.3s ease, width 0.3s ease;
}

[data-theme="dark"] .whiteboard-canvas-area,
.dark-mode .whiteboard-canvas-area {
    background-color: #1e293b;
}

/* Toolbar */
.whiteboard-toolbar {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 12px 16px;
    background-color: white;
    border-bottom: 1px solid var(--border-color);
    gap: 16px;
}

.toolbar-section {
    display: flex;
    align-items: center;
    gap: 8px;
}

.toolbar-divider {
    width: 1px;
    height: 30px;
    background-color: var(--border-color);
}

.tool-button {
    padding: 8px 12px;
    background-color: white;
    border: 1px solid var(--border-color);
    border-radius: 8px;
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: 6px;
    font-size: 0.875rem;
    color: var(--text-primary);
    transition: all 0.3s ease;
    user-select: none;
    -webkit-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
}

.tool-button:hover {
    background-color: var(--primary-light);
    border-color: var(--primary-color);
    color: var(--primary-color);
}

.tool-button.active {
    background-color: var(--primary-color);
    color: white;
    border-color: var(--primary-color);
}

/* Tool Button with Badge (Allow Interaction) */
.tool-button.has-badge {
    position: relative;
}

.tool-button .btn-text {
    margin-left: 4px;
}

.tool-button .request-badge {
    position: absolute;
    top: -6px;
    right: -6px;
    min-width: 18px;
    height: 18px;
    padding: 0 5px;
    background-color: #ef4444;
    color: white;
    font-size: 0.7rem;
    font-weight: 700;
    border-radius: 10px;
    display: none; /* Hidden by default */
    align-items: center;
    justify-content: center;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
    animation: pulse-badge 2s infinite;
}

.tool-button .request-badge.has-requests {
    display: flex;
}

@keyframes pulse-badge {
    0%, 100% {
        transform: scale(1);
    }
    50% {
        transform: scale(1.1);
    }
}

/* When interaction is active, change badge color */
.tool-button.active .request-badge {
    background-color: #10b981;
    animation: none;
}

/* Dropdown arrow for Allow Interaction */
.tool-button .dropdown-arrow {
    margin-left: 6px;
    font-size: 0.75rem;
    transition: transform 0.2s ease;
}

.allow-interaction-wrapper.dropdown-open .dropdown-arrow {
    transform: rotate(180deg);
}

/* Format Buttons (Text Formatting) */
.format-button {
    padding: 8px 12px;
    background-color: white;
    border: 1px solid var(--border-color);
    border-radius: 8px;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    min-width: 36px;
    height: 36px;
    font-size: 0.875rem;
    color: var(--text-primary);
    transition: all 0.3s ease;
    user-select: none;
    -webkit-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
}

.format-button:hover {
    background-color: var(--primary-light);
    border-color: var(--primary-color);
    color: var(--primary-color);
    transform: translateY(-1px);
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
}

.format-button:active {
    transform: translateY(0);
    box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
}

.format-button.active {
    background-color: var(--primary-color);
    color: white;
    border-color: var(--primary-color);
    box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.1);
}

.format-button i {
    font-size: 1rem;
}

/* Pen Tools and Text Tools Sections with Smooth Transitions */
.pen-tools,
.text-tools {
    display: flex;
    align-items: center;
    gap: 8px;
    opacity: 1;
    transform: translateX(0);
    transition: opacity 0.3s ease, transform 0.3s ease;
}

.pen-tools.hidden,
.text-tools.hidden {
    opacity: 0;
    transform: translateX(-10px);
    pointer-events: none;
}

/* Primary Tools Section */
.primary-tools {
    display: flex;
    align-items: center;
    gap: 8px;
}

/* Enhanced Toolbar Divider */
.toolbar-divider {
    width: 1px;
    height: 30px;
    background: linear-gradient(to bottom, transparent, var(--border-color), transparent);
    margin: 0 4px;
}

/* Allow Interaction Wrapper - Positioned for dropdown */
.allow-interaction-wrapper {
    position: relative;
    display: inline-block;
}

/* Interaction Requests Dropdown */
.interaction-requests-dropdown {
    position: absolute;
    top: calc(100% + 8px);
    right: 0;
    width: 320px;
    max-height: 400px;
    background-color: var(--card-background, #ffffff);
    border-radius: 12px;
    box-shadow: 0 10px 40px rgba(0, 0, 0, 0.25), 0 4px 12px rgba(0, 0, 0, 0.15);
    border: 1px solid var(--border-color, rgba(0, 0, 0, 0.1));
    z-index: 1000;
    display: none;
    flex-direction: column;
    overflow: hidden;
    animation: dropdownSlideIn 0.2s ease;
}

@keyframes dropdownSlideIn {
    from {
        opacity: 0;
        transform: translateY(-10px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

.allow-interaction-wrapper.dropdown-open .interaction-requests-dropdown {
    display: flex;
}

/* Dark mode */
[data-theme="dark"] .interaction-requests-dropdown,
.dark-mode .interaction-requests-dropdown {
    background-color: var(--card-background, #1e293b);
    border-color: rgba(255, 255, 255, 0.1);
}

/* Dropdown Header */
.interaction-requests-dropdown .dropdown-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 12px 16px;
    border-bottom: 1px solid var(--border-color, rgba(0, 0, 0, 0.1));
    background-color: var(--bg-secondary, #f8fafc);
}

[data-theme="dark"] .interaction-requests-dropdown .dropdown-header,
.dark-mode .interaction-requests-dropdown .dropdown-header {
    background-color: rgba(255, 255, 255, 0.05);
}

.dropdown-header .dropdown-title {
    font-weight: 600;
    font-size: 0.875rem;
    color: var(--text-primary, #1e293b);
}

.dropdown-header .dropdown-actions {
    display: flex;
    gap: 8px;
}

.dropdown-action-btn {
    width: 28px;
    height: 28px;
    border-radius: 6px;
    border: none;
    background-color: transparent;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.15s ease;
    font-size: 0.8rem;
}

.dropdown-action-btn.approve-all {
    color: #10b981;
}

.dropdown-action-btn.approve-all:hover {
    background-color: rgba(16, 185, 129, 0.15);
}

.dropdown-action-btn.deny-all {
    color: #ef4444;
}

.dropdown-action-btn.deny-all:hover {
    background-color: rgba(239, 68, 68, 0.15);
}

/* Dropdown Requests List */
.dropdown-requests-list {
    flex: 1;
    overflow-y: auto;
    max-height: 280px;
    padding: 8px;
}

.dropdown-requests-list::-webkit-scrollbar {
    width: 6px;
}

.dropdown-requests-list::-webkit-scrollbar-thumb {
    background-color: rgba(0, 0, 0, 0.15);
    border-radius: 3px;
}

/* No Requests Message */
.no-requests-message {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    padding: 32px 16px;
    color: var(--text-muted, #94a3b8);
    gap: 8px;
}

.no-requests-message i {
    font-size: 2rem;
    opacity: 0.5;
}

.no-requests-message span {
    font-size: 0.85rem;
}

/* Individual Request Item */
.request-item {
    display: flex;
    align-items: center;
    padding: 10px 12px;
    border-radius: 8px;
    background-color: var(--bg-secondary, #f8fafc);
    margin-bottom: 6px;
    transition: all 0.15s ease;
    cursor: pointer;
}

.request-item:last-child {
    margin-bottom: 0;
}

.request-item:hover {
    background-color: var(--bg-hover, #f1f5f9);
    transform: translateX(2px);
}

[data-theme="dark"] .request-item,
.dark-mode .request-item {
    background-color: rgba(255, 255, 255, 0.05);
}

[data-theme="dark"] .request-item:hover,
.dark-mode .request-item:hover {
    background-color: rgba(255, 255, 255, 0.08);
}

/* Request Item Avatar */
.request-item .request-avatar {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    overflow: hidden;
    flex-shrink: 0;
    margin-right: 12px;
    border: 2px solid var(--primary-color, #6366f1);
}

.request-item .request-avatar img {
    width: 100%;
    height: 100%;
    object-fit: cover;
}

.request-item .request-avatar.initials-avatar {
    background: linear-gradient(135deg, var(--primary-color, #6366f1), #4f46e5);
    color: white;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: 600;
    font-size: 0.9rem;
    border: none;
}

/* Request Item Info */
.request-item .request-info {
    flex: 1;
    min-width: 0;
}

.request-item .request-name {
    font-weight: 600;
    font-size: 0.875rem;
    color: var(--text-primary, #1e293b);
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.request-item .request-time {
    font-size: 0.75rem;
    color: var(--text-muted, #94a3b8);
    margin-top: 2px;
}

/* Request Item Actions */
.request-item .request-actions {
    display: flex;
    gap: 6px;
    margin-left: 8px;
}

.request-item .request-action-btn {
    width: 32px;
    height: 32px;
    border-radius: 6px;
    border: none;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 0.8rem;
    transition: all 0.15s ease;
}

.request-item .request-action-btn.approve {
    background-color: rgba(16, 185, 129, 0.15);
    color: #10b981;
}

.request-item .request-action-btn.approve:hover {
    background-color: #10b981;
    color: white;
}

.request-item .request-action-btn.deny {
    background-color: rgba(239, 68, 68, 0.1);
    color: #ef4444;
}

.request-item .request-action-btn.deny:hover {
    background-color: #ef4444;
    color: white;
}

.request-item .request-action-btn.revoke {
    background-color: rgba(239, 68, 68, 0.1);
    color: #ef4444;
}

.request-item .request-action-btn.revoke:hover {
    background-color: #ef4444;
    color: white;
}

/* Dropdown Sections - Active & Pending */
.dropdown-section {
    padding: 8px 0;
}

.dropdown-section + .dropdown-section {
    border-top: 1px solid var(--border-color, rgba(0, 0, 0, 0.1));
}

.dropdown-section .section-header {
    display: flex;
    align-items: center;
    gap: 8px;
    padding: 6px 16px;
    font-size: 0.75rem;
    font-weight: 600;
    color: var(--text-secondary, #64748b);
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.dropdown-section .section-header i {
    font-size: 0.7rem;
}

.dropdown-section.active-section .section-header {
    color: #10b981;
}

.dropdown-section.active-section .section-header i {
    color: #10b981;
}

.dropdown-section.pending-section .section-header {
    color: #f59e0b;
}

.dropdown-section.pending-section .section-header i {
    color: #f59e0b;
}

.section-action-btn {
    margin-left: auto;
    padding: 4px 10px;
    font-size: 0.7rem;
    font-weight: 500;
    color: #ef4444;
    background: rgba(239, 68, 68, 0.1);
    border: none;
    border-radius: 4px;
    cursor: pointer;
    transition: all 0.15s ease;
}

.section-action-btn:hover {
    background: #ef4444;
    color: white;
}

/* Active permission item */
.request-item.active-permission {
    background-color: rgba(16, 185, 129, 0.05);
    border-left: 3px solid #10b981;
}

.request-item.active-permission:hover {
    background-color: rgba(16, 185, 129, 0.1);
}

.request-status {
    font-size: 0.7rem;
    color: var(--text-secondary, #64748b);
}

.request-status.active {
    color: #10b981;
    display: flex;
    align-items: center;
    gap: 4px;
}

.request-status.active i {
    font-size: 0.5rem;
    animation: pulse 2s infinite;
}

@keyframes pulse {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.5; }
}

[data-theme="dark"] .dropdown-section + .dropdown-section,
.dark-mode .dropdown-section + .dropdown-section {
    border-top-color: rgba(255, 255, 255, 0.1);
}

[data-theme="dark"] .request-item.active-permission,
.dark-mode .request-item.active-permission {
    background-color: rgba(16, 185, 129, 0.1);
}

/* Dropdown Footer - Toggle All */
.dropdown-footer {
    padding: 12px 16px;
    border-top: 1px solid var(--border-color, rgba(0, 0, 0, 0.1));
    background-color: var(--bg-secondary, #f8fafc);
}

[data-theme="dark"] .dropdown-footer,
.dark-mode .dropdown-footer {
    background-color: rgba(255, 255, 255, 0.05);
}

/* Toggle Switch */
.toggle-all-interaction {
    display: flex;
    align-items: center;
    cursor: pointer;
    user-select: none;
}

.toggle-all-interaction input {
    opacity: 0;
    width: 0;
    height: 0;
    position: absolute;
}

.toggle-slider {
    position: relative;
    width: 42px;
    height: 24px;
    background-color: #cbd5e1;
    border-radius: 12px;
    transition: all 0.3s ease;
    margin-right: 10px;
}

.toggle-slider::before {
    content: '';
    position: absolute;
    width: 18px;
    height: 18px;
    background-color: white;
    border-radius: 50%;
    top: 3px;
    left: 3px;
    transition: transform 0.3s ease;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.2);
}

.toggle-all-interaction input:checked + .toggle-slider {
    background-color: #10b981;
}

.toggle-all-interaction input:checked + .toggle-slider::before {
    transform: translateX(18px);
}

.toggle-label {
    font-size: 0.85rem;
    color: var(--text-primary, #1e293b);
    font-weight: 500;
}

/* Click outside to close - clickaway overlay */
.dropdown-clickaway {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: 999;
    display: none;
}

.allow-interaction-wrapper.dropdown-open .dropdown-clickaway {
    display: block;
}

/* ============================================================================
   PARTICIPANT INTERACTION VIEW - Request Interaction Button
   ============================================================================ */

.participant-interaction-view {
    display: flex;
    align-items: center;
    gap: 10px;
}

/* Request Interaction Button */
.request-interaction-btn {
    background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%) !important;
    color: white !important;
    border: none !important;
    position: relative;
    overflow: hidden;
}

.request-interaction-btn:hover {
    background: linear-gradient(135deg, #4f46e5 0%, #7c3aed 100%) !important;
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(99, 102, 241, 0.4);
}

.request-interaction-btn:active {
    transform: translateY(0);
}

.request-interaction-btn.request-pending {
    background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%) !important;
    pointer-events: none;
}

.request-interaction-btn.request-granted {
    background: linear-gradient(135deg, #10b981 0%, #059669 100%) !important;
}

.request-interaction-btn .btn-text {
    position: relative;
    z-index: 1;
}

/* Pulse animation when pending */
.request-interaction-btn.request-pending::before {
    content: '';
    position: absolute;
    top: 50%;
    left: 50%;
    width: 100%;
    height: 100%;
    background: rgba(255, 255, 255, 0.2);
    border-radius: inherit;
    transform: translate(-50%, -50%) scale(0);
    animation: requestPulse 1.5s ease-out infinite;
}

@keyframes requestPulse {
    0% {
        transform: translate(-50%, -50%) scale(0.8);
        opacity: 1;
    }
    100% {
        transform: translate(-50%, -50%) scale(1.5);
        opacity: 0;
    }
}

/* Interaction Status Indicator */
.interaction-status {
    display: flex;
    align-items: center;
    gap: 8px;
    padding: 8px 14px;
    border-radius: 8px;
    font-size: 0.85rem;
    font-weight: 500;
    animation: fadeIn 0.3s ease;
}

.interaction-status.status-pending {
    background-color: rgba(245, 158, 11, 0.15);
    color: #d97706;
    border: 1px solid rgba(245, 158, 11, 0.3);
}

.interaction-status.status-granted {
    background-color: rgba(16, 185, 129, 0.15);
    color: #059669;
    border: 1px solid rgba(16, 185, 129, 0.3);
}

.interaction-status.status-denied {
    background-color: rgba(239, 68, 68, 0.15);
    color: #dc2626;
    border: 1px solid rgba(239, 68, 68, 0.3);
}

.interaction-status .status-icon {
    font-size: 1rem;
}

.interaction-status .status-icon i {
    animation: none;
}

.interaction-status.status-pending .status-icon i {
    animation: spin 1.5s linear infinite;
}

@keyframes spin {
    from { transform: rotate(0deg); }
    to { transform: rotate(360deg); }
}

/* Dark mode support */
[data-theme="dark"] .request-interaction-btn,
.dark-mode .request-interaction-btn {
    box-shadow: 0 2px 8px rgba(99, 102, 241, 0.3);
}

[data-theme="dark"] .interaction-status.status-pending,
.dark-mode .interaction-status.status-pending {
    background-color: rgba(245, 158, 11, 0.2);
}

[data-theme="dark"] .interaction-status.status-granted,
.dark-mode .interaction-status.status-granted {
    background-color: rgba(16, 185, 129, 0.2);
}

[data-theme="dark"] .interaction-status.status-denied,
.dark-mode .interaction-status.status-denied {
    background-color: rgba(239, 68, 68, 0.2);
}

/* Hide interaction views based on role */
.allow-interaction-wrapper[data-role="host"] .participant-interaction-view {
    display: none !important;
}

.allow-interaction-wrapper[data-role="host"] .host-interaction-view {
    display: block !important;
}

.allow-interaction-wrapper[data-role="participant"] .host-interaction-view {
    display: none !important;
}

.allow-interaction-wrapper[data-role="participant"] .participant-interaction-view {
    display: flex !important;
}

.tool-icon {
    font-size: 1.125rem;
}

/* Color Picker */
.color-picker-wrapper {
    position: relative;
}

.color-display {
    width: 30px;
    height: 30px;
    border-radius: 6px;
    border: 2px solid var(--border-color);
    cursor: pointer;
    transition: transform 0.2s ease;
}

.color-display:hover {
    transform: scale(1.1);
}

#strokeColor {
    position: absolute;
    opacity: 0;
    width: 0;
    height: 0;
}

/* Stroke Width */
.stroke-width-selector {
    display: flex;
    align-items: center;
    gap: 8px;
}

#strokeWidth {
    width: 100px;
}

.width-display {
    font-size: 0.75rem;
    color: var(--text-secondary);
    min-width: 30px;
}

/* Canvas Container */
.canvas-container {
    flex: 1;
    position: relative;
    overflow: hidden;
    background-color: #f5f5f5;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 8px;
}

#whiteboardCanvas,
#whiteboardCanvasNext {
    display: block;
    cursor: crosshair;
    background-color: white;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
    max-width: 100%;
    max-height: 100%;
}

/* Page Navigation */
.page-navigation {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 12px 16px;
    background-color: white;
    border-top: 1px solid var(--border-color);
    user-select: none;
    -webkit-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
}

.page-info {
    display: flex;
    align-items: center;
    gap: 12px;
    font-size: 0.875rem;
    color: var(--text-secondary);
    user-select: none;
    -webkit-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
}

.page-controls {
    display: flex;
    align-items: center;
    gap: 8px;
    user-select: none;
    -webkit-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
}

.page-nav-btn {
    padding: 6px 12px;
    background-color: white;
    border: 1px solid var(--border-color);
    border-radius: 6px;
    cursor: pointer;
    font-size: 0.875rem;
    color: var(--text-primary);
    transition: all 0.3s ease;
    user-select: none;
    -webkit-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
}

.page-nav-btn:hover:not(:disabled) {
    background-color: var(--primary-color);
    color: white;
    border-color: var(--primary-color);
}

.page-nav-btn:disabled {
    opacity: 0.4;
    cursor: not-allowed;
    user-select: none;
}

.add-page-btn {
    background-color: var(--primary-color);
    color: white;
    border: none;
}

.add-page-btn:hover {
    background-color: var(--primary-dark);
}

/* ============================================================================
   RIGHT SIDEBAR - VS Code Style with Icon Bar
   Icon bar on far right, panel content opens to its left
   ============================================================================ */

.whiteboard-right-sidebar {
    display: flex;
    flex-direction: row-reverse; /* Icon bar on right, content on left */
    background-color: var(--sidebar-background, #f8fafc);
    border-left: 1px solid var(--border-color, #e2e8f0);
    overflow: hidden;
    transition: all 0.3s ease;
    width: auto; /* Allow grid to manage width */
}

[data-theme="dark"] .whiteboard-right-sidebar,
.dark-mode .whiteboard-right-sidebar {
    background-color: var(--sidebar-background, #0f172a);
    border-left-color: var(--border-color, #334155);
}

/* Collapsed state - only icon bar visible */
.whiteboard-right-sidebar.collapsed .right-sidebar-content {
    width: 0 !important;
    min-width: 0 !important;
    padding: 0 !important;
    overflow: hidden;
}

/* Video Section */
.video-section {
    border-bottom: 1px solid var(--border-color);
    padding: 16px;
}

.video-header {
    font-size: 0.875rem;
    font-weight: 600;
    color: var(--text-primary);
    margin-bottom: 12px;
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 8px;
}

/* Live Video Header - Stacked Layout */
.right-sidebar-panel-header.live-video-header {
    flex-direction: column;
    align-items: stretch;
    gap: 12px;
}

.right-sidebar-panel-header.live-video-header h3 {
    text-align: center;
}

/* Live Video Controls Container */
.live-video-controls {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
}

/* Start Session Button */
.start-session-btn {
    background-color: #10b981;
    color: white;
    border: none;
    padding: 6px 12px;
    border-radius: 20px;
    font-size: 0.75rem;
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: 6px;
    transition: all 0.3s ease;
}

.start-session-btn:hover {
    background-color: #059669;
    transform: translateY(-1px);
    box-shadow: 0 2px 8px rgba(16, 185, 129, 0.4);
}

.start-session-btn:disabled {
    background-color: #9ca3af;
    cursor: not-allowed;
    transform: none;
    box-shadow: none;
}

.start-session-btn.active {
    background-color: #059669;
    animation: pulse 2s infinite;
}

.start-session-btn.active:hover {
    background-color: #047857;
}

/* Add Participant Button (shown during active session for host) */
.add-participant-btn {
    background-color: #6366f1;
    color: white;
    border: none;
    padding: 6px 12px;
    border-radius: 20px;
    font-size: 0.75rem;
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: 6px;
    transition: all 0.3s ease;
}

.add-participant-btn:hover {
    background-color: #4f46e5;
    transform: translateY(-1px);
    box-shadow: 0 2px 8px rgba(99, 102, 241, 0.4);
}

.add-participant-btn:disabled {
    background-color: #9ca3af;
    cursor: not-allowed;
    transform: none;
    box-shadow: none;
}

/* Rejoin Session Button (shown for participants who left an active session) */
.rejoin-session-btn {
    background: linear-gradient(135deg, #10b981, #059669);
    color: white;
    border: none;
    padding: 6px 12px;
    border-radius: 20px;
    font-size: 0.75rem;
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: 6px;
    transition: all 0.3s ease;
    animation: rejoinPulse 2s ease-in-out infinite;
}

.rejoin-session-btn:hover {
    background: linear-gradient(135deg, #059669, #047857);
    transform: translateY(-1px);
    box-shadow: 0 2px 8px rgba(16, 185, 129, 0.4);
}

.rejoin-session-btn:disabled {
    background: #9ca3af;
    cursor: not-allowed;
    transform: none;
    box-shadow: none;
    animation: none;
}

@keyframes rejoinPulse {
    0%, 100% {
        box-shadow: 0 0 0 0 rgba(16, 185, 129, 0.4);
    }
    50% {
        box-shadow: 0 0 0 8px rgba(16, 185, 129, 0);
    }
}

/* Pending call state - pulsing orange (waiting for answer) */
.start-session-btn.pending {
    background: linear-gradient(135deg, #f59e0b, #d97706);
    animation: pendingCallPulse 1.5s ease-in-out infinite;
}

.start-session-btn.pending:hover {
    background: linear-gradient(135deg, #d97706, #b45309);
}

@keyframes pendingCallPulse {
    0%, 100% {
        opacity: 1;
        box-shadow: 0 0 0 0 rgba(245, 158, 11, 0.7);
    }
    50% {
        opacity: 0.85;
        box-shadow: 0 0 15px 3px rgba(245, 158, 11, 0.4);
    }
}

/* Incoming call state - pulsing blue/purple */
.start-session-btn.incoming-call {
    background: linear-gradient(135deg, #6366f1, #8b5cf6);
    animation: incomingCallPulse 1s ease-in-out infinite;
}

.start-session-btn.incoming-call:hover {
    background: linear-gradient(135deg, #4f46e5, #7c3aed);
}

@keyframes incomingCallPulse {
    0%, 100% {
        transform: scale(1);
        box-shadow: 0 0 0 0 rgba(99, 102, 241, 0.7);
    }
    50% {
        transform: scale(1.05);
        box-shadow: 0 0 20px 5px rgba(99, 102, 241, 0.4);
    }
}

/* Phone shake animation for incoming call icon */
.start-session-btn.incoming-call i.fa-shake {
    animation: phoneShake 0.5s ease-in-out infinite;
}

@keyframes phoneShake {
    0%, 100% { transform: rotate(0deg); }
    10% { transform: rotate(-15deg); }
    20% { transform: rotate(15deg); }
    30% { transform: rotate(-15deg); }
    40% { transform: rotate(15deg); }
    50% { transform: rotate(0deg); }
}

.start-session-btn i {
    font-size: 0.8rem;
}

/* Reject Call Button - shown alongside Accept when incoming call */
.reject-call-btn {
    background: linear-gradient(135deg, #ef4444, #dc2626);
    color: white;
    border: none;
    padding: 6px 12px;
    border-radius: 20px;
    font-size: 0.75rem;
    cursor: pointer;
    display: none; /* Hidden by default, shown via JS */
    align-items: center;
    gap: 6px;
    transition: all 0.2s ease;
    margin-left: 6px;
}

.reject-call-btn:hover {
    background: linear-gradient(135deg, #dc2626, #b91c1c);
    transform: translateY(-1px);
    box-shadow: 0 2px 8px rgba(239, 68, 68, 0.4);
}

.reject-call-btn i {
    font-size: 0.8rem;
}

.record-btn {
    background-color: #ef4444;
    color: white;
    border: none;
    padding: 6px 12px;
    border-radius: 20px;
    font-size: 0.75rem;
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: 6px;
    transition: background-color 0.3s ease;
}

.record-btn:hover {
    background-color: #dc2626;
}

.record-btn.recording {
    background-color: #10b981;
    animation: pulse 2s infinite;
}

.record-btn.recording:hover {
    background-color: #059669;
}

/* Video Grid Layout: Tutor full row + students 2-per-row grid */
.video-grid-container {
    display: flex;
    flex-direction: column;
    gap: 12px;
}

/* Tutor video row: Full width, own row */
.tutor-video-row {
    width: 100%;
}

/* Tutor video: Full width, prominent display */
.tutor-video-row .video-placeholder.tutor-video {
    width: 100%;
    height: 180px;
}

/* Host badge styling */
.video-status-badge.host-badge {
    background-color: rgba(234, 179, 8, 0.9);
}

.video-placeholder {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    border-radius: 12px;
    height: 200px;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    color: white;
    position: relative;
    overflow: hidden;
}

.video-avatar {
    width: 80px;
    height: 80px;
    border-radius: 50%;
    border: 3px solid white;
    object-fit: cover;
    margin-bottom: 12px;
}

.video-participant-name {
    font-size: 1rem;
    font-weight: 600;
    margin-bottom: 4px;
}

.video-status-badge {
    background-color: rgba(16, 185, 129, 0.9);
    padding: 4px 12px;
    border-radius: 12px;
    font-size: 0.75rem;
    display: flex;
    align-items: center;
    gap: 6px;
}

.video-coming-soon {
    position: absolute;
    bottom: 12px;
    right: 12px;
    background-color: rgba(0, 0, 0, 0.6);
    padding: 6px 12px;
    border-radius: 6px;
    font-size: 0.75rem;
}

/* Student Video Grid - 2 videos side by side */
.student-video-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 12px;
}

.student-video-placeholder {
    background: linear-gradient(135deg, #3b82f6 0%, #8b5cf6 100%);
    border-radius: 10px;
    height: 180px;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    color: white;
    position: relative;
    overflow: hidden;
}

.student-avatar {
    width: 50px;
    height: 50px;
    border-radius: 50%;
    border: 2px solid white;
    object-fit: cover;
    margin-bottom: 8px;
    z-index: 1;
}

/* Ensure initials avatar doesn't cover controls */
.student-video-placeholder .initials-avatar {
    z-index: 1;
}

.student-name {
    font-size: 0.75rem;
    font-weight: 600;
    margin-bottom: 4px;
}

.student-status {
    font-size: 0.7rem;
    padding: 3px 8px;
    background-color: rgba(0, 0, 0, 0.3);
    border-radius: 10px;
    display: flex;
    align-items: center;
    gap: 4px;
}

.student-status.online {
    background-color: rgba(16, 185, 129, 0.3);
}

.student-status.online i {
    color: #10b981;
}

.student-status.offline i {
    color: #9ca3af;
}

/* Video Controls (Mute/Camera toggle) */
.video-controls {
    position: absolute;
    bottom: 10px;
    right: 10px;
    display: flex;
    gap: 8px;
    z-index: 15;
}

.video-control-btn {
    width: 36px;
    height: 36px;
    border-radius: 50%;
    border: none;
    background: rgba(0, 0, 0, 0.6);
    color: white;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.2s ease;
    backdrop-filter: blur(4px);
}

.video-control-btn:hover {
    background: rgba(0, 0, 0, 0.8);
    transform: scale(1.1);
}

.video-control-btn.muted,
.video-control-btn.camera-off,
.video-control-btn.video-off {
    background: rgba(239, 68, 68, 0.8);
}

.video-control-btn.muted:hover,
.video-control-btn.camera-off:hover,
.video-control-btn.video-off:hover {
    background: rgba(239, 68, 68, 1);
}

/* Participant audio/video toggle controls */
.participant-audio-toggle,
.participant-video-toggle {
    cursor: pointer;
}

/* Participant Selection (multi-select mode) */
.student-video-placeholder.selectable {
    cursor: pointer;
    transition: all 0.2s ease;
}

.student-video-placeholder.selectable:hover {
    transform: scale(1.02);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
}

.student-video-placeholder.participant-selected {
    border: 3px solid #10b981;
    box-shadow: 0 0 15px rgba(16, 185, 129, 0.4);
}

.student-video-placeholder .selection-indicator {
    position: absolute;
    top: 8px;
    left: 8px;
    width: 24px;
    height: 24px;
    border-radius: 50%;
    background: rgba(255, 255, 255, 0.2);
    border: 2px solid rgba(255, 255, 255, 0.5);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 12px;
    color: white;
    transition: all 0.2s ease;
}

.student-video-placeholder.participant-selected .selection-indicator {
    background: #10b981;
    border-color: #10b981;
}

/* Participant Video Controls */
.student-video-placeholder .video-controls {
    bottom: 8px;
    right: 8px;
    z-index: 20;
}

/* Ensure participant controls always stay visible (even when video is hidden) */
.student-video-placeholder .video-controls.participant-controls {
    display: flex !important;
    z-index: 25;
    pointer-events: auto;
}

.student-video-placeholder .video-control-btn {
    width: 28px;
    height: 28px;
    font-size: 0.75rem;
}

/* Remove Participant Button */
.remove-participant-btn {
    position: absolute;
    top: 6px;
    right: 6px;
    width: 22px;
    height: 22px;
    border-radius: 50%;
    background: rgba(239, 68, 68, 0.85);
    color: white;
    border: none;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 0.65rem;
    opacity: 0;
    transition: all 0.2s ease;
    z-index: 20;
}

.student-video-placeholder:hover .remove-participant-btn {
    opacity: 1;
}

.remove-participant-btn:hover {
    background: #dc2626;
    transform: scale(1.1);
}

/* Cancel Call Button - shown on calling placeholders */
.cancel-call-btn {
    position: absolute;
    top: 6px;
    right: 6px;
    width: 24px;
    height: 24px;
    border-radius: 50%;
    background: rgba(239, 68, 68, 0.9);
    color: white;
    border: 2px solid rgba(255, 255, 255, 0.3);
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 0.7rem;
    opacity: 1;
    transition: all 0.2s ease;
    z-index: 20;
    animation: pulse-cancel 1.5s infinite;
}

@keyframes pulse-cancel {
    0%, 100% {
        box-shadow: 0 0 0 0 rgba(239, 68, 68, 0.5);
    }
    50% {
        box-shadow: 0 0 0 6px rgba(239, 68, 68, 0);
    }
}

.cancel-call-btn:hover {
    background: #dc2626;
    transform: scale(1.15);
    border-color: white;
}

/* When call is connected, hide cancel button and show remove button instead */
.student-video-placeholder.connected .cancel-call-btn {
    display: none;
}

/* Empty Video Grid State */
.empty-video-grid {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    height: 100%;
    color: var(--text-secondary);
    text-align: center;
    padding: 20px;
}

.empty-video-grid i {
    font-size: 2rem;
    margin-bottom: 10px;
    opacity: 0.5;
}

.empty-video-grid p {
    font-size: 0.8rem;
}

/* Multi-select hint for sidebar cards */
.student-card::after,
.tutor-card::after {
    content: 'Ctrl+click for multi-select';
    position: absolute;
    bottom: 4px;
    right: 8px;
    font-size: 0.55rem;
    color: var(--text-tertiary);
    opacity: 0;
    transition: opacity 0.2s ease;
    pointer-events: none;
}

.student-card:hover::after,
.tutor-card:hover::after {
    opacity: 0.7;
}

/* Add Participant Mode Styles */
.add-participant-mode .student-card,
.add-participant-mode .tutor-card {
    transition: all 0.2s ease;
}

/* Already in call - greyed out and blocked */
.student-card.already-in-call,
.tutor-card.already-in-call {
    opacity: 0.5;
    pointer-events: none;
    position: relative;
}

.student-card.already-in-call::before,
.tutor-card.already-in-call::before {
    content: 'In Call';
    position: absolute;
    top: 8px;
    right: 8px;
    background: #10b981;
    color: white;
    font-size: 0.65rem;
    padding: 2px 8px;
    border-radius: 10px;
    font-weight: 600;
    z-index: 5;
}

/* Offline participant - clickable but shows offline badge */
.student-card.offline-participant,
.tutor-card.offline-participant {
    position: relative;
}

.student-card.offline-participant::before,
.tutor-card.offline-participant::before {
    content: 'Offline';
    position: absolute;
    top: 8px;
    right: 8px;
    background: #6b7280;
    color: white;
    font-size: 0.65rem;
    padding: 2px 8px;
    border-radius: 10px;
    font-weight: 600;
    z-index: 5;
}

.student-card.offline-participant .student-card-avatar,
.tutor-card.offline-participant .tutor-card-avatar {
    filter: grayscale(50%);
}

/* Online participant in add mode - green highlight */
.add-participant-mode .student-card:not(.already-in-call):not(.offline-participant),
.add-participant-mode .tutor-card:not(.already-in-call):not(.offline-participant) {
    border-color: #10b981;
}

.add-participant-mode .student-card:not(.already-in-call):not(.offline-participant)::before,
.add-participant-mode .tutor-card:not(.already-in-call):not(.offline-participant)::before {
    content: 'Online';
    position: absolute;
    top: 8px;
    right: 8px;
    background: #10b981;
    color: white;
    font-size: 0.65rem;
    padding: 2px 8px;
    border-radius: 10px;
    font-weight: 600;
    z-index: 5;
}

/* Chat Section */
.chat-section {
    flex: 1;
    display: flex;
    flex-direction: column;
    overflow: hidden;
}

.chat-header {
    padding: 6px 12px;
    border-bottom: 1px solid var(--border-color);
    font-size: 0.7rem;
    font-weight: 600;
    color: var(--text-primary);
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 6px;
    min-height: 32px;
    max-height: 32px;
}

.chat-messages {
    flex: 1;
    overflow-y: auto;
    padding: 16px;
    display: flex;
    flex-direction: column;
    gap: 12px;
}

/* Chat Message Bubble */
.chat-message {
    display: flex;
    gap: 8px;
    animation: slideInMessage 0.3s ease-out;
}

.chat-message.sent {
    flex-direction: row-reverse;
}

.message-avatar {
    width: 32px;
    height: 32px;
    border-radius: 50%;
    object-fit: cover;
    flex-shrink: 0;
}

.message-content {
    max-width: 75%;
}

.message-sender {
    font-size: 0.75rem;
    color: var(--text-secondary);
    margin-bottom: 4px;
    font-weight: 500;
}

.chat-message.sent .message-sender {
    text-align: right;
}

.message-bubble {
    background-color: var(--card-background);
    padding: 10px 14px;
    border-radius: 12px;
    font-size: 0.875rem;
    color: var(--text-primary);
    word-wrap: break-word;
}

.chat-message.sent .message-bubble {
    background-color: var(--primary-color);
    color: white;
}

.message-time {
    font-size: 0.7rem;
    color: var(--text-secondary);
    margin-top: 4px;
}

.chat-message.sent .message-time {
    text-align: right;
}

/* Chat Input */
.chat-input-area {
    padding: 16px;
    border-top: 1px solid var(--border-color);
    background-color: var(--card-background);
}

.chat-input-wrapper {
    display: flex;
    align-items: center;
    gap: 8px;
}

#chatMessageInput {
    flex: 1;
    padding: 10px 14px;
    border: 1px solid var(--border-color);
    border-radius: 20px;
    font-size: 0.875rem;
    outline: none;
    transition: border-color 0.3s ease;
}

#chatMessageInput:focus {
    border-color: var(--primary-color);
}

.chat-recipient-selector {
    display: flex;
    align-items: center;
    gap: 4px;
    white-space: nowrap;
}

.chat-recipient-selector label {
    font-size: 0.65rem;
    color: var(--text-secondary);
    font-weight: 500;
}

.chat-recipient-dropdown {
    padding: 4px 8px;
    border: 1px solid var(--border-color);
    border-radius: 8px;
    background-color: var(--card-background);
    color: var(--text-primary);
    font-size: 0.65rem;
    outline: none;
    cursor: pointer;
    transition: border-color 0.3s ease;
    min-width: 90px;
    height: 24px;
}

.chat-recipient-dropdown:focus {
    border-color: var(--primary-color);
}

.send-message-btn {
    background-color: var(--primary-color);
    color: white;
    border: none;
    padding: 10px 16px;
    border-radius: 20px;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: background-color 0.3s ease;
    flex-shrink: 0;
}

.send-message-btn:hover {
    background-color: var(--primary-dark);
}

/* ============================================================================
   ANIMATIONS
   ============================================================================ */

@keyframes fadeIn {
    from {
        opacity: 0;
    }
    to {
        opacity: 1;
    }
}

@keyframes pulse {
    0%, 100% {
        opacity: 1;
    }
    50% {
        opacity: 0.5;
    }
}

@keyframes slideInMessage {
    from {
        opacity: 0;
        transform: translateY(10px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

/* ============================================================================
   RESPONSIVE DESIGN - TO BE IMPLEMENTED FRESH
   ============================================================================ */

/* Permission Badge */
.permission-badge {
    display: inline-flex;
    align-items: center;
    gap: 4px;
    padding: 4px 10px;
    background-color: rgba(16, 185, 129, 0.1);
    color: #059669;
    border-radius: 12px;
    font-size: 0.75rem;
    font-weight: 500;
}

.permission-badge.disabled {
    background-color: rgba(239, 68, 68, 0.1);
    color: #dc2626;
}

/* Loading State */
.canvas-loading {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    text-align: center;
    color: var(--text-secondary);
}

.spinner {
    width: 40px;
    height: 40px;
    border: 4px solid var(--border-color);
    border-top-color: var(--primary-color);
    border-radius: 50%;
    animation: spin 1s linear infinite;
    margin: 0 auto 12px;
}

@keyframes spin {
    to {
        transform: rotate(360deg);
    }
}

/* ============================================================================
   RIGHT SIDEBAR - VS Code Style with Icon Bar (Mirrored from Left Sidebar)
   ============================================================================ */

/* Right Icon Bar (always visible, on far right edge) */
.whiteboard-right-sidebar .right-sidebar-icon-bar {
    width: 50px;
    min-width: 50px;
    background-color: var(--background-color);
    border-left: 1px solid var(--border-color); /* Border on left side since icon bar is on right */
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 8px 0;
    gap: 4px;
    position: relative;
    z-index: 10; /* Ensure icon bar stays above canvas area */
}

.whiteboard-right-sidebar .right-sidebar-icon-btn {
    width: 40px;
    height: 40px;
    display: flex;
    align-items: center;
    justify-content: center;
    background: transparent;
    border: none;
    border-radius: 8px;
    color: var(--text-secondary);
    cursor: pointer;
    transition: all 0.2s ease;
    font-size: 1rem;
}

.whiteboard-right-sidebar .right-sidebar-icon-btn:hover {
    background-color: var(--card-background);
    color: var(--primary-color);
}

.whiteboard-right-sidebar .right-sidebar-icon-btn.active {
    background-color: var(--primary-color);
    color: white;
}

/* Emoji Icon Styling */
.emoji-icon {
    font-size: 1.25rem;
    line-height: 1;
    display: inline-flex;
    align-items: center;
    justify-content: center;
}

.ai-avatar .emoji-icon {
    font-size: 1.1rem;
}

.right-sidebar-panel-header h3 .emoji-icon {
    font-size: 1rem;
    margin-right: 2px;
}

/* Right Sidebar Content Area (collapsible) */
.whiteboard-right-sidebar .right-sidebar-content {
    width: 420px;
    display: flex;
    flex-direction: column;
    overflow: hidden;
    transition: width 0.3s ease;
}

/* Collapsed state - only icon bar visible */
.whiteboard-right-sidebar.collapsed .right-sidebar-content {
    width: 0 !important;
    min-width: 0 !important;
    overflow: hidden;
}

/* Right Sidebar Panels - CRITICAL: Hide non-active panels */
.whiteboard-right-sidebar .right-sidebar-panel {
    display: none !important;
    flex: 1;
    flex-direction: column;
    overflow: hidden;
}

.whiteboard-right-sidebar .right-sidebar-panel.active {
    display: flex !important;
}

/* Right Sidebar Panel Header (matches left sidebar style) */
.whiteboard-right-sidebar .right-sidebar-panel-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 12px 16px;
    border-bottom: 1px solid var(--border-color);
    background-color: var(--card-background);
    flex-shrink: 0;
}

.whiteboard-right-sidebar .right-sidebar-panel-header h3 {
    display: flex;
    align-items: center;
    gap: 8px;
    font-size: 0.875rem;
    font-weight: 600;
    color: var(--text-primary);
    margin: 0;
}

.whiteboard-right-sidebar .right-sidebar-panel-header h3 i {
    color: var(--primary-color);
}

/* Make sections fill the panel */
.whiteboard-right-sidebar .right-sidebar-panel .video-section,
.whiteboard-right-sidebar .right-sidebar-panel .chat-section,
.whiteboard-right-sidebar .right-sidebar-panel .ai-section {
    flex: 1;
    display: flex;
    flex-direction: column;
    overflow: hidden;
}

/* Video section adjustments */
.whiteboard-right-sidebar .right-sidebar-panel .video-section {
    padding: 16px;
    border-bottom: none;
    overflow-y: auto;
}

/* Chat section adjustments */
.whiteboard-right-sidebar .right-sidebar-panel .chat-section {
    flex: 1;
    display: flex;
    flex-direction: column;
}

.whiteboard-right-sidebar .right-sidebar-panel .chat-messages {
    flex: 1;
    overflow-y: auto;
    padding: 16px;
}

.whiteboard-right-sidebar .right-sidebar-panel .chat-input-area {
    padding: 12px 16px;
    border-top: 1px solid var(--border-color);
    flex-shrink: 0;
}

/* ============================================================================
   AI ASSISTANT SECTION
   ============================================================================ */

.ai-section {
    flex: 1;
    display: flex;
    flex-direction: column;
    overflow: hidden;
}

.ai-header {
    font-size: 0.875rem;
    font-weight: 600;
    color: var(--text-primary);
    padding: 16px;
    border-bottom: 1px solid var(--border-color);
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 8px;
}

.ai-model-selector {
    display: flex;
    align-items: center;
    gap: 8px;
}

.ai-model-dropdown {
    padding: 4px 8px;
    border-radius: 6px;
    border: 1px solid var(--border-color);
    background-color: var(--card-background);
    color: var(--text-primary);
    font-size: 0.75rem;
    cursor: pointer;
}

.ai-messages {
    flex: 1;
    overflow-y: auto;
    padding: 16px;
    display: flex;
    flex-direction: column;
    gap: 16px;
}

.ai-welcome-message {
    display: flex;
    gap: 12px;
    align-items: flex-start;
}

.ai-avatar {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    flex-shrink: 0;
}

.ai-avatar i {
    font-size: 1.25rem;
}

.ai-bubble {
    background-color: var(--card-background);
    border: 1px solid var(--border-color);
    border-radius: 12px;
    padding: 12px 16px;
    font-size: 0.875rem;
    color: var(--text-primary);
    max-width: 90%;
}

.ai-bubble p {
    margin: 0 0 8px 0;
}

.ai-bubble p:last-child {
    margin-bottom: 0;
}

.ai-bubble ul {
    margin: 8px 0;
    padding-left: 20px;
}

.ai-bubble li {
    margin: 4px 0;
    color: var(--text-secondary);
}

.ai-input-area {
    padding: 12px 16px;
    border-top: 1px solid var(--border-color);
    display: flex;
    flex-direction: column;
    gap: 8px;
}

.ai-quick-actions {
    display: flex;
    gap: 8px;
    flex-wrap: nowrap;
    justify-content: space-between;
}

.ai-quick-btn {
    flex: 1;
    padding: 8px 12px;
    background-color: var(--card-background);
    border: 1px solid var(--border-color);
    border-radius: 16px;
    font-size: 0.8rem;
    color: var(--text-secondary);
    cursor: pointer;
    transition: all 0.2s ease;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 6px;
    white-space: nowrap;
}

.ai-quick-btn:hover {
    background-color: var(--primary-color);
    color: white;
    border-color: var(--primary-color);
}

.ai-input-wrapper {
    display: flex;
    gap: 8px;
    align-items: center;
}

.ai-input-wrapper input {
    flex: 1;
    padding: 10px 14px;
    border-radius: 20px;
    border: 1px solid var(--border-color);
    background-color: var(--card-background);
    color: var(--text-primary);
    font-size: 0.875rem;
    outline: none;
    transition: border-color 0.2s ease;
}

.ai-input-wrapper input:focus {
    border-color: var(--primary-color);
}

.ai-input-wrapper input::placeholder {
    color: var(--text-secondary);
}

/* AI Message Styles */
.ai-message {
    display: flex;
    gap: 12px;
    align-items: flex-start;
}

.ai-message.user {
    flex-direction: row-reverse;
}

.ai-message.user .ai-bubble {
    background-color: var(--primary-color);
    color: white;
    border-color: var(--primary-color);
}

.ai-message.user .ai-avatar {
    background: var(--secondary-color);
}


/* ============================================================================
   DIGITAL LAB PANEL STYLES
   Interactive science laboratory experiments - Two-state view design
   ============================================================================ */

/* Lab Panel Header with Back Button */
#labPanelHeader {
    position: relative;
}

.lab-back-btn {
    background: none;
    border: none;
    color: var(--text-primary);
    font-size: 1rem;
    cursor: pointer;
    padding: 6px 10px;
    border-radius: 6px;
    transition: all 0.2s ease;
    display: flex;
    align-items: center;
    justify-content: center;
    margin-right: 8px;
}

.lab-back-btn:hover {
    background-color: var(--hover-background);
    color: var(--primary-color);
}

/* ============================================
   Course List View (Initial State)
   ============================================ */

.lab-course-list {
    padding: 12px;
    overflow-y: auto;
    flex: 1;
    display: flex;
    flex-direction: column;
    gap: 10px;
}

/* Course Card */
.lab-course-card {
    display: flex;
    align-items: center;
    gap: 14px;
    padding: 14px 16px;
    background-color: var(--card-background);
    border: 1px solid var(--border-color);
    border-radius: 12px;
    cursor: pointer;
    transition: all 0.25s ease;
}

.lab-course-card:hover {
    border-color: var(--primary-color);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    transform: translateY(-2px);
}

/* Course Icon */
.lab-course-icon {
    width: 48px;
    height: 48px;
    border-radius: 12px;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
}

.lab-course-icon i {
    font-size: 1.4rem;
    color: white;
}

/* Course-specific icon colors */
.lab-course-icon.chemistry {
    background: linear-gradient(135deg, #3b82f6, #1d4ed8);
}

.lab-course-icon.physics {
    background: linear-gradient(135deg, #f59e0b, #d97706);
}

.lab-course-icon.biology {
    background: linear-gradient(135deg, #10b981, #059669);
}

.lab-course-icon.mathematics {
    background: linear-gradient(135deg, #8b5cf6, #6d28d9);
}

.lab-course-icon.computer {
    background: linear-gradient(135deg, #06b6d4, #0891b2);
}

.lab-course-icon.music {
    background: linear-gradient(135deg, #ec4899, #db2777);
}

.lab-course-icon.visualart {
    background: linear-gradient(135deg, #f97316, #ea580c);
}

/* Category Labels */
.lab-category-label {
    display: flex;
    align-items: center;
    gap: 8px;
    padding: 8px 4px;
    margin-top: 8px;
    font-size: 0.75rem;
    font-weight: 600;
    color: var(--text-secondary);
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.lab-category-label:first-child {
    margin-top: 0;
}

.lab-category-emoji {
    font-size: 1rem;
}

/* Course Info */
.lab-course-info {
    flex: 1;
    min-width: 0;
}

.lab-course-info h4 {
    font-size: 0.95rem;
    font-weight: 600;
    color: var(--text-primary);
    margin: 0 0 4px 0;
}

.lab-course-info p {
    font-size: 0.75rem;
    color: var(--text-secondary);
    margin: 0;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

/* Course Arrow */
.lab-course-arrow {
    color: var(--text-secondary);
    font-size: 0.9rem;
    transition: transform 0.2s ease;
}

.lab-course-card:hover .lab-course-arrow {
    color: var(--primary-color);
    transform: translateX(4px);
}

/* ============================================
   Tools View (After selecting a course)
   ============================================ */

.lab-tools-view {
    padding: 12px;
    overflow-y: auto;
    flex: 1;
}

/* Tools Grid - 2 columns */
.lab-tools-grid {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 10px;
}

/* Tool Card */
.lab-tool-card {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 8px;
    padding: 16px 12px;
    background-color: var(--card-background);
    border: 1px solid var(--border-color);
    border-radius: 12px;
    cursor: pointer;
    transition: all 0.25s ease;
    text-align: center;
    position: relative;
}

.lab-tool-card:hover {
    border-color: var(--primary-color);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    transform: translateY(-2px);
}

/* Tool Icon */
.lab-tool-icon {
    width: 50px;
    height: 50px;
    border-radius: 50%;
    background: linear-gradient(135deg, var(--primary-color), var(--secondary-color, #ea580c));
    display: flex;
    align-items: center;
    justify-content: center;
    margin-bottom: 4px;
}

.lab-tool-icon i {
    font-size: 1.3rem;
    color: white;
}

/* Tool Name */
.lab-tool-card > span:not(.lab-badge) {
    font-size: 0.8rem;
    font-weight: 500;
    color: var(--text-primary);
    line-height: 1.3;
}

/* Tool Badges */
.lab-tool-card .lab-badge {
    position: absolute;
    top: 8px;
    right: 8px;
    padding: 2px 6px;
    font-size: 0.6rem;
    font-weight: 600;
    border-radius: 8px;
    text-transform: uppercase;
}

.lab-badge.new {
    background-color: #10b981;
    color: white;
}

.lab-badge.popular {
    background-color: #f59e0b;
    color: white;
}

.lab-badge.advanced {
    background-color: #8b5cf6;
    color: white;
}

/* ============================================
   Legacy Lab Category Styles (kept for compatibility)
   ============================================ */

/* Lab List Container */
.lab-list {
    padding: 12px;
    overflow-y: auto;
    flex: 1;
}

/* Lab Category (Collapsible Section) */
.lab-category {
    margin-bottom: 12px;
    background-color: var(--card-background);
    border: 1px solid var(--border-color);
    border-radius: 10px;
    overflow: hidden;
    transition: all 0.3s ease;
}

.lab-category:hover {
    border-color: var(--primary-color);
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
}

/* Lab Category Header */
.lab-category-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 12px 14px;
    cursor: pointer;
    background-color: var(--background-color);
    transition: background-color 0.3s ease;
}

.lab-category-header:hover {
    background-color: var(--hover-background);
}

.lab-category-header span {
    display: flex;
    align-items: center;
    gap: 10px;
    font-size: 0.9rem;
    font-weight: 600;
    color: var(--text-primary);
}

.lab-category-header span i {
    font-size: 1.1rem;
    width: 24px;
    text-align: center;
}

/* Category-specific colors */
.lab-category-header span i.fa-atom {
    color: #3b82f6; /* Blue for Chemistry */
}

.lab-category-header span i.fa-bolt {
    color: #f59e0b; /* Orange for Physics */
}

.lab-category-header span i.fa-dna {
    color: #10b981; /* Green for Biology */
}

.lab-category-header span i.fa-square-root-variable {
    color: #8b5cf6; /* Purple for Mathematics */
}

.lab-category-header .toggle-icon {
    font-size: 0.75rem;
    color: var(--text-secondary);
    transition: transform 0.3s ease;
}

.lab-category.expanded .toggle-icon {
    transform: rotate(180deg);
}

/* Lab Items Container */
.lab-items {
    display: none;
    padding: 8px;
    background-color: var(--card-background);
    border-top: 1px solid var(--border-color);
}

.lab-category.expanded .lab-items {
    display: block;
}

/* Individual Lab Item */
.lab-item {
    display: flex;
    align-items: center;
    gap: 10px;
    padding: 10px 12px;
    margin-bottom: 4px;
    background-color: var(--background-color);
    border: 1px solid transparent;
    border-radius: 8px;
    cursor: pointer;
    transition: all 0.2s ease;
}

.lab-item:last-child {
    margin-bottom: 0;
}

.lab-item:hover {
    background-color: var(--hover-background);
    border-color: var(--primary-color);
    transform: translateX(4px);
}

.lab-item i {
    font-size: 1rem;
    color: var(--primary-color);
    width: 20px;
    text-align: center;
}

.lab-item span {
    font-size: 0.85rem;
    color: var(--text-primary);
    font-weight: 500;
}

/* Lab Item Badges (optional) */
.lab-item .lab-badge {
    margin-left: auto;
    padding: 2px 8px;
    font-size: 0.65rem;
    font-weight: 600;
    border-radius: 10px;
    text-transform: uppercase;
}

.lab-item .lab-badge.new {
    background-color: #10b981;
    color: white;
}

.lab-item .lab-badge.popular {
    background-color: #f59e0b;
    color: white;
}

.lab-item .lab-badge.advanced {
    background-color: #8b5cf6;
    color: white;
}

/* Empty State for Lab */
.lab-empty-state {
    text-align: center;
    padding: 40px 20px;
    color: var(--text-secondary);
}

.lab-empty-state i {
    font-size: 3rem;
    margin-bottom: 16px;
    opacity: 0.5;
}

.lab-empty-state p {
    font-size: 0.9rem;
}

/* Lab Loading State */
.lab-loading {
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 40px 20px;
    color: var(--text-secondary);
}

.lab-loading i {
    font-size: 1.5rem;
    animation: spin 1s linear infinite;
}


/* ============================================================================
   INTERACTION REQUESTS MODAL
   Modal for managing student interaction requests
   ============================================================================ */

.interaction-requests-modal-overlay {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-color: rgba(0, 0, 0, 0.6);
    z-index: 10002;
    display: flex;
    align-items: center;
    justify-content: center;
    animation: fadeIn 0.2s ease;
}

.interaction-requests-modal {
    background-color: var(--card-background);
    border-radius: 16px;
    width: 90%;
    max-width: 420px;
    max-height: 80vh;
    display: flex;
    flex-direction: column;
    box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
    animation: slideUp 0.3s ease;
}

@keyframes slideUp {
    from {
        opacity: 0;
        transform: translateY(20px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

.requests-modal-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 16px 20px;
    border-bottom: 1px solid var(--border-color);
    background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
    border-radius: 16px 16px 0 0;
    color: white;
}

.requests-modal-header h3 {
    font-size: 1.1rem;
    font-weight: 600;
    display: flex;
    align-items: center;
    gap: 10px;
    margin: 0;
}

.close-requests-modal {
    background: rgba(255, 255, 255, 0.2);
    border: none;
    color: white;
    width: 32px;
    height: 32px;
    border-radius: 50%;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: background-color 0.2s;
}

.close-requests-modal:hover {
    background: rgba(255, 255, 255, 0.3);
}

.requests-modal-body {
    flex: 1;
    overflow-y: auto;
    padding: 12px;
    max-height: 400px;
}

/* Individual Request Item */
.request-item {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 12px;
    background-color: var(--background-color);
    border: 1px solid var(--border-color);
    border-radius: 10px;
    margin-bottom: 8px;
    transition: all 0.2s ease;
}

.request-item:last-child {
    margin-bottom: 0;
}

.request-item:hover {
    border-color: var(--primary-color);
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
}

.request-student {
    display: flex;
    align-items: center;
    gap: 12px;
}

.request-avatar {
    width: 44px;
    height: 44px;
    border-radius: 50%;
    object-fit: cover;
    border: 2px solid var(--border-color);
}

.request-info {
    display: flex;
    flex-direction: column;
    gap: 2px;
}

.request-name {
    font-size: 0.95rem;
    font-weight: 600;
    color: var(--text-primary);
}

.request-time {
    font-size: 0.75rem;
    color: var(--text-secondary);
}

.request-actions {
    display: flex;
    gap: 8px;
}

.request-btn {
    width: 36px;
    height: 36px;
    border-radius: 50%;
    border: none;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 0.9rem;
    transition: all 0.2s ease;
}

.request-btn.approve {
    background-color: #10b981;
    color: white;
}

.request-btn.approve:hover {
    background-color: #059669;
    transform: scale(1.1);
}

.request-btn.deny {
    background-color: #ef4444;
    color: white;
}

.request-btn.deny:hover {
    background-color: #dc2626;
    transform: scale(1.1);
}

/* No Requests State */
.no-requests {
    text-align: center;
    padding: 40px 20px;
    color: var(--text-secondary);
}

.no-requests i {
    font-size: 3rem;
    margin-bottom: 12px;
    opacity: 0.5;
}

.no-requests p {
    font-size: 0.95rem;
}

/* Modal Footer */
.requests-modal-footer {
    display: flex;
    gap: 12px;
    padding: 16px 20px;
    border-top: 1px solid var(--border-color);
    background-color: var(--background-color);
    border-radius: 0 0 16px 16px;
}

.requests-modal-footer button {
    flex: 1;
    padding: 10px 16px;
    border-radius: 8px;
    font-size: 0.9rem;
    font-weight: 500;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
    transition: all 0.2s ease;
}

.requests-modal-footer .btn-secondary {
    background-color: var(--background-color);
    border: 1px solid var(--border-color);
    color: var(--text-primary);
}

.requests-modal-footer .btn-secondary:hover {
    background-color: var(--hover-background);
    border-color: var(--text-secondary);
}

.requests-modal-footer .btn-primary {
    background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
    border: none;
    color: white;
}

.requests-modal-footer .btn-primary:hover {
    opacity: 0.9;
    transform: translateY(-1px);
}

/* ============================================================================
   CANVAS READ-ONLY MODE INDICATOR
   ============================================================================ */

.canvas-readonly-indicator {
    position: absolute;
    top: 10px;
    left: 50%;
    transform: translateX(-50%);
    background: linear-gradient(135deg, rgba(59, 130, 246, 0.95), rgba(99, 102, 241, 0.95));
    color: white;
    padding: 8px 16px;
    border-radius: 8px;
    display: flex;
    align-items: center;
    gap: 10px;
    font-size: 0.85rem;
    font-weight: 500;
    box-shadow: 0 4px 15px rgba(59, 130, 246, 0.3);
    z-index: 100;
    backdrop-filter: blur(10px);
}

.canvas-readonly-indicator i {
    font-size: 1rem;
}

.canvas-readonly-indicator .exit-readonly-btn {
    background: rgba(255, 255, 255, 0.2);
    border: 1px solid rgba(255, 255, 255, 0.3);
    color: white;
    padding: 4px 10px;
    border-radius: 4px;
    cursor: pointer;
    font-size: 0.75rem;
    display: flex;
    align-items: center;
    gap: 4px;
    transition: all 0.2s ease;
}

.canvas-readonly-indicator .exit-readonly-btn:hover {
    background: rgba(255, 255, 255, 0.3);
}

/* Disabled tool buttons in read-only mode */
.tool-btn.disabled {
    opacity: 0.4;
    pointer-events: none;
    cursor: not-allowed;
}

/* ============================================================================
   RECORDING PLAYER IN LIVE PANEL
   ============================================================================ */

.recording-player-container {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: var(--card-background, #1a1a2e);
    display: none;
    flex-direction: column;
    z-index: 50;
    border-radius: 12px;
    overflow: hidden;
}

.recording-player-container .recording-header {
    padding: 12px 16px;
    background: linear-gradient(135deg, rgba(59, 130, 246, 0.15), rgba(99, 102, 241, 0.15));
    border-bottom: 1px solid var(--border-color, rgba(255, 255, 255, 0.1));
    display: flex;
    align-items: center;
    justify-content: space-between;
}

.recording-player-container .recording-header h4 {
    margin: 0;
    font-size: 0.9rem;
    color: var(--text-primary, white);
    display: flex;
    align-items: center;
    gap: 8px;
}

.recording-player-container .recording-header h4 i {
    color: var(--primary-color, #3B82F6);
}

.recording-player-container .recording-info {
    font-size: 0.75rem;
    color: var(--text-secondary, rgba(255, 255, 255, 0.6));
}

.recording-player-container .session-recording-video {
    flex: 1;
    width: 100%;
    max-height: calc(100% - 100px);
    object-fit: contain;
    background: #000;
}

.recording-player-container .recording-controls {
    padding: 10px 16px;
    background: var(--card-background, #1a1a2e);
    border-top: 1px solid var(--border-color, rgba(255, 255, 255, 0.1));
    display: flex;
    justify-content: center;
}

.recording-close-btn {
    background: rgba(239, 68, 68, 0.15);
    border: 1px solid rgba(239, 68, 68, 0.3);
    color: #EF4444;
    padding: 8px 16px;
    border-radius: 6px;
    cursor: pointer;
    font-size: 0.8rem;
    display: flex;
    align-items: center;
    gap: 6px;
    transition: all 0.2s ease;
}

.recording-close-btn:hover {
    background: rgba(239, 68, 68, 0.25);
    transform: translateY(-1px);
}

/* ============================================================================
   ENHANCED CALL HISTORY CARDS
   ============================================================================ */

.call-history-card {
    cursor: pointer;
    transition: all 0.2s ease;
}

.call-history-card:hover {
    background: var(--hover-background, rgba(255, 255, 255, 0.05));
    transform: translateX(2px);
}

.call-history-card.has-canvas::after,
.call-history-card.has-recording::before {
    position: absolute;
    font-size: 0.6rem;
    padding: 2px 5px;
    border-radius: 3px;
    font-weight: 600;
}

.call-history-card.has-canvas::after {
    content: 'CANVAS';
    top: 5px;
    right: 5px;
    background: rgba(59, 130, 246, 0.2);
    color: #3B82F6;
}

.call-history-card.has-recording::before {
    content: 'VIDEO';
    top: 5px;
    right: 55px;
    background: rgba(16, 185, 129, 0.2);
    color: #10B981;
}

/* Recording save choice modal styles */
.recording-save-choice {
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background: var(--card-background, #1f2937);
    border-radius: 12px;
    padding: 24px;
    z-index: 10001;
    box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5);
    min-width: 320px;
}

.recording-save-choice h3 {
    margin: 0 0 16px 0;
    font-size: 1.1rem;
    color: var(--text-primary, white);
    text-align: center;
}

.recording-save-choice .choice-options {
    display: flex;
    flex-direction: column;
    gap: 12px;
}

.recording-save-choice .choice-btn {
    padding: 16px;
    border-radius: 8px;
    border: 2px solid var(--border-color, rgba(255, 255, 255, 0.1));
    background: transparent;
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: 12px;
    transition: all 0.2s ease;
}

.recording-save-choice .choice-btn:hover {
    border-color: var(--primary-color, #3B82F6);
    background: rgba(59, 130, 246, 0.1);
}

.recording-save-choice .choice-btn i {
    font-size: 1.5rem;
    color: var(--primary-color, #3B82F6);
}

.recording-save-choice .choice-btn .choice-text {
    text-align: left;
}

.recording-save-choice .choice-btn .choice-title {
    font-weight: 600;
    color: var(--text-primary, white);
    font-size: 0.95rem;
}

.recording-save-choice .choice-btn .choice-desc {
    font-size: 0.75rem;
    color: var(--text-secondary, rgba(255, 255, 255, 0.6));
    margin-top: 2px;
}

.recording-save-choice .cancel-btn {
    width: 100%;
    padding: 10px;
    margin-top: 12px;
    background: transparent;
    border: 1px solid var(--border-color, rgba(255, 255, 255, 0.2));
    color: var(--text-secondary, rgba(255, 255, 255, 0.6));
    border-radius: 6px;
    cursor: pointer;
    font-size: 0.85rem;
    transition: all 0.2s ease;
}

.recording-save-choice .cancel-btn:hover {
    background: rgba(255, 255, 255, 0.05);
}

/* ============================================================================
   ENHANCED CANVAS - PAGE FLIP ANIMATION & REAL-TIME SYNC
   ============================================================================ */

/* Page Flipper Container */
.canvas-page-flipper {
    position: relative;
    width: 100%;
    height: 100%;
    perspective: 2000px;
    transform-style: preserve-3d;
}

.canvas-page {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    backface-visibility: hidden;
    transform-origin: left center;
    transition: transform 0.6s ease-in-out;
}

.canvas-page.current-page {
    z-index: 2;
}

.canvas-page.next-page {
    z-index: 1;
    transform: rotateY(0deg);
}

/* Page flip animations */
.canvas-page-flipper.flipping-next .current-page {
    animation: flipPageNext 0.6s ease-in-out forwards;
}

.canvas-page-flipper.flipping-prev .current-page {
    animation: flipPagePrev 0.6s ease-in-out forwards;
}

@keyframes flipPageNext {
    0% {
        transform: rotateY(0deg);
        box-shadow: 0 0 20px rgba(0, 0, 0, 0.1);
    }
    50% {
        transform: rotateY(-90deg);
        box-shadow: 10px 0 30px rgba(0, 0, 0, 0.3);
    }
    100% {
        transform: rotateY(-180deg);
        box-shadow: 0 0 20px rgba(0, 0, 0, 0.1);
    }
}

@keyframes flipPagePrev {
    0% {
        transform: rotateY(0deg);
        box-shadow: 0 0 20px rgba(0, 0, 0, 0.1);
    }
    50% {
        transform: rotateY(90deg);
        box-shadow: -10px 0 30px rgba(0, 0, 0, 0.3);
    }
    100% {
        transform: rotateY(180deg);
        box-shadow: 0 0 20px rgba(0, 0, 0, 0.1);
    }
}

/* Page shadow effect during flip */
.canvas-page-flipper.flipping-next::after,
.canvas-page-flipper.flipping-prev::after {
    content: '';
    position: absolute;
    top: 0;
    width: 50%;
    height: 100%;
    background: linear-gradient(to right, rgba(0, 0, 0, 0.2), transparent);
    animation: pageShadow 0.6s ease-in-out;
    pointer-events: none;
    z-index: 10;
}

.canvas-page-flipper.flipping-next::after {
    right: 0;
}

.canvas-page-flipper.flipping-prev::after {
    left: 0;
    background: linear-gradient(to left, rgba(0, 0, 0, 0.2), transparent);
}

@keyframes pageShadow {
    0% { opacity: 0; }
    50% { opacity: 1; }
    100% { opacity: 0; }
}

/* Sync Indicator */
.canvas-sync-indicator {
    position: absolute;
    top: 12px;
    left: 12px;
    display: flex;
    align-items: center;
    gap: 6px;
    padding: 6px 12px;
    background: rgba(16, 185, 129, 0.9);
    color: white;
    border-radius: 20px;
    font-size: 0.75rem;
    font-weight: 500;
    z-index: 10;
    box-shadow: 0 2px 8px rgba(16, 185, 129, 0.3);
}

.canvas-sync-indicator .sync-dot {
    width: 8px;
    height: 8px;
    border-radius: 50%;
    background-color: white;
    animation: syncPulse 2s infinite;
}

@keyframes syncPulse {
    0%, 100% { opacity: 1; transform: scale(1); }
    50% { opacity: 0.5; transform: scale(0.8); }
}

.canvas-sync-indicator.syncing {
    background: rgba(245, 158, 11, 0.9);
}

.canvas-sync-indicator.syncing .sync-dot {
    animation: syncPulseActive 0.5s infinite;
}

@keyframes syncPulseActive {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.3; }
}

.canvas-sync-indicator.error {
    background: rgba(239, 68, 68, 0.9);
}

/* Permission Indicator */
.canvas-permission-indicator {
    position: absolute;
    bottom: 80px;
    left: 50%;
    transform: translateX(-50%);
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 12px 20px;
    background: rgba(107, 114, 128, 0.95);
    color: white;
    border-radius: 12px;
    font-size: 0.875rem;
    z-index: 10;
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
    backdrop-filter: blur(10px);
}

.canvas-permission-indicator i {
    font-size: 1.25rem;
    color: #fbbf24;
}

.request-permission-btn {
    padding: 8px 16px;
    background: var(--primary-color);
    color: white;
    border: none;
    border-radius: 8px;
    font-size: 0.8rem;
    font-weight: 500;
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: 6px;
    transition: all 0.2s ease;
}

.request-permission-btn:hover {
    background: var(--primary-dark);
    transform: scale(1.05);
}

.request-permission-btn.pending {
    background: #6b7280;
    cursor: not-allowed;
}

/* ============================================================================
   INLINE TEXT EDITOR (replaces prompt)
   ============================================================================ */

.canvas-text-editor {
    position: absolute;
    display: flex;
    flex-direction: column;
    gap: 8px;
    background: white;
    border: 2px solid var(--primary-color);
    border-radius: 8px;
    padding: 8px;
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
    z-index: 100;
    min-width: 200px;
    max-width: 400px;
}

.canvas-text-editor textarea {
    width: 100%;
    min-height: 60px;
    padding: 8px 12px;
    border: 1px solid var(--border-color);
    border-radius: 6px;
    font-size: 1rem;
    font-family: inherit;
    resize: vertical;
    outline: none;
    transition: border-color 0.2s ease;
}

.canvas-text-editor textarea:focus {
    border-color: var(--primary-color);
}

.text-editor-controls {
    display: flex;
    justify-content: flex-end;
    gap: 8px;
}

.text-editor-btn {
    padding: 6px 12px;
    border: none;
    border-radius: 6px;
    font-size: 0.875rem;
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: 4px;
    transition: all 0.2s ease;
}

.text-editor-btn.confirm {
    background: var(--primary-color);
    color: white;
}

.text-editor-btn.confirm:hover {
    background: var(--primary-dark);
}

.text-editor-btn.cancel {
    background: #f3f4f6;
    color: #6b7280;
}

.text-editor-btn.cancel:hover {
    background: #e5e7eb;
}

[data-theme="dark"] .canvas-text-editor,
.dark-mode .canvas-text-editor {
    background: var(--card-background, #1e293b);
    border-color: var(--primary-color);
}

[data-theme="dark"] .canvas-text-editor textarea,
.dark-mode .canvas-text-editor textarea {
    background: var(--background-color, #0f172a);
    color: var(--text-primary);
    border-color: var(--border-color);
}

[data-theme="dark"] .text-editor-btn.cancel,
.dark-mode .text-editor-btn.cancel {
    background: var(--background-color);
    color: var(--text-secondary);
}

/* ============================================================================
   DOCUMENT VIEWER (PDF/Word/PPT)
   ============================================================================ */

.document-viewer-overlay {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.9);
    z-index: 50;
    display: flex;
    flex-direction: column;
}

.document-viewer-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 12px 20px;
    background: rgba(0, 0, 0, 0.8);
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
}

.document-title {
    color: white;
    font-size: 0.95rem;
    font-weight: 500;
}

.document-viewer-controls {
    display: flex;
    align-items: center;
    gap: 8px;
}

.doc-viewer-btn {
    width: 36px;
    height: 36px;
    border: 1px solid rgba(255, 255, 255, 0.2);
    background: rgba(255, 255, 255, 0.1);
    color: white;
    border-radius: 8px;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.2s ease;
}

.doc-viewer-btn:hover {
    background: rgba(255, 255, 255, 0.2);
    border-color: rgba(255, 255, 255, 0.4);
}

.doc-viewer-btn.close-btn:hover {
    background: rgba(239, 68, 68, 0.8);
    border-color: #ef4444;
}

.doc-page-info {
    color: white;
    font-size: 0.875rem;
    padding: 0 12px;
}

.document-viewer-content {
    flex: 1;
    overflow: auto;
    display: flex;
    justify-content: center;
    align-items: flex-start;
    padding: 20px;
}

.document-viewer-content img,
.document-viewer-content canvas {
    max-width: 100%;
    height: auto;
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.5);
}

/* ============================================================================
   AD PANEL (slides in at 28 minutes)
   ============================================================================ */

.whiteboard-ad-panel {
    position: absolute;
    top: 60px;
    right: -320px;
    width: 300px;
    height: calc(100% - 120px);
    background: var(--card-background, white);
    border-left: 1px solid var(--border-color);
    box-shadow: -4px 0 20px rgba(0, 0, 0, 0.15);
    z-index: 60;
    display: flex;
    flex-direction: column;
    transition: right 0.5s cubic-bezier(0.4, 0, 0.2, 1);
}

.whiteboard-ad-panel.active {
    right: 0;
}

.ad-panel-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 12px 16px;
    background: linear-gradient(135deg, #667eea, #764ba2);
    color: white;
}

.ad-label {
    font-size: 0.75rem;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    opacity: 0.9;
}

.ad-close-btn {
    width: 28px;
    height: 28px;
    border: none;
    background: rgba(255, 255, 255, 0.2);
    color: white;
    border-radius: 6px;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: background 0.2s ease;
}

.ad-close-btn:hover {
    background: rgba(255, 255, 255, 0.3);
}

.ad-panel-content {
    flex: 1;
    overflow-y: auto;
    padding: 16px;
}

.ad-placeholder {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    height: 100%;
    color: var(--text-secondary);
    text-align: center;
}

.ad-placeholder i {
    font-size: 3rem;
    margin-bottom: 12px;
    opacity: 0.3;
}

.ad-placeholder p {
    font-size: 0.875rem;
}

.ad-panel-footer {
    padding: 12px 16px;
    background: var(--background-color, #f8fafc);
    border-top: 1px solid var(--border-color);
    text-align: center;
}

.ad-timer {
    font-size: 0.8rem;
    color: var(--text-secondary);
    font-weight: 500;
}

[data-theme="dark"] .whiteboard-ad-panel,
.dark-mode .whiteboard-ad-panel {
    background: var(--card-background, #1e293b);
}

[data-theme="dark"] .ad-panel-footer,
.dark-mode .ad-panel-footer {
    background: var(--background-color, #0f172a);
}

/* ============================================================================
   TIMED POP-UPS (bottom right, at specific intervals)
   ============================================================================ */

.whiteboard-popup-container {
    position: fixed;
    bottom: 20px;
    right: 20px;
    z-index: 9998;
    display: flex;
    flex-direction: column;
    gap: 12px;
    pointer-events: none;
}

.whiteboard-popup {
    min-width: 280px;
    max-width: 350px;
    background: var(--card-background, white);
    border-radius: 12px;
    box-shadow: 0 8px 30px rgba(0, 0, 0, 0.2);
    overflow: hidden;
    pointer-events: all;
    animation: popupSlideIn 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    transform-origin: right bottom;
}

.whiteboard-popup.exiting {
    animation: popupSlideOut 0.3s cubic-bezier(0.4, 0, 0.2, 1) forwards;
}

@keyframes popupSlideIn {
    0% {
        opacity: 0;
        transform: translateX(100%) scale(0.8);
    }
    100% {
        opacity: 1;
        transform: translateX(0) scale(1);
    }
}

@keyframes popupSlideOut {
    0% {
        opacity: 1;
        transform: translateX(0) scale(1);
    }
    100% {
        opacity: 0;
        transform: translateX(100%) scale(0.8);
    }
}

.popup-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 12px 16px;
    background: linear-gradient(135deg, var(--primary-color), #4f46e5);
    color: white;
}

.popup-header-content {
    display: flex;
    align-items: center;
    gap: 10px;
}

.popup-header-content i {
    font-size: 1.25rem;
}

.popup-title {
    font-size: 0.9rem;
    font-weight: 600;
}

.popup-close-btn {
    width: 24px;
    height: 24px;
    border: none;
    background: rgba(255, 255, 255, 0.2);
    color: white;
    border-radius: 6px;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 0.75rem;
    transition: background 0.2s ease;
}

.popup-close-btn:hover {
    background: rgba(255, 255, 255, 0.3);
}

.popup-content {
    padding: 16px;
}

.popup-content p {
    font-size: 0.875rem;
    color: var(--text-primary);
    margin: 0 0 12px 0;
    line-height: 1.5;
}

.popup-content .popup-cta {
    display: inline-flex;
    align-items: center;
    gap: 8px;
    padding: 8px 16px;
    background: var(--primary-color);
    color: white;
    border: none;
    border-radius: 8px;
    font-size: 0.85rem;
    font-weight: 500;
    cursor: pointer;
    transition: all 0.2s ease;
}

.popup-content .popup-cta:hover {
    background: var(--primary-dark);
    transform: translateY(-2px);
}

.popup-timer-bar {
    height: 3px;
    background: var(--border-color);
    overflow: hidden;
}

.popup-timer-progress {
    height: 100%;
    background: var(--primary-color);
    animation: popupTimer 12s linear forwards;
}

@keyframes popupTimer {
    0% { width: 100%; }
    100% { width: 0%; }
}

[data-theme="dark"] .whiteboard-popup,
.dark-mode .whiteboard-popup {
    background: var(--card-background, #1e293b);
    border: 1px solid var(--border-color);
}

/* ============================================================================
   PAGE THUMBNAILS TOGGLE
   ============================================================================ */

.page-thumbnails-toggle {
    margin-left: auto;
    user-select: none;
    -webkit-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
}

.thumbnail-toggle-btn {
    width: 36px;
    height: 36px;
    border: 1px solid var(--border-color);
    background: white;
    color: var(--text-secondary);
    border-radius: 8px;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.2s ease;
    user-select: none;
    -webkit-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
}

.thumbnail-toggle-btn:hover {
    background: var(--primary-color);
    color: white;
    border-color: var(--primary-color);
}

[data-theme="dark"] .thumbnail-toggle-btn,
.dark-mode .thumbnail-toggle-btn {
    background: var(--card-background);
    border-color: var(--border-color);
}

/* Remote cursor indicators for real-time collaboration */
.remote-cursor {
    position: absolute;
    pointer-events: none;
    z-index: 100;
    transition: all 0.1s ease;
}

.remote-cursor-pointer {
    width: 0;
    height: 0;
    border-left: 8px solid transparent;
    border-right: 8px solid transparent;
    border-bottom: 16px solid var(--cursor-color, #3b82f6);
    transform: rotate(-45deg);
}

.remote-cursor-label {
    position: absolute;
    top: 16px;
    left: 12px;
    padding: 2px 8px;
    background: var(--cursor-color, #3b82f6);
    color: white;
    font-size: 0.7rem;
    font-weight: 500;
    border-radius: 4px;
    white-space: nowrap;
}

/* Drawing indicator when others are drawing */
.drawing-indicator {
    position: absolute;
    top: 12px;
    right: 12px;
    display: flex;
    align-items: center;
    gap: 8px;
    padding: 8px 12px;
    background: rgba(59, 130, 246, 0.9);
    color: white;
    border-radius: 8px;
    font-size: 0.8rem;
    z-index: 10;
}

.drawing-indicator .drawing-dot {
    width: 8px;
    height: 8px;
    border-radius: 50%;
    background: white;
    animation: drawingPulse 0.6s infinite;
}

@keyframes drawingPulse {
    0%, 100% { transform: scale(1); opacity: 1; }
    50% { transform: scale(1.5); opacity: 0.5; }
}


/* Mobile overlay backdrop */
.mobile-sidebar-backdrop {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-color: rgba(0, 0, 0, 0.5);
    z-index: 999; /* Below sidebars (1000+) */
    opacity: 0;
    transition: opacity 0.3s ease;
}

.mobile-sidebar-backdrop.active {
    display: block;
    opacity: 1;
}


/* ============================================================================
   RESPONSIVE DESIGN - Mobile, Tablet, Desktop
   ============================================================================ */

/* ============================================================================
   TABLET LANDSCAPE & SMALL DESKTOP (max-width: 1200px)
   ============================================================================ */
@media (max-width: 1200px) {
    /* Modal adjustments */
    .whiteboard-modal {
        width: 98vw;
        height: 95vh;
    }

    /* Header adjustments */
    .whiteboard-header {
        padding: 12px 16px;
    }

    .whiteboard-title {
        font-size: 1.1rem;
        gap: 8px;
    }

    .whiteboard-session-info {
        font-size: 0.8rem;
        gap: 12px;
    }

    /* Toolbar adjustments */
    .whiteboard-toolbar {
        padding: 8px 12px;
        flex-wrap: wrap;
        gap: 8px;
    }

    .tool-button, .format-button {
        padding: 6px 10px;
        font-size: 0.85rem;
    }

    .tool-icon {
        font-size: 0.9rem;
    }

    /* Right sidebar adjustments - only when NOT collapsed */
    .whiteboard-right-sidebar:not(.collapsed) {
        width: 300px;
    }

    .whiteboard-right-sidebar:not(.collapsed) .right-sidebar-content {
        width: 250px;
    }

    /* Collapsed state - keep icon bar only */
    .whiteboard-right-sidebar.collapsed {
        width: 50px;
    }

    .whiteboard-right-sidebar.collapsed .right-sidebar-content {
        width: 0 !important;
    }
}

/* ============================================================================
   TABLET PORTRAIT (max-width: 1024px)
   ============================================================================ */
@media (max-width: 1024px) {
    /* Modal full screen on tablets */
    .whiteboard-modal {
        width: 100vw;
        height: 100vh;
        border-radius: 0;
    }

    /* Header compact */
    .whiteboard-header {
        padding: 10px 12px;
    }

    .whiteboard-title {
        font-size: 1rem;
    }

    .whiteboard-title i {
        font-size: 1.2rem;
    }

    .whiteboard-session-info {
        font-size: 0.75rem;
        gap: 8px;
    }

    .session-status {
        padding: 4px 8px;
    }

    /* Show right sidebar toggle */
    #rightSidebarToggle {
        display: flex;
    }

    /* Right sidebar as overlay on tablet */
    .whiteboard-right-sidebar {
        position: fixed;
        right: 0;
        top: 60px;
        height: calc(100vh - 60px);
        z-index: 1000;
        transform: translateX(100%);
        transition: transform 0.3s ease;
        box-shadow: -4px 0 12px rgba(0, 0, 0, 0.15);
    }

    .whiteboard-right-sidebar.expanded {
        transform: translateX(0);
    }

    /* Left sidebar narrower */
    .sidebar-content {
        width: 250px;
    }

    /* Canvas area expands when right sidebar is overlay */
    .whiteboard-body {
        grid-template-columns: auto 1fr; /* Left sidebar + canvas (right sidebar is overlay) */
    }

    /* Canvas adjustments - with margin for when right sidebar expands */
    .whiteboard-canvas-area {
        padding: 0;
        width: 100%;
        margin-right: 0;
        transition: margin-right 0.3s ease, width 0.3s ease;
    }

    /* When right sidebar is expanded, add helper class to body for canvas adjustment */
    /* This needs to be toggled via JavaScript when right sidebar opens/closes */
    .whiteboard-body:has(.whiteboard-right-sidebar.expanded) .whiteboard-canvas-area {
        margin-right: 470px; /* Right sidebar width (420px content + 50px icon bar) */
    }

    /* Page navigation compact */
    .page-navigation {
        padding: 8px 12px;
        flex-wrap: wrap;
        gap: 8px;
    }

    .page-nav-btn {
        padding: 6px 12px;
        font-size: 0.8rem;
    }

    /* Video grid adjustments */
    .video-grid-container {
        gap: 8px;
    }

    .tutor-video-row {
        height: 180px;
    }
}

/* ============================================================================
   MOBILE LANDSCAPE (max-width: 768px)
   ============================================================================ */
@media (max-width: 768px) {
    /* Header mobile layout */
    .whiteboard-header {
        padding: 8px 12px;
    }

    .whiteboard-session-info {
        display: none; /* Hide session info on mobile to save space */
    }

    /* Show mobile toggle for left sidebar */
    .mobile-toggle-history {
        display: flex;
    }

    /* Left sidebar as overlay with VERTICAL layout (icon bar on top) */
    .whiteboard-sidebar {
        position: fixed;
        left: 0;
        top: 60px;
        height: calc(100vh - 60px);
        width: 280px;
        max-width: 85vw;
        z-index: 1001;
        transform: translateX(-100%);
        transition: transform 0.3s ease;
        box-shadow: 4px 0 12px rgba(0, 0, 0, 0.15);
        flex-direction: column; /* Stack vertically on mobile */
    }

    .whiteboard-sidebar.mobile-active {
        transform: translateX(0);
    }

    /* Icon bar becomes horizontal header on mobile */
    .sidebar-icon-bar {
        width: 100%;
        height: auto;
        min-height: 56px; /* Ensure adequate height for touch targets */
        flex-direction: row; /* Horizontal layout */
        padding: 8px 12px;
        border-right: none;
        border-bottom: 1px solid var(--border-color);
        overflow-x: auto;
        -webkit-overflow-scrolling: touch;
        scrollbar-width: thin;
        display: flex;
        align-items: center;
    }

    /* Icon buttons in horizontal row */
    .sidebar-icon-btn {
        width: 40px;
        height: 40px;
        flex-shrink: 0;
    }

    /* Divider vertical on mobile */
    .sidebar-icon-bar-divider {
        display: block; /* Show divider on mobile */
        width: 1px;
        height: 28px;
        margin: 0 6px;
        flex-shrink: 0;
    }

    /* Sidebar content takes remaining space */
    .sidebar-content {
        width: 100%;
        flex: 1;
    }

    /* Toolbar mobile */
    .whiteboard-toolbar {
        padding: 6px 8px;
        gap: 4px;
        overflow-x: auto;
        overflow-y: hidden;
        -webkit-overflow-scrolling: touch;
        scrollbar-width: thin;
    }

    .toolbar-section {
        flex-shrink: 0;
        gap: 4px;
    }

    .tool-button, .format-button {
        padding: 6px 8px;
        font-size: 0.75rem;
        min-width: 36px;
    }

    .tool-button .btn-text {
        display: none; /* Hide text labels on mobile */
    }

    .toolbar-divider {
        margin: 0 4px;
    }

    /* Color and stroke controls */
    .color-picker-wrapper {
        width: 32px;
        height: 32px;
    }

    .color-display {
        width: 32px;
        height: 32px;
    }

    .stroke-width-selector {
        max-width: 100px;
    }

    .stroke-width-selector input {
        width: 50px;
    }

    .width-display {
        font-size: 0.7rem;
    }

    /* Canvas area takes full width on mobile (sidebars are overlays) */
    .whiteboard-body {
        grid-template-columns: 1fr; /* Single column - canvas only */
    }

    .whiteboard-canvas-area {
        width: 100%;
        margin: 0;
    }

    /* Canvas container */
    .canvas-container {
        height: calc(100vh - 180px);
    }

    #whiteboardCanvas,
    #whiteboardCanvasNext {
        max-width: 100%;
        height: auto;
    }

    /* Text editor mobile */
    .canvas-text-editor {
        max-width: 90%;
    }

    .canvas-text-editor textarea {
        font-size: 0.9rem;
        padding: 8px;
    }

    /* Page navigation mobile */
    .page-navigation {
        flex-direction: column;
        gap: 6px;
        padding: 6px 8px;
    }

    .page-controls {
        gap: 6px;
        width: 100%;
        justify-content: center;
    }

    .page-nav-btn {
        padding: 6px 10px;
        font-size: 0.75rem;
        flex: 1;
    }

    .page-nav-btn i {
        font-size: 0.7rem;
    }

    /* Right sidebar mobile - VERTICAL LAYOUT (icon bar on top) */
    .whiteboard-right-sidebar {
        position: fixed;
        right: 0;
        top: 60px;
        height: calc(100vh - 60px);
        width: 280px;
        max-width: 85vw;
        flex-direction: column; /* Stack vertically on mobile */
        transform: translateX(100%); /* Hidden by default */
        transition: transform 0.3s ease;
        z-index: 1000;
        box-shadow: -4px 0 12px rgba(0, 0, 0, 0.15);
    }

    .whiteboard-right-sidebar.mobile-active {
        transform: translateX(0); /* Show when active */
    }

    /* Right sidebar icon bar becomes horizontal header on mobile */
    .whiteboard-right-sidebar .right-sidebar-icon-bar {
        width: 100%;
        height: auto;
        min-height: 56px; /* Same as left sidebar */
        flex-direction: row; /* Horizontal layout */
        padding: 8px 12px;
        border-left: none;
        border-bottom: 1px solid var(--border-color);
        overflow-x: auto;
        -webkit-overflow-scrolling: touch;
        scrollbar-width: thin;
        display: flex;
        align-items: center;
    }

    /* Right sidebar icon buttons in horizontal row */
    .whiteboard-right-sidebar .right-sidebar-icon-btn {
        width: 40px;
        height: 40px;
        flex-shrink: 0;
    }

    /* Right sidebar content takes remaining space */
    .whiteboard-right-sidebar .right-sidebar-content {
        width: 100%;
        flex: 1;
    }

    /* Video grid mobile */
    .tutor-video-row {
        height: 150px;
    }

    .student-video-grid {
        grid-template-columns: 1fr;
    }

    .student-video-item {
        height: 120px;
    }

    /* Chat mobile */
    .chat-messages {
        font-size: 0.85rem;
    }

    .chat-input-area input {
        font-size: 0.9rem;
        padding: 8px 12px;
    }

    /* AI panel mobile */
    .ai-messages {
        font-size: 0.85rem;
    }

    .ai-quick-actions {
        gap: 6px;
    }

    .ai-quick-btn {
        padding: 6px 10px;
        font-size: 0.75rem;
    }

    /* Sidebar panels mobile */
    .sidebar-panel-header h3 {
        font-size: 0.9rem;
    }

    .sidebar-search-bar input {
        font-size: 0.85rem;
        padding: 6px 10px;
    }

    /* Session cards mobile */
    .session-card {
        margin-bottom: 8px;
    }

    .session-card-header {
        padding: 10px;
    }

    .session-card-title {
        font-size: 0.8rem;
    }

    .session-card-date {
        font-size: 0.7rem;
    }

    /* Lab course cards mobile */
    .lab-course-card {
        padding: 10px;
    }

    .lab-course-icon {
        width: 36px;
        height: 36px;
        font-size: 1.1rem;
    }

    .lab-course-info h4 {
        font-size: 0.85rem;
    }

    .lab-course-info p {
        font-size: 0.7rem;
    }

    /* Lab tools grid mobile */
    .lab-tools-grid {
        grid-template-columns: repeat(2, 1fr);
        gap: 8px;
    }

    .lab-tool-card {
        padding: 10px;
    }

    .lab-tool-icon {
        width: 36px;
        height: 36px;
        font-size: 1.1rem;
    }

    .lab-tool-card span {
        font-size: 0.75rem;
    }

    /* Minimized state mobile */
    .whiteboard-modal.minimized {
        width: calc(100vw - 40px);
        bottom: 10px;
        right: 10px;
    }
}

/* ============================================================================
   MOBILE PORTRAIT (max-width: 480px)
   ============================================================================ */
@media (max-width: 480px) {
    /* Header ultra compact */
    .whiteboard-header {
        padding: 6px 8px;
    }

    .whiteboard-title {
        font-size: 0.9rem;
        gap: 6px;
    }

    .whiteboard-title i {
        font-size: 1rem;
    }

    .header-icon-btn {
        padding: 6px 8px;
        font-size: 0.85rem;
    }

    .whiteboard-header-right {
        gap: 4px;
    }

    /* Hide minimize/maximize on small mobile */
    #minimizeWhiteboard,
    #maximizeWhiteboard {
        display: none;
    }

    /* Toolbar ultra compact */
    .whiteboard-toolbar {
        padding: 4px 6px;
    }

    .tool-button, .format-button {
        padding: 4px 6px;
        font-size: 0.7rem;
        min-width: 32px;
        height: 32px;
    }

    .tool-icon {
        font-size: 0.85rem;
    }

    /* Primary tools always visible */
    .toolbar-section.primary-tools {
        gap: 4px;
    }

    /* Hide tool labels completely */
    .toolbar-section {
        gap: 3px;
    }

    /* Canvas full height */
    .canvas-container {
        height: calc(100vh - 160px);
    }

    /* Smaller canvas for better performance */
    #whiteboardCanvas,
    #whiteboardCanvasNext {
        width: 100%;
        height: auto;
    }

    /* Text editor full width on small mobile */
    .canvas-text-editor {
        max-width: 95%;
        min-width: 280px;
    }

    .canvas-text-editor textarea {
        font-size: 0.85rem;
        padding: 6px 8px;
    }

    /* Page navigation ultra compact */
    .page-navigation {
        padding: 4px 6px;
        gap: 4px;
    }

    .page-info {
        font-size: 0.75rem;
    }

    .page-nav-btn {
        padding: 4px 8px;
        font-size: 0.7rem;
    }

    .add-page-btn i {
        margin-right: 2px;
    }

    /* Thumbnail toggle */
    .thumbnail-toggle-btn {
        padding: 4px 8px;
    }

    /* Sidebar adjustments for small mobile */
    .whiteboard-sidebar {
        width: 260px;
        max-width: 90vw;
    }

    .sidebar-content {
        width: 100%;
    }

    /* Right sidebar small mobile adjustments */
    .whiteboard-right-sidebar {
        width: 260px;
        max-width: 90vw;
    }

    .whiteboard-right-sidebar .right-sidebar-icon-bar {
        padding: 6px 8px;
        min-height: 48px; /* Smaller but still touch-friendly */
    }

    .whiteboard-right-sidebar .right-sidebar-icon-btn {
        width: 36px;
        height: 36px;
        font-size: 0.9rem;
    }

    .whiteboard-right-sidebar .right-sidebar-content {
        width: 100%;
    }

    /* Smaller icon bar on small mobile */
    .sidebar-icon-bar {
        padding: 6px 8px;
        min-height: 48px; /* Smaller but still touch-friendly */
    }

    .sidebar-icon-btn {
        width: 36px;
        height: 36px;
        font-size: 1rem;
    }

    .sidebar-icon-bar-divider {
        height: 24px;
        margin: 0 4px;
    }

    /* Video controls */
    .video-controls {
        gap: 6px;
    }

    .video-control-btn {
        width: 32px;
        height: 32px;
        font-size: 0.85rem;
    }

    /* Chat ultra compact */
    .chat-message {
        padding: 6px 8px;
        font-size: 0.8rem;
    }

    .chat-input-area input {
        font-size: 0.85rem;
        padding: 6px 10px;
    }

    .send-message-btn {
        width: 32px;
        height: 32px;
    }

    /* AI panel ultra compact */
    .ai-bubble {
        padding: 8px 10px;
        font-size: 0.8rem;
    }

    .ai-quick-btn {
        padding: 4px 8px;
        font-size: 0.7rem;
    }

    /* Document viewer mobile */
    .document-viewer-header {
        padding: 8px;
    }

    .document-title {
        font-size: 0.85rem;
    }

    .doc-viewer-btn {
        width: 32px;
        height: 32px;
        font-size: 0.85rem;
    }

    /* Ad panel mobile */
    .whiteboard-ad-panel {
        width: 100%;
        max-width: 280px;
    }

    /* Allow interaction button mobile */
    #allowInteractionBtn {
        padding: 6px 8px;
        font-size: 0.75rem;
    }

    .request-badge {
        width: 16px;
        height: 16px;
        font-size: 0.65rem;
    }

    /* Interaction dropdown mobile */
    .interaction-requests-dropdown {
        width: calc(100vw - 20px);
        max-width: 320px;
        right: 0;
    }

    /* Session info hidden on mobile */
    .session-timer,
    .session-status {
        display: none;
    }

    /* Minimized modal mobile */
    .whiteboard-modal.minimized {
        width: calc(100vw - 20px);
        height: 50px;
        bottom: 10px;
        right: 10px;
        left: 10px;
    }

    .whiteboard-modal.minimized .whiteboard-title {
        font-size: 0.85rem;
    }
}

/* ============================================================================
   LANDSCAPE ORIENTATION ADJUSTMENTS
   ============================================================================ */
@media (max-height: 500px) and (orientation: landscape) {
    /* Optimize for landscape phones */
    .whiteboard-header {
        padding: 4px 8px;
    }

    .whiteboard-toolbar {
        padding: 3px 6px;
    }

    .tool-button, .format-button {
        padding: 3px 6px;
        height: 28px;
    }

    .canvas-container {
        height: calc(100vh - 120px);
    }

    .page-navigation {
        padding: 3px 6px;
    }

    /* Sidebars overlay in landscape */
    .whiteboard-sidebar,
    .whiteboard-right-sidebar {
        position: fixed;
        z-index: 1001;
    }
}

/* ============================================================================
   TOUCH DEVICE OPTIMIZATIONS
   ============================================================================ */
@media (hover: none) and (pointer: coarse) {
    /* Larger touch targets */
    .tool-button,
    .format-button,
    .header-icon-btn,
    .page-nav-btn {
        min-height: 44px;
        min-width: 44px;
    }

    .sidebar-icon-btn,
    .right-sidebar-icon-btn {
        min-height: 48px;
        min-width: 48px;
    }

    /* Better scrolling */
    .session-history-list,
    .chat-messages,
    .ai-messages,
    .whiteboard-toolbar {
        -webkit-overflow-scrolling: touch;
    }

    /* Remove hover effects on touch */
    .tool-button:hover,
    .session-card:hover {
        transform: none;
    }

    /* Larger color picker for touch */
    .color-display {
        min-width: 40px;
        min-height: 40px;
    }
}

/* ============================================================================
   HIGH DPI DISPLAYS (Retina)
   ============================================================================ */
@media (-webkit-min-device-pixel-ratio: 2), (min-resolution: 192dpi) {
    /* Sharper borders */
    .whiteboard-modal,
    .session-card,
    .tool-button {
        border-width: 0.5px;
    }

    /* Crisp icons */
    .tool-icon,
    .sidebar-icon-btn i,
    .right-sidebar-icon-btn i {
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
    }
}

/* ============================================================================
   PRINT STYLES
   ============================================================================ */
@media print {
    .whiteboard-modal-overlay {
        background-color: white;
    }

    .whiteboard-header,
    .whiteboard-sidebar,
    .whiteboard-right-sidebar,
    .whiteboard-toolbar,
    .page-navigation {
        display: none !important;
    }

    .whiteboard-canvas-area {
        width: 100%;
        padding: 0;
    }

    .canvas-container {
        height: auto;
        page-break-inside: avoid;
    }

    #whiteboardCanvas {
        max-width: 100%;
        height: auto;
    }
}
